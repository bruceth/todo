(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],[,,,,,,,function(e,t,n){"use strict";n(21);var r=n(19);n.d(t,"userApi",(function(){return r.p}));var a=n(15);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Loading")&&n.d(t,"Loading",(function(){return a.Loading})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"NavView")&&n.d(t,"NavView",(function(){return a.NavView})),n.o(a,"Page")&&n.d(t,"Page",(function(){return a.Page})),n.o(a,"QueryPager")&&n.d(t,"QueryPager",(function(){return a.QueryPager})),n.o(a,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return a.TabCaptionComponent})),n.o(a,"Tabs")&&n.d(t,"Tabs",(function(){return a.Tabs})),n.o(a,"Tuid")&&n.d(t,"Tuid",(function(){return a.Tuid})),n.o(a,"UserIcon")&&n.d(t,"UserIcon",(function(){return a.UserIcon})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"nav")&&n.d(t,"nav",(function(){return a.nav})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"tv")&&n.d(t,"tv",(function(){return a.tv})),n.o(a,"useUser")&&n.d(t,"useUser",(function(){return a.useUser}));n(92);var i=n(59);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Loading")&&n.d(t,"Loading",(function(){return i.Loading})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"NavView")&&n.d(t,"NavView",(function(){return i.NavView})),n.o(i,"Page")&&n.d(t,"Page",(function(){return i.Page})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return i.TabCaptionComponent})),n.o(i,"Tabs")&&n.d(t,"Tabs",(function(){return i.Tabs})),n.o(i,"Tuid")&&n.d(t,"Tuid",(function(){return i.Tuid})),n.o(i,"UserIcon")&&n.d(t,"UserIcon",(function(){return i.UserIcon})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"nav")&&n.d(t,"nav",(function(){return i.nav})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"tv")&&n.d(t,"tv",(function(){return i.tv})),n.o(i,"useUser")&&n.d(t,"useUser",(function(){return i.useUser}));var s=n(89);n.d(t,"CAppBase",(function(){return s.a})),n.d(t,"CBase",(function(){return s.b})),n.d(t,"CSub",(function(){return s.c})),n.d(t,"start",(function(){return s.d}));var c=n(33);n.d(t,"VPage",(function(){return c.b})),n.d(t,"View",(function(){return c.c}))},,,,,,,,function(e,t,n){"use strict";var r=n(18);n.d(t,"NavView",(function(){return r.a})),n.d(t,"nav",(function(){return r.b}));var a=n(72);n.d(t,"Page",(function(){return a.a})),n.d(t,"TabCaptionComponent",(function(){return a.b})),n.d(t,"Tabs",(function(){return a.c}));var i=n(73);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Loading")&&n.d(t,"Loading",(function(){return i.Loading})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"Tuid")&&n.d(t,"Tuid",(function(){return i.Tuid})),n.o(i,"UserIcon")&&n.d(t,"UserIcon",(function(){return i.UserIcon})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"emailRegex")&&n.d(t,"emailRegex",(function(){return i.emailRegex})),n.o(i,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return i.mobileRegex})),n.o(i,"resLang")&&n.d(t,"resLang",(function(){return i.resLang})),n.o(i,"resOptions")&&n.d(t,"resOptions",(function(){return i.resOptions})),n.o(i,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return i.setGlobalRes})),n.o(i,"setRes")&&n.d(t,"setRes",(function(){return i.setRes})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"t")&&n.d(t,"t",(function(){return i.t})),n.o(i,"tv")&&n.d(t,"tv",(function(){return i.tv})),n.o(i,"useUser")&&n.d(t,"useUser",(function(){return i.useUser}));var s=n(87);n.d(t,"Form",(function(){return s.a}));var c=n(88);n.d(t,"Edit",(function(){return c.a}));var o=n(32);n.d(t,"resLang",(function(){return o.a})),n.d(t,"resOptions",(function(){return o.b})),n.d(t,"setGlobalRes",(function(){return o.c})),n.d(t,"setRes",(function(){return o.d})),n.d(t,"t",(function(){return o.e}));var u=n(46);n.d(t,"Loading",(function(){return u.a}));var l=n(36);n.d(t,"Image",(function(){return l.a}));n(58);var d=n(78);n.d(t,"emailRegex",(function(){return d.a})),n.d(t,"mobileRegex",(function(){return d.b}));var h=n(90);n.d(t,"List",(function(){return h.a}));n(79);var f=n(80);n.d(t,"EasyTime",(function(){return f.a}));n(91);var p=n(41);n.d(t,"FA",(function(){return p.a})),n.d(t,"LMR",(function(){return p.b})),n.d(t,"Muted",(function(){return p.c}));n(81),n(82);var v=n(83);n.d(t,"UserIcon",(function(){return v.a})),n.d(t,"UserView",(function(){return v.b})),n.d(t,"useUser",(function(){return v.c}))},,,function(e,t,n){"use strict";var r,a,i=n(11),s=n(10),c=n(9),o=(n(22),n(1)),u=n.n(o),l=n(2),d=n(3),h=n(4),f=n(6),p=n(5),v=n(0),m=n(8),b=n(93),y=n.n(b),k=n(23),g=n(30),w=n(31),O=function(e,t){Object(g.i)(e,t),w.a.setCenterToken(t)},j=n(19),x=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).reApi=Object(l.a)(u.a.mark((function t(){var n,r,a,i,s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.props.clearError(),n=e.props,r=n.channel,a=n.url,i=n.options,s=n.resolve,c=n.reject,t.next=4,Object(j.l)(r,a,i,s,c);case 4:case"end":return t.stop()}}),t)}))),e.close=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.clearError();case 1:case"end":return t.stop()}}),t)}))),e}return Object(h.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.error,r=t.url;if("object"===typeof n){var a=[];for(var i in n)a.push(v.createElement("li",{key:i},v.createElement("label",null,i),v.createElement("div",{style:{wordWrap:"break-word"}},n[i])));e=v.createElement("ul",null,a)}else e=v.createElement("div",null,n);return v.createElement("div",null,v.createElement("article",null,v.createElement("main",{className:"va-error"},v.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),v.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),v.createElement("div",{style:{wordWrap:"break-word"}},"url: ",r),e,v.createElement("div",{className:"p-3"},v.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),v.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed")))))}}]),n}(v.Component),E=function(e){var t=e.message;return v.createElement(k.a,{header:"\u7cfb\u7edf\u63d0\u9192"},v.createElement("div",{className:"px-3"},t))},C=n(25),N=n(21),A=n(32),T=n(46),I=(n(71),n(96),n(107),n(108),n(41)),S=n(54),P=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(d.a)(this,n),(r=t.call(this,e)).timerHandler=void 0,r.reload=function(){clearInterval(r.timerHandler),U.reload()};var a=e.seconds;return void 0===a?Object(S.a)(r):(r.state={seconds:a},a<=0?Object(S.a)(r):(r.timerHandler=setInterval((function(){var e=r.state.seconds;--e<=0?r.reload():r.setState({seconds:e})}),1e3),r))}return Object(h.a)(n,[{key:"render",value:function(){var e,t;return this.state.seconds>0?(e="\u7a0b\u5e8f\u5347\u7ea7\u4e2d...",t=this.state.seconds+"\u79d2\u949f\u4e4b\u540e\u81ea\u52a8\u91cd\u542f\u52a8"):(e="\u7a0b\u5e8f\u9700\u8981\u5347\u7ea7",t="\u8bf7\u70b9\u51fb\u4e0b\u9762\u6309\u94ae\u91cd\u542f"),v.createElement(k.a,{header:!1},v.createElement("div",{className:"text-center p-5"},v.createElement("div",{className:"text-info py-5"},v.createElement("span",{className:"text-danger"},e),v.createElement("br",null),t,v.createElement("br",null),v.createElement("span",{className:"small text-muted"},this.props.message)),v.createElement("button",{className:"btn btn-danger",onClick:this.reload},"\u7acb\u523b\u91cd\u542f")))}}]),n}(v.Component),R=function(e){return v.createElement(k.a,{header:"\u5347\u7ea7\u8f6f\u4ef6",back:"close"},v.createElement("div",{className:"py-5 px-3 my-5 mx-2 border bg-white rounded"},v.createElement("div",{className:"text-center text-info"},"\u5347\u7ea7\u5c06\u6e05\u9664\u6240\u6709\u672c\u673a\u7f13\u51b2\u533a\u5185\u5bb9\uff0c\u5e76\u4ece\u670d\u52a1\u5668\u91cd\u65b0\u5b89\u88c5\u7a0b\u5e8f\uff01"),v.createElement("div",{className:"text-center mt-5"},v.createElement("button",{className:"btn btn-danger mr-3",onClick:function(){return e.confirm(!0)}},"\u786e\u8ba4\u5347\u7ea7"))))};n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return U}));var V,F=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent),L=[],M=1,D=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).stack=void 0,r.htmlTitle=void 0,r.waitCount=0,r.waitTimeHandler=void 0,r.upgradeUq=function(){U.start()},r.isHistoryBack=!1,r.navBack=function(){var e=Date.now();r.isHistoryBack=!0,r.back(!0),r.isHistoryBack=!1,console.log("///\\\\ ".concat(Date.now()-e,"ms backbutton pressed - nav level: ").concat(r.stack.length))},r.back=Object(l.a)(u.a.mark((function e(){var t,n,a,i,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(s.length>0&&void 0!==s[0])||s[0],n=r.stack,0!==(a=n.length)){e.next=5;break}return e.abrupt("return");case 5:if(1!==a){e.next=8;break}return window.self!==window.top&&window.top.postMessage({type:"pop-app"},"*"),e.abrupt("return");case 8:if(i=n[a-1],!0!==t||!i.confirmClose){e.next=17;break}return e.next=12,i.confirmClose();case 12:if(e.t0=e.sent,!0!==e.t0){e.next=15;break}r.pop();case 15:e.next=18;break;case 17:r.pop();case 18:case"end":return e.stop()}}),e)}))),r.clearError=function(){r.setState({fetchError:void 0})},r.stack=[],r.state={stack:r.stack,wait:0,fetchError:void 0},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("popstate",this.navBack),U.set(this),e.next=4,U.start();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startWait",value:function(){var e=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=N.c.setTimeout("NavView.startWait",(function(){e.waitTimeHandler=void 0,e.setState({wait:2})}),1e3)),++this.waitCount,this.setState({fetchError:void 0})}},{key:"endWait",value:function(){var e=this;N.c.setTimeout(void 0,(function(){--e.waitCount,0===e.waitCount&&(void 0!==e.waitTimeHandler&&(N.c.clearTimeout(e.waitTimeHandler),e.waitTimeHandler=void 0),e.setState({wait:0}))}),100)}},{key:"onError",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=t.error)){e.next=14;break}if(!0!==n.unauthorized){e.next=6;break}return e.next=5,U.showLogin(void 0);case 5:return e.abrupt("return");case 6:e.t0=n.type,e.next="unauthorized"===e.t0?9:"sheet-processing"===e.t0?12:14;break;case 9:return e.next=11,U.showLogin(void 0);case 11:return e.abrupt("return");case 12:return U.push(v.createElement(E,{message:"\u5355\u636e\u6b63\u5728\u5904\u7406\u4e2d\u3002\u8bf7\u91cd\u65b0\u64cd\u4f5c\uff01"})),e.abrupt("return");case 14:this.setState({fetchError:t});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.show(v.createElement(k.a,{header:!1},v.createElement("div",null,"UQ\u5347\u7ea7\u4e86\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u5347\u7ea7 ",v.createElement("br",null),v.createElement("small",{className:"text-muted"},t," ver-",n),v.createElement("button",{className:"btn btn-primary",onClick:this.upgradeUq},"\u5347\u7ea7"))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"show",value:function(e,t){return this.clear(),this.push(e,t)}},{key:"push",value:function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=M++;return this.stack.push({key:n,view:e,ceased:!1,disposer:t}),this.refresh(),n}},{key:"replace",value:function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var a=M++;return this.stack.push({key:a,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh(),a}},{key:"ceaseTop",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){var r=this.stack[t];r.ceased=!0}}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,a=0;a<e&&0!==t.length;a++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}}},{key:"popTo",value:function(e){if(void 0!==e&&void 0!==this.stack.find((function(t){return t.key===e})))for(;this.stack.length>0;){var t=this.stack.length;if(this.stack[t-1].key===e)break;this.pop()}}},{key:"topKey",value:function(){var e=this.stack.length;if(0!==e)return this.stack[e-1].key}},{key:"removeCeased",value:function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()}},{key:"popAndDispose",value:function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}}},{key:"dispose",value:function(e){void 0!==e&&(void 0===this.stack.find((function(t){return t.disposer===e}))&&e())}},{key:"clear",value:function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose()}},{key:"regConfirmClose",value:function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)}},{key:"confirmBox",value:function(e){return window.confirm(e)}},{key:"render",value:function(){var e=this.state,t=e.wait,n=e.fetchError,r=this.state.stack,a=r.length-1,i=null,s=null;switch(t){case 1:i=v.createElement("div",{className:"va-wait va-wait1"});break;case 2:i=v.createElement("div",{className:"va-wait va-wait2"},v.createElement(T.a,null))}n&&(s=v.createElement(x,Object.assign({clearError:this.clearError},n)));var c=!0===U.testing&&v.createElement("span",{className:"cursor-pointer position-fixed",style:{top:0,left:"0.2rem",zIndex:90001}},v.createElement(I.a,{className:"text-warning",name:"info-circle"}));return v.createElement(v.Fragment,null,r.map((function(e,t){var n=e.key,r=e.view;return v.createElement("div",{key:n,style:t<a?{visibility:"hidden",position:"absolute"}:void 0},r)})),i,s,c)}},{key:"refresh",value:function(){this.setState({stack:this.stack})}},{key:"level",get:function(){return this.stack.length}}]),n}(v.Component),U=new(r=function(){function e(){var t=this;Object(d.a)(this,e),this.nav=void 0,this.ws=void 0,this.wsHost=void 0,this.local=new N.a,this.navSettings=void 0,Object(s.a)(this,"user",a,this),this.testing=void 0,this.language=void 0,this.culture=void 0,this.resUrl=void 0,this.hashParam=void 0,this.centerHost=void 0,this.arrs=["/test","/test/"],this.windowOnError=function(e,t,n,r,a){console.error("windowOnError"),console.error(a)},this.windowOnUnhandledRejection=function(e){console.error("windowOnUnhandledRejection"),console.error(e.reason)},this.windowOnClick=function(e){console.error("windowOnClick")},this.windowOnMouseMove=function(e){console.log("navigator.userAgent: "+navigator.userAgent),console.log("mouse move (%s, %s)",e.x,e.y)},this.windowOnScroll=function(e){console.log("scroll event")},this.showPrivacyPage=function(){var e=t.getPrivacyContent();e?t.privacyPage(e):U.push(v.createElement(k.a,{header:"\u9690\u79c1\u653f\u7b56"},v.createElement("div",{className:"p-3"},"AppConfig \u4e2d\u6ca1\u6709\u5b9a\u4e49 privacy\u3002\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5b57\u7b26\u4e32\uff0c\u6216\u8005url\u3002markdown\u683c\u5f0f")))},this.privacyPage=function(){var e=Object(l.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPrivacy(n);case 2:r=e.sent,a={__html:y()(r)},U.push(v.createElement(k.a,{header:"\u9690\u79c1\u653f\u7b56"},v.createElement("div",{className:"p-3",dangerouslySetInnerHTML:a})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.reload=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Promise((function(e,t){setTimeout(e,100)})),!("serviceWorker"in navigator)){e.next=6;break}return e.next=4,Promise.race([t,navigator.serviceWorker.ready]);case 4:(n=e.sent)&&n.unregister();case 6:window.document.location.reload();case 7:case"end":return e.stop()}}),e)}))),this.resetAll=function(){t.push(v.createElement(R,{confirm:function(e){!0===e?(t.showReloadPage("\u5f7b\u5e95\u5347\u7ea7"),localStorage.clear()):t.pop()}}))};var n=A.b.lang,r=A.b.district;this.language=n,this.culture=r,this.testing=!1}return Object(h.a)(e,[{key:"set",value:function(e){this.nav=e}},{key:"registerReceiveHandler",value:function(e){if(void 0!==this.ws)return this.ws.onWsReceiveAny(e)}},{key:"unregisterReceiveHandler",value:function(e){void 0!==this.ws&&void 0!==e&&this.ws.endWsReceive(e)}},{key:"onReceive",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.ws){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.ws.receive(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadUnitJson",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.unitJsonPath(),e.next=4,fetch(t,{});case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r.unit);case 11:return e.prev=11,e.t0=e.catch(0),this.local.unit.remove(),e.abrupt("return");case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPredefinedUnitName",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("unit.json")){e.next=5;break}return e.next=4,this.loadUnitJson();case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,n=t.innerHTML,r=JSON.parse(n),e.abrupt("return",r.unit);case 11:return e.prev=11,e.t0=e.catch(5),e.next=15,this.loadUnitJson();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadPredefinedUnit",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UNIT)){e.next=3;break}return e.abrupt("return",Number(t));case 3:if(void 0===(r=this.local.unit.get())){e.next=16;break}if(!0===N.c.isDevelopment){e.next=7;break}return e.abrupt("return",r.id);case 7:return e.next=9,this.getPredefinedUnitName();case 9:if(void 0!==(n=e.sent)){e.next=12;break}return e.abrupt("return");case 12:if(r.name!==n){e.next=14;break}return e.abrupt("return",r.id);case 14:e.next=21;break;case 16:return e.next=18,this.getPredefinedUnitName();case 18:if(void 0!==(n=e.sent)){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,j.h.unitFromName(n);case 23:return void 0!==(a=e.sent)&&this.local.unit.set({id:a,name:n}),e.abrupt("return",a);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(e){this.navSettings=e}},{key:"unitJsonPath",value:function(){var e=document.location,t=e.origin,n=e.pathname;n=n.toLowerCase();var r,a=Object(i.a)(this.arrs);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!0===n.endsWith(s)){n=n.substr(0,n.length-s.length);break}}}catch(c){a.e(c)}finally{a.f()}return!0!==n.endsWith("/")&&!0!==n.endsWith("\\")||(n=n.substr(0,n.length-1)),t+n+"/unit.json"}},{key:"start",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,a,i,s,c,o,l,d,h;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.onerror=this.windowOnError,window.onunhandledrejection=this.windowOnUnhandledRejection,!0===F&&(document.onselectstart=function(){return!1},document.oncontextmenu=function(){return!1}),this.testing=N.c.testing,e.next=7,j.i.start(this.testing);case 7:if(void 0!==(t=document.location.hash)&&t.length>0&&((n=Object(C.g)())<0&&(n=void 0),this.hashParam=t.substring(1,n)),U.clear(),this.startWait(),r=j.i.url,a=j.i.ws,i=j.i.resHost,this.centerHost=r,this.resUrl=Object(j.m)(i),this.wsHost=a,Object(j.o)(r),void 0!==(s=this.local.guest.get())){e.next=21;break}return e.next=20,j.h.guest();case 20:s=e.sent;case 21:if(U.setGuest(s),c=Object(C.f)(),o=Object(C.j)(c),void 0===c||window===window.parent){e.next=30;break}if(void 0===o){e.next=30;break}return this.ws=w.c,console.log("this.ws = wsBridge in sub frame"),window.self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:o.hash},"*"),e.abrupt("return");case 30:return e.next=32,this.loadPredefinedUnit();case 32:if(l=e.sent,o.predefinedUnit=l,void 0!==(d=this.local.user.get())){e.next=45;break}if(void 0===(h=this.nav.props.notLogined)){e.next=42;break}return e.next=40,h();case 40:e.next=44;break;case 42:return e.next=44,U.showLogin(void 0);case 44:return e.abrupt("return");case 45:return e.next=47,U.logined(d);case 47:e.next=51;break;case 49:e.prev=49,e.t0=e.catch(0);case 51:return e.prev=51,this.endWait(),e.finish(51);case 54:case"end":return e.stop()}}),e,this,[[0,49,51,54]])})));return function(){return e.apply(this,arguments)}}()},{key:"showAppView",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.nav.props.onLogined)){e.next=4;break}return U.push(v.createElement("div",null,"NavView has no prop onLogined")),e.abrupt("return");case 4:return U.clear(),e.next=7,t();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setGuest",value:function(e){this.local.guest.set(e),O(0,e.token)}},{key:"saveLocalUser",value:function(){this.local.user.set(this.user)}},{key:"loadMe",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.p.me();case 2:t=e.sent,this.user.icon=t.icon,this.user.nick=t.nick;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logined",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(j.k)(),console.log("logined: %s",JSON.stringify(t)),this.user=t,this.saveLocalUser(),O(t.id,t.token),void 0===n){e.next=9;break}n(t),e.next=11;break;case 9:return e.next=11,this.showAppView();case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"wsConnect",value:function(){(this.ws=new j.f(this.wsHost,this.user.token)).connect()}},{key:"loginTop",value:function(e){return this.navSettings&&this.navSettings.loginTop||e}},{key:"privacyEntry",value:function(){if(this.getPrivacyContent())return v.createElement("div",{className:"text-center"},v.createElement("button",{className:"btn btn-sm btn-link",onClick:this.showPrivacyPage},v.createElement("small",{className:"text-muted"},"\u9690\u79c1\u653f\u7b56")))}},{key:"getPrivacyContent",value:function(){if(this.navSettings)return this.navSettings.privacy}},{key:"getPrivacy",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Headers({"Content-Type":"text/plain"}),!((r=t.indexOf("://"))>0)){e.next=18;break}if("http"!==(a=t.substring(0,r).toLowerCase())&&"https"!==a){e.next=18;break}return e.prev=5,e.next=8,fetch(t,{method:"GET",headers:n});case 8:return i=e.sent,e.next=11,i.text();case 11:return s=e.sent,e.abrupt("return",s);case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",e.t0.message);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showLogin",value:function(){var e=Object(l.a)(u.a.mark((function e(t,r){var a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(3).then(n.bind(null,120));case 2:a=e.sent,i=v.createElement(a.default,{withBack:r,callback:t}),!0!==r&&(this.nav.clear(),this.pop()),this.nav.push(i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"showLogout",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=v.createElement("div",{className:"text-center justify-content-center"},v.createElement("button",{className:"btn btn-outline-danger",onClick:this.resetAll},"\u5347\u7ea7\u8f6f\u4ef6")),U.push(v.createElement(k.a,{header:"\u5b89\u5168\u9000\u51fa",back:"close",footer:n},v.createElement("div",{className:"my-5 mx-1 border border-info bg-white rounded p-3 text-center"},v.createElement("div",null,"\u9000\u51fa\u5f53\u524d\u8d26\u53f7\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5386\u53f2\u6570\u636e\uff0c\u4e0b\u6b21\u767b\u5f55\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u672c\u8d26\u53f7"),v.createElement("div",{className:"mt-3 text-center"},v.createElement("button",{className:"btn btn-danger",onClick:function(){return r.logout(t)}},"\u5b89\u5168\u9000\u51fa")))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j.g.unit=void 0,this.local.logoutClear(),this.user=void 0,Object(j.k)(),n=this.local.guest.get(),Object(j.n)(0,n&&n.token),this.ws=void 0,void 0!==t){e.next=12;break}return e.next=10,U.start();case 10:e.next=14;break;case 12:return e.next=14,t();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changePassword",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(4).then(n.bind(null,119));case 2:t=e.sent,U.push(v.createElement(t.ChangePasswordPage,null));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startWait",value:function(){this.nav.startWait()}},{key:"endWait",value:function(){this.nav.endWait()}},{key:"onError",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nav.onError(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nav.showUpgradeUq(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"show",value:function(e,t){this.nav.show(e,t)}},{key:"push",value:function(e,t){this.nav.push(e,t)}},{key:"replace",value:function(e,t){this.nav.replace(e,t)}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.nav.pop(e)}},{key:"topKey",value:function(){return this.nav.topKey()}},{key:"popTo",value:function(e){this.nav.popTo(e)}},{key:"clear",value:function(){this.nav.clear()}},{key:"navBack",value:function(){this.nav.navBack()}},{key:"ceaseTop",value:function(e){this.nav.ceaseTop(e)}},{key:"removeCeased",value:function(){this.nav.removeCeased()}},{key:"back",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.next=3,this.nav.back(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"regConfirmClose",value:function(e){this.nav.regConfirmClose(e)}},{key:"confirmBox",value:function(e){return this.nav.confirmBox(e)}},{key:"navToApp",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n,r,a,i){var s=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){var o=!0===s.centerHost.includes("http://localhost:")?"sheet_debug":"sheet",u=void 0===i?Object(C.c)(t,n):Object(C.c)(t,n,o,[r,a,i]);console.log("navToApp: %s",JSON.stringify(u)),U.push(v.createElement("article",{className:"app-container"},v.createElement("span",{id:u.hash,onClick:function(){return s.back()}},v.createElement("i",{className:"fa fa-arrow-left"})),v.createElement("iframe",{src:u.url,title:String(i)})),(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"navToSite",value:function(e){window.open(e)}},{key:"log",value:function(e){L.push(e)}},{key:"logMark",value:function(){var e=new Date;V=e.getTime(),L.push("log-mark: "+e.toTimeString())}},{key:"logStep",value:function(e){L.push(e+": "+((new Date).getTime()-V))}},{key:"showReloadPage",value:function(e){this.push(v.createElement(P,{message:e,seconds:-1}))}},{key:"checkVersion",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,a,i,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.location.href,t+=(t.indexOf("?")>=0?"&":"?")+"_t_t_="+(new Date).getTime(),e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.text();case 7:return r=e.sent,a=new DOMParser,i=a.parseFromString(r,"text/html"),s=i.getElementsByTagName("html"),c=s[0].getAttribute("data-version"),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"guest",get:function(){var e=this.local.guest;if(void 0===e)return 0;var t=e.get();return void 0===t?0:t.guest}},{key:"oem",get:function(){return this.navSettings&&this.navSettings.oem}},{key:"level",get:function(){return this.nav.level}},{key:"logs",get:function(){return L}}]),e}(),a=Object(c.a)(r.prototype,"user",[m.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),r)},function(e,t,n){"use strict";var r=n(31),a=n(51),i=n(1),s=n.n(i),c=n(2),o=n(3),u=n(4),l=n(6),d=n(5),h=n(38),f=n(30),p=new(function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"guest",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("",{});case 2:t=e.sent,e.t0=typeof t,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(h.a)(t));case 8:return n=Object(h.a)(t.token),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unitFromName",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,e.abrupt("return",n&&n.unit);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f.a))("tv/guest/",void 0),v=function(){function e(t,n){Object(o.a)(this,e),this._params=void 0,this.method="POST",this.waiting=void 0,this._params=t,this.waiting=n}return Object(u.a)(e,[{key:"buildParams",value:function(){return this.params}},{key:"params",get:function(){return this._params}},{key:"headers",get:function(){}}]),e}(),m=n(25),b=n(39);n.d(t,"f",(function(){return r.a})),n.d(t,"l",(function(){return a.b})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"k",(function(){return f.h})),n.d(t,"e",(function(){return f.d})),n.d(t,"d",(function(){return f.c})),n.d(t,"o",(function(){return f.j})),n.d(t,"n",(function(){return f.i})),n.d(t,"b",(function(){return f.a})),n.d(t,"c",(function(){return f.b})),n.d(t,"j",(function(){return f.g})),n.d(t,"p",(function(){return f.l})),n.d(t,"g",(function(){return m.a})),n.d(t,"m",(function(){return b.b})),n.d(t,"i",(function(){return b.a}))},,function(e,t,n){"use strict";n(38),n(35);var r,a,i=n(56),s=n(1),c=n.n(s),o=n(2),u=n(11),l=n(10),d=n(3),h=n(4),f=n(9),p=(n(22),n(8)),v=(r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(d.a)(this,e),this.maxCount=void 0,this.arr=[],Object(l.a)(this,"dict",a,this),this.maxCount=t}return Object(h.a)(e,[{key:"loadIds",value:function(e){var t,n=[],r=Object(u.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(null!==a){var i=this.dict.get(a);void 0===i&&(n.push(a),i={id:a},this.dict.set(a,i))}}}catch(s){r.e(s)}finally{r.f()}this.loadId(n)}},{key:"get",value:function(e){if(void 0===e||null===e)return null;var t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t}},{key:"setItem",value:function(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))}},{key:"loadId",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a,i,s,o,l,d,h=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadIds(t);case 2:if(void 0!==(n=e.sent)){e.next=27;break}r=Object(u.a)(t),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=17;break}if(null!==(i=a.value)){e.next=11;break}return e.abrupt("continue",15);case 11:return e.next=13,this._loadId(i);case 13:s=e.sent,this.setItem(i,s);case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(5),r.e(e.t0);case 22:return e.prev=22,r.f(),e.finish(22);case 25:e.next=29;break;case 27:o=Object(u.a)(t);try{for(d=function(){var e=l.value,t=n.find((function(t){return t.id===e}));h.setItem(e,t)},o.s();!(l=o.n()).done;)d()}catch(c){o.e(c)}finally{o.f()}case 29:case"end":return e.stop()}}),e,this,[[5,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),a=Object(f.a)(r.prototype,"dict",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),n(43),n(48)),m=function(){function e(){Object(d.a)(this,e),this.user=v.a.localDb.child("user"),this.guest=v.a.localDb.child("guest"),this.unit=v.a.localDb.child("unit"),this._user=void 0,this._guest=void 0,this._unit=void 0}return Object(h.a)(e,[{key:"readToMemory",value:function(){this._user=this.user.get(),this._guest=this.guest.get(),this._unit=this.unit.get()}},{key:"saveToLocalStorage",value:function(){this.user.set(this._user),this.guest.set(this._guest),this.unit.set(this._unit)}},{key:"logoutClear",value:function(){[this.user,this.unit].forEach((function(e){return e.remove()}))}}]),e}();n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return v.a}))},,function(e,t,n){"use strict";var r,a=n(3),i=n(4),s=n(6),c=n(5),o=n(0),u=n(12),l=n(1),d=n.n(l),h=n(2),f=n(18),p=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).back=Object(h.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.b.back();case 2:(n=e.props.afterBack)&&n();case 4:case"end":return t.stop()}}),t)}))),e.logoutClick=function(){f.b.showLogout(e.logout)},e.logout=Object(h.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!==typeof(n=e.props.logout)){t.next=4;break}return t.next=4,n();case 4:return t.next=6,f.b.logout(void 0);case 6:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(n,[{key:"openWindow",value:function(){window.open(document.location.href)}},{key:"render",value:function(){var e,t,n=f.b.level>1||window.self!==window.top,r=this.props,a=r.right,i=r.center,s=r.logout,c=r.className,u=r.ex;if(void 0!==s&&window.self===window.top&&("boolean"===typeof s&&!0===s||"function"===typeof s)){var l=f.b.user;if(void 0!==l){var d=l.nick,h=l.name;t=o.createElement("div",{className:"d-flex align-items-center"},o.createElement("small",{className:"text-light"},d||h),o.createElement("div",{className:"ml-2 py-2 px-3 cursor-pointer",role:"button",onClick:this.logoutClick},o.createElement("i",{className:"fa fa-sign-out fa-lg"})))}}if(n)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=o.createElement("nav",{onClick:this.back},o.createElement("i",{className:"fa fa-angle-left"}));break;case"close":e=o.createElement("nav",{onClick:this.back},o.createElement("i",{className:"fa fa-close"}))}window.self!==window.top&&console.log(document.location.href),void 0===e&&"string"===typeof i&&(i=o.createElement("div",{className:"px-3"},i));var p=(a||t)&&o.createElement("aside",null,a," ",t),v=o.createElement("header",{className:c},o.createElement("nav",null,e,o.createElement("div",null,i),p),u);return o.createElement(o.Fragment,null,o.createElement("section",{className:"tv-page-header"},v),v)}}]),n}(o.Component),v=n(57),m=n(45);n.d(t,"a",(function(){return b}));var b=Object(u.a)(r=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var r;Object(a.a)(this,n),(r=t.call(this,e)).tabsView=void 0;var i=e.tabsProps;return i&&(r.tabsView=new v.c(i)),r}return Object(i.a)(n,[{key:"renderHeader",value:function(){var e=this.props,t=e.back,n=e.header,r=e.right,a=e.headerClassName,i=e.afterBack;return!1!==n&&o.createElement(p,{back:t,center:n,right:r,logout:this.props.logout,className:a,afterBack:i})}},{key:"renderFooter",value:function(){var e=this.props.footer;if(e){var t=o.createElement("footer",null,e);return o.createElement(o.Fragment,null,o.createElement("section",{className:"tv-page-footer"},t),t)}}},{key:"render",value:function(){if(this.tabsView)return o.createElement(this.tabsView.content);var e=this.props,t=e.onScroll,n=e.onScrollTop,r=e.onScrollBottom,a=e.children,i=e.className;return o.createElement(m.a,{onScroll:t,onScrollTop:n,onScrollBottom:r,className:i},this.renderHeader(),o.createElement("main",null,a),this.renderFooter())}}]),n}(o.Component))||r},,function(e,t,n){"use strict";n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return k})),n.d(t,"j",(function(){return N})),n.d(t,"g",(function(){return A})),n.d(t,"f",(function(){return T})),n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return R})),n.d(t,"b",(function(){return F})),n.d(t,"d",(function(){return M}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(20),u=n.n(o),l=n(15),d=n(35),h=n(30),f=n(31),p=n(39),v={};function m(){for(var e in v)v[e]=void 0}var b={},y=new(function(){function e(){Object(s.a)(this,e),this.hash=void 0,this._unit=void 0,this.page=void 0,this.param=void 0}return Object(c.a)(e,[{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e}}]),e}());function k(){return window.self!==window.parent}function g(e){var t=e.data,n=e.source;Object(f.b)(n),function(e){var t=document.getElementById(e);void 0!==t&&(t.hidden=!0)}(t.hash);var r=u.a.clone(l.nav.user);r.type="init-sub-win",n.postMessage(r,"*")}function w(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("initSubWin: set nav.user",t),n=l.nav.user=t,Object(h.i)(n.id,n.token),e.next=5,l.nav.showAppView();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return x.apply(this,arguments)}function x(){return(x=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,c,o,u,l,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=b[t])){e.next=3;break}return e.abrupt("return",{name:n,db:void 0,url:void 0,token:void 0});case 3:return i=r.unit,s=r.predefinedUnit,(i=i||s)||console.error("no unit defined in unit.json or not logined in",i),c=n.split("/"),o={unit:i,uqOwner:c[0],uqName:c[1],appOwner:c[2],appName:c[3]},console.log("uqTokenApi.uq onReceiveAppApiMessage",o),e.next=11,h.k.uq(o);case 11:return u=e.sent,l=u.db,d=u.url,f=u.token,e.abrupt("return",{name:n,db:l,url:d,token:f});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return C.apply(this,arguments)}function C(){return(C=Object(i.a)(a.a.mark((function e(t){var n,r,i,s,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.apiName,r=t.db,i=t.url,s=t.urlTest,c=t.token,void 0!==(o=P[n])){e.next=4;break}throw new Error("error app api return");case 4:u=p.a.getUrlOrTest(r,i,s),console.log("onAppApiReturn(message:any): url="+i+", real="+u),o.resolve({name:n,db:r,url:u,token:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){if(e){var t=e.split("-"),n=t.length;if(n>0){var r=1;y.hash=t[r++],n>0&&(y.unit=Number(t[r++])),n>1&&(y.page=t[r++]),n>2&&(y.param=t.slice(r++))}}return y}function A(){var e=document.location.hash;if(void 0!==e&&e.length>0){var t=e.lastIndexOf("#tv-");return t<0&&(t=e.lastIndexOf("#tvdebug-")),t}return-1}function T(){var e=A();if(!(e<0))return document.location.hash.substring(e)}function I(e,t,n,r){for(var a;;){if(a=Object(d.a)(),void 0===b[a]){b[a]={hash:a,unit:t};break}}if(e+="#tv-"+a+"-"+t,void 0!==n&&(e+="-"+n,void 0!==r))for(var i=0;i<r.length;i++)e+="-"+r[i];return{url:e,hash:a}}function S(){var e=y.unit,t=y.predefinedUnit,n=e||t;if(void 0===n)throw new Error("no unit defined in unit.json or not logined in");return n}window.addEventListener("message",function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.data,e.t0=r.type,e.next="sub-frame-started"===e.t0?4:"ws"===e.t0?6:"init-sub-win"===e.t0?9:"pop-app"===e.t0?12:"center-api"===e.t0?15:"center-api-return"===e.t0?18:"app-api"===e.t0?20:"app-api-return"===e.t0?25:30;break;case 4:return g(t),e.abrupt("break",34);case 6:return e.next=8,l.nav.onReceive(r.msg);case 8:return e.abrupt("break",34);case 9:return e.next=11,w(r);case 11:return e.abrupt("break",34);case 12:return window.console.log("///\\\\\\ pop-app"),l.nav.navBack(),e.abrupt("break",34);case 15:return e.next=17,U(t.source,r);case 17:return e.abrupt("break",34);case 18:return B(r),e.abrupt("break",34);case 20:return e.next=22,j(r.hash,r.apiName);case 22:return i=e.sent,t.source.postMessage({type:"app-api-return",apiName:r.apiName,db:i.db,url:i.url,token:i.token},"*"),e.abrupt("break",34);case 25:return console.log("app-api-return: %s",JSON.stringify(r)),console.log("await onAppApiReturn(message);"),e.next=29,E(r);case 29:return e.abrupt("break",34);case 30:if(!0!==(null===(n=r.source)||void 0===n?void 0:n.startsWith("react-devtools"))){e.next=32;break}return e.abrupt("break",34);case 32:return window.console.log("message: %s",JSON.stringify(r)),e.abrupt("break",34);case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var P={};function R(e,t,n,r,a){return V.apply(this,arguments)}function V(){return(V=Object(i.a)(a.a.mark((function e(t,n,r,s,c){var o,u,l,d,f,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k()){e.next=12;break}return o=S(),e.next=4,h.k.uq({unit:o,uqOwner:n,uqName:r,appOwner:s,appName:c});case 4:return void 0===(u=e.sent).token&&(u.token=h.f),l=u.db,d=u.url,f=u.urlTest,m=p.a.getUrlOrTest(l,d,f),console.log("realUrl: %s",m),u.url=m,v[t]=u,e.abrupt("return",u);case 12:if(console.log("**** before buildAppUq ****",y),void 0===P[t]){e.next=16;break}return e.abrupt("return");case 16:return e.abrupt("return",new Promise((function(e,n){P[t]={resolve:function(){var n=Object(i.a)(a.a.mark((function n(r){var i,s,c,o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r;case 2:i=n.sent,s=i.db,c=i.url,o=i.token,v[t]={name:t,db:s,url:c,token:o},P[t]=void 0,console.log("**** after buildAppUq ****",y),e();case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),reject:n},(window.opener||window.parent).postMessage({type:"app-api",apiName:t,hash:y.hash},"*")})));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return v[e]}var L={};function M(e,t,n){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",t,n),e.next=3,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(i,s){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(d.a)(),void 0!==L[c]){e.next=5;break}return L[c]={id:c,resolve:i,reject:s},e.abrupt("break",7);case 5:e.next=0;break;case 7:(window.opener||window.parent).postMessage({type:"center-api",callId:c,url:t,method:n,body:r},"*");case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return _.apply(this,arguments)}function _(){return(_=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.callId,i=n.url,s=n.method,c=n.body,e.next=3,h.e.directCall(i,s,c);case 3:o=e.sent,t.postMessage({type:"center-api-return",callId:r,result:o},"*");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){var t=e.callId,n=e.result,r=L[t];void 0!==r&&(L[t]=void 0,r.resolve(n))}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return f}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(6),u=n(5),l=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(s.a)(this,n),(a=t.call(this,r,i)).tries=void 0,a._entity=void 0,a.tries=0,a._entity=e,a}return Object(c.a)(n,[{key:"request",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.loadSchema();case 2:return e.next=4,this.innerRequest();case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerCall",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.uqApi.xcall(this);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerRequest",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerCall();case 2:if(t=e.sent,n=t.$uq,r=t.$modify,i=t.res,this.entity.uq.pullModify(r),void 0!==n){e.next=8;break}return s=this.xresult(i),e.abrupt("return",s);case 8:return e.next=10,this.retry(n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"xresult",value:function(e){return e}},{key:"retry",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(++this.tries,!(this.tries>5)){e.next=3;break}throw new Error("can not get right uq response schema, 5 tries");case 3:return this.rebuildSchema(t),e.next=6,this.innerRequest();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebuildSchema",value:function(e){var t=e.uq,n=e.entity;void 0!==t&&this.entity.uq.buildEntities(t),void 0!==n&&this.entity.setSchema(n)}},{key:"entity",get:function(){return this._entity}},{key:"headers",get:function(){var e=this.entity,t=e.ver,n=e.uq.uqVersion;return{uq:"".concat(n),en:"".concat(t)}}}]),n}(n(19).a),d=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(l),h=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}},{key:"buildParams",value:function(){return this.entity.buildParams(this.params)}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query/".concat(this.entity.name)}}]),n}(l),f=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"buildParams",value:function(){var e,t=this.params,n=t.pageStart,r=t.pageSize,a=t.params;return(e=void 0===a?{key:""}:this.entity.buildParams(a)).$pageStart=n,e.$pageSize=r,e}},{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}},{key:"params",get:function(){return this._params}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query-page/".concat(this.entity.name)}}]),n}(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),a=n.n(r),i=n(2),s=n(11),c=n(3),o=n(4),u=function(){function e(t,n,r){Object(c.a)(this,e),this.jName=void 0,this.schema=void 0,this.ver=0,this.sys=void 0,this.uq=void 0,this.name=void 0,this.typeId=void 0,this.cache=void 0,this.uqApi=void 0,this.fields=void 0,this.arrFields=void 0,this.returns=void 0,this.face=void 0,this.fieldMaps={},this.uq=t,this.name=n,this.typeId=r,this.sys=this.name.indexOf("$")>=0,this.cache=this.uq.localMap.item(this.name),this.uqApi=this.uq.uqApi}return Object(o.a)(e,[{key:"sName",get:function(){return this.jName||this.name}}]),Object(o.a)(e,[{key:"fieldMap",value:function(e){void 0===e&&(e="$");var t=this.fieldMaps[e];if(void 0===t){var n;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){var r=this.arrFields.find((function(t){return t.name===e}));void 0!==r&&(n=r.fields)}else if(void 0!==this.returns){var a=this.returns.find((function(t){return t.name===e}));void 0!==a&&(n=a.fields)}if(void 0===n)return{};t={};var i,c=Object(s.a)(n);try{for(c.s();!(i=c.n()).done;){var o=i.value;t[o.name]=o}}catch(u){c.e(u)}finally{c.f()}this.fieldMaps[e]=t}return t}},{key:"loadSchema",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.schema){e.next=2;break}return e.abrupt("return");case 2:if(t=this.cache.get()){e.next=7;break}return e.next=6,this.uq.loadEntitySchema(this.name);case 6:t=e.sent;case 7:return this.setSchema(t),this.buildFieldsTuid(),e.next=11,this.loadValues();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadValues",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSchema",value:function(){this.schema=void 0}},{key:"setSchema",value:function(e){if(void 0!==e){var t=e.name,n=e.version;this.ver=n||0,this.setJName(t),this.cache.set(e),this.schema=e,this.buildFieldsTuid()}}},{key:"setJName",value:function(e){e!==this.name&&(this.jName=e)}},{key:"buildFieldsTuid",value:function(){var e=this.schema,t=e.fields,n=e.arrs,r=e.returns;this.uq.buildFieldTuid(this.fields=t),this.uq.buildArrFieldsTuid(this.arrFields=n,t),this.uq.buildArrFieldsTuid(this.returns=r,t)}},{key:"schemaStringify",value:function(){return JSON.stringify(this.schema,(function(e,t){if("_tuid"!==e)return t}),4)}},{key:"tuidFromName",value:function(e,t){if(void 0!==this.schema){var n=this.schema,r=n.fields,a=n.arrs,i=this.uq,s=e.toLowerCase();if(void 0===t)return u(s,r);if(void 0!==a){var c=t.toLowerCase(),o=a.find((function(e){return e.name===c}));if(void 0!==o)return u(s,o.fields)}}function u(e,t){if(void 0!==t){var n=t.find((function(t){return t.name===e}));if(void 0!==n)return i.getTuid(n.tuid)}}}},{key:"buildParams",value:function(e){var t={},n=this.fields;void 0!==n&&this.buildFieldsParams(t,n,e);var r=this.arrFields;if(void 0!==r){var a,i=Object(s.a)(r);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=c.name,u=c.fields;if(void 0!==e[o]){var l=[];t[o]=l;var d,h=Object(s.a)(e);try{for(h.s();!(d=h.n()).done;){var f=d.value,p={};this.buildFieldsParams(p,u,f),l.push(p)}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){i.e(v)}finally{i.f()}}return t}},{key:"buildFieldsParams",value:function(e,t,n){var r,a=Object(s.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=i.name,o=i.type,u=n[c],l=void 0;if("datetime"===o)l=this.buildDateTimeParam(u);else switch(typeof u){default:l=u;break;case"object":var d=i._tuid;l=void 0===d?u.id:d.getIdFromObj(u)}e[c]=l}}catch(h){a.e(h)}finally{a.f()}}},{key:"buildDateTimeParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return"";case"object":t=e;break;case"string":case"number":t=new Date(e)}return Math.floor(t.getTime()/1e3)}},{key:"buildDateParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return"";case"string":return e;case"object":t=e;break;case"number":t=new Date(e)}var n=t.toISOString(),r=n.indexOf("T");return r>0?n.substr(0,r):n}},{key:"pack",value:function(e){var t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);var r=this.arrFields;if(void 0!==r){var a,i=Object(s.a)(r);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=c.name,u=c.fields,l=e[o];l||(l=e[o.toLowerCase()]),this.packArr(t,u,l)}}catch(d){i.e(d)}finally{i.f()}}return t.join("")}},{key:"escape",value:function(e,t){var n=e[t.name];switch(t.type){case"datetime":return this.buildDateTimeParam(n);default:switch(typeof n){default:return n;case"object":var r=t._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var a=n.length,i="",s=0,c=0;c<a;c++){switch(n.charCodeAt(c)){case 9:i+=n.substring(s,c)+"\\t",s=c+1;break;case 10:i+=n.substring(s,c)+"\\n",s=c+1;break;case 92:i+=n.substring(s,c)+"\\\\",s=c+1}}return i+n.substring(s);case"undefined":return""}}}},{key:"packRow",value:function(e,t,n){var r=t.length;if(0!==r){var a="";a+=this.escape(n,t[0]);for(var i=1;i<r;i++){var s=t[i];a+="\t"+this.escape(n,s)}e.push(a+"\n")}}},{key:"packArr",value:function(e,t,n){if(void 0!==n){var r,a=Object(s.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.packRow(e,t,i)}}catch(c){a.e(c)}finally{a.f()}}e.push("\n")}},{key:"cacheFieldsInValue",value:function(e,t){var n,r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.name,c=a._tuid;if(void 0!==c){var o=e[i];e[i]=c.boxId(o)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"unpackTuidIdsOfFields",value:function(e,t){if(void 0===t)return e;var n,r=[],a=Object(s.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i)for(var c=i.length,o=0;o<c;){if(10===i.charCodeAt(o)){++o;break}var u={};o=this.unpackRow(u,t,i,o),r.push(u)}}}catch(l){a.e(l)}finally{a.f()}return r}},{key:"unpackSheet",value:function(e){var t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));var a=this.arrFields;if(void 0!==a){var i,c=Object(s.a)(a);try{for(c.s();!(i=c.n()).done;){var o=i.value;r=this.unpackArr(t,o,e,r)}}catch(u){c.e(u)}finally{c.f()}}return t}},{key:"unpackReturns",value:function(e){var t={},n=0,r=this.returns;if(void 0!==r){var a,i=Object(s.a)(r);try{for(i.s();!(a=i.n()).done;){var c=a.value;n=this.unpackArr(t,c,e,n)}}catch(o){i.e(o)}finally{i.f()}}return t}},{key:"unpackRow",value:function(e,t,n,r){for(var a=0,i=0,s=r,c=0,o=n.length,u=t.length;r<o;r++)if(a=i,9===(i=n.charCodeAt(r))){var l=t[c],d=l.name;if(8!==a){if(r>s){var h=n.substring(s,r);e[d]=this.to(e,h,l)}}else e[d]=null;if(s=r+1,++c>=u)return(r=n.indexOf("\n",s))>=0?++r:r=o,r}else if(10===i){var f=t[c],p=f.name;if(8!==a){if(r>s){var v=n.substring(s,r);e[p]=this.to(e,v,f)}}else e[p]=null;return++c,++r}var m=t[c],b=m.name;if(8!==a){var y=n.substring(s);e[b]=this.to(e,y,m)}return o}},{key:"to",value:function(e,t,n){switch(n.type){default:return t;case"datetime":case"time":case"timestamp":var r=Number(t);return!0===isNaN(r)?new Date(t):new Date(1e3*r);case"date":var a=t.split("-");return new Date(Number(a[0]),Number(a[1])-1,Number(a[2]));case"tinyint":case"smallint":case"int":case"bigint":case"dec":return Number(t);case"id":var i=Number(t),s=n._tuid;return void 0===s?i:s.boxId(i)}}},{key:"unpackArr",value:function(e,t,n,r){for(var a=[],i=n.length,s=t.name,c=t.fields;r<i;){if(10===n.charCodeAt(r)){++r;break}var o={};a.push(o),r=this.unpackRow(o,c,n,r)}return e[s]=a,r}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,a,i,s=n(11),c=n(1),o=n.n(c),u=n(2),l=n(10),d=n(3),h=n(4),f=n(9),p=(n(22),n(0)),v=n(18),m=n(8),b=n(36),y=(r=function(){function e(t,n,r,s){Object(d.a)(this,e),this.name=void 0,this._itemSchema=void 0,this._uiItem=void 0,this.value=void 0,this.label=void 0,Object(l.a)(this,"error",a,this),Object(l.a)(this,"isChanged",i,this),this.newValue=void 0,this._itemSchema=t,this._uiItem=n,this.value=s;var c=t.name;this.name=c,this.label=r}return Object(h.a)(e,[{key:"itemSchema",get:function(){return this._itemSchema}},{key:"uiItem",get:function(){return this._uiItem}}]),Object(h.a)(e,[{key:"init",value:function(){}},{key:"start",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalStart();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalEnd();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t,n,r=this,a=this._itemSchema,i=a.name,s=a.type,c=this._uiItem;if(void 0===c)t=i;else{t=c.label,n=c.labelHide;var o=c.Templet;if(void 0!==o)"function"===typeof o?void 0!==this.value&&(e=o(this.value)):e={templet:o};else if(void 0!==this.value)switch(c.widget){case"radio":case"select":var u=c.list;e=p.createElement("b",null,u.find((function(e){return e.value===r.value})).title);break;case"id":e=p.createElement("b",null,"no templet for ",i,"=",this.value)}}if(void 0===e)switch(s){default:e=this.value?p.createElement("b",null,this.value):p.createElement("small",{className:"text-muted"},"[",!0===n?t:"\u65e0","]");break;case"image":e=p.createElement(b.a,{className:"w-4c h-4c",src:this.value})}return e}},{key:"internalEnd",value:function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.b.pop();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"verifyValue",value:function(){if(void 0!==this.uiItem){var e=this.uiItem.rules;if(void 0!==e){var t=this.newValue;if(Array.isArray(e)){var n,r=Object(s.a)(e);try{for(r.s();!(n=r.n()).done;){var a=i(n.value);if(void 0!==a){this.error=a;break}}}catch(c){r.e(c)}finally{r.f()}}else this.error=i(e)}}function i(e,n){var r=e(t);if(void 0!==r)return"object"!==typeof r?r:JSON.stringify(r)}}}]),e}(),a=Object(f.a)(r.prototype,"error",[m.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(f.a)(r.prototype,"isChanged",[m.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},function(e,t,n){"use strict";var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(6),u=n(5),l=n(20),d=n.n(l),h=n(11),f=n(25),p=n(18),v=n(21),m=["POST","PUT"],b=function(){function e(t,n,r){var c=this;Object(s.a)(this,e),this.timeout=void 0,this.ui=void 0,this.hostUrl=void 0,this.apiToken=void 0,this.startWait=function(e){!0===e&&void 0!==c.ui&&c.ui.startWait()},this.endWait=function(e,t){void 0!==c.ui&&c.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)},this.showError=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===c.ui){e.next=3;break}return e.next=3,c.ui.showError(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.hostUrl=t,this.apiToken=n,this.ui=r,this.timeout=!0===v.c.isDevelopment?5e5:5e4}return Object(c.a)(e,[{key:"used",value:function(){this.post("",{})}},{key:"xcall",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,c,o,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.buildOptions(),i=n.headers,s=n.path,c=n.method,void 0!==i)for(u in o=r.headers,i)o.append(u,encodeURI(i[u]));return r.method=c,l=n.buildParams(),m.indexOf(c)>=0&&void 0!==l&&(r.body=JSON.stringify(l)),e.next=8,this.innerFetch(t+s,r,n.waiting);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"innerFetchResult",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerFetch(t,n,r);case 2:return i=e.sent,e.abrupt("return",i.res);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s,c,o,u,l,d=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:void 0,r=d.length>2?d[2]:void 0,!n){e.next=26;break}if(!((i=Object.keys(n)).length>0)){e.next=26;break}s="?",c=Object(h.a)(i),e.prev=7,c.s();case 9:if((o=c.n()).done){e.next=18;break}if(u=o.value,void 0!==n[u]){e.next=14;break}return e.abrupt("continue",16);case 14:t+=s+u+"="+n[u],s="&";case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return(l=this.buildOptions()).method="GET",e.next=30,this.innerFetchResult(t,l,r);case 30:return e.abrupt("return",e.sent);case 31:case"end":return e.stop()}}),e,this,[[7,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="POST",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="PUT",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="DELETE",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){function t(t,n,r,a,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,s,c){var o,u,l,d,h,f,m,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(e,t){switch(typeof e){case"string":void 0!==t&&(e+=" "+t);break;case"object":for(var r={ex:t},a=0,i=Object.keys(e);a<i.length;a++){var l=i[a];r[l]=e[l]}e=r}return{channel:o,url:u,options:n,resolve:s,reject:c,error:e}},o=this,this.startWait(r),u=t,e.prev=4,console.log("%s-%s %s",n.method,u,n.body||""),d=Date.now(),h=v.c.setTimeout(void 0,(function(){o.endWait(t+" timeout endWait: "+(Date.now()-d)+"ms",c)}),this.timeout),e.next=10,fetch(encodeURI(u),n);case 10:if(!1!==(f=e.sent).ok){e.next=17;break}throw v.c.clearTimeout(h),console.log("ok false endWait"),o.endWait(),console.log("call error %s",f.statusText),f.statusText;case 17:if(!((m=f.headers.get("content-type"))&&m.indexOf("json")>=0)){e.next=22;break}return e.abrupt("return",f.json().then(function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.c.clearTimeout(h),o.endWait(),!0!==t.ok){e.next=5;break}return"object"!==typeof t||Array.isArray(t),e.abrupt("return",s(t));case 5:if(void 0!==(n=t.error)){e.next=11;break}return e.next=9,o.showError(l("not valid tonva json"));case 9:e.next=14;break;case 11:return e.next=13,o.showError(l(n,"retJson.error"));case 13:c(n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.showError(l(t,"catch res.json()"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 22:return e.next=24,f.text();case 24:b=e.sent,v.c.clearTimeout(h),console.log("text endWait"),o.endWait(),s(b);case 29:e.next=40;break;case 31:if(e.prev=31,e.t0=e.catch(4),this.endWait(t,c),"string"!==typeof e.t0){e.next=39;break}if(!0!==e.t0.toLowerCase().startsWith("unauthorized")){e.next=39;break}return p.b.logout(),e.abrupt("return");case 39:console.error("fecth error (no nav.showError): "+t);case 40:case 41:case"end":return e.stop()}}),e,this,[[4,31]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}())},{key:"callFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var s,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=this.buildOptions()).method=n,s.body=r,e.next=5,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetch(t,s,!0,n,r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"buildOptions",value:function(){return{headers:this.buildHeaders(),method:void 0,body:void 0}}},{key:"buildHeaders",value:function(){var e=p.b.language,t=p.b.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=e;return t&&(r+="-"+t),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),n}}]),e}(),y=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"innerFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var s,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.hostUrl+t,void 0!==this.apiToken||!Object(f.h)()){e.next=5;break}return e.next=4,Object(f.d)(s,n.method,n.body);case 4:return e.abrupt("return",e.sent);case 5:return e.next=7,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(t,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetch(s,n,r,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(b),k=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"innerFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var s,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.hostUrl+t,e.next=3,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(t,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetch(s,n,r,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(b),g=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"startWait",value:function(){p.b.startWait()}},{key:"endWait",value:function(){p.b.endWait()}},{key:"showError",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.b.endWait(),e.next=3,p.b.onError(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.b.showUpgradeUq(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),w=n(51),O=n(39),j=n(38);n.d(t,"h",(function(){return C})),n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return I})),n.d(t,"j",(function(){return S})),n.d(t,"f",(function(){return V})),n.d(t,"i",(function(){return L})),n.d(t,"a",(function(){return M})),n.d(t,"k",(function(){return D})),n.d(t,"e",(function(){return U})),n.d(t,"b",(function(){return _})),n.d(t,"g",(function(){return B})),n.d(t,"l",(function(){return z}));var x={},E={};function C(){x={},E={},A={},Object(f.i)()}var N=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e,r,a,i,c,o,u){var l;return Object(s.a)(this,n),(l=t.call(this,e,u)).access=void 0,l.appOwner=void 0,l.appName=void 0,l.uqOwner=void 0,l.uqName=void 0,l.uq=void 0,l.appOwner=r,l.appName=a,c&&(l.uqOwner=i,l.uqName=c,l.uq=i+"/"+c),l.access=o,l.showWaiting=u,l}return Object(c.a)(n,[{key:"init",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.e)(this.uq,this.uqOwner,this.uqName,this.appOwner,this.appName);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.showWaiting||void 0===this.showWaiting?(t=x,n=new g):t=E,void 0===(r=t[this.uq])){e.next=4;break}return e.abrupt("return",r);case 4:if(i=Object(f.b)(this.uq)){e.next=9;break}return e.next=8,this.init();case 8:i=Object(f.b)(this.uq);case 9:return c=(s=i).url,o=s.token,this.token=o,r=new k(c,o,n),e.abrupt("return",t[this.uq]=r);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadAccess",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===this.access?"":this.access.join("|"),e.next=3,this.get("access",{acc:t});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"schema",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("schema/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queueModify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("queue-modify",{start:t,page:n,entities:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w.a),A={};var T,I=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,"tv/",void 0,void 0,void 0,void 0,void 0,!0)).unitId=void 0,r.unitId=e,r}return Object(c.a)(n,[{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=A[this.unitId])){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,this.buildChannel();case 5:return e.abrupt("return",A[this.unitId]=e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,s,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new g,n=new _("tv/",void 0),e.next=4,n.unitxUq(this.unitId);case 4:return r=e.sent,i=r.token,s=r.db,c=r.url,o=r.urlTest,u=O.a.getUrlOrTest(s,c,o),this.token=i,e.abrupt("return",new k(u,i,t));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(N);function S(e){console.log("setCenterUrl %s",e),T=e,V=void 0,R=void 0,P=void 0}var P,R,V=void 0,F=0;function L(e,t){F=e,V=t,console.log("setCenterToken %s",t),R=void 0,P=void 0}var M=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0===this.showWaiting||void 0===this.showWaiting?void 0!==P?P:P=new y(T,V,new g):void 0!==R?R:R=new y(T,V));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(w.a),D=new(function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).localMap=v.c.localDb.map("uqTokens"),e}return Object(c.a)(n,[{key:"uq",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s,c,o,u,l,h,f,p,v,m,b,y,k,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uqOwner,r=t.uqName,i=n+"/"+r,s=this.localMap.child(i),e.prev=3,void 0!==(c=s.get())&&(u=(o=c).unit,l=o.user,u===t.unit&&l===F||(s.remove(),c=void 0)),h=Math.floor(Date.now()/1e3),void 0===c){e.next=11;break}if(p=(f=c).tick,!(void 0!==(v=f.value)&&h-p<86400)){e.next=11;break}return e.abrupt("return",d.a.clone(v));case 11:return(m=d.a.clone(t)).testing=O.a.testing,e.next=15,this.get("app-uq",m);case 15:if(void 0!==(b=e.sent)){e.next=20;break}throw y=t.unit,k=t.uqOwner,g=t.uqName,"center get app-uq(unit=".concat(y,", '").concat(k,"/").concat(g,"') - not exists or no unit-service");case 20:return c={unit:t.unit,user:F,tick:h,value:b},s.set(c),e.abrupt("return",d.a.clone(b));case 25:throw e.prev=25,e.t0=e.catch(3),s.remove(),e.t0;case 29:case"end":return e.stop()}}),e,this,[[3,25]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(M))("tv/tie/",void 0),U=new(function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"directCall",value:function(e,t,n){return this.call(e,t,n)}}]),n}(M))("",void 0),_=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"uqs",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/app-uqs",{appOwner:t,appName:n});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uqsPure",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/app-uqs",{appOwner:t,appName:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unitxUq",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/unitx-uq",{unit:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changePassword",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/change-password",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(M);function B(e,t){return q.apply(this,arguments)}function q(){return(q=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new _("tv/",void 0),e.next=3,r.uqs(t,n);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=new(function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"login",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/login",t);case 2:n=e.sent,e.t0=typeof n,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(j.b)(n));case 8:return r=n.token,i=Object(j.b)(r),s=n.nick,c=n.icon,s&&(i.nick=s),c&&(i.icon=c),e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/register",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendVerify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/set-verify",{account:t,type:n,oem:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"checkVerify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/check-verify",{account:t,verify:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"isExists",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/is-exists",{account:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/reset-password",{account:t,password:n,verify:r,type:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"userSetProp",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/user-set-prop",{prop:t,value:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"me",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/me");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"user",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromKey",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(M))("tv/",void 0)},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return v}));var r,a=n(6),i=n(5),s=n(1),c=n.n(s),o=n(2),u=n(3),l=n(4);function d(e){r=e}var h=function(){function e(){Object(u.a)(this,e),this.wsBaseId=void 0,this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return Object(l.a)(e,[{key:"onWsReceiveAny",value:function(e){var t=this.handlerSeed++;return this.anyHandlers[t]=e,t}},{key:"onWsReceive",value:function(e,t){var n=this.handlerSeed++;return this.msgHandlers[n]={type:e,handler:t},n}},{key:"endWsReceive",value:function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}},{key:"receive",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a,i,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$type,e.t0=c.a.keys(this.anyHandlers);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,this.anyHandlers[r](t);case 6:e.next=2;break;case 8:e.t2=c.a.keys(this.msgHandlers);case 9:if((e.t3=e.t2()).done){e.next=18;break}if(a=e.t3.value,i=this.msgHandlers[a],s=i.type,o=i.handler,s===n){e.next=14;break}return e.abrupt("continue",9);case 14:return e.next=16,o(t);case 16:e.next=9;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),f=1,p=new(function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).wsBaseId="WsBridge seed "+f++,e}return n}(h)),v=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this)).wsBaseId="WSChannel seed "+f++,a.wsHost=void 0,a.token=void 0,a.ws=void 0,a.wsHost=e,a.token=r,a}return Object(l.a)(n,[{key:"connect",value:function(){var e=this;if(void 0===this.ws){var t=this;return new Promise((function(r,a){var i=new WebSocket(e.wsHost,e.token||n.centerToken);console.log("connect webSocket %s",e.wsHost),i.onopen=function(n){console.log("webSocket connected %s",e.wsHost),t.ws=i,r()},i.onerror=function(e){a("webSocket can't open!")},i.onmessage=function(){var e=Object(o.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.wsMessage(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.onclose=function(e){t.ws=void 0,console.log("webSocket closed!")}}))}}},{key:"close",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}},{key:"wsMessage",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("websocket message: %s",t.data),n=JSON.parse(t.data),a=n,void 0!==r&&r.postMessage({type:"ws",msg:a},"*"),e.next=6,this.receive(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ws msg error: ",e.t0);case 11:case"end":return e.stop()}var a}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendWs",value:function(e){var t=this;this.connect().then((function(){t.ws.send(e)}))}}],[{key:"setCenterToken",value:function(e){n.centerToken=e}}]),n}(h);v.centerToken=void 0},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return l}));var r=n(20),a=n.n(r),i={lang:void 0,$lang:void 0,district:void 0,$district:void 0};function s(e){var t=i.lang,n=i.district,r={};if(void 0===e)return r;a.a.merge(r,e._);var s=e[t];if(void 0===s)return r;a.a.merge(r,s._);var c=s[n];if(void 0===c)return r;a.a.merge(r,c);var o=r.entity;if(void 0!==o)for(var u in o)o[u.toLowerCase()]=o[u];return r}!function(){var e,t,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");e=r[0],r.length>1&&(t=r[1].toUpperCase())}else e="zh",t="CN";!function(e,t){i.lang=e,i.$lang="$"+e,i.district=t,i.$district="$"+t}(e,t)}();var c={};function o(e,t){if(void 0!==t){var n=i.$lang,r=i.$district;if(a.a.merge(e,t),void 0!==n){var s=t[n];if(void 0!==s){a.a.merge(e,s);var c=s[r];void 0!==c&&a.a.merge(e,c)}}return function(t){return e[t]||t}}}function u(e){o(c,e)}function l(e){return c[e]||e}},function(e,t,n){"use strict";var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(0),u=n(20),l=n.n(u),d=n(15),h=n(21),f=function(){function e(t){var n=this;Object(s.a)(this,e),this.res=void 0,this.x=void 0,this._t={},this.t=void 0,this.icon=void 0,this.label=void 0,this.isDev=h.c.isDevelopment,this.receiveHandlerId=void 0,this.disposer=void 0,this.dispose=function(){d.nav.unregisterReceiveHandler(n.receiveHandlerId),n.onDispose()},this.onMessageReceive=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.onMessage(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._resolve_$=void 0,this.topPageKey=void 0,this.res=t||{},this.x=this.res.x||{},this.t=function(e){return n.internalT(e)||e}}return Object(c.a)(e,[{key:"user",get:function(){return d.nav.user}},{key:"isLogined",get:function(){var e=d.nav.user;return void 0!==e&&e.id>0}}]),Object(c.a)(e,[{key:"init",value:function(e){}},{key:"internalT",value:function(e){return this._t[e]}},{key:"setRes",value:function(e){if(void 0!==e){var t=d.resOptions.$lang,n=d.resOptions.$district;if(l.a.merge(this._t,e),void 0!==t){var r=e[t];if(void 0!==r){l.a.merge(this._t,r);var a=r[n];void 0!==a&&l.a.merge(this._t,a)}}}}},{key:"onDispose",value:function(){}},{key:"isMe",value:function(e){if(null===e)return!1;var t=this.user.id;switch(typeof e){default:return!1;case"string":return Number(e)===t;case"number":return e===t;case"object":return e.id===t}}},{key:"openVPage",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this).open(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"renderView",value:function(e,t){return new e(this).render(t)}},{key:"event",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onEvent(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEvent",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"msg",value:function(e){alert(e)}},{key:"errorPage",value:function(e,t){this.openPage(o.createElement(d.Page,{header:"App error!"},o.createElement("pre",null,"string"===typeof t?t:t.message)))}},{key:"onMessage",value:function(e){}},{key:"beforeStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"registerReceiveHandler",value:function(){this.receiveHandlerId=d.nav.registerReceiveHandler(this.onMessageReceive)}},{key:"start",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.disposer=this.dispose,this.registerReceiveHandler(),e.next=4,this.beforeStart();case 4:if(!1!==e.sent){e.next=7;break}return e.abrupt("return");case 7:for(n=s.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=s[i];return e.next=10,this.internalStart.apply(this,[t].concat(r));case 10:return e.next=12,this.afterStart();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,s,c=this,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=o.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=o[s];return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c._resolve_$.push(n),e.next=3,c.start.apply(c,[t].concat(r));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"vCall",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark((function e(i,s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._resolve_$.push(i),e.next=3,new t(r).open(n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"returnCall",value:function(e){if(void 0!==this._resolve_$){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Controller call already returned, or not called")}}},{key:"openPage",value:function(e,t){var n,r=this;void 0!==t&&(n=function(){r.disposer&&r.disposer(),t()}),d.nav.push(e,n),this.disposer=void 0}},{key:"replacePage",value:function(e){d.nav.replace(e,this.disposer),this.disposer=void 0}},{key:"backPage",value:function(){d.nav.back()}},{key:"closePage",value:function(e){d.nav.pop(e)}},{key:"ceasePage",value:function(e){d.nav.ceaseTop(e)}},{key:"removeCeased",value:function(){d.nav.removeCeased()}},{key:"regConfirmClose",value:function(e){d.nav.regConfirmClose(e)}},{key:"startAction",value:function(){this.topPageKey=d.nav.topKey()}},{key:"popToTopPage",value:function(){d.nav.popTo(this.topPageKey)}},{key:"confirm",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(i.a)(a.a.mark((function e(r,s){var c,u,l,h,f,p,v,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.caption,u=t.message,l=t.ok,h=t.yes,f=t.no,p=t.classNames,v=function(e){n.closePage(),r(e)},m=[],void 0!==l&&m.push(o.createElement("button",{key:"ok",className:"btn btn-primary mr-3",onClick:function(){return v("ok")}},l)),void 0!==h&&m.push(o.createElement("button",{key:"yes",className:"btn btn-success mr-3",onClick:function(){return v("yes")}},h)),void 0!==f&&m.push(o.createElement("button",{key:"no",className:"btn btn-outline-danger mr-3",onClick:function(){return v("no")}},f)),n.openPage(o.createElement(d.Page,{header:c||"\u8bf7\u786e\u8ba4",back:"close"},o.createElement("div",{className:p||"rounded bg-white m-5 p-3 border"},o.createElement("div",{className:"d-flex align-items-center justify-content-center"},u),o.createElement("div",{className:"mt-3 d-flex align-items-center justify-content-center"},m)))),d.nav.regConfirmClose(Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(void 0),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"isCalling",get:function(){return void 0!==this._resolve_$}}]),e}(),p=function(){function e(t){Object(s.a)(this,e),this.controller=void 0,this.res=void 0,this.x=void 0,this.t=void 0,this.controller=t,this.res=t.res,this.x=t.x,this.t=t.t}return Object(c.a)(e,[{key:"isMe",value:function(e){return this.controller.isMe(e)}},{key:"renderVm",value:function(e,t){return new e(this.controller).render(t)}},{key:"openVPage",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this.controller).open(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"event",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.event(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"vCall",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.vCall(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"returnCall",value:function(e){this.controller.returnCall(e)}},{key:"renderUser",value:function(e,t,n){var r=function(e){var r=e.name,a=e.nick,i=e.icon;return o.createElement(o.Fragment,null,o.createElement(d.Image,{src:i,className:t||"w-1c h-1c mr-2"}),o.createElement("span",{className:n},a||r))};return o.createElement(d.UserView,{user:e,render:r})}},{key:"renderUserText",value:function(e){return o.createElement(d.UserView,{user:e,render:function(e){var t=e.name,n=e.nick;return o.createElement(o.Fragment,null,n||t)}})}},{key:"renderMe",value:function(e,t){var n=this.controller.user;if(n)return this.renderUser(n.id,e,t)}},{key:"openPage",value:function(e,t){var n=typeof t;"object"===n||"undefined"===n?this.controller.openPage(o.createElement(e,t)):this.controller.openPage(o.createElement(d.Page,{header:"param type error"},"View.openPage param must be object, but here is ",n))}},{key:"replacePage",value:function(e,t){this.controller.replacePage(o.createElement(e,t))}},{key:"openPageElement",value:function(e,t){this.controller.openPage(e,t)}},{key:"replacePageElement",value:function(e){this.controller.replacePage(e)}},{key:"backPage",value:function(){this.controller.backPage()}},{key:"closePage",value:function(e){this.controller.closePage(e)}},{key:"ceasePage",value:function(e){this.controller.ceasePage(e)}},{key:"removeCeased",value:function(){this.controller.removeCeased()}},{key:"regConfirmClose",value:function(e){this.controller.regConfirmClose(e)}},{key:"popToTopPage",value:function(){this.controller.popToTopPage()}},{key:"isDev",get:function(){return h.c.isDevelopment}}]),e}(),v=n(6),m=n(5),b=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).retOnClosePage=void 0,e}return Object(c.a)(n,[{key:"open",value:function(e,t){var n,r=this;this.init(e),void 0!==t&&(n=function(){return t(r.retOnClosePage)}),this.openPageElement(this.renderPage(),n)}},{key:"render",value:function(e){return this.init(e),this.renderPage()}},{key:"init",value:function(e){}},{key:"header",value:function(){return null}},{key:"right",value:function(){return null}},{key:"content",value:function(){return null}},{key:"footer",value:function(){return null}},{key:"logout",value:function(){return!1}},{key:"renderPage",value:function(){var e=this,t=this.header();return t||(t=!1),o.createElement(d.Page,{header:t,right:this.right(),footer:this.footer(),onScroll:function(t){return e.onPageScroll(t)},onScrollTop:function(t){return e.onPageScrollTop(t)},onScrollBottom:function(t){return e.onPageScrollBottom(t)},back:this.back,headerClassName:this.headerClassName,className:this.className,afterBack:function(){return e.afterBack()},tabsProps:this.tabsProps,logout:this.logout()},this.content())}},{key:"onPageScroll",value:function(e){}},{key:"onPageScrollTop",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPageScrollBottom",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterBack",value:function(){}},{key:"back",get:function(){return"back"}},{key:"headerClassName",get:function(){return null}},{key:"className",get:function(){return null}},{key:"tabsProps",get:function(){return null}}]),n}(p);n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return b}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return E}));var r,a,i=n(24),s=n(10),c=n(13),o=n(17),u=n(16),l=n(9),d=(n(22),n(1)),h=n.n(d),f=n(2),p=n(3),v=n(4),m=n(6),b=n(5),y=n(20),k=n.n(y),g=n(8),w=n(21),O=n(28),j=n(27),x=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e,r,a,i){var s;return Object(p.a)(this,n),(s=t.call(this,i)).query=void 0,s.$page=void 0,s.idFieldName=void 0,s.query=e,void 0!==r&&(s.pageSize=r),void 0!==a&&(s.firstSize=a),s}return Object(v.a)(n,[{key:"setReverse",value:function(){this.appendPosition="head"}},{key:"onLoad",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$page){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==(t=this.query.schema)){e.next=7;break}return e.next=6,this.query.loadSchema();case 6:t=this.query.schema;case 7:if(void 0!==t){e.next=9;break}return e.abrupt("return");case 9:if(void 0!==(n=this.$page=t.returns.find((function(e){return"$page"===e.name})))){e.next=12;break}return e.abrupt("return");case 12:this.sortOrder=n.order,void 0!==(r=n.fields)&&(a=r[0])&&(this.idFieldName=a.name);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadResults",value:function(){var e=Object(f.a)(h.a.mark((function e(t,n,r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.page(t,n,r);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getPageId",value:function(e){if(void 0!==e){if("number"===typeof e)return e;var t=e[this.idFieldName];if(null!==t&&void 0!==t){if("object"===typeof t){var n=t.id;if(void 0!==n)return n}return t}}}},{key:"refreshItems",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a,i,s,c,o,u=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this._items.indexOf(t))<0)){e.next=3;break}return e.abrupt("return");case 3:return r="tail"===this.appendPosition?n-1:n+1,a=this.getPageId(this._items[r]),1,e.next=8,this.load(this.param,a,1);case 8:if(i=e.sent,0!==(s=i.length)){e.next=13;break}return this._items.splice(n,1),e.abrupt("return");case 13:c=function(e){var t=i[e];if(!t)return"continue";var n=t[u.idFieldName];if(void 0===n||null===n)return"continue";"object"===typeof n&&(n=n.id);var r=u._items.find((function(e){var t=e[u.idFieldName];return void 0!==t&&null!==t&&("object"===typeof t&&(t=t.id),n)}));r&&k.a.merge(r,t)},o=0;case 15:if(!(o<s)){e.next=22;break}if("continue"!==c(o)){e.next=19;break}return e.abrupt("continue",19);case 19:o++,e.next=15;break;case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w.b),E=(r=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).pageStart=void 0,e.pageSize=void 0,e.params=void 0,e.more=void 0,e.startField=void 0,Object(s.a)(e,"list",a,Object(c.a)(e)),e.returns=void 0,e.isPaged=void 0,e}return Object(v.a)(n,[{key:"setSchema",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"setSchema",this).call(this,e);var t=e.returns;this.isPaged=t&&void 0!==t.find((function(e){return"$page"===e.name}))}},{key:"resetPage",value:function(e,t){this.pageStart=void 0,this.pageSize=e,this.params=t,this.more=!1,this.list=void 0}},{key:"loadPage",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.pageSize){e.next=2;break}throw new Error("call resetPage(size:number, params:any) first");case 2:if(void 0===this.pageStart){e.next=10;break}e.t0=this.startField.type,e.next="date"===e.t0||"time"===e.t0||"datetime"===e.t0?8:6;break;case 6:return t=this.pageStart,e.abrupt("break",10);case 8:return t=this.pageStart.getTime(),e.abrupt("break",10);case 10:return e.next=12,this.page(this.params,t,this.pageSize+1);case 12:n=e.sent,r=n.$page,this.list=g.n.array([],{deep:!1}),void 0!==r&&(r.length>this.pageSize?(this.more=!0,r.pop(),s=this.returns.find((function(e){return"$page"===e.name})),this.startField=s.fields[0],this.pageStart=r[r.length-1][this.startField.name]):this.more=!1,(a=this.list).push.apply(a,Object(i.a)(r)));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pageCaller",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new j.c(this,e,t)}},{key:"page",value:function(){var e=Object(f.a)(h.a.mark((function e(t,n,r){var a,i,s,c=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(c.length>3&&void 0!==c[3])||c[3],i={pageStart:n,pageSize:r,params:t},e.next=4,this.pageCaller(i,a).request();case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"queryCaller",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new j.d(this,e,t)}},{key:"query",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.queryCaller(t,n).request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a,i=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.query(t,n);case 3:r=e.sent,e.t0=h.a.keys(r);case 5:if((e.t1=e.t0()).done){e.next=10;break}return a=e.t1.value,e.abrupt("return",r[a]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.table(t,n);case 3:if(!((r=e.sent).length>0)){e.next=6;break}return e.abrupt("return",r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a,i=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.obj(t,n);case 3:r=e.sent,e.t0=h.a.keys(r);case 5:if((e.t1=e.t0()).done){e.next=10;break}return a=e.t1.value,e.abrupt("return",r[a]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"query"}},{key:"hasMore",get:function(){return this.more}}]),n}(O.a),a=Object(l.a)(r.prototype,"list",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function a(){for(var e=r.length,t="",n=0;n<8;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(14),i=n.n(a),s=n(18);function c(e){var t=e.className,n=e.style,a=e.src,c=e.altImage;return a?(!0===a.startsWith(":")&&(a=s.b.resUrl+a.substr(1)),r.createElement("img",{src:a,className:t,alt:"img",style:n,onError:function(e){e.currentTarget.src=c||"https://tv.jkchemical.com/imgs/0001.png"}})):r.createElement("div",{className:i()(t,"image-none"),style:n},r.createElement("i",{className:"fa fa-file-o"}))}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(68),a=n.n(r);function i(e){var t=a()(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function s(e){return{id:0,guest:a()(e).guest,token:e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(11),u=n(21),l={centerhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_CENTER_DEBUG_HOST||"localhost:3000",local:!1},reshost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_RES_DEBUG_HOST||"localhost:3015",local:!1},uqhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},unitxhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},"uq-build":{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_BUILDER_HOST||"localhost:3009",local:!1}},d=["https://","http://"];function h(e){return!0===function(e){var t,n=Object(o.a)(d);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!0===e.startsWith(r))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}(e)?e.endsWith("/")?e:e+"/":"http://".concat(e,"/")}function f(e){return h(e)}function p(e){return!0===e.startsWith("https://")?(!0===(e=e.substr("https://".length)).endsWith("/")&&(e=e.substr(0,e.length-1)),"wss://"+e+"/tv/"):"ws://".concat(e,"/tv/")}function v(e){return h(e)+"res/"}var m={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},b=new(function(){function e(){Object(s.a)(this,e),this.testing=void 0,this.url=void 0,this.ws=void 0,this.resHost=void 0}return Object(c.a)(e,[{key:"start",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.testing=t,!0!==u.c.isDevelopment){e.next=4;break}return e.next=4,this.tryLocal();case 4:n=this.getCenterHost(),this.url=f(n),this.ws=p(n),this.resHost=this.getResHost();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"debugHostUrl",value:function(e){return"http://".concat(e,"/hello")}},{key:"tryLocal",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,s,c,o,u,d,h,f,p,v,m,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in t=[],n=[],r=function(e){var t=l[e].value;n.findIndex((function(e){return e===t}))<0&&n.push(t)},l)r(i);for(s=0,c=n;s<c.length;s++)o=c[s],u=this.debugHostUrl(o),t.push(k(u));return e.next=7,Promise.all(t);case 7:for(d=e.sent,h=n.length,f=0;f<h;f++)for(m in p=d[f],v=n[f],l)(b=l[m]).value===v&&(b.local=p);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCenterHost",value:function(){var e=l.centerhost,t=e.value,n=e.local;return!0===document.location.hash.includes("sheet_debug")||!0===u.c.isDevelopment&&!0===n?t:"https://tv.jkchemical.com"}},{key:"getResHost",value:function(){var e=l.reshost,t=e.value,n=e.local;return!0===document.location.hash.includes("sheet_debug")||!0===u.c.isDevelopment&&!0===n?t:"https://tv.jkchemical.com"}},{key:"getUrlOrDebug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uqhost";if(!1===u.c.isDevelopment)return e;var n=l[t];if(void 0===n)return e;var r=n.value,a=n.local;return!1===a?e:"http://".concat(r,"/")}},{key:"getUrlOrTest",value:function(e,t,n){var r;return n||(n=t)||console.error("no server set for "+e),!0===this.testing?("-"!==n&&(t=n),r="uq/test/"+e+"/"):r="uq/prod/"+e+"/",!1===(t=this.getUrlOrDebug(t)).endsWith("/")&&(t+="/"),t+r}},{key:"localCheck",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}());function y(e){return new Promise((function(t,n){fetch(e,m).then((function(e){e.text().then(t).catch(n)})).catch(n);var r=new Error("Connection timed out");u.c.setTimeout("fetchLocalCheck",n,200,r)}))}function k(e){return g.apply(this,arguments)}function g(){return(g=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y(t);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(6),u=n(5),l=n(28),d=n(27),h=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"submit",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new f(this,t),e.next=3,n.request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReturns",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new p(this,t).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitConvert",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new v(this,t).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"action"}}]),n}(l.a),f=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"buildParams",value:function(){return{data:this.entity.pack(this.params)}}},{key:"path",get:function(){return"action/"+this.entity.name}}]),n}(d.a),p=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"xresult",value:function(e){for(var t=this.entity.returns,n=t.length,r={},a=0;a<n;a++){r[t[a].name]=e[a]}return r}},{key:"path",get:function(){return"action/"+this.entity.name+"/returns"}}]),n}(f),v=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"buildParams",value:function(){return{data:this.params}}},{key:"path",get:function(){return"action-convert/"+this.entity.name}}]),n}(f)},function(e,t,n){"use strict";var r,a,i=n(3),s=n(4),c=n(6),o=n(5),u=n(0),l=n(12),d=n(14),h=n.n(d),f=(n(109),Object(l.a)(r=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.badge,a=t.size,i=t.color,s=t.badgeAlign,c=t.badgeVertical,o=t.children,l=h()(n,"va-badge",a&&"va-badge-"+a,"va-badge-"+(i||"secondary"),s&&"va-badg-"+s,c&&"va-badg-"+c);return r&&(e=u.createElement("b",null,r)),u.createElement("div",{className:l},o,e)}}]),n}(u.Component)),n(110),Object(l.a)(a=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e,t,n,r=this.props,a=r.className,i=r.left,s=r.children,c=r.right,o=r.onClick;return void 0!==i&&(e=u.createElement("header",null,i)),void 0!==c&&(t=u.createElement("footer",null,c)),void 0!==o&&(n="cursor-pointer"),u.createElement("div",{className:h()("va-lmr",a,n),onClick:o},e,u.createElement("div",null,s),t)}}]),n}(u.Component))||a),p=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.className,r=e.size,a=e.spin,i=e.fixWidth,s=e.border,c=e.pull,o=e.pulse,l=e.rotate,d=e.flip,f=e.inverse,p=h()(n,"fa",t&&"fa-"+t,r&&"fa-"+r,i&&"fa-fw",s&&"fa-border",c&&"fa-pull-"+c,a&&"fa-spin",o&&"fa-pulse",l&&"fa-rotate-"+l,d&&"fa-flip-"+d,f&&"fa-inverse");return u.createElement("i",{className:p})}}]),n}(u.Component),v=(u.Component,u.Component,function(e){return u.createElement("small",{className:h()("text-muted",e.className),style:e.style},e.children)});n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return v}))},function(e,t,n){"use strict";var r=n(11),a=n(13),i=n(1),s=n.n(i),c=n(2),o=n(3),u=n(4),l=n(17),d=n(16),h=n(6),f=n(5),p=n(20),v=n.n(p),m=n(28),b=n(27),y=n(8),k=n(94),g=function(){function e(t){Object(o.a)(this,e),this.queue=[],this.cache=y.n.map({},{deep:!1}),this.loading=!1,this.localArr=void 0,this.waitingIds=[],this.tuidInner=void 0,this.divName=void 0,this.tuidInner=t,this.initLocalArr()}return Object(u.a)(e,[{key:"initLocalArr",value:function(){this.localArr=this.tuidInner.cache.arr(this.tuidInner.name+".ids")}},{key:"useId",value:function(e,t){if(e&&!1!==Object(k.isNumber)(e))if(!0!==this.cache.has(e))if(this.tuidInner.cacheTuids(!0===t?70:20),this.cache.set(e,e),this.waitingIds.findIndex((function(t){return t===e}))>=0)this.moveToHead(e);else{if(this.queue.length>=1e3){var n=this.queue.shift();if(n===e)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex((function(e){return e===n}));this.waitingIds.splice(r,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e)}},{key:"moveToHead",value:function(e){var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.queue.push(e)}},{key:"getValue",value:function(e){return this.cache.get(e)}},{key:"remove",value:function(e){this.cache.delete(e);var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.localArr.removeItem(e)}},{key:"valueFromId",value:function(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}return this.getValue(t)}},{key:"resetCache",value:function(e){this.remove(e),this.useId(e)}},{key:"cacheValue",value:function(e){if(void 0===e)return!1;var t=this.getIdFromObj(e);if(void 0===t)return!1;var n=this.waitingIds.findIndex((function(e){return e===t}));return n>=0&&this.waitingIds.splice(n,1),this.cache.set(t,e),!0}},{key:"getIdFromObj",value:function(e){return this.tuidInner.getIdFromObj(e)}},{key:"cacheIds",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.waitingIds.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadIds();case 4:if(void 0!==(t=e.sent)){e.next=7;break}return e.abrupt("return");case 7:this.cacheIdValues(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheIdValues",value:function(e){if(void 0!==e){var t,n=this.unpackTuidIds(e),a=Object(r.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;!1!==this.cacheValue(i)&&this.cacheTuidFieldValues(i)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"modifyIds",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n,r,a=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTuidIdsOrLocal(t);case 2:if(n=e.sent,0!==(r=n.filter((function(e){var t=e.indexOf("\t");t<0&&(t=e.length);var n=Number(e.substr(0,t));return void 0!==a.localArr.getItem(n)}))).length){e.next=6;break}return e.abrupt("return");case 6:this.cacheIdValues(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadIds",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,e.next=5,this.loadTuidIdsOrLocal(this.waitingIds);case 5:return t=e.sent,this.loading=!1,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unpackTuidIds",value:function(e){return this.tuidInner.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.tuidInner.cacheTuidFieldValues(e)}},{key:"assureObj",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.cache.get(t),e.t0=typeof n,e.next="object"===e.t0?4:"number"===e.t0?5:7;break;case 4:return e.abrupt("return",n);case 5:return this.cache.set(t,t),e.abrupt("break",7);case 7:return e.next=9,this.loadTuidIdsOrLocal([t]);case 9:r=e.sent,this.cacheIdValues(r);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTuidIdsOrLocal",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n,a,i,c,o,u,l,d,h,f,p,m=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=[],i=Object(r.a)(t);try{for(i.s();!(c=i.n()).done;)o=c.value,(u=this.localArr.getItem(o))?n.push(u):a.push(o)}catch(s){i.e(s)}finally{i.f()}if(!((l=a.length)>0)){e.next=20;break}return e.next=8,this.tuidInner.loadTuidIds(this.divName,a);case 8:d=e.sent,h=function(e){var t=d[e];if(!t)return"continue";var r=t.indexOf("\t");r<0&&(r=t.length);var i=Number(t.substr(0,r));v.a.remove(a,(function(e){return e===i})),n.push(t),m.localArr.setItem(i,t)},f=0;case 11:if(!(f<l)){e.next=18;break}if("continue"!==h(f)){e.next=15;break}return e.abrupt("continue",15);case 15:f++,e.next=11;break;case 18:for(l=a.length,p=0;p<l;p++)this.localArr.setItem(a[p],"");case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),w=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(o.a)(this,n),(a=t.call(this,e)).div=void 0,a.divName=void 0,a.div=r,a.divName=r.name,a.localArr=e.cache.arr(e.name+".ids."+a.divName),a}return Object(u.a)(n,[{key:"initLocalArr",value:function(){}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"unpackTuidIds",value:function(e){return this.div.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.div.cacheTuidFieldValues(e)}}]),n}(g);n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return V}));var O=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).noCache=void 0,e.typeName="tuid",e.idName=void 0,e.cached=void 0,e.unique=void 0,e.isImport=!1,e}return Object(u.a)(n,[{key:"setSchema",value:function(e){Object(l.a)(Object(d.a)(n.prototype),"setSchema",this).call(this,e);var t=e.id;this.idName=t}},{key:"buildTuidBox",value:function(){return new F(this)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"stopCache",value:function(){this.noCache=!0}},{key:"cacheIds",value:function(){}},{key:"modifyIds",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"equ",value:function(e,t){return void 0!==e&&(void 0!==t&&("object"===typeof e?e.equ(t):"object"===typeof t?t.equ(e):e===t))}}]),n}(m.a),j=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,r,i)).divs=void 0,s.cacheFields=void 0,s.idCache=void 0,s.localArr=void 0,s.idCache=new g(Object(a.a)(s)),s.localArr=s.cache.arr(s.name+".whole"),!0===e.newVersion&&s.localArr.removeAll(),s}return Object(u.a)(n,[{key:"setSchema",value:function(e){Object(l.a)(Object(d.a)(n.prototype),"setSchema",this).call(this,e);var t=e.arrs;if(void 0!==t){this.divs={};var a,i=Object(r.a)(t);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.name,o=new L(this.uq,this,c);this.divs[c]=o,o.setSchema(s),o.buildFieldsTuid()}}catch(u){i.e(u)}finally{i.f()}}}},{key:"useId",value:function(e,t){!0!==this.noCache&&e&&this.idCache.useId(e,t)}},{key:"boxId",value:function(e){if(e){if("object"===typeof e)return e;this.useId(e);var t=this.uq.createBoxId;return t?t(this,e):{id:e}}}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"resetCache",value:function(e){"object"===typeof e&&(e=e.id),this.idCache.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.assureObj(t);case 2:return e.abrupt("return",this.idCache.getValue(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){if(this.idCache.cacheIds(),void 0!==this.divs)for(var e in this.divs)this.divs[e].cacheIds()}},{key:"modifyIds",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.modifyIds(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuids",value:function(e){this.uq.cacheTuids(e)}},{key:"div",value:function(e){return this.divs&&this.divs[e]}},{key:"loadTuidIds",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new C(this,{divName:t,ids:n},!1).request();case 2:return(r=e.sent).length>0&&(this.cached=!0),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMain",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"object"===typeof t&&(t=t.id),e.next=3,this.idCache.assureObj(t);case 3:return e.abrupt("return",this.idCache.valueFromId(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n,a,i,c,o,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&0!==t){e.next=2;break}return e.abrupt("return");case 2:"object"===typeof t&&(t=t.id),void 0,e.next=8;break;case 8:return e.next=10,new E(this,t).request();case 10:n=e.sent;case 12:if(void 0!==n){e.next=14;break}return e.abrupt("return");case 14:a=Object(r.a)(this.schema.fields),e.prev=15,a.s();case 17:if((i=a.n()).done){e.next=29;break}if(c=i.value,void 0!==(o=c.tuid)){e.next=22;break}return e.abrupt("continue",27);case 22:if(void 0!==(u=this.uq.getTuid(o))){e.next=25;break}return e.abrupt("continue",27);case 25:l=c.name,n[l]=u.boxId(n[l]);case 27:e.next=17;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(15),a.e(e.t0);case 34:return e.prev=34,a.f(),e.finish(34);case 37:return this.idCache.cacheValue(n),this.cacheTuidFieldValues(n),e.abrupt("return",n);case 40:case"end":return e.stop()}}),e,this,[[15,31,34,37]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema,n=t.fields,a=t.arrs;if(this.cacheFieldsInValue(e,n),void 0!==a){var i,s=Object(r.a)(a);try{for(s.s();!(i=s.n()).done;){var c=i.value,o=c.name,u=c.fields,l=e[o];if(void 0!==l){var d,h=this.div(o),f=Object(r.a)(l);try{for(f.s();!(d=f.n()).done;){var p=d.value;h.cacheValue(p),this.cacheFieldsInValue(p,u)}}catch(v){f.e(v)}finally{f.f()}}}}catch(v){s.e(v)}finally{s.f()}}}},{key:"buildFieldsTuid",value:function(){Object(l.a)(Object(d.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema.mainFields;this.uq.buildFieldTuid(this.cacheFields=e||this.fields)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}},{key:"save",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new N(this,{id:t,props:n}).request();case 2:return r=e.sent,void 0!==t&&(this.idCache.remove(t),this.localArr.removeItem(t)),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new S(this,{id:t,prop:n,value:r}).request();case 2:return this.idCache.remove(t),e.next=5,this.idCache.assureObj(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new T(this,{}).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchArr(void 0,t,n,r);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,a,i){var c,o,u,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={arr:void 0,owner:t,key:n,pageStart:a,pageSize:i},e.next=3,new A(this,c).request();case 3:o=e.sent,u=this.schema.fields,l=Object(r.a)(o);try{for(l.s();!(d=l.n()).done;)h=d.value,this.cacheFieldsInValue(h,u)}catch(s){l.e(s)}finally{l.f()}return e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r&&0!==r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new I(this,{arr:t,owner:n,id:r}).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new P(this,{arr:t,owner:n,id:r,props:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new R(this,{arr:t,owner:n,id:r,order:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"hasDiv",get:function(){return void 0!==this.divs}}]),n}(O),x=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(b.b),E=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(u.a)(n,[{key:"path",get:function(){return"tuid/".concat(this.entity.name,"/").concat(this.params)}}]),n}(x),C=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"buildParams",value:function(){return this.params.ids}},{key:"xresult",value:function(e){return e.split("\n")}},{key:"path",get:function(){var e=this.params.divName;return"tuidids/".concat(this.entity.name,"/").concat(void 0!==e?e:"$")}}]),n}(x),N=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"buildParams",value:function(){var e=this.entity.schema,t=e.fields,n=e.arrs,a=this.params,i=a.id,s=a.props,c={$id:i};if(this.transParams(c,s,t),void 0!==n){var o,u=Object(r.a)(n);try{for(u.s();!(o=u.n()).done;){var l=o.value,d=l.name,h=[],f=l.fields,p=s[d];if(void 0!==p){var v,m=Object(r.a)(p);try{for(m.s();!(v=m.n()).done;){var b=v.value,y={};this.transParams(y,b,f),h.push(y)}}catch(k){m.e(k)}finally{m.f()}}c[d]=h}}catch(k){u.e(k)}finally{u.f()}}return c}},{key:"transParams",value:function(e,t,n){if(void 0!==t){var a,i=Object(r.a)(n);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.name,o=s.tuid,u=s.type,l=t[c];if(void 0!==o)"object"===typeof l&&null!==l&&(l=l.id);else switch(u){case"date":l=this.entity.buildDateParam(l);break;case"datetime":l=this.entity.buildDateTimeParam(l)}e[c]=l}}catch(d){i.e(d)}finally{i.f()}}}},{key:"path",get:function(){return"tuid/".concat(this.entity.name)}}]),n}(x),A=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"path",get:function(){return"tuids/".concat(this.entity.name)}}]),n}(x),T=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(u.a)(n,[{key:"path",get:function(){return"tuid-all/".concat(this.entity.name)}}]),n}(x),I=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(u.a)(n,[{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner,r=e.id;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/").concat(r)}}]),n}(x),S=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"path",get:function(){return"tuid-prop/".concat(this.entity.name,"/")}}]),n}(x),P=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"buildParams",value:function(){var e=this.params,t=e.id,n=e.props,r=v.a.clone(n);return r.$id=t,r}},{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}}]),n}(x),R=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"buildParams",value:function(){var e=this.params;return{bid:e.id,$order:e.order}}},{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr-pos/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}}]),n}(x),V=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,r,a)).tuidLocal=void 0,s.from=void 0,s.isImport=!0,s.from=i,s}return Object(u.a)(n,[{key:"setFrom",value:function(e){this.tuidLocal=e}},{key:"useId",value:function(e){this.tuidLocal.useId(e)}},{key:"boxId",value:function(e){return this.tuidLocal.boxId(e)}},{key:"valueFromId",value:function(e){return this.tuidLocal.valueFromId(e)}},{key:"resetCache",value:function(e){this.tuidLocal.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.assureBox(t);case 2:return e.abrupt("return",this.tuidLocal.valueFromId(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"div",value:function(e){return this.tuidLocal.div(e)}},{key:"loadMain",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadMain(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.load(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.save(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveProp(t,n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.all();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.search(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.searchArr(t,n,r,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadArr(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(c.a)(s.a.mark((function e(t,n,r,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.posArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"hasDiv",get:function(){return this.tuidLocal.hasDiv}}]),n}(O),F=function(){function e(t){Object(o.a)(this,e),this.tuid=void 0,this.ownerField=void 0,this.tuid=t}return Object(u.a)(e,[{key:"boxId",value:function(e){return this.tuid.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.tuid.getIdFromObj(e)}},{key:"useId",value:function(e){return this.tuid.useId(e)}},{key:"showInfo",value:function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:alert("showInfo not implemented");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),L=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,i){var s;return Object(o.a)(this,n),(s=t.call(this,e,i,0)).typeName="div",s.cacheFields=void 0,s.tuid=void 0,s.idName=void 0,s.idCache=void 0,s.tuid=r,s.idName="id",s.idCache=new w(r,Object(a.a)(s)),s}return Object(u.a)(n,[{key:"buildFieldsTuid",value:function(){Object(l.a)(Object(d.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema.mainFields;this.uq.buildFieldTuid(this.cacheFields=e)}},{key:"buildTuidDivBox",value:function(e){return new M(this.tuid,this,e)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"cacheValue",value:function(e){this.idCache.cacheValue(e)}},{key:"useId",value:function(e,t){!0!==this.noCache&&this.idCache.useId(e,t)}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"assureBox",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.assureObj(t);case 2:return e.abrupt("return",this.idCache.getValue(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.cacheIds();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema.fields;this.cacheFieldsInValue(e,t)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}},{key:"owner",get:function(){return this.tuid}}]),n}(j),M=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var i;return Object(o.a)(this,n),(i=t.call(this,e)).ownerField=void 0,i.div=void 0,i.div=r,i.ownerField=a,i}return Object(u.a)(n,[{key:"boxId",value:function(e){return this.div.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"useId",value:function(e){return this.div.useId(e)}}]),n}(F)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(11),a=n(6),i=n(5),s=n(3),c=n(4),o=n(20),u=n.n(o),l=new(function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"getItem",value:function(e){return localStorage.getItem(e)}},{key:"setItem",value:function(e,t){localStorage.setItem(e,t)}},{key:"removeItem",value:function(e){localStorage.removeItem(e)}}]),e}()),d=function(){function e(t,n){Object(s.a)(this,e),this.local=void 0,this.key=void 0,this.local=t,this.key=n}return Object(c.a)(e,[{key:"get",value:function(){try{var e=this.local.getItem(this.key);if(null===e)return;if(void 0===e)return;return JSON.parse(e)}catch(t){return void this.local.removeItem(this.key)}}},{key:"set",value:function(e){var t=JSON.stringify(e,(function(e,t){if("_tuid"!==e)return t}));this.local.setItem(this.key,t)}},{key:"remove",value:function(e){void 0===e?this.local.removeItem(this.key):this.local.removeLocal(e)}},{key:"child",value:function(e){return this.local.child(e)}},{key:"arr",value:function(e){return this.local.arr(e)}},{key:"map",value:function(e){return this.local.map(e)}}]),e}(),h=function(){function e(t){Object(s.a)(this,e),this.caches=void 0,this.locals=void 0,this.name=void 0,this.name=t,this.caches={},this.locals={}}return Object(c.a)(e,[{key:"getItem",value:function(e){var t=this.keyForGet(e);if(void 0!==t)return l.getItem(t)}},{key:"setItem",value:function(e,t){var n=this.keyForSet(e);l.setItem(n,t)}},{key:"removeItem",value:function(e){var t=this.keyForSet(e);void 0!==t&&localStorage.removeItem(t)}},{key:"arr",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new f(r)}return n}},{key:"map",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new p(r)}return n}},{key:"removeLocal",value:function(e){var t=e.name,n=this.keyForRemove(t);if(void 0!==n){var r=this.locals[t];void 0===r?r=new f(n):this.locals[t]=void 0,r.removeAll()}}},{key:"child",value:function(e){var t=String(e),n=this.caches[t];return void 0!==n?n:this.caches[t]=new d(this,e)}}]),e}(),f=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).index=void 0;var a=l.getItem(r.name);return r.index=null===a?[]:a.split("\n").map((function(e){return Number(e)})),r}return Object(c.a)(n,[{key:"saveIndex",value:function(){l.setItem(this.name,this.index.join("\n"))}},{key:"keyForGet",value:function(e){if(!(u.a.indexOf(this.index,e)<0))return"".concat(this.name,".").concat(e)}},{key:"keyForSet",value:function(e){var t=u.a.indexOf(this.index,e);return t<0?(this.index.unshift(e),this.index.length>500&&this.index.pop()):(this.index.splice(t,1),this.index.unshift(e)),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"keyForRemove",value:function(e){var t=u.a.indexOf(this.index,e);if(!(t<0))return this.index.splice(t,1),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"removeAll",value:function(){var e,t=Object(r.a)(this.index);try{for(t.s();!(e=t.n()).done;){var n=e.value;l.removeItem("".concat(this.name,".").concat(n))}}catch(a){t.e(a)}finally{t.f()}l.removeItem(this.name),this.index.splice(0)}},{key:"item",value:function(e){return this.child(e)}}]),n}(h),p=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).index=void 0,r.max=void 0,r.max=0,r.index={};var a=l.getItem(r.name);null!==a&&a.split("\n").forEach((function(e){var t=e.indexOf("\t");if(!(t<0)){var n=e.substr(0,t),a=Number(e.substr(t+1));!0!==isNaN(a)&&(r.index[n]=a,a>r.max&&(r.max=a))}}));return r}return Object(c.a)(n,[{key:"saveIndex",value:function(){var e=[];for(var t in this.index){var n=this.index[t];void 0!==n&&e.push("".concat(t,"\t").concat(n))}l.setItem(this.name,e.join("\n"))}},{key:"keyForGet",value:function(e){var t=this.index[e];if(void 0!==t)return"".concat(this.name,".").concat(t)}},{key:"keyForSet",value:function(e){var t=this.index[e];return void 0===t&&(++this.max,t=this.max,this.index[e]=t,this.saveIndex()),"".concat(this.name,".").concat(t)}},{key:"keyForRemove",value:function(e){var t=this.index[e];if(void 0!==t)return this.index[e]=void 0,this.saveIndex(),"".concat(this.name,".").concat(t)}},{key:"removeAll",value:function(){for(var e in this.index)l.removeItem("".concat(this.name,".").concat(this.index[e])),this.index[e]=void 0;l.removeItem(this.name),this.max=0}},{key:"item",value:function(e){return this.child(e)}}]),n}(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(0),u=n(12),l=function(e,t,n){return o.createElement(o.Fragment,null,e,": ",function(e){var t="{";if(void 0===e)return"undefined";for(var n in e){var r=e[n];if(t+=n+": ",void 0===r)t+="undefined";else if(null===r)t+="null";else switch(typeof r){default:t+=r;break;case"function":t+="function";break;case"object":t+="{obj}"}t+=", "}return t+"}"}(t))};var d=function(){function e(t,n,r){Object(s.a)(this,e),this.id=void 0,this.tuid=void 0,this.ui=void 0,this.isUndefined=void 0,this.id=Number(t),this.tuid=n,this.ui=r,this.isUndefined=void 0===this.tuid}return Object(c.a)(e,[{key:"equ",value:function(e){return void 0!==e&&null!==e&&("object"===typeof e?this.id===e.id:this.id===e)}},{key:"render",value:function(e,t){if(void 0!==this.id&&null!==this.id&&!0!==isNaN(this.id)){var n=this.boxName,r=this.obj;if(!0===this.isUndefined)return void 0!==e?e(r,t):l(n,r);switch(typeof r){case"undefined":return o.createElement("span",{className:"text-black-50"},n," undefined");case"number":return o.createElement("span",{className:"text-light"},n," ",this.id)}if(void 0===e&&(e=this.ui),void 0!==e&&("function"!==typeof e&&(e=e.content),void 0!==e)){var a=e(r);return void 0!==a?a:o.createElement("span",{className:"text-danger"},n," ",this.id)}return l(n,r)}}},{key:"assure",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuid.assureBox(this.id);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"obj",get:function(){return this.tuid.valueFromId(this.id)}},{key:"boxName",get:function(){return this.tuid.name}}]),e}();var h=Object(u.a)((function(e){var t=e.tuidValue,n=e.ui,r=e.x,a=e.nullUI;if(void 0===t)return void 0===a?o.createElement("small",{className:"text-muted"},"[\u65e0]"):a();if(null===t)return void 0===a?o.createElement(o.Fragment,null,"[null]"):a();var i=typeof t;switch(i){default:if(void 0===n)return o.createElement(o.Fragment,null,i,"-",t);var s=n(t,r);return void 0!==s?s:o.createElement(o.Fragment,null,t);case"object":var c=function(e,t,n){var r,a=e;switch(typeof e){case"undefined":r=o.createElement(o.Fragment,null,"boxId undefined");break;case"number":r=o.createElement(o.Fragment,null,"id:",e);break;default:if("function"!==typeof a.render){if(void 0!==t)return t(e,n);r=l(a.boxName,e)}}return void 0!==r?o.createElement("del",{className:"text-danger"},r):a.render(t,n)}(t,n,r);return void 0!==c?c:void 0===a?o.createElement(o.Fragment,null,"id null"):a();case"number":return o.createElement(o.Fragment,null,"id...",t)}})),f=function(e,t,n,r){return o.createElement(h,{tuidValue:e,ui:t,x:n,nullUI:r})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(1),a=n.n(r),i=n(2),s=n(6),c=n(5),o=n(3),u=n(4),l=n(0),d=n.n(l),h=n(14),f=n.n(h),p=function(){function e(t){Object(o.a)(this,e),this.el=void 0,this.el=t}return Object(u.a)(e,[{key:"scrollToTop",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,0)}),20)}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,e.el.scrollTop+e.el.offsetHeight)}),20)}}]),e}(),v=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).bottomTime=0,e.topTime=0,e.div=void 0,e.refDiv=function(t){t?(e.div=t,e.div.addEventListener("resize",e.onResize)):e.div&&e.div.removeEventListener("resize",e.onResize)},e.onResize=function(e){console.error("div resize")},e.onScroll=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i,s,c,o,u,l,d;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props,i=r.onScroll,s=r.onScrollTop,c=r.onScrollBottom,i&&e.props.onScroll(n),o=n.target,u=new p(o),o.scrollTop<30&&void 0!==s&&(l=(new Date).getTime())-e.topTime>100&&(e.topTime=l,s(u).then((function(e){if(!0===e){var t=o.scrollHeight,n=200;n>t&&(n=t),o.scrollTop=n}}))),o.scrollTop+o.offsetHeight>o.scrollHeight-30&&void 0!==c&&(d=(new Date).getTime())-e.bottomTime>100&&(e.bottomTime=d,c(u));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(u.a)(n,[{key:"eachChild",value:function(e,t){var n=this,r=e.props;if(void 0!==r){var a=r.children;void 0!==a&&d.a.Children.forEach(a,(function(e,r){var a=e._$scroll;a&&a(t),console.log(e.toString()),n.eachChild(e,t)}))}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.style;return d.a.createElement("div",{ref:this.refDiv,className:f()("tv-page"),onScroll:this.onScroll,style:n},d.a.createElement("article",{className:t},this.props.children))}}]),n}(d.a.Component)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(){return r.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},r.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"}))}},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var r=n(11),a=n(43),i=["/test","/test/","-test","-test/"];var s=function(){var t=function(){var e,t=document.location.pathname.toLowerCase(),n=Object(r.a)(i);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(!0===t.endsWith(a))return!0}}catch(s){n.e(s)}finally{n.f()}return!1}();return{testing:t,isDevelopment:!1,localDb:new a.a(!0===t?"$$":"$"),setTimeout:function(t,n,r){for(var a,i=arguments.length,s=new Array(i>3?i-3:0),c=3;c<i;c++)s[c-3]=arguments[c];return(a=e).setTimeout.apply(a,[n,r].concat(s))},clearTimeout:function(t){e.clearTimeout(t)},setInterval:function(t,n){for(var r,a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];return(r=e).setInterval.apply(r,[t,n].concat(i))},clearInterval:function(t){e.clearInterval(t)}}}()}).call(this,n(50))},function(e,t,n){"use strict";var r=n(84);n.o(r,"CAppBase")&&n.d(t,"CAppBase",(function(){return r.CAppBase})),n.o(r,"CBase")&&n.d(t,"CBase",(function(){return r.CBase})),n.o(r,"CSub")&&n.d(t,"CSub",(function(){return r.CSub})),n.o(r,"EasyTime")&&n.d(t,"EasyTime",(function(){return r.EasyTime})),n.o(r,"Edit")&&n.d(t,"Edit",(function(){return r.Edit})),n.o(r,"FA")&&n.d(t,"FA",(function(){return r.FA})),n.o(r,"Form")&&n.d(t,"Form",(function(){return r.Form})),n.o(r,"Image")&&n.d(t,"Image",(function(){return r.Image})),n.o(r,"LMR")&&n.d(t,"LMR",(function(){return r.LMR})),n.o(r,"List")&&n.d(t,"List",(function(){return r.List})),n.o(r,"Loading")&&n.d(t,"Loading",(function(){return r.Loading})),n.o(r,"Muted")&&n.d(t,"Muted",(function(){return r.Muted})),n.o(r,"NavView")&&n.d(t,"NavView",(function(){return r.NavView})),n.o(r,"Page")&&n.d(t,"Page",(function(){return r.Page})),n.o(r,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return r.TabCaptionComponent})),n.o(r,"Tabs")&&n.d(t,"Tabs",(function(){return r.Tabs})),n.o(r,"UQsMan")&&n.d(t,"UQsMan",(function(){return r.UQsMan})),n.o(r,"UserIcon")&&n.d(t,"UserIcon",(function(){return r.UserIcon})),n.o(r,"UserView")&&n.d(t,"UserView",(function(){return r.UserView})),n.o(r,"VPage")&&n.d(t,"VPage",(function(){return r.VPage})),n.o(r,"View")&&n.d(t,"View",(function(){return r.View})),n.o(r,"nav")&&n.d(t,"nav",(function(){return r.nav})),n.o(r,"start")&&n.d(t,"start",(function(){return r.start})),n.o(r,"useUser")&&n.d(t,"useUser",(function(){return r.useUser}));var a=n(42);n.d(t,"Tuid",(function(){return a.a})),n.d(t,"TuidImport",(function(){return a.b})),n.d(t,"TuidInner",(function(){return a.c}));var i=n(85);n.d(t,"TuidsCache",(function(){return i.a}));var s=n(44);n.d(t,"tv",(function(){return s.b}))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l}));var r=n(1),a=n.n(r),i=n(3),s=n(4),c=n(2);function o(e,t,n,r,a){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(a.a.mark((function e(t,n,r,i,s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetch(n,r,!1,i,s);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(){function e(t,n){Object(i.a)(this,e),this.token=void 0,this.path=void 0,this.showWaiting=void 0,this.path=t||"",this.showWaiting=n}return Object(s.a)(e,[{key:"xcall",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return n=e.sent,e.next=5,n.xcall(this.path,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return i=e.sent,e.next=5,i.callFetch(t,n,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:void 0,e.next=3,this.getHttpChannel();case 3:return r=e.sent,e.next=6,r.get(this.path+t,n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.post(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.put(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.delete(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,a,i=n(1),s=n.n(i),c=n(2),o=n(10),u=n(3),l=n(4),d=n(13),h=n(6),f=n(5),p=n(9),v=(n(22),n(0)),m=n(12),b=n(8),y=n(58),k=n(18),g=(r=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),Object(o.a)(e,"resId",a,Object(d.a)(e)),e.page=Object(m.a)((function(t){var n=t.resolve,r=e.uiItem&&e.uiItem.size;return v.createElement(y.a,{label:"\u66f4\u6539"+e.label,id:e.resId,size:r,onSaved:function(e){n(e)}})})),e}return Object(l.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resId=this.value,e.abrupt("return",new Promise((function(e,n){k.b.push(v.createElement(t.page,{resolve:e,reject:n}),(function(){return n()}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(n(29).a),a=Object(p.a)(r.prototype,"resId",[b.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},,function(e,t,n){"use strict";n(32);var r={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},a={_:{none:"[none]"},zh:{_:{none:"[\u65e0]"}}},i={_:{a:"d"}},s={_:{a:"d"}};n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r,a,i,s,c,o,u,l=n(24),d=n(1),h=n.n(d),f=n(2),p=n(10),v=n(3),m=n(4),b=n(9),y=(n(22),n(20)),k=n.n(y),g=n(8),w=(r=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(v.a)(this,e),this.isFirst=!0,this.pageItemAction=void 0,this.itemConverter=void 0,Object(p.a)(this,"loading",a,this),Object(p.a)(this,"beforeLoad",i,this),Object(p.a)(this,"loaded",s,this),this._items=void 0,Object(p.a)(this,"allLoaded",c,this),Object(p.a)(this,"topDiv",o,this),Object(p.a)(this,"bottomDiv",u,this),this.scrollToTop=function(){t.scrollIntoView(t.topDiv)},this.scrollToBottom=function(){t.scrollIntoView(t.bottomDiv)},this.param=void 0,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this.sortOrder=void 0,this.changing=!1,this._items=g.n.array([],{deep:n})}return Object(m.a)(e,[{key:"setEachPageItem",value:function(e){this.pageItemAction=e}},{key:"setItemConverter",value:function(e){this.itemConverter=e}},{key:"scrollIntoView",value:function(e){setTimeout((function(){var t=document.getElementById(e);null===t||void 0===t||t.scrollIntoView()}),20)}},{key:"getPageId",value:function(e){}},{key:"setPageStart",value:function(e){this.pageStart=this.getPageId(e)}},{key:"load",value:function(){var e=Object(f.a)(h.a.mark((function e(t,n,r){var a,i,s,c,o,u,l,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadResults(t,n,r);case 2:if(a=e.sent,i=a.$page,!this.itemConverter){e.next=9;break}for(s=[],c=i.length,o=0;o<c;o++)u=this.itemConverter(i[o],a),s.push(u);return e.abrupt("return",s);case 9:if(void 0!==this.pageItemAction)for(l=i.length,d=0;d<l;d++)this.pageItemAction(i[d],a);return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this.pageStart=void 0,this._items.clear()}},{key:"append",value:function(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)}},{key:"first",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.reset(),this.beforeLoad=!1,this.param=t,e.next=5,this.more();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attach",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a,i,s,c,o,u,l,d,f,p,v;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sortOrder){e.next=3;break}return console.error("\u6ca1\u6709\u5b9a\u4e49\u589e\u51cf\u5e8f\uff0c\u65e0\u6cd5attach"),e.abrupt("return");case 3:if(!0!==this.changing){e.next=5;break}return e.abrupt("return");case 5:this.changing=!0,t=this._items,n="asc"===this.sortOrder,"tail"===this.appendPosition?(r=t[0],a=this.scrollToTop,i=function(e){return t.unshift(e)}):(s=t.length,r=t[s-1],a=this.scrollToBottom,i=function(e){return t.splice(s,0,e)}),c=this.getPageId(r),o=void 0,u=0,l=50;case 12:if(!(u<l)){e.next=39;break}return e.next=15,this.load(this.param,o,3);case 15:if(d=e.sent,0!==(f=d.length)){e.next=19;break}return e.abrupt("break",39);case 19:p=0;case 20:if(!(p<f)){e.next=37;break}if(v=d[p],o=this.getPageId(v),!0!==n){e.next=29;break}if(!(o>=c)){e.next=27;break}return l=0,e.abrupt("break",37);case 27:e.next=32;break;case 29:if(!(o<=c)){e.next=32;break}return l=0,e.abrupt("break",37);case 32:i(v),++u;case 34:p++,e.next=20;break;case 37:e.next=12;break;case 39:this.changing=!1,u>0&&a();case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.changing){e.next=2;break}return e.abrupt("return");case 2:return this.changing=!0,e.next=5,this.load(this.param,void 0,this.firstSize>this.pageSize?this.firstSize:this.pageSize);case 5:t=e.sent,this._items.clear(),this.setLoaded(t),this.changing=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRefreshPageId",value:function(e){return this.getPageId(e)}},{key:"onLoad",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onLoaded",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"more",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.allLoaded){e.next=2;break}return e.abrupt("return",!1);case 2:if(!0!==this.loading){e.next=4;break}return e.abrupt("return",!0);case 4:if(!0!==this.changing){e.next=6;break}return e.abrupt("return",!0);case 6:return this.loading=!0,this.changing=!0,e.next=10,this.onLoad();case 10:return void 0===this.pageStart&&this.setPageStart(void 0),t=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(t=this.firstSize+1),e.next=15,this.load(this.param,this.pageStart,t);case 15:return n=e.sent,this.loaded=!0,r=n.length,!0===this.isFirst&&r>this.firstSize||!1===this.isFirst&&r>this.pageSize?(this.allLoaded=!1,--r,n.splice(r,1)):this.allLoaded=!0,this.setLoaded(n),this.isFirst=!1,this.onLoaded(),this.changing=!1,this.loading=!1,e.abrupt("return",!this.allLoaded);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setLoaded",value:function(e){var t,n,r=e.length;0===r?(this.setPageStart(void 0),this._items.clear()):(this.setPageStart(e[r-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,Object(l.a)(e)):(n=this._items).unshift.apply(n,Object(l.a)(e.reverse())))}},{key:"findItem",value:function(e){var t=this,n=this.getPageId(e),r=k.a.findIndex(this._items,(function(e){return t.getPageId(e)===n}));if(!(r<0))return this._items[r]}},{key:"items",get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0}}]),e}(),a=Object(b.a)(r.prototype,"loading",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(b.a)(r.prototype,"beforeLoad",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),s=Object(b.a)(r.prototype,"loaded",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=Object(b.a)(r.prototype,"allLoaded",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(b.a)(r.prototype,"items",[g.g],Object.getOwnPropertyDescriptor(r.prototype,"items"),r.prototype),o=Object(b.a)(r.prototype,"topDiv",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$$top"}}),u=Object(b.a)(r.prototype,"bottomDiv",[g.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$$bottom"}}),r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return A})),n.d(t,"b",(function(){return T}));var r,a,i,s,c,o,u,l,d=n(6),h=n(5),f=n(1),p=n.n(f),v=n(2),m=n(10),b=n(3),y=n(4),k=n(9),g=(n(22),n(0)),w=n(8),O=n(12),j=n(14),x=n.n(j),E=(n(106),n(45)),C=(r=function(){function e(){Object(b.a)(this,e),Object(m.a)(this,"loaded",a,this),this.name=void 0,Object(m.a)(this,"selected",i,this),this.caption=void 0,this.contentBuilder=void 0,this.page=void 0,this.notify=void 0,this.load=void 0,this.onShown=void 0,this.onScroll=void 0,this.onScrollTop=void 0,this.onScrollBottom=void 0,this.className=void 0,this._content=void 0}return Object(y.a)(e,[{key:"shown",value:function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.onShown){e.next=3;break}return e.next=3,this.onShown();case 3:if(void 0===this.load){e.next=8;break}if(!1!==this.loaded){e.next=8;break}return e.next=7,this.load();case 7:this.loaded=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"content",get:function(){return this.load&&!1===this.loaded?null:(!1===this.selected||this._content||(void 0!==this.contentBuilder?this._content=this.contentBuilder():void 0!==this.page?this._content=this.page.content():this._content=g.createElement("div",{className:"p-5"},"tab \u5e94\u8be5\u5b9a\u4e49content\u6216\u8005page")),this._content)}}]),e}(),a=Object(k.a)(r.prototype,"loaded",[w.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(k.a)(r.prototype,"selected",[w.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r),N=function(e,t,n){return g.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},g.createElement("div",null,g.createElement("i",{className:"fa fa-lg fa-"+t})),g.createElement("small",null,e))},A=(s=function(){function e(t){var n=this;Object(b.a)(this,e),this.props=void 0,this.size=void 0,this.tabBg=void 0,this.sep=void 0,Object(m.a)(this,"selectedTab",c,this),Object(m.a)(this,"tabArr",o,this),this.tabClick=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}if(void 0!==(t=n.selectedTab)){e.next=8;break}if(void 0!==n.tabArr){e.next=5;break}return e.abrupt("return");case 5:if(0!==n.tabArr.length){e.next=7;break}return e.abrupt("return");case 7:t=n.tabArr[0];case 8:return n.selectedTab.selected=!1,t.selected=!0,n.selectedTab=t,e.next=13,t.shown();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.tabs=Object(O.a)((function(){var e,t,r=n.props,a=r.tabPosition,i=r.borderColor;i&&(e={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderLeftWidth:1,borderRightWidth:1,borderBottomWidth:1},t={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:0},"top"===a?(e.borderBottomWidth=0,e.borderTopLeftRadius=10,e.borderTopRightRadius=10,t.borderTopWidth=0):(e.borderTopWidth=0,e.borderBottomLeftRadius=10,e.borderBottomRightRadius=10,t.borderBottomWidth=0));var s=x()("tv-tabs",n.tabBg,n.sep,"tv-tabs-"+n.size);return g.createElement("div",{className:s},n.tabArr.map((function(r,a){var i,s=r.selected,c=r.caption,o=r.notify;if(void 0!==o){var u=o.get();void 0!==u&&(u>0?i=g.createElement("u",null,u>99?"99+":u):u<0&&(i=g.createElement("u",{className:"dot"})))}return g.createElement("div",{key:a,onClick:function(){return n.tabClick(r)},style:!0===s?e:t},g.createElement("div",null,i,c(s)))})))})),this.content=Object(O.a)((function(){var e={visibility:"hidden"};return g.createElement(g.Fragment,null,n.tabArr.map((function(t,r){var a,i,s,c,o=n.props.tabPosition,u=t.content,l=t.page,d=t.onScroll,h=t.onScrollTop,f=t.onScrollBottom,p=t.className,v=g.createElement(n.tabs);void 0!==l&&(a=l.header(),i=l.footer());var m,b={visibility:"hidden"};return"top"===o?(s=g.createElement(g.Fragment,null,g.createElement("section",{className:"tv-page-header"},g.createElement("header",null,v,a)),g.createElement("header",{style:b},v,a)),void 0!==i&&(c=g.createElement(g.Fragment,null,g.createElement("footer",{style:b},i),g.createElement("section",{className:"tv-page-footer"},g.createElement("footer",null,i))))):(void 0!==a&&(s=g.createElement(g.Fragment,null,g.createElement("section",{className:"tv-page-header"},g.createElement("header",null,a)),g.createElement("header",{style:b},a))),c=g.createElement(g.Fragment,null,g.createElement("footer",{style:b},i,v),g.createElement("section",{className:"tv-page-footer"},g.createElement("footer",null,i,v)))),!1===t.selected&&(m=e),g.createElement(E.a,{key:r,className:p,style:m,onScroll:d,onScrollTop:h,onScrollBottom:f},s,u,c)})))})),this.props=t;var r=t.size,a=t.tabs,i=t.tabBg,s=t.sep,u=t.selected;this.size=r||"md",this.tabArr=a.map((function(e){var t=new C,r=e.name,a=e.caption,i=e.content,s=e.page,c=e.notify,o=e.load,l=e.onShown,d=e.isSelected,h=e.onScroll,f=e.onScrollTop,p=e.onScrollBottom,v=e.className;return t.name=r,!0!==d&&r!==u||(n.selectedTab=t),t.selected=!1,t.caption=a,void 0!==i?t.contentBuilder=i:void 0!==s&&(t.page=s),t.notify=c,t.load=o,t.onShown=l,t.onScroll=h,t.onScrollTop=f,t.onScrollBottom=p,t.className=v,t})),this.tabBg=i,this.sep=s,void 0===this.selectedTab&&(this.selectedTab=this.tabArr[0]),this.selectedTab.selected=!0}return Object(y.a)(e,[{key:"render",value:function(){var e,t,n=this.props.tabPosition,r=g.createElement(this.tabs,null),a={display:"none"};return"top"===n?e=g.createElement("header",null,r):t=g.createElement("footer",null,r),g.createElement(g.Fragment,null,e,this.tabArr.map((function(e,t){var n;return!1===e.selected&&(n=a),g.createElement("div",{key:t,className:x()(e.className),style:n},e.content)})),t)}}]),e}(),c=Object(k.a)(s.prototype,"selectedTab",[w.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(k.a)(s.prototype,"tabArr",[w.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s),T=Object(O.a)(u=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new A(e),setTimeout((function(){r.tabsView.tabClick(void 0)}),100),r}return Object(y.a)(n,[{key:"render",value:function(){return this.tabsView.render()}}]),n}(g.Component))||u;Object(O.a)(l=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new A(e),setTimeout((function(){r.tabsView.tabClick(void 0)}),100),r}return Object(y.a)(n,[{key:"render",value:function(){return g.createElement(this.tabsView.content)}}]),n}(g.Component))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var r,a,i,s,c,o,u,l,d,h,f,p,v,m,b,y,k,g,w,O,j,x,E,C,N,A,T,I,S,P,R,V,F,L=n(1),M=n.n(L),D=n(2),U=n(10),_=n(3),B=n(4),q=n(13),z=n(6),W=n(5),G=n(9),H=(n(22),n(0)),$=n(18),K=n(46),Q=n(36),J=n(23),Z=n(12),X=n(8),Y=n(41),ee=Object(Z.a)((a=function(e){Object(z.a)(n,e);var t=Object(W.a)(n);function n(){var e;Object(_.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).fileInput=void 0,Object(U.a)(e,"fileName",i,Object(q.a)(e)),e.upload=function(){var t=Object(D.a)(M.a.mark((function t(n){var r,a,i,s;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=$.b.resUrl+"upload",n||(n=e.buildFormData()),t.prev=2,$.b.startWait(),(a=new Headers).append("Access-Control-Allow-Origin","*"),t.next=8,fetch(r,{method:"POST",body:n,headers:a});case 8:return i=t.sent,t.next=11,i.json();case 11:return s=t.sent,t.abrupt("return",":"+s.res.id);case 15:return t.prev=15,t.t0=t.catch(2),console.error("%s %s",r,t.t0),t.abrupt("return",{error:t.t0});case 19:return t.prev=19,$.b.endWait(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,15,19,22]])})));return function(e){return t.apply(this,arguments)}}(),e.onFilesChange=function(t){var n=e.props.onFilesChange;n&&n(t);for(var r=t.target.files,a=r.length,i=[],s=0;s<a;s++)i.push(r.item(s).name);e.fileName=i.join(", ")},e}return Object(B.a)(n,[{key:"buildFormData",value:function(){var e=this.props.maxSize;void 0===e||e<=0?e=1e11:e*=1024;for(var t=this.fileInput.files,n=new FormData,r=t.length,a=0;a<r;a++){var i=t[a];if(i.size>e)return null;n.append("files[]",i,i.name)}}},{key:"getFile0",value:function(){return this.fileInput.files[0]}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.multiple,a=t.label;return H.createElement("div",null,H.createElement("label",{className:"btn btn-outline-success"},a||"\u9009\u62e9\u6587\u4ef6",H.createElement("input",{className:n,ref:function(t){return e.fileInput=t},onChange:this.onFilesChange,type:"file",name:"file",multiple:r,style:{display:"none"}})),"\xa0",this.fileName)}}]),n}(H.Component),i=Object(G.a)(a.prototype,"fileName",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=a))||r;function te(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2?arguments[2]:void 0;for(r=r||["B","K","M","G","TB"];(t=r.shift())&&e>1024;)e/=1024;return("B"===t?e:e.toFixed(void 0===n?2:n))+t}var ne=Object(Z.a)((O=w=function(e){Object(z.a)(n,e);var t=Object(W.a)(n);function n(e){var r;return Object(_.a)(this,n),(r=t.call(this,e)).imgBaseSize=void 0,r.suffix=void 0,r.resUploader=void 0,Object(U.a)(r,"file",o,Object(q.a)(r)),Object(U.a)(r,"desImgWidth",u,Object(q.a)(r)),Object(U.a)(r,"desImgHeight",l,Object(q.a)(r)),Object(U.a)(r,"desImgSize",d,Object(q.a)(r)),Object(U.a)(r,"srcImgWidth",h,Object(q.a)(r)),Object(U.a)(r,"srcImgHeight",f,Object(q.a)(r)),Object(U.a)(r,"isChanged",p,Object(q.a)(r)),Object(U.a)(r,"resId",v,Object(q.a)(r)),Object(U.a)(r,"enableUploadButton",m,Object(q.a)(r)),Object(U.a)(r,"srcImage",b,Object(q.a)(r)),Object(U.a)(r,"desImage",y,Object(q.a)(r)),Object(U.a)(r,"fileError",k,Object(q.a)(r)),Object(U.a)(r,"uploaded",g,Object(q.a)(r)),r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),n.imageTypes.indexOf(r.suffix)<0)return void(r.fileError="\u56fe\u7247\u7c7b\u578b\u5fc5\u987b\u662f ".concat(n.imageTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var a=new FileReader;a.readAsDataURL(r.file),a.onload=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.srcImage=a.result,e.t0=r.suffix,e.next="svg"===e.t0?7:4;break;case 4:return e.next=6,r.setSize(r.props.size);case 6:return e.abrupt("break",11);case 7:return r.imgBaseSize=400,r.desImgSize=r.srcImage.length,r.desImage=r.srcImage,e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})))}},r.compress=function(){return new Promise((function(e,t){var n=new Image;n.src=r.srcImage,n.onload=function(){var t=n.width,a=n.height;r.srcImgWidth=t,r.srcImgHeight=a;var i,s,c=t/a;t<=r.imgBaseSize&&a<=r.imgBaseSize?(i=t,s=a):c<0?s=(i=r.imgBaseSize)/c:i=(s=r.imgBaseSize)*c,r.desImgWidth=Math.round(i),r.desImgHeight=Math.round(s);var o=document.createElement("canvas"),u=o.getContext("2d"),l=document.createAttribute("width");l.nodeValue=String(i);var d=document.createAttribute("height");d.nodeValue=String(s),o.setAttributeNode(l),o.setAttributeNode(d),u.drawImage(n,0,0,i,s);var h=o.toDataURL("image/"+r.suffix,.7),f=r.convertBase64UrlToBlob(h);r.desImgSize=f.size,r.desImgSize>5e6&&(r.fileError="\u56fe\u7247\u5927\u4e8e4M\uff0c\u65e0\u6cd5\u4e0a\u4f20",r.enableUploadButton=!1),e(h)}}))},r.upload=Object(D.a)(M.a.mark((function e(){var t,n,a,i,s,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return t=new FormData,n=r.convertBase64UrlToBlob(r.desImage),t.append("image",n,r.file.name),e.next=7,r.resUploader.upload(t);case 7:if("object"!==typeof(a=e.sent)){e.next=24;break}i=a.error,s=typeof i,e.t0=s,e.next="undefined"===e.t0?14:"string"===e.t0?16:"object"===e.t0?18:20;break;case 14:return c="error: undefined",e.abrupt("break",22);case 16:return c=i,e.abrupt("break",22);case 18:return c=i.message,e.abrupt("break",22);case 20:return c=String(c),e.abrupt("break",22);case 22:return r.fileError="error: "+s+" - "+c,e.abrupt("return");case 24:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 27:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},r.showOrgImage=function(){$.b.push(H.createElement(J.a,{header:"\u539f\u56fe"},H.createElement("div",{className:"p-3 text-center"},H.createElement(Q.a,{className:"h-min-4c",style:{maxWidth:"100%"},src:r.srcImage}))))},r.resId=e.id,r}return Object(B.a)(n,[{key:"setSize",value:function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="sm"===e.t0?3:"md"===e.t0?5:"lg"===e.t0?7:3;break;case 3:return this.imgBaseSize=180,e.abrupt("break",9);case 5:return this.imgBaseSize=400,e.abrupt("break",9);case 7:return this.imgBaseSize=800,e.abrupt("break",9);case 9:return e.next=11,this.compress();case 11:this.desImage=e.sent;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"levelDiv",value:function(){var e=this;if(!this.props.size){var t=[{caption:"\u5c0f\u56fe",size:"sm"}];if((this.srcImgHeight>400||this.srcImgWidth>400)&&t.push({caption:"\u4e2d\u56fe",size:"md"}),(this.srcImgHeight>800||this.srcImgWidth>800)&&t.push({caption:"\u5927\u56fe",size:"lg"}),!(t.length<2))return H.createElement("div",null,t.map((function(t,n){var r=t.caption,a=t.size;return H.createElement("label",{key:n,className:"mr-3"},H.createElement("input",{type:"radio",name:"size",onChange:function(){return e.setSize(a)},defaultChecked:0===n})," ",r)})))}}},{key:"render",value:function(){var e=this,t=this.props.label,r=H.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!this.isChanged,onClick:this.onSaved},"\u4fdd\u5b58");return H.createElement(J.a,{header:t||"\u66f4\u6539\u56fe\u7247",right:r},H.createElement("div",{className:"my-3 px-3 py-3 bg-white"},H.createElement("div",null,H.createElement("div",{className:"mb-3"},H.createElement(ee,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u56fe\u7247\u6587\u4ef6",onFilesChange:this.onFileChange}),H.createElement("div",{className:"small text-muted"},"\u652f\u6301 ",n.imageTypes.join(", ")," \u683c\u5f0f\u56fe\u7247\u3002"),this.fileError&&H.createElement("div",{className:"text-danger"},this.fileError)),H.createElement(Y.b,{left:!0===this.uploaded?H.createElement("div",{className:"text-success p-2"},"\u4e0a\u4f20\u6210\u529f\uff01"):this.file&&this.desImgSize>0&&H.createElement("div",{className:"mb-3 d-flex align-items-end"},H.createElement("div",{className:"mr-5"},this.levelDiv(),H.createElement("div",null,"\u5206\u8fa8\u7387\uff1a",this.desImgWidth," x ",this.desImgHeight,"\xa0 \xa0 \u6587\u4ef6\u5927\u5c0f\uff1a",te(this.desImgSize))),H.createElement("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload},"\u4e0a\u4f20")),right:this.desImage&&H.createElement("button",{className:"btn btn-link btn-sm text-right mb-3",onClick:this.showOrgImage},"\u539f\u56fe\u5927\u5c0f: ",te(this.file.size),H.createElement("br",null),"\u5206\u8fa8\u7387\uff1a",this.srcImgWidth," x ",this.srcImgHeight)})),H.createElement("div",{className:"text-center",style:{border:!0===this.uploaded?"2px solid green":"1px dotted gray",padding:"8px"}},H.createElement(Q.a,{className:"h-min-4c",style:{maxWidth:"100%"},src:this.desImage}))))}}]),n}(H.Component),w.imageTypes=["gif","jpg","jpeg","png","svg","apng","bmp","ico","cur","tiff","tif","webp"],c=O,o=Object(G.a)(c.prototype,"file",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(G.a)(c.prototype,"desImgWidth",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(G.a)(c.prototype,"desImgHeight",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(G.a)(c.prototype,"desImgSize",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(G.a)(c.prototype,"srcImgWidth",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(G.a)(c.prototype,"srcImgHeight",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(G.a)(c.prototype,"isChanged",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=Object(G.a)(c.prototype,"resId",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(G.a)(c.prototype,"enableUploadButton",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=Object(G.a)(c.prototype,"srcImage",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(G.a)(c.prototype,"desImage",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(G.a)(c.prototype,"fileError",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(G.a)(c.prototype,"uploaded",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=c))||s;Object(Z.a)((F=V=function(e){Object(z.a)(n,e);var t=Object(W.a)(n);function n(e){var r;return Object(_.a)(this,n),(r=t.call(this,e)).suffix=void 0,r.resUploader=void 0,Object(U.a)(r,"content",E,Object(q.a)(r)),Object(U.a)(r,"file",C,Object(q.a)(r)),Object(U.a)(r,"fileSize",N,Object(q.a)(r)),Object(U.a)(r,"isChanged",A,Object(q.a)(r)),Object(U.a)(r,"resId",T,Object(q.a)(r)),Object(U.a)(r,"enableUploadButton",I,Object(q.a)(r)),Object(U.a)(r,"fileError",S,Object(q.a)(r)),Object(U.a)(r,"uploaded",P,Object(q.a)(r)),Object(U.a)(r,"uploading",R,Object(q.a)(r)),r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),n.audioTypes.indexOf(r.suffix)<0)return void(r.fileError="\u97f3\u9891\u7c7b\u578b\u5fc5\u987b\u662f ".concat(n.audioTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var a=new FileReader;a.readAsDataURL(r.file),a.onload=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.content=a.result,r.fileSize=r.content.length;case 2:case"end":return e.stop()}}),e)})))}},r.upload=Object(D.a)(M.a.mark((function e(){var t,n,a,i,s,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return r.uploading=!0,t=new FormData,n=r.convertBase64UrlToBlob(r.content),t.append("image",n,r.file.name),e.next=8,r.resUploader.upload(t);case 8:if("object"!==typeof(a=e.sent)){e.next=25;break}i=a.error,s=typeof i,e.t0=s,e.next="undefined"===e.t0?15:"string"===e.t0?17:"object"===e.t0?19:21;break;case 15:return c="error: undefined",e.abrupt("break",23);case 17:return c=i,e.abrupt("break",23);case 19:return c=i.message,e.abrupt("break",23);case 21:return c=String(c),e.abrupt("break",23);case 23:return r.fileError="error: "+s+" - "+c,e.abrupt("return");case 25:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 28:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},r.resId=e.id,r}return Object(B.a)(n,[{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"render",value:function(){var e=this,t=this.props.label,r=H.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!this.isChanged,onClick:this.onSaved},"\u4fdd\u5b58");return H.createElement(J.a,{header:t||"\u66f4\u6539\u6587\u4ef6",right:r},H.createElement("div",{className:"my-3 px-3 py-3 bg-white"},H.createElement("div",null,H.createElement("div",{className:"mb-3"},H.createElement(ee,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u97f3\u9891\u6587\u4ef6",onFilesChange:this.onFileChange}),H.createElement("div",{className:"small text-muted"},"\u652f\u6301 ",n.audioTypes.join(", ")," \u683c\u5f0f\u3002"),this.fileError&&H.createElement("div",{className:"text-danger"},this.fileError)))),H.createElement(Y.b,{left:!0===this.uploaded?H.createElement("div",{className:"text-success p-2"},"\u4e0a\u4f20\u6210\u529f\uff01"):!0===this.uploading?H.createElement("div",{className:"m-3"},H.createElement(K.a,null)):this.file&&this.content&&H.createElement("div",{className:"m-3"},H.createElement("div",{className:"mb-3"},"\u6587\u4ef6\u5927\u5c0f\uff1a",te(this.fileSize)),H.createElement("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload},"\u4e0a\u4f20"))}))}}]),n}(H.Component),V.audioTypes=["mp3","wav"],x=F,E=Object(G.a)(x.prototype,"content",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(G.a)(x.prototype,"file",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(G.a)(x.prototype,"fileSize",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(G.a)(x.prototype,"isChanged",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=Object(G.a)(x.prototype,"resId",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(G.a)(x.prototype,"enableUploadButton",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=Object(G.a)(x.prototype,"fileError",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(G.a)(x.prototype,"uploaded",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),R=Object(G.a)(x.prototype,"uploading",[X.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=x))},function(e,t,n){"use strict";n(60),n(28),n(40);var r=n(34);n.d(t,"QueryPager",(function(){return r.b}));n(61);var a=n(49);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Loading")&&n.d(t,"Loading",(function(){return a.Loading})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"NavView")&&n.d(t,"NavView",(function(){return a.NavView})),n.o(a,"Page")&&n.d(t,"Page",(function(){return a.Page})),n.o(a,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return a.TabCaptionComponent})),n.o(a,"Tabs")&&n.d(t,"Tabs",(function(){return a.Tabs})),n.o(a,"Tuid")&&n.d(t,"Tuid",(function(){return a.Tuid})),n.o(a,"UQsMan")&&n.d(t,"UQsMan",(function(){return a.UQsMan})),n.o(a,"UserIcon")&&n.d(t,"UserIcon",(function(){return a.UserIcon})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"nav")&&n.d(t,"nav",(function(){return a.nav})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"tv")&&n.d(t,"tv",(function(){return a.tv})),n.o(a,"useUser")&&n.d(t,"useUser",(function(){return a.useUser}));n(62),n(64),n(63),n(65);var i=n(86);n.d(t,"UQsMan",(function(){return i.a}));n(66)},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(11),a=n(1),i=n.n(a),s=n(2),c=n(3),o=n(4),u=n(20),l=n.n(u),d=n(19),h=n(49),f=n(40),p=n(61),v=n(34),m=n(62),b=n(63),y=n(64),k=n(65),g=n(44),w=n(66);var O=function(){function e(t,n,r,a){var i=this;Object(c.a)(this,e),this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tags={},this.tuidsCache=void 0,this.localAccess=void 0,this.tvs=void 0,this.localMap=void 0,this.localModifyMax=void 0,this.tuids={},this.createBoxId=void 0,this.newVersion=void 0,this.uqOwner=void 0,this.uqName=void 0,this.name=void 0,this.uqApi=void 0,this.id=void 0,this.uqVersion=void 0,this.createBoxIdFromTVs=function(e,t){var n=e.name;return new g.a(t,e,i.tvs[n])},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.tagArr=[],this.createBoxId=r,void 0===r&&(this.createBoxId=this.createBoxIdFromTVs,this.tvs=a||{});var s=n.id,o=n.uqOwner,u=n.uqName,l=n.access,f=n.newVersion;this.newVersion=f,this.uqOwner=o,this.uqName=u,this.id=s,this.name=o+"/"+u,this.uqVersion=0,this.localMap=t.localMap.map(this.name),this.localModifyMax=this.localMap.child("$modifyMax"),this.localAccess=this.localMap.child("$access");var p;if(p=null===l||void 0===l||"*"===l?[]:l.split(";").map((function(e){return e.trim()})).filter((function(e){return e.length>0})),"$$$/$unitx"===this.name)this.uqApi=new d.d(d.g.unit);else{var v=t.appOwner,m=t.appName;this.uqApi=new d.e("tv/",v,m,o,u,p,!0)}this.tuidsCache=new h.TuidsCache(this)}return Object(o.a)(e,[{key:"tuid",value:function(e){return this.tuids[e.toLowerCase()]}},{key:"tuidDiv",value:function(e,t){var n=this.tuids[e.toLowerCase()];return n&&n.div(t.toLowerCase())}},{key:"action",value:function(e){return this.actions[e.toLowerCase()]}},{key:"sheet",value:function(e){return this.sheets[e.toLowerCase()]}},{key:"query",value:function(e){return this.queries[e.toLowerCase()]}},{key:"book",value:function(e){return this.books[e.toLowerCase()]}},{key:"map",value:function(e){return this.maps[e.toLowerCase()]}},{key:"history",value:function(e){return this.histories[e.toLowerCase()]}},{key:"pending",value:function(e){return this.pendings[e.toLowerCase()]}},{key:"sheetFromTypeId",value:function(e){for(var t in this.sheets){var n=this.sheets[t];if(n.typeId===e)return n}}},{key:"init",value:function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadEntities",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.localAccess.get()){e.next=6;break}return e.next=5,this.uqApi.loadAccess();case 5:t=e.sent;case 6:if(t){e.next=8;break}return e.abrupt("return");case 8:this.buildEntities(t),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"buildEntities",value:function(e){this.localAccess.set(e);var t=e.access,n=e.tuids,r=e.version;this.uqVersion=r,this.buildTuids(n),this.buildAccess(t)}},{key:"buildTuids",value:function(e){for(var t in e){var n=e[t],r=n.typeId,a=n.from;this.newTuid(t,r,a).sys=!0}for(var i in e){var s=e[i];this.getTuid(i).setSchema(s)}for(var c in this.tuids){this.tuids[c].buildFieldsTuid()}}},{key:"loadEntitySchema",value:function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.schema(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTuid",value:function(e){return this.tuids[e]}},{key:"buildAccess",value:function(e){for(var t in e){var n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}}},{key:"cacheTuids",value:function(e){this.tuidsCache.cacheTuids(e)}},{key:"newAction",value:function(e,t){var n=this.actions[e];return void 0!==n||(n=this.actions[e]=new f.a(this,e,t),this.actionArr.push(n)),n}},{key:"newTuid",value:function(e,t,n){var r=this.tuids[e];return void 0!==r||(r=void 0!==n?new h.TuidImport(this,e,t,n):new h.TuidInner(this,e,t),this.tuids[e]=r,this.tuidArr.push(r)),r}},{key:"newQuery",value:function(e,t){var n=this.queries[e];return void 0!==n||(n=this.queries[e]=new v.a(this,e,t),this.queryArr.push(n)),n}},{key:"newBook",value:function(e,t){var n=this.books[e];return void 0!==n||(n=this.books[e]=new m.a(this,e,t),this.bookArr.push(n)),n}},{key:"newMap",value:function(e,t){var n=this.maps[e];return void 0!==n||(n=this.maps[e]=new y.a(this,e,t),this.mapArr.push(n)),n}},{key:"newTag",value:function(e,t){var n=this.tags[e];return void 0!==n||(n=this.tags[e]=new w.a(this,e,t),this.tagArr.push(n)),n}},{key:"newHistory",value:function(e,t){var n=this.histories[e];if(void 0===n)return n=this.histories[e]=new b.a(this,e,t),this.historyArr.push(n),n}},{key:"newPending",value:function(e,t){var n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new k.a(this,e,t),this.pendingArr.push(n),n}},{key:"newSheet",value:function(e,t){var n=this.sheets[e];return void 0!==n||(n=this.sheets[e]=new p.a(this,e,t),this.sheetArr.push(n)),n}},{key:"fromType",value:function(e,t){var n=t.split("|");t=n[0];var r=Number(n[1]);switch(t){case"tuid":break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r);break;case"tag":this.newTag(e,r)}}},{key:"fromObj",value:function(e,t){switch(t.$){case"sheet":this.buildSheet(e,t)}}},{key:"buildSheet",value:function(e,t){var n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)}},{key:"buildFieldTuid",value:function(e,t){var n=this;if(void 0!==e){var a,i=Object(r.a)(e);try{for(i.s();!(a=i.n()).done;){var s=a.value,c=s.tuid;if(void 0!==c){var o=this.getTuid(c);void 0!==o&&(s._tuid=o.buildTuidBox())}}}catch(h){i.e(h)}finally{i.f()}var u,l=Object(r.a)(e);try{var d=function(){var r=u.value,a=r.owner;if(void 0===a)return"continue";var i=e.find((function(e){return e.name===a}));if(void 0===i&&(void 0!==t&&(i=t.find((function(e){return e.name===a}))),void 0===i))throw new Error("owner field ".concat(a," is undefined"));var s=r.arr,c=r.tuid,o=n.getTuid(i._tuid.tuid.name);if(void 0===o)return"continue";var l=o.div(s||c);if(r._tuid=l&&l.buildTuidDivBox(i),void 0===r._tuid)throw new Error("owner field ".concat(a," is not tuid"))};for(l.s();!(u=l.n()).done;)d()}catch(h){l.e(h)}finally{l.f()}}}},{key:"buildArrFieldsTuid",value:function(e,t){if(void 0!==e){var n,a=Object(r.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value.fields;void 0!==i&&this.buildFieldTuid(i,t)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"pullModify",value:function(e){this.tuidsCache.pullModify(e)}},{key:"entities",get:function(){return l.a.merge({},this.actions,this.sheets,this.queries,this.books,this.maps,this.histories,this.pendings,this.tuids,this.tags)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(1),a=n.n(r),i=n(2),s=n(11),c=n(3),o=n(4),u=n(17),l=n(16),d=n(6),h=n(5),f=n(28),p=n(56),v=n(27),m=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).states=void 0,e}return Object(o.a)(n,[{key:"setSchema",value:function(e){Object(u.a)(Object(l.a)(n.prototype),"setSchema",this).call(this,e),this.states=e.states}},{key:"build",value:function(e){this.states=[];var t,n=Object(s.a)(e.ops);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.states.push({name:r,actions:void 0})}}catch(a){n.e(a)}finally{n.f()}}},{key:"createSheetState",value:function(e,t){var n={name:e,actions:[]},r=n.actions;for(var a in t){var i={name:a};r.push(i)}return n}},{key:"save",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.uq.id,i={app:r,discription:t,data:n},e.next=4,new y(this,i).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"action",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new k(this,{id:t,flow:n,state:r,action:i}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"unpack",value:function(e){var t=e[0][0];return{brief:t,data:this.unpackSheet(t.data),flows:e[1]}}},{key:"getSheet",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new g(this,t).request();case 2:if(0!==(n=e.sent)[0].length){e.next=7;break}return e.next=6,this.getArchive(t);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",this.unpack(n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchive",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w(this,t).request();case 2:return n=e.sent,e.abrupt("return",this.unpack(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchives",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={pageStart:t,pageSize:n},e.next=3,new O(this,r).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStateSheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={state:t,pageStart:n,pageSize:r},e.next=3,new j(this,i).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createPageStateItems",value:function(){return new N(this)}},{key:"stateSheetCount",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new x(this,void 0).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"userSheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={state:t,user:n,pageStart:r,pageSize:i},e.next=3,new E(this,s).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"mySheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={state:t,pageStart:n,pageSize:r},e.next=3,new C(this,i).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"sheet"}}]),n}(f.a),b=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix=void 0,e}return Object(o.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/").concat(this.suffix)}}]),n}(v.b),y=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"buildParams",value:function(){var e=this.params,t=e.app,n=e.discription,r=e.data;return{app:t,discription:n,data:this.entity.pack(r)}}},{key:"path",get:function(){return"sheet/".concat(this.entity.name)}}]),n}(b),k=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="PUT",e}return Object(o.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name)}}]),n}(b),g=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(o.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/get/").concat(this.params)}}]),n}(b),w=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(o.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/archive/").concat(this.params)}}]),n}(b),O=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="archives",e}return n}(b),j=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="states",e}return n}(b),x=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e.suffix="statecount",e}return Object(o.a)(n,[{key:"xresult",value:function(e){return this.entity.states.map((function(t){var n=t.name,r=0,a=e.find((function(e){return e.state===n}));return void 0!==a&&(r=a.count),{state:n,count:r}}))}}]),n}(b),E=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="user-sheets",e}return Object(o.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(b),C=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="my-sheets",e}return Object(o.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(b),N=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,!0)).sheet=void 0,r.sheet=e,r.pageSize=10,r}return Object(o.a)(n,[{key:"loadResults",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sheet.getStateSheets(t,n,r);case 2:return i=e.sent,e.abrupt("return",{$page:i});case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getPageId",value:function(e){return void 0===e?0:e.id}}]),n}(p.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3),a=n(4),i=n(6),s=n(5),c=n(34),o=n(27),u=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="book",e}return Object(a.a)(n,[{key:"queryCaller",value:function(e){return new l(this,e)}},{key:"typeName",get:function(){return"book"}}]),n}(c.a),l=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"path",get:function(){return"book/".concat(this.entity.name)}}]),n}(o.d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(4),i=n(6),s=n(5),c=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="history",e}return Object(a.a)(n,[{key:"typeName",get:function(){return"history"}}]),n}(n(34).a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(1),a=n.n(r),i=n(2),s=n(3),c=n(4),o=n(17),u=n(16),l=n(6),d=n(5),h=n(28),f=n(40),p=n(27),v=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).keys=void 0,e.actions={},e.queries={},e.schemaFrom=void 0,e}return Object(c.a)(n,[{key:"setSchema",value:function(e){Object(o.a)(Object(u.a)(n.prototype),"setSchema",this).call(this,e),this.schemaFrom=this.schema.from;var t=e.actions,r=e.queries,a=e.keys;for(var i in this.uq.buildFieldTuid(this.keys=a),t){var s=t[i],c=s.name,l=this.uq.newAction(c,void 0);l.setSchema(s),l.buildFieldsTuid(),this.actions[i]=l}for(var d in r){var h=r[d],f=h.name,p=this.uq.newQuery(f,void 0);p.setSchema(h),p.buildFieldsTuid(),this.queries[d]=p}}},{key:"add",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new b(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new y(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new k(this,void 0).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"page",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new g(this,{pageStart:n,pageSize:r,param:t}).request();case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new w(this,t),e.next=3,n.request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query(t);case 2:n=e.sent,e.t0=a.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.table(t);case 2:if(!((n=e.sent).length>0)){e.next=5;break}return e.abrupt("return",n[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.obj(t);case 2:n=e.sent,e.t0=a.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"map"}}]),n}(h.a),m=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"innerCall",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getCaller(this.params),e.next=3,this.entity.uqApi.xcall(t);case 3:return n=e.sent,r=t.xresult(n.res),e.abrupt("return",{res:r});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildParams",value:function(){return Object(o.a)(Object(u.a)(n.prototype),"buildParams",this).call(this)}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){}}]),n}(p.b),b=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCaller",value:function(e){return new O(this.entity,this.entity.actions.add,e)}}]),n}(m),y=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCaller",value:function(e){return new j(this.entity,this.entity.actions.add,e)}}]),n}(m),k=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCaller",value:function(e){return new x(this.entity,this.entity.queries.all,e)}}]),n}(m),g=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCaller",value:function(e){return new E(this.entity,this.entity.queries.page,e)}}]),n}(m),w=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getCaller",value:function(e){return new C(this.entity,this.entity.queries.query,e)}}]),n}(m),O=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(c.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/add")}},{key:"headers",get:function(){}}]),n}(f.b),j=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(c.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/del")}},{key:"headers",get:function(){}}]),n}(f.b),x=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(c.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/all")}},{key:"headers",get:function(){}}]),n}(p.c),E=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(c.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/page")}},{key:"headers",get:function(){}}]),n}(p.c),C=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(c.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/query")}},{key:"headers",get:function(){}}]),n}(p.d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(4),i=n(6),s=n(5),c=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).queryApiName="pending",e}return Object(a.a)(n,[{key:"typeName",get:function(){return"pending"}}]),n}(n(34).a)},function(e,t,n){"use strict";var r=n(1),a=n.n(r),i=n(2),s=n(11),c=n(3),o=n(4),u=n(6),l=n(5),d=n(28),h=n(0),f={height:"auto"},p=function(){function e(t){Object(c.a)(this,e),this.tag=void 0,this.tag=t}return Object(o.a)(e,[{key:"render",value:function(e){var t;return t="number"===typeof e?[this.tag.nameFromId(e)]:this.tag.namesFromIds(e),h.createElement("div",{className:"d-flex flex-wrap "},t.map((function(e,t){return h.createElement("div",{key:t,className:"mx-2 border border-muted rounded px-3 bg-light"},e)})))}},{key:"renderRadios",value:function(e,t){var n=this,r=this.tag.values.map((function(r,a){return h.createElement("div",{className:"col",key:a},n.renderRadio(r,e,t))}));return this.renderView(t,r)}},{key:"renderChecks",value:function(e,t){var n=this,r=void 0===e?void 0:e.split("|").map((function(e){return Number(e)})),a=this.tag.values.map((function(e,a){var i=void 0===r?void 0:r.indexOf(e.id)>=0;return h.createElement("div",{className:"col",key:a},n.renderCheck(e,i,t))}));return this.renderView(t,a)}},{key:"renderView",value:function(e,t){var n=e.className,r=e.wrapClassName;return r=r?"row "+r:"row row-cols-2 row-cols-sm-3 row-cols-md-4",h.createElement("div",{className:n,style:f},h.createElement("div",{className:r},t))}},{key:"renderRadio",value:function(e,t,n){var r=e.id,a=e.name,i=n.inputs,s=n.inputName,c=n.onInputChange,o=i&&function(e){return i[r]=e};return h.createElement("label",{className:"form-radio-inline"},h.createElement("input",{ref:o,type:"radio",name:s,value:r,defaultChecked:t===r,onChange:c}),a)}},{key:"renderCheck",value:function(e,t,n){var r=e.id,a=e.name,i=n.inputs,s=n.onInputChange,c=i&&function(e){return i[r]=e};return h.createElement("label",{className:"form-radio-inline"},h.createElement("input",{ref:c,type:"checkbox",value:r,defaultChecked:t,onChange:s}),a)}}]),e}();n.d(t,"a",(function(){return v}));var v=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).values=void 0,e.coll={},e._view=void 0,e}return Object(o.a)(n,[{key:"nameFromId",value:function(e){var t=this.coll[e];return void 0===t?void 0:t.name}},{key:"namesFromIds",value:function(e){var t,n=[],r=Object(s.a)(e.split("|"));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=this.coll[Number(a)],c=void 0===i?void 0:i.name;void 0!==c&&n.push(c)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"loadValues",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.values){e.next=2;break}return e.abrupt("return",this.values);case 2:return this.values=[],e.next=5,this.uqApi.get("tag/values/"+this.name);case 5:if(void 0!==(t=e.sent)){e.next=8;break}return e.abrupt("return");case 8:n=t.split("\n"),r=Object(s.a)(n),e.prev=10,r.s();case 12:if((i=r.n()).done){e.next=23;break}if(0!==(c=i.value).length){e.next=16;break}return e.abrupt("continue",21);case 16:o=c.split("\t"),u=Number(o[0]),l={id:u,name:o[1],ext:o[2]},this.values.push(l),this.coll[u]=l;case 21:e.next=12;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(10),r.e(e.t0);case 28:return e.prev=28,r.f(),e.finish(28);case 31:return e.abrupt("return",this.values);case 32:case"end":return e.stop()}}),e,this,[[10,25,28,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"tag"}},{key:"view",get:function(){return void 0!==this._view?this._view:this._view=new p(this)}}]),n}(d.a)},,,,,,function(e,t,n){"use strict";var r=n(23);n.d(t,"a",(function(){return r.a}));var a=n(57);n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return a.b}));n(45)},function(e,t,n){"use strict";var r=n(74);n.o(r,"CAppBase")&&n.d(t,"CAppBase",(function(){return r.CAppBase})),n.o(r,"CBase")&&n.d(t,"CBase",(function(){return r.CBase})),n.o(r,"CSub")&&n.d(t,"CSub",(function(){return r.CSub})),n.o(r,"EasyTime")&&n.d(t,"EasyTime",(function(){return r.EasyTime})),n.o(r,"Edit")&&n.d(t,"Edit",(function(){return r.Edit})),n.o(r,"FA")&&n.d(t,"FA",(function(){return r.FA})),n.o(r,"Form")&&n.d(t,"Form",(function(){return r.Form})),n.o(r,"Image")&&n.d(t,"Image",(function(){return r.Image})),n.o(r,"LMR")&&n.d(t,"LMR",(function(){return r.LMR})),n.o(r,"List")&&n.d(t,"List",(function(){return r.List})),n.o(r,"Loading")&&n.d(t,"Loading",(function(){return r.Loading})),n.o(r,"Muted")&&n.d(t,"Muted",(function(){return r.Muted})),n.o(r,"QueryPager")&&n.d(t,"QueryPager",(function(){return r.QueryPager})),n.o(r,"Tuid")&&n.d(t,"Tuid",(function(){return r.Tuid})),n.o(r,"UserIcon")&&n.d(t,"UserIcon",(function(){return r.UserIcon})),n.o(r,"UserView")&&n.d(t,"UserView",(function(){return r.UserView})),n.o(r,"VPage")&&n.d(t,"VPage",(function(){return r.VPage})),n.o(r,"View")&&n.d(t,"View",(function(){return r.View})),n.o(r,"emailRegex")&&n.d(t,"emailRegex",(function(){return r.emailRegex})),n.o(r,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return r.mobileRegex})),n.o(r,"resLang")&&n.d(t,"resLang",(function(){return r.resLang})),n.o(r,"resOptions")&&n.d(t,"resOptions",(function(){return r.resOptions})),n.o(r,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return r.setGlobalRes})),n.o(r,"setRes")&&n.d(t,"setRes",(function(){return r.setRes})),n.o(r,"start")&&n.d(t,"start",(function(){return r.start})),n.o(r,"t")&&n.d(t,"t",(function(){return r.t})),n.o(r,"tv")&&n.d(t,"tv",(function(){return r.tv})),n.o(r,"useUser")&&n.d(t,"useUser",(function(){return r.useUser}));var a=n(75);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Loading")&&n.d(t,"Loading",(function(){return a.Loading})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"QueryPager")&&n.d(t,"QueryPager",(function(){return a.QueryPager})),n.o(a,"Tuid")&&n.d(t,"Tuid",(function(){return a.Tuid})),n.o(a,"UserIcon")&&n.d(t,"UserIcon",(function(){return a.UserIcon})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"emailRegex")&&n.d(t,"emailRegex",(function(){return a.emailRegex})),n.o(a,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return a.mobileRegex})),n.o(a,"resLang")&&n.d(t,"resLang",(function(){return a.resLang})),n.o(a,"resOptions")&&n.d(t,"resOptions",(function(){return a.resOptions})),n.o(a,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return a.setGlobalRes})),n.o(a,"setRes")&&n.d(t,"setRes",(function(){return a.setRes})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"t")&&n.d(t,"t",(function(){return a.t})),n.o(a,"tv")&&n.d(t,"tv",(function(){return a.tv})),n.o(a,"useUser")&&n.d(t,"useUser",(function(){return a.useUser}));n(76);var i=n(77);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Loading")&&n.d(t,"Loading",(function(){return i.Loading})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"Tuid")&&n.d(t,"Tuid",(function(){return i.Tuid})),n.o(i,"UserIcon")&&n.d(t,"UserIcon",(function(){return i.UserIcon})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"emailRegex")&&n.d(t,"emailRegex",(function(){return i.emailRegex})),n.o(i,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return i.mobileRegex})),n.o(i,"resLang")&&n.d(t,"resLang",(function(){return i.resLang})),n.o(i,"resOptions")&&n.d(t,"resOptions",(function(){return i.resOptions})),n.o(i,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return i.setGlobalRes})),n.o(i,"setRes")&&n.d(t,"setRes",(function(){return i.setRes})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"t")&&n.d(t,"t",(function(){return i.t})),n.o(i,"tv")&&n.d(t,"tv",(function(){return i.tv})),n.o(i,"useUser")&&n.d(t,"useUser",(function(){return i.useUser}))},function(e,t){},function(e,t){},function(e,t,n){"use strict";n(11)},function(e,t){},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=/^[0-9]*$/,a=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/},function(e,t,n){"use strict";var r=n(3),a=n(4),i=n(6),s=n(5),c=n(0),o=n(14),u=n.n(o);c.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),a=n(4),i=n(6),s=n(5),c=n(0),o=n(15),u={md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw",$zh:{md:function(e,t){return"".concat(e,"\u6708").concat(t,"\u65e5")},ymd:function(e,t,n){return"".concat(e,"\u5e74").concat(t,"\u6708").concat(n,"\u65e5")},yesterday:"\u6628\u5929",today:"\u4eca\u5929",tomorrow:"\u660e\u5929"},$en:{md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw"}};function l(e){return u[e]}function d(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;switch(typeof e){default:n=e;break;case"string":n=new Date(e);break;case"number":n=new Date(1e3*e)}var a,i,s,c,o,u,d=new Date,h=n;a=d.getTime()-h.getTime();var f=h.getHours(),p=h.getMinutes();i=d.getDate(),s=h.getDate(),c=h.getMonth()+1,o=h.getFullYear(),u=d.getFullYear();var v=!1,m=a<-864e5?o===u?(v=!0,l("md")(c,s)):(v=!0,l("ymd")(o,c,s)):a<864e5?s!==i?(v=!0,l(a<0?"tomorrow":"yesterday")):!0===t?(v=!0,""):l("today"):o===u?l("md")(c,s):l("ymd")(o,c,s),b=f+(p<10?":0":":")+p;return!0===v||!0===r?m+" "+b:m}Object(o.setRes)(u,u);c.Component;var h=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props;return d(e.date,!0,e.always)}}]),n}(c.Component)},function(e,t,n){"use strict";var r=n(3),a=n(4),i=n(6),s=n(5),c=n(0),o=n(14),u=n.n(o),l=n(15);c.Component},function(e,t,n){"use strict";var r,a,i=n(1),s=n.n(i),c=n(2),o=n(10),u=n(3),l=n(4),d=n(13),h=n(6),f=n(5),p=n(9),v=(n(22),n(0)),m=n(14),b=n.n(m),y=n(8);r=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).input=void 0,e.key=null,Object(o.a)(e,"disabled",a,Object(d.a)(e)),e.onChange=function(t){e.key=t.target.value,void 0!==e.key&&(e.key=e.key.trim(),""===e.key&&(e.key=void 0)),!0!==e.props.allowEmptySearch&&(e.disabled=!e.key)},e.onSubmit=function(){var t=Object(c.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),null===e.key&&(e.key=e.props.initKey||""),!0===e.props.allowEmptySearch){t.next=6;break}if(e.key){t.next=5;break}return t.abrupt("return");case 5:e.input&&(e.input.disabled=!0);case 6:return t.next=8,e.props.onSearch(e.key);case 8:e.input&&(e.input.disabled=!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"clear",value:function(){this.input&&(this.input.value="")}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.className,a=n.inputClassName,i=n.onFocus,s=n.label,c=n.placeholder,o=n.buttonText,u=n.maxLength;switch(n.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return v.createElement("form",{className:r,onSubmit:this.onSubmit},v.createElement("div",{className:b()("input-group",e)},s&&v.createElement("div",{className:"input-group-addon align-self-center mr-2"},s),v.createElement("input",{ref:function(e){return t.input=e},onChange:this.onChange,type:"text",name:"key",onFocus:i,className:b()("form-control",a||"border-primary"),placeholder:c,defaultValue:this.props.initKey,maxLength:u}),v.createElement("div",{className:"input-group-append"},v.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.disabled},v.createElement("i",{className:"fa fa-search"}),v.createElement("i",{className:"fa"}),o))))}}]),n}(v.Component),a=Object(p.a)(r.prototype,"disabled",[y.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v}));var r=n(3),a=n(4),i=n(0),s=n(14),c=n.n(s),o=n(18),u=n(12),l=n(8),d=n(19),h=new(function(){function e(t){Object(r.a)(this,e),this.loader=void 0,this.onLoaded=void 0,this.map=Object(l.n)(new Map),void 0===t&&(t=function(e){return d.p.user(e)}),this.loader=t}return Object(a.a)(e,[{key:"use",value:function(e,t){e&&("object"===typeof e&&(e=e.id),e&&(this.onLoaded=t,e=Number(e),void 0===this.map.get(e)&&this.map.set(e,e)))}},{key:"getValue",value:function(e){var t=this;if(e){switch(typeof e){case"object":if(!(e=e.id))return}var n=this.map.get(e);if(n)switch(typeof n){default:return n;case"number":return n<0||(this.map.set(e,-e),this.loader(e).then((function(n){n||(n=null),t.map.set(e,n),t.onLoaded&&t.onLoaded(n)})).catch((function(e){console.error(e)}))),e}}}}]),e}())(void 0),f=Object(u.a)((function(e){var t=e.className,n=e.style,r=e.id,a=e.altImage,s=e.noneImage,u=h.getValue(r);switch(typeof u){case"undefined":case"number":return i.createElement("div",{className:c()(t,"image-none"),style:n},s||i.createElement("i",{className:"fa fa-file-o"}))}var l=u.icon;return l?(!0===l.startsWith(":")&&(l=o.b.resUrl+l.substr(1)),i.createElement("img",{src:l,className:t,alt:"img",style:n,onError:function(e){e.currentTarget.src=a||"https://tv.jkchemical.com/imgs/0001.png"}})):i.createElement("div",{className:c()(t,"image-none"),style:n},i.createElement("i",{className:"fa fa-file-o"}))})),p=Object(u.a)((function(e){var t=e.id,n=e.user,r=e.render,a=e.onLoaded;if(null===n)return i.createElement(i.Fragment,null,"null");switch(typeof n){case"undefined":n=h.getValue(t);break;case"object":var s=n.id;v(s,a),n=h.getValue(s);break;case"number":v(n,a),n=h.getValue(n);break;case"string":v(Number(n),a),n=h.getValue(Number(n));break;default:n=void 0}switch(typeof n){case"undefined":case"number":return i.createElement(i.Fragment,null,n)}return r(n)}));function v(e,t){e&&("object"===typeof e&&(e=e.id),h.use(e,t))}},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1),a=n.n(r),i=n(11),s=n(2),c=n(3),o=n(4),u=n(21),l=function(){function e(t){var n=this;Object(c.a)(this,e),this.uq=void 0,this.modifyMax=void 0,this.cacheTimer=void 0,this.loadIds=function(){n.clearCacheTimer();var e=n.uq.tuids;for(var t in e){e[t].cacheIds()}},this.uq=t}return Object(o.a)(e,[{key:"cacheTuids",value:function(e){this.clearCacheTimer(),this.cacheTimer=u.c.setTimeout("TuidsCache.cacheTuids",this.loadIds,e)}},{key:"clearCacheTimer",value:function(){void 0!==this.cacheTimer&&(u.c.clearTimeout(this.cacheTimer),this.cacheTimer=void 0)}},{key:"pullModify",value:function(e){if(void 0!==e){var t=Math.floor(Date.now()/1e3);void 0===this.modifyMax&&(this.modifyMax=this.uq.localModifyMax.get(),void 0===this.modifyMax&&(this.modifyMax={max:e,seconds:t},this.uq.localModifyMax.set(this.modifyMax)));var n=this.modifyMax,r=n.max;if(!(t-n.seconds<3600)&&!(e<=r)){var a=[],i=this.uq.tuids;for(var s in i)a.push(s);0!==a.length&&(this.modifyMax.seconds=t,this.innerPullModify(a.join("\t")))}}}},{key:"innerPullModify",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r,s,c,o,u,l,d,h,f,p,v,m,b,y,k,g,w,O,j;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.uq,r=n.uqApi,s=n.tuids,c=this.modifyMax.max,e.next=4,r.queueModify(c,30,t);case 4:o=e.sent,u={},l=0,d=Object(i.a)(o.queue),e.prev=8,d.s();case 10:if((h=d.n()).done){e.next=24;break}if(f=h.value,p=f.id,v=f.entity,m=f.key){e.next=15;break}return e.abrupt("continue",22);case 15:if(void 0!==(b=s[v])){e.next=18;break}return e.abrupt("continue",22);case 18:void 0===(y=u[v])&&(y=u[v]={tuid:b,ids:[]}),y.ids.push(m),p>l&&(l=p);case 22:e.next=10;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(8),d.e(e.t0);case 29:return e.prev=29,d.f(),e.finish(29);case 32:e.t1=a.a.keys(u);case 33:if((e.t2=e.t1()).done){e.next=40;break}return k=e.t2.value,g=u[k],w=g.tuid,O=g.ids,e.next=38,w.modifyIds(O);case 38:e.next=33;break;case 40:j=Math.floor(Date.now()/1e3),this.modifyMax={max:l,seconds:j},this.uq.localModifyMax.set(this.modifyMax);case 43:case"end":return e.stop()}}),e,this,[[8,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(1),a=n.n(r),i=n(11),s=n(2),c=n(3),o=n(4),u=n(21),l=n(60),d=n(15),h=function(){function e(t,n){Object(c.a)(this,e),this.collection=void 0,this.tvs=void 0,this.name=void 0,this.appOwner=void 0,this.appName=void 0,this.localMap=void 0,this.localData=void 0,this.id=void 0,this.tvs=n||{},this.buildTVs(),this.collection={};var r=t.split("/");if(2!==r.length)throw new Error("tonvaApp name must be / separated, owner/app");this.appOwner=r[0],this.appName=r[1],this.localMap=u.c.localDb.map(t),this.localData=this.localMap.child("uqData")}return Object(o.a)(e,[{key:"addUq",value:function(e){this.collection[e.name]=e}},{key:"buildTVs",value:function(){for(var e in this.tvs){var t=this.tvs[e];if(void 0!==t){var n=e.toLowerCase();if(n!==e)for(var r in this.tvs[n]=t,t){var a=t[r];if(void 0!==a){var i=r.toLowerCase();i!==r&&(t[i]=a)}}}}}},{key:"init",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r,s,c,o,u,d,h,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=Object(i.a)(t);try{for(r.s();!(s=r.n()).done;)c=s.value,o=c.uqOwner,u=c.uqName,d=o+"/"+u,h=new l.a(this,c,void 0,this.tvs[d]||this.tvs[u]),this.collection[d]=h,(f=d.toLowerCase())!==d&&(this.collection[f]=h),n.push(h.init())}catch(a){r.e(a)}finally{r.f()}return e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,n,r,s,c,o,u,l,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t=[],n=[],this.collection)s=this.collection[r],n.push(s.loadEntities());return e.next=5,Promise.all(n);case 5:c=e.sent,o=Object(i.a)(c),e.prev=7,o.s();case 9:if((u=o.n()).done){e.next=17;break}if(l=u.value,void 0===(d=l)){e.next=15;break}return t.push(d),e.abrupt("continue",15);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[7,19,22,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"buildUQs",value:function(){var e=this,t=this,n={},r=function(r){for(var a=e.collection[r],i=a.uqName,s=i.toLowerCase(),c=a.entities,o=0,u=Object.keys(c);o<u.length;o++){var l=c[u[o]];c[l.name.toLowerCase()]=l}n[s]=new Proxy(c,{get:function(e,n,r){var a=e[n.toLowerCase()];if(void 0!==a)return a;var s="entity ".concat(i,".").concat(String(n)," not defined");console.error(s),t.showReload("UQ\u9519\u8bef\uff1a"+s)}})};for(var a in this.collection)r(a);return new Proxy(n,{get:function(e,n,r){var a=e[n.toLowerCase()];if(void 0!==a)return a;console.error("error in uqs"),t.showReload("\u4ee3\u7801\u9519\u8bef\uff1a\u65b0\u589e uq ".concat(String(n)))}})}},{key:"showReload",value:function(e){this.localMap.removeAll(),d.nav.showReloadPage(e)}},{key:"setTuidImportsLocal",value:function(){var e=[];for(var t in this.collection){var n,r=this.collection[t],a=Object(i.a)(r.tuidArr);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(!0===s.isImport){var c=this.setInner(s);c&&e.push(c)}}}catch(o){a.e(o)}finally{a.f()}}return e}},{key:"setInner",value:function(e){var t=e.from,n=t.owner+"/"+t.uq,r=this.collection[n];if(void 0===r)return"setInner(tuidImport: TuidImport): uq ".concat(n," is not loaded");var a=e.name,i=r.tuid(a);return void 0===i?"setInner(tuidImport: TuidImport): uq ".concat(n," has no Tuid ").concat(a):!0===i.isImport?"setInner(tuidImport: TuidImport): uq ".concat(n," Tuid ").concat(a," is import"):void e.setFrom(i)}}]),e}()},function(e,t,n){"use strict";var r,a,i,s,c,o,u,l,d,h,f,p,v,m,b,y=n(1),k=n.n(y),g=n(2),w=n(11),O=n(3),j=n(4),x=n(6),E=n(5),C=n(0),N=n(8),A=n(14),T=n.n(A),I=n(10),S=n(13),P=n(9),R=(n(22),n(24)),V=n(17),F=n(16),L=n(20),M=n.n(L),D=function e(){Object(O.a)(this,e)},U=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this)).func=void 0,r.func=e,r}return Object(j.a)(n,[{key:"check",value:function(e,t){var n=this.func(t);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void e.push(n);default:return void e.push.apply(e,Object(R.a)(n))}}}]),n}(D),_=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this)).res=void 0,r.res=e,r}return n}(D),B=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"check",value:function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(!1===isNaN(t))return;break;case"undefined":}e.push(this.res.required)}}]),n}(_),q=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r,a){var i;return Object(O.a)(this,n),(i=t.call(this,e)).minMsg=void 0,i.maxMsg=void 0,i.min=void 0,i.max=void 0,i.minMsg=M.a.template(e.min),i.maxMsg=M.a.template(e.max),i.min=r,i.max=a,i}return Object(j.a)(n,[{key:"check",value:function(e,t){if(void 0!==t&&null!==t){var n=Number(t);!0===isNaN(n)?e.push(this.res.number):this.checkMore(e,n)}}},{key:"checkMore",value:function(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))}}]),n}(_),z=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"checkMore",value:function(e,t){Object(V.a)(Object(F.a)(n.prototype),"checkMore",this).call(this,e,t),!1===Number.isInteger(t)&&e.push(this.res.integer)}}]),n}(q),W=n(12),G=(r=function(){function e(t,n,r,c){var o=this;Object(O.a)(this,e),this.name=void 0,this.context=void 0,this.fieldProps=void 0,this.children=void 0,this._itemSchema=void 0,this._ui=void 0,this.defaultValue=void 0,this.value=void 0,this.rules=void 0,Object(I.a)(this,"errors",a,this),Object(I.a)(this,"contextErrors",i,this),this.readOnly=void 0,this.disabled=void 0,Object(I.a)(this,"visible",s,this),this.isChanging=void 0,this.onInputChange=function(e){o.changeValue(e.target.value,!0)},this.container=Object(W.a)((function(){if(!1===o.visible)return null;var e=o.context,t=e.form;if(!0===e.inNode)return o.render();var n=o.label;return!0===o.itemSchema.required&&!1!==t.props.requiredFlag&&null!==n&&(n=C.createElement(C.Fragment,null,n,"\xa0",C.createElement("span",{className:"text-danger"},"*"))),t.FieldContainer(n,o.renderBody())})),this.context=t;var u=n.name;if(this.name=u,this._itemSchema=n,this.fieldProps=r,this.children=c,this._ui=t.getUiItem(u),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var l=this.ui,d=l.readOnly,h=l.disabled,f=l.visible;this.readOnly=!0===d,this.disabled=!0===h,this.visible=!(!1===f)}this.value=this.defaultValue=t.getValue(u)}return Object(j.a)(e,[{key:"hasError",get:function(){return this.errors.length+this.contextErrors.length>0}}]),Object(j.a)(e,[{key:"init",value:function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new B(this.context.form.res)),this.buildRules(),void 0!==this.ui){var e=this.ui.rules;if(void 0!==e)if(!1!==Array.isArray(e)){var t,n=Object(w.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.rules.push(new U(r))}}catch(a){n.e(a)}finally{n.f()}}else this.rules.push(new U(e))}}},{key:"buildRules",value:function(){}},{key:"checkRules",value:function(){var e,t,n=[],r=Object(w.a)(this.rules);try{for(r.s();!(e=r.n()).done;){e.value.check(n,this.value)}}catch(a){r.e(a)}finally{r.f()}0===n.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,n))}},{key:"setError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.errors.push(e):(t=this.errors).push.apply(t,Object(R.a)(e)))}},{key:"setContextError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.contextErrors.push(e):(t=this.contextErrors).push.apply(t,Object(R.a)(e)))}},{key:"clearError",value:function(){this.errors.splice(0)}},{key:"clearContextError",value:function(){this.contextErrors.splice(0)}},{key:"parse",value:function(e){return e}},{key:"setElementValue",value:function(e){}},{key:"setDataValue",value:function(e){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(e))}},{key:"setValue",value:function(e){!0!==this.isChanging&&this.changeValue(e,!1)}},{key:"getValue",value:function(){return this.context.getValue(this.name)}},{key:"getReadOnly",value:function(){return this.readOnly}},{key:"getDisabled",value:function(){return this.disabled}},{key:"getVisible",value:function(){return this.visible}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setVisible",value:function(e){this.visible=e}},{key:"changeValue",value:function(e,t){var n,r,a=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var i=!0;void 0!==n&&(this.isChanging=!0,i=n(this.context,this.value,a),this.isChanging=!1),!0===i&&(this.setDataValue(e),!0!==t&&this.setElementValue(e),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,a),this.isChanging=!1))}},{key:"renderBody",value:function(){var e;if(!1===this.hasError&&this.ui){var t=this.ui,n=t.discription,r=t.discriptionClassName;void 0===r&&(r="small text-muted"),e=C.createElement("span",{className:r},n)}return C.createElement(C.Fragment,null,this.render(),e)}},{key:"renderTemplet",value:function(){if(void 0!==this.children)return C.createElement(C.Fragment,null,this.children);if(void 0!==this.ui){var e=this.ui.Templet;return"function"===typeof e?e(this.value):e}}},{key:"renderErrors",value:function(){var e=[].concat(Object(R.a)(this.errors),Object(R.a)(this.contextErrors));if(0===e.length)return null;var t=!0===this.context.inNode?"span":"div";return e.map((function(e){return C.createElement(t,{key:e,className:"text-danger d-inline-block my-2 ml-3"},C.createElement(C.Fragment,null,C.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e))}))}},{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}},{key:"isOk",get:function(){return 0===this.errors.length}},{key:"className",get:function(){var e;return!1===this.context.inNode&&(e="form-control"),T()(e,this.context.form.FieldClass,this.ui&&this.ui.className)}},{key:"label",get:function(){var e;if(void 0===this.ui)e=this.name;else{var t=this.ui.label;e=null===t?null:t||this.name}return e}}]),e}(),a=Object(P.a)(r.prototype,"errors",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=Object(P.a)(r.prototype,"contextErrors",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(P.a)(r.prototype,"hasError",[N.g],Object.getOwnPropertyDescriptor(r.prototype,"hasError"),r.prototype),s=Object(P.a)(r.prototype,"visible",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(r.prototype,"isOk",[N.g],Object.getOwnPropertyDescriptor(r.prototype,"isOk"),r.prototype),r),H=(c=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="text",e.input=void 0,Object(I.a)(e,"hasFocus",o,Object(S.a)(e)),e.onKeyDown=function(){var t=Object(g.a)(k.a.mark((function t(n){var r,a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.internalOnKeyDown(n),13===n.keyCode){t.next=3;break}return t.abrupt("return");case 3:if(void 0!==(r=e.context.form.props.onEnter)){t.next=6;break}return t.abrupt("return");case 6:return e.changeValue(n.currentTarget.value,!0),e.input.blur(),t.next=10,r(e.name,e.context);case 10:void 0!==(a=t.sent)&&e.context.setError(e.name,a);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onBlur=function(t){e.onInputChange(t),e.checkRules(),e.context.checkContextRules(),e.hasFocus=!1},e.onFocus=function(t){e.clearError(),e.context.removeErrorWidget(Object(S.a)(e)),e.context.clearErrors(),e.hasFocus=!0},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){null!==this.input&&(this.input.value=e)}},{key:"internalOnKeyDown",value:function(e){}},{key:"onChange",value:function(e){}},{key:"setReadOnly",value:function(e){null!==this.input&&(this.input.readOnly=this.readOnly=e)}},{key:"setDisabled",value:function(e){null!==this.input&&(this.input.disabled=this.disabled=e)}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,C.createElement(C.Fragment,null,C.createElement("input",{ref:function(t){return e.input=t},className:T()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:function(t){return e.onChange(t)},placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,maxLength:this.itemSchema.maxLength}),this.renderErrors())}},{key:"ui",get:function(){return this._ui}},{key:"placeholder",get:function(){return this.ui&&this.ui.placeholder||this.name}}]),n}(G),o=Object(P.a)(c.prototype,"hasFocus",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c),$=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.onInputChange=function(t){e.setValue(t.currentTarget.value)},e.onBlur=function(t){e.onInputChange(t),e.checkRules(),e.context.checkContextRules()},e.onFocus=function(t){e.clearError(),e.context.removeErrorWidget(Object(S.a)(e)),e.context.clearErrors()},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){this.input.value=e}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,C.createElement(C.Fragment,null,C.createElement("textarea",{ref:function(t){return e.input=t},onBlur:this.onBlur,onFocus:this.onFocus,className:T()(this.className,n),rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange}),this.renderErrors())}},{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}}]),n}(G),K=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="password",e}return n}(H),Q=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="url",e}return n}(H),J=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="email",e}return n}(H),Z=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(j.a)(n,[{key:"buildRules",value:function(){Object(V.a)(Object(F.a)(n.prototype),"buildRules",this).call(this);var e=this.context.form.res,t=this.itemSchema,r=t.min,a=t.max;this.rules.push("integer"===this.itemSchema.type?new q(e,r,a):new z(e,r,a))}},{key:"parse",value:function(e){if(void 0!==e&&null!==e)return Number(e)}},{key:"itemSchema",get:function(){return this._itemSchema}}]),n}(H),X=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(j.a)(n,[{key:"isValidKey",value:function(e){return 46===e||8===e||37===e||39===e||e>=48&&e<=57||e>=96&&e<=105||109===e||189===e}},{key:"internalOnKeyDown",value:function(e){var t=e.keyCode;window.event.returnValue=this.isValidKey(t)}}]),n}(Z),Y=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="date",e}return n}(H),ee=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="datetime",e}return n}(H),te=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="time",e}return n}(H),ne=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="month",e}return n}(H),re=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.trueValue=void 0,e.falseValue=void 0,e.onInputChange=function(t){var n=!0===t.target.checked?e.trueValue:e.falseValue;e.setDataValue(n)},e.onClick=function(){e.context.clearErrors()},e}return Object(j.a)(n,[{key:"init",value:function(){if(Object(V.a)(Object(F.a)(n.prototype),"init",this).call(this),void 0!==this.ui){var e=this.ui,t=e.trueValue,r=e.falseValue;this.trueValue=void 0===t||t,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1}},{key:"setElementValue",value:function(e){this.input.checked=e===this.trueValue}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=T()(this.className,"form-check-inline p-0"),n=C.createElement("input",{ref:function(t){return e.input=t},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return!0===this.context.inNode?C.createElement("label",{className:t},n," ",this.ui&&this.ui.label||this.name):C.createElement("div",{className:t},C.createElement("label",{className:"w-100 h-100 mb-0 d-flex justify-content-center"},n))}},{key:"ui",get:function(){return this._ui}}]),n}(G),ae=(u=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).select=void 0,Object(I.a)(e,"readOnly",l,Object(S.a)(e)),e.onInputChange=function(t){e.setDataValue(t.target.value)},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){this.select.value=e}},{key:"setReadOnly",value:function(e){this.select.disabled=this.readOnly=!e}},{key:"setDisabled",value:function(e){this.select.disabled=this.disabled=e}},{key:"render",value:function(){var e=this;if(!0===this.readOnly){var t=this.ui.list.find((function(t){return t.value===e.value})),n=void 0===t?"(???)":t.title;return C.createElement("span",{className:"form-control w-min-6c"},n)}return C.createElement("select",{ref:function(t){return e.select=t},className:T()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map((function(e,t){var n=e.title,r=e.value;return C.createElement("option",{className:void 0,key:t,value:r},n||r)})))}},{key:"ui",get:function(){return this._ui}}]),n}(G),l=Object(P.a)(u.prototype,"readOnly",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u),ie={height:"auto"},se=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"render",value:function(){var e,t=this,n=this.ui,r=n.defaultValue,a=n.list;!0===this.context.isRow&&(e=this.context.rowKey);var i=T()(this.className,"py-0");return C.createElement("span",{className:i,style:ie},a.map((function(n,a){var i=n.value,s=n.title,c=t.name;return void 0!==e&&(c+="-"+e),C.createElement("label",{key:a,className:"form-radio-inline"},C.createElement("input",{ref:function(e){return t.inputs[a]=e},type:"radio",name:c,value:i,defaultChecked:(t.defaultValue||r)===i,onChange:t.onInputChange}),s||i)})))}},{key:"ui",get:function(){return this._ui}}]),n}(G),ce=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="range",e.input=void 0,e}return Object(j.a)(n,[{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.ui,n=t.min,r=t.max,a=t.step;return C.createElement(C.Fragment,null,C.createElement("input",{ref:function(t){return e.input=t},className:T()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:a}))}},{key:"ui",get:function(){return this._ui}}]),n}(G),oe=(d=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(I.a)(e,"value",h,Object(S.a)(e)),e.onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=e.ui&&e.ui.pickId)){t.next=4;break}return alert("no pickId defined!"),t.abrupt("return");case 4:return t.next=6,n(e.context,e.name,e.value);case 6:r=t.sent,e.setDataValue(r),e.clearError(),e.clearContextError(),e.checkRules();case 11:case"end":return t.stop()}}),t)}))),e}return Object(j.a)(n,[{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"render",value:function(){var e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};if(void 0===this.value||null===this.value)n=e||C.createElement("small",{className:"text-muted"},"[\u65e0]"),r["text-muted"]=!0;else if(void 0===t){var a;if(null===this.value)a="null";else switch(typeof this.value){case"undefined":a=C.createElement("small",{className:"text-muted"},"[\u65e0]");break;case"object":a=this.value.id;break;default:a=this.value}n=C.createElement(C.Fragment,null,a)}else n="function"===typeof t?t(this.value):t;return C.createElement(C.Fragment,null,C.createElement("div",{className:T()(r),onClick:this.onClick},n),this.renderErrors())}},{key:"ui",get:function(){return this._ui}}]),n}(G),h=Object(P.a)(d.prototype,"value",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d),ue=function(e,t,n){return C.createElement("span",{className:"text-danger"},"!!data type ",e," only support ",(n||[]).join(", "),", can't use ui ",t,"!!")},le=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.clearError(),e.clearContextError(),n=e.itemSchema,r=n.name,"submit"!==n.type){t.next=6;break}return t.next=6,e.context.submit(r);case 6:case"end":return t.stop()}}),t)}))),e.observerRender=Object(W.a)((function(){var t,n,r,a=e.itemSchema,i=a.name,s=a.type;if(void 0!==e.ui){var c=e.ui.widget;if("button"!==c)return ue(s,c,["button"]);t=e.ui.Templet,n=e.ui.className,r=e.ui.label}var o,u=e.context,l=u.form,d=u.hasError,h=e.context,f="submit"===s&&d;o=void 0!==e.children?e.children:"function"===typeof t?t():void 0!==t?t:r;var p=C.createElement("button",{className:n,type:"button",disabled:f,onClick:e.onClick},o||i);return!0===h.inNode?C.createElement(C.Fragment,null,p,e.renderErrors()):C.createElement("div",{className:l.ButtonClass},C.createElement("div",null,e.renderErrors()),p)})),e}return Object(j.a)(n,[{key:"render",value:function(){return C.createElement(this.observerRender,null)}},{key:"ui",get:function(){return this._ui}},{key:"label",get:function(){return null}}]),n}(G),de=(f=function(){function e(t,n,r,a,i){var s=this;if(Object(O.a)(this,e),this.subContexts=void 0,this.form=void 0,this.uiSchema=void 0,this.initData=void 0,this.inNode=void 0,this.widgets={},this.rules=void 0,this.isRow=void 0,Object(I.a)(this,"errors",p,this),Object(I.a)(this,"errorWidgets",v,this),this.renderErrors=Object(W.a)((function(){var e=s.errors;return 0===e.length?null:C.createElement(C.Fragment,null,e.map((function(e){return C.createElement("span",{key:e,className:"text-danger inline-block my-1 ml-3"},C.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)})))})),this.form=t,this.uiSchema=n,this.initData=r,this.inNode=a,this.isRow=i,void 0!==n){var c,o=n.rules;if(void 0!==o)this.rules=[],!1===Array.isArray(o)?this.rules.push(o):(c=this.rules).push.apply(c,Object(R.a)(o))}}return Object(j.a)(e,[{key:"getArrRowContexts",value:function(e){void 0===this.subContexts&&(this.subContexts={});var t=this.subContexts[e];return void 0===t&&(this.subContexts[e]=t={}),t}},{key:"getValue",value:function(e){return this.initData[e]}},{key:"setValue",value:function(e,t){this.initData[e]=t;var n=this.widgets[e];void 0!==n&&n.setValue(t)}},{key:"getDisabled",value:function(e){var t=this.widgets[e];if(void 0!==t)return t.getDisabled()}},{key:"setDisabled",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setDisabled(t)}},{key:"getReadOnly",value:function(e){var t=this.widgets[e];void 0!==t&&t.getReadOnly()}},{key:"setReadOnly",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setReadOnly(t)}},{key:"getVisible",value:function(e){var t=this.widgets[e];void 0!==t&&t.getVisible()}},{key:"setVisible",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setVisible(t)}},{key:"submit",value:function(){var e=Object(g.a)(k.a.mark((function e(t){var n,r,a,i,s,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkRules(),!0!==this.hasError){e.next=7;break}n="",r=Object(w.a)(this.errorWidgets);try{for(r.s();!(a=r.n()).done;)i=a.value,n+=i.name+":\n"+i.errors.join("\n")}catch(n){r.e(n)}finally{r.f()}return console.error(n),e.abrupt("return");case 7:if(void 0!==(s=this.form.props.onButtonClick)){e.next=11;break}return alert("button ".concat(t," clicked. you should define form onButtonClick")),e.abrupt("return");case 11:return e.next=13,s(t,this);case 13:if(void 0!==(c=e.sent)){e.next=16;break}return e.abrupt("return");case 16:this.setError(t,c);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkFieldRules",value:function(){for(var e in this.widgets)this.widgets[e].checkRules();if(void 0!==this.subContexts)for(var t in this.subContexts){var n=this.subContexts[t];for(var r in n)n[r].checkFieldRules()}}},{key:"checkContextRules",value:function(){if(this.clearErrors(),void 0!==this.rules){var e,t=Object(w.a)(this.rules);try{for(t.s();!(e=t.n()).done;){var n,r=(0,e.value)(this);if(void 0!==r)if(!0===Array.isArray(r))(n=this.errors).push.apply(n,Object(R.a)(r));else if("string"===typeof r)this.errors.push(r);else for(var a in r)this.setError(a,r[a])}}catch(u){t.e(u)}finally{t.f()}if(void 0!==this.subContexts)for(var i in this.subContexts){var s=this.subContexts[i];for(var c in s){var o=s[c];o.clearErrors(),o.checkContextRules()}}}}},{key:"setError",value:function(e,t){var n=this.widgets[e];void 0!==n&&(n.setContextError(t),this.addErrorWidget(n))}},{key:"clearContextErrors",value:function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearContextError()}}},{key:"clearWidgetsErrors",value:function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearError()}}},{key:"checkRules",value:function(){this.clearErrors(),this.clearWidgetsErrors(),this.checkFieldRules(),!0!==this.hasError&&this.checkContextRules()}},{key:"addErrorWidget",value:function(e){this.errorWidgets.findIndex((function(t){return t===e}))<0&&this.errorWidgets.push(e)}},{key:"removeErrorWidget",value:function(e){var t=this.errorWidgets.findIndex((function(t){return t===e}));t>=0&&this.errorWidgets.splice(t,1)}},{key:"checkHasError",value:function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var e in this.subContexts){var t=this.subContexts[e];for(var n in t)if(!0===t[n].hasError)return!0}return!1}},{key:"clearErrors",value:function(){this.errors.splice(0),this.errorWidgets.splice(0),this.clearContextErrors()}},{key:"arrName",get:function(){}},{key:"hasError",get:function(){return this.checkHasError()}}]),e}(),p=Object(P.a)(f.prototype,"errors",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=Object(P.a)(f.prototype,"errorWidgets",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(P.a)(f.prototype,"hasError",[N.g],Object.getOwnPropertyDescriptor(f.prototype,"hasError"),f.prototype),f),he=1,fe=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r,a,i){var s,c;Object(O.a)(this,n);var o=e.uiSchema;if(void 0!==o){var u=o.items;void 0!==u&&(c=u[r.name])}return(s=t.call(this,e.form,c,a,i,!0)).parentContext=void 0,s.arrSchema=void 0,s.rowKey=void 0,s.data=void 0,s.parentContext=e,s.arrSchema=r,s.rowKey=he++,s.data=a,s}return Object(j.a)(n,[{key:"getItemSchema",value:function(e){return this.arrSchema.itemSchemas[e]}},{key:"getUiItem",value:function(e){if(void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)return t[e]}}},{key:"clearErrors",value:function(){Object(V.a)(Object(F.a)(n.prototype),"clearErrors",this).call(this),this.parentContext.clearErrors()}},{key:"arrName",get:function(){return this.arrSchema.name}},{key:"parentData",get:function(){return this.parentContext.data}}]),n}(de),pe=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r){return Object(O.a)(this,n),t.call(this,e,e.uiSchema,e.data,r,!1)}return Object(j.a)(n,[{key:"getItemSchema",value:function(e){return this.form.itemSchemas[e]}},{key:"getUiItem",value:function(e){var t=this.form.uiSchema;if(void 0!==t){var n=t.items;if(void 0!==n)return n[e]}}},{key:"data",get:function(){return this.form.data}}]),n}(de),ve=C.createContext({}),me=Object(W.a)((function(e){var t,n,r,a,i=e.parentContext,s=e.arrSchema,c=e.children,o=s.name,u=s.arr,l=i.initData[o],d=i.form,h=i.getArrRowContexts(o),f=i.getUiItem(o),p=o,v=d.ArrContainer,m=d.RowContainer,b=d.RowSeperator,y=d.uiSchema;if(void 0!==y){var k=y.selectable,g=y.deletable,w=y.restorable;!0!==n&&(n=k),!0!==r&&(r=g),!0!==a&&(a=w)}if(void 0!==f){var O=f.widget,j=f.label,x=f.selectable,E=f.deletable,N=f.restorable,A=f.ArrContainer,I=f.RowContainer,S=f.RowSeperator;if(void 0!==x&&(n=x),void 0!==E&&(r=E),void 0!==N&&(a=N),void 0!==A&&(v=A),void 0!==I&&(m=I),void 0!==S&&(b=S),t=f.Templet,"arr"!==O)return ue(s.type,O,["arr"]);p=j||p}var P=!0;return v(p,C.createElement(C.Fragment,null,l.map((function(e,o){var d,f,p=void 0;if(!1===P?p=b:P=!1,void 0!==c)d=new fe(i,s,e,!0),f=C.createElement(C.Fragment,null,c);else{var v=typeof t;"function"===v?(d=new fe(i,s,e,!0),f=C.createElement(Object(W.a)(t),e)):"object"===v?(d=new fe(i,s,e,!0),f=t):(d=new fe(i,s,e,!1),f=C.createElement(C.Fragment,null,u.map((function(e,t){return C.createElement(C.Fragment,{key:e.name},Oe(d,e,void 0))}))))}var y,k,g=d.rowKey;if(h[g]=d,!0===n){y=C.createElement("div",{className:"form-row-checkbox"},C.createElement("input",{type:"checkbox",onClick:function(t){var n=t.target.checked;e.$isSelected=n;var r=e.$source;void 0!==r&&(r.$isSelected=n),d.clearErrors()},defaultChecked:e.$isSelected}))}var w=!(void 0===e.$isDeleted||!1===e.$isDeleted);if(!0===r){var O=w?"fa-undo":"fa-trash";k=C.createElement("div",{className:"form-row-edit text-info",onClick:function(){if(!0===a){e.$isDeleted=!w;var t=e.$source;void 0!==t&&(t.$isDeleted=!w)}else{var n=l.indexOf(e);n>=0&&l.splice(n,1)}d.clearErrors()}},C.createElement("i",{className:T()("fa",O,"fa-fw")}))}var j=!0===n||!0===r?function(t){return C.createElement("fieldset",{disabled:w},C.createElement("div",{className:T()("d-flex",{deleted:w,"row-selected":e.$isSelected})},y,C.createElement("div",{className:!0===n&&!0===r?"form-row-content":"form-row-content-1"},t),k))}:function(e){return e};return C.createElement(ve.Provider,{key:g,value:d},p,m(j(C.createElement(C.Fragment,null,C.createElement(d.renderErrors,null),f))))}))))})),be=n(36),ye=n(53),ke=(m=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,Object(I.a)(e,"imageSrc",b,Object(S.a)(e)),e.onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new ye.a(e.itemSchema,e.ui,e.ui.label,e.value),t.next=3,n.start();case 3:return null!==(r=t.sent)&&(e.setValue(r),e.imageSrc=r),t.next=7,n.end();case 7:case"end":return t.stop()}}),t)}))),e.observerRender=Object(W.a)((function(){var t,n=["bg-white p-1 d-flex justify-content-center"];return e.readOnly||e.disabled||(n.push("cursor-pointer"),t=e.onClick),C.createElement("div",{className:T()(n),onClick:t},C.createElement(be.a,{src:e.imageSrc,className:"w-4c h-4c"}))})),e}return Object(j.a)(n,[{key:"init",value:function(){Object(V.a)(Object(F.a)(n.prototype),"init",this).call(this),this.imageSrc=this.value}},{key:"render",value:function(){return C.createElement(this.observerRender,null)}},{key:"ui",get:function(){return this._ui}}]),n}(G),b=Object(P.a)(m.prototype,"imageSrc",[N.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m),ge=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"ui",get:function(){return this._ui}}]),n}(G),we={id:{dataTypes:["id"],widget:oe},text:{dataTypes:["integer","number","string"],widget:H},textarea:{dataTypes:["string"],widget:$},password:{dataTypes:["string"],widget:K},date:{dataTypes:["date"],widget:Y},datetime:{dataTypes:["date"],widget:ee},time:{dataTypes:["date"],widget:te},month:{dataTypes:["date"],widget:ne},select:{dataTypes:["integer","number","string","date","boolean"],widget:ae},url:{dataTypes:["string"],widget:Q},email:{dataTypes:["string"],widget:J},number:{dataTypes:["integer","number"],widget:Z},updown:{dataTypes:["integer","number"],widget:X},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:re},image:{dataTypes:["string"],widget:ke},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:se},tagSingle:{dataTypes:["integer"],widget:function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){var e,t=this.ui,n=t.valuesView,r=t.wrapClassName;if(void 0===n)return C.createElement(C.Fragment,null,"valuesView must be defined");!0===this.context.isRow&&(e=this.context.rowKey);var a=T()(this.className,"py-0"),i=this.name;void 0!==e&&(i+="-"+e);var s={className:a,inputName:i,wrapClassName:r,onInputChange:this.onInputChange};return n.renderRadios(this.defaultValue,s)}}]),n}(ge)},tagMulti:{dataTypes:["string"],widget:function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).defaultArr=void 0,e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.changeValue(n.join("|"),!0)},e}return Object(j.a)(n,[{key:"init",value:function(){Object(V.a)(Object(F.a)(n.prototype),"init",this).call(this);var e=this.defaultValue;switch(typeof e){default:this.defaultArr=[];break;case"string":this.defaultArr=e.split("|").map((function(e){return Number(e)}))}}},{key:"render",value:function(){var e=this.ui,t=e.valuesView,n=e.wrapClassName;if(void 0===t)return C.createElement(C.Fragment,null,"valuesView must be defined");var r={className:T()(this.className,"py-0"),inputs:this.inputs,wrapClassName:n,onInputChange:this.onInputChange};return t.renderChecks(this.defaultValue,r)}}]),n}(ge)},range:{dataTypes:["integer"],widget:ce},button:{dataTypes:["button","submit"],widget:le}};function Oe(e,t,n,r){if(void 0===e)return null;if(void 0!==t){var a,i=t.name,s=t.type;switch(s){case"arr":var c=e.getItemSchema(i);return C.createElement(me,{parentContext:e,arrSchema:c,children:n})}var o=e.getUiItem(i);if(void 0===o)a=h(s);else{var u=o.widget;switch(u){default:if(void 0!==u)a=we[u].widget;void 0===a&&(a=h(s));break;case"custom":a=o.WidgetClass;break;case"group":return C.createElement("span",null,"impletment group")}}var l=e.widgets,d=new a(e,t,r,n);return d.init(),l[i]=d,C.createElement(d.container,null)}function h(e){switch(e){default:return H;case"id":return oe;case"integer":return X;case"number":return Z;case"string":return H;case"date":return Y;case"boolean":return re;case"button":case"submit":return le}}}n(71);var je=n(55),xe=n(32),Ee=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;Object(O.a)(this,n),(r=t.call(this,e)).schema=void 0,r.itemSchemas=void 0,r.uiSchema=void 0,r.res=void 0,r.formContext=void 0,r.disposer=void 0,r.data=void 0,r.Container=void 0,r.FieldContainer=void 0,r.FieldClass=void 0,r.ButtonClass=void 0,r.watch=function(){void 0!==r.props.formData&&r.calcSelectOrDelete()},r.DefaultContainer=function(e){return C.createElement("form",{className:T()(r.props.className),onSubmit:function(e){return e.preventDefault()}},e)},r.DefaultFieldContainer=function(e,t){var n=r.props.fieldLabelSize;if(n>0){var a;null===e?n=0:a=C.createElement("label",{className:T()("col-sm-"+n,"col-form-label")},e);var i="col-sm-"+(12-n);return C.createElement("div",{className:"form-group row"},a,C.createElement("div",{className:i},t))}return C.createElement("div",{className:"form-group"},null===e?null:C.createElement("label",{className:"col-form-label"},e),t)},r.DefaultFieldClass=void 0,r.DefaultButtonClass="text-center py-2",r.DefaultRes=Object(xe.a)(je.a),r.ArrContainer=function(e,t){return C.createElement("div",null,C.createElement("div",{className:T()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},e),t)},r.RowContainer=function(e){var t=T()({"py-3":!0});return C.createElement("div",{className:t},e)},r.RowSeperator=C.createElement("div",{className:"border border-gray border-top"});var a=e.schema,i=e.uiSchema,s=e.Container,c=e.FieldContainer,o=e.FieldClass,u=e.ButtonClass,l=e.res;r.Container=s||r.DefaultContainer,r.FieldContainer=c||r.DefaultFieldContainer,r.FieldClass=void 0!==o&&""!==o&&null!==o?o:r.DefaultFieldClass,r.res=l||r.DefaultRes,r.ButtonClass=u||r.DefaultButtonClass,r.schema=a,r.itemSchemas={};var d,h=Object(w.a)(r.schema);try{for(h.s();!(d=h.n()).done;){var f=d.value;r.itemSchemas[f.name]=f}}catch(p){h.e(p)}finally{h.f()}return r.uiSchema=i,r.disposer=Object(N.f)(r.watch),r.data={},r}return Object(j.a)(n,[{key:"renderContent",value:function(){var e=this;this.initData(this.props.formData);var t,n=this.props.children;return void 0!==n?(this.formContext=new pe(this,!0),C.createElement(C.Fragment,null,n)):(void 0!==this.uiSchema&&(t=this.uiSchema.Templet),void 0!==t?(this.formContext=new pe(this,!0),"function"===typeof t?t(this.data):t):(this.formContext=new pe(this,!1),C.createElement(C.Fragment,null,this.schema.map((function(t,r){return C.createElement(C.Fragment,{key:r},Oe(e.formContext,t,n))})))))}},{key:"initData",value:function(e){if(void 0===e&&(e={}),void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)for(var n in t){var r=t[n].defaultValue;void 0!==r&&void 0===e[n]&&(e[n]=r)}}var a,i=Object(w.a)(this.schema);try{for(i.s();!(a=i.n()).done;){var s=a.value;this.initDataItem(s,this.data,e)}}catch(c){i.e(c)}finally{i.f()}}},{key:"initDataItem",value:function(e,t,n){var r=e.name,a=e.type;if("button"!==a)if("arr"===a){var i=e,s=i.arr;if(void 0!==s){var c,o=i.itemSchemas={},u=Object(w.a)(s);try{for(u.s();!(c=u.n()).done;){var l=c.value;o[l.name]=l}}catch(g){u.e(g)}finally{u.f()}var d=n[r];void 0===d?d=[]:!1===Array.isArray(d)&&(d=[d]);var h,f=[],p=Object(w.a)(d);try{for(p.s();!(h=p.n()).done;){var v,m=h.value,b={$source:m,$isSelected:m.$isSelected,$isDeleted:m.$isDeleted},y=Object(w.a)(s);try{for(y.s();!(v=y.n()).done;){var k=v.value;this.initDataItem(k,b,m)}}catch(g){y.e(g)}finally{y.f()}f.push(b)}}catch(g){p.e(g)}finally{p.f()}t[r]=Object(N.n)(f)}}else t[r]=n[r]}},{key:"calcSelectOrDelete",value:function(){var e,t=Object(w.a)(this.schema);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.arrItemOperated(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"arrItemOperated",value:function(e){var t=e.name;if("arr"===e.type&&void 0!==this.data){var n=this.data[t];if(void 0!==n){var r,a=e.arr,i=Object(w.a)(n);try{for(i.s();!(r=i.n()).done;){var s=r.value,c=s.$source;if(void 0!==c){var o=c.$isSelected,u=c.$isDeleted;s.$isSelected=o,s.$isDeleted=u;var l,d=Object(w.a)(a);try{for(d.s();!(l=d.n()).done;){var h=l.value;this.arrItemOperated(h)}}catch(f){d.e(f)}finally{d.f()}}}}catch(f){i.e(f)}finally{i.f()}}}}},{key:"componentDidMount",value:function(){var e=this.props.beforeShow;void 0!==e&&e(this.formContext)}},{key:"componentWillUnmount",value:function(){void 0!==this.disposer&&this.disposer()}},{key:"render",value:function(){var e=this.renderContent();return C.createElement(ve.Provider,{value:this.formContext},C.createElement(this.formContext.renderErrors,null),this.Container(e))}},{key:"buttonClick",value:function(){var e=Object(g.a)(k.a.mark((function e(t){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formContext.checkRules(),!0!==this.formContext.hasError){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=this.formContext.form.props.onButtonClick)){e.next=7;break}return alert("you should define form onButtonClick"),e.abrupt("return");case 7:return e.next=9,n(t,this.formContext);case 9:if(void 0!==(r=e.sent)){e.next=12;break}return e.abrupt("return");case 12:this.formContext.setError(t,r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(C.Component);(function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.children,r=this.context;if(void 0===r)return C.createElement("span",{className:"text-danger"},"!only in Form!");var a=r.getItemSchema(t),i=Oe(r,a,n,this.props);return void 0===i?C.createElement("span",{className:"text-danger"},"!!",t," is not defined!!"):i}}]),n}(C.Component)).contextType=ve,n.d(t,"a",(function(){return Ee}))},function(e,t,n){"use strict";var r,a=n(1),i=n.n(a),s=n(2),c=n(3),o=n(4),u=n(6),l=n(5),d=n(0),h=n(12),f=n(18),p=n(23),v=n(29),m=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(h.a)((function(t){var n=t.resolve,r=function(){if(e.verifyValue(),void 0===e.error){var t=e.newValue;n(t)}},a=d.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!e.isChanged,onClick:r},"\u4fdd\u5b58");return d.createElement(p.a,{header:e.label,right:a},d.createElement("div",{className:"m-3"},d.createElement("input",{type:"text",onChange:e.onChange,onKeyDown:function(e){13===e.keyCode&&r()},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value}),e.uiItem&&d.createElement("div",{className:"small muted m-2"},e.uiItem.placeholder),e.error&&d.createElement("div",{className:"text-danger"},e.error)))})),e}return Object(o.a)(n,[{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=d.createElement(t.page,{resolve:e,reject:n});f.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),b=n(53),y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(h.a)((function(t){var n=t.resolve,r=e.itemSchema.name,a=e.uiItem.list,i=d.createElement("button",{className:"btn btn-sm btn-success align-self-center",disabled:!e.isChanged,onClick:function(){e.verifyValue(),void 0===e.error&&n(e.newValue)}},"\u4fdd\u5b58"),s=a?a.map((function(t,n){var a=t.title,i=t.value;return d.createElement("div",{key:n,className:"col"},d.createElement("label",{className:"px-3 py-2 cursor-pointer"},d.createElement("input",{name:r,type:"radio",value:i,onClick:function(){return e.onChange(i)},defaultChecked:i===e.value})," ",a||i," \xa0"))})):d.createElement(d.Fragment,null,"no list defined");return d.createElement(p.a,{header:"\u66f4\u6539"+e.label,right:i},d.createElement("div",{className:"m-3"},d.createElement("div",{className:"row row-cols-2 row-cols-sm-3 row-cols-md-4"},s)))})),e}return Object(o.a)(n,[{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=d.createElement(t.page,{resolve:e,reject:n});f.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),k=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(h.a)((function(t){var n=t.resolve,r=e.uiItem.list,a=r?r.map((function(t,r){var a=t.title,i=t.value;return d.createElement("div",{key:r,className:"px-3 py-2 cursor-pointer bg-white mb-1",onClick:function(){e.onChange(i),n(e.newValue)}},a||i)})):d.createElement(d.Fragment,null,"no list defined");return d.createElement(p.a,{header:"\u66f4\u6539"+e.label},d.createElement("div",{className:"my-3"},a))})),e}return Object(o.a)(n,[{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=d.createElement(t.page,{resolve:e,reject:n});f.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),g=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(h.a)((function(t){return d.createElement(p.a,{header:"\u66f4\u6539"+e.label},"ddd")})),e}return Object(o.a)(n,[{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(i.a.mark((function e(n,r){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=t.uiItem.pickId)){e.next=4;break}return alert("IdItemEdit.pickId = undefined"),e.abrupt("return");case 4:return e.next=6,a(void 0,void 0,t.value);case 6:s=e.sent,t.onChange(s.id),n(s);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"internalEnd",value:function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),w=n(17),O=n(16),j=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e.inputType=void 0,e.page=Object(h.a)((function(t){var n=t.resolve,r=d.createElement("button",{className:"btn btn-sm btn-success align-self-center",disabled:!e.isChanged,onClick:function(){e.verifyValue(),void 0===e.error&&n(e.newValue)}},"\u4fdd\u5b58");return d.createElement(p.a,{header:"\u66f4\u6539"+e.label,right:r},d.createElement("div",{className:"p-3"},e.renderInputs()))})),e}return Object(o.a)(n,[{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=d.createElement(t.page,{resolve:e,reject:n});f.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e=this.uiItem.valuesView;return void 0===e?Object(w.a)(Object(O.a)(n.prototype),"renderContent",this).call(this):e.render(this.value)}},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="radio",e.onInputChange=function(t){var n=t.currentTarget;if(!1!==n.checked){e.newValue=Number(n.value);var r=e.value;e.isChanged=e.newValue!==r}},e}return Object(o.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderRadios(this.value,t)}}]),n}(j),E=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="checkbox",e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.newValue=n.join("|");var i=e.value;e.isChanged=e.newValue!==i},e}return Object(o.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderChecks(this.value,t)}}]),n}(j),C=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(h.a)((function(t){var n=t.resolve,r=d.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!e.isChanged,onClick:function(){if(e.verifyValue(),void 0===e.error){var t=e.newValue;n(t)}}},"\u4fdd\u5b58");return d.createElement(p.a,{header:e.label,right:r},d.createElement("div",{className:"m-3"},d.createElement("textarea",{onChange:e.onChange,onKeyDown:function(e){},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,rows:6}),e.uiItem&&d.createElement("div",{className:"small muted m-2"},e.uiItem.placeholder),e.error&&d.createElement("div",{className:"text-danger"},e.error)))})),e}return Object(o.a)(n,[{key:"internalStart",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=d.createElement(t.page,{resolve:e,reject:n});f.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(v.a),N=Object(h.a)(r=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).defaultSepClassName="border-top edit-sep-light-gray",r.defaultRowContainerClassName="d-flex px-3 py-2 bg-white align-items-center",r.topBorder=void 0,r.bottomBorder=void 0,r.rowContainerClassName=void 0,r.sep=void 0,r.uiSchema=void 0,r.rowClick=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a,s,c,o,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=3;break}return alert("item has no edit"),e.abrupt("return");case 3:if(n=t.itemSchema,a=t.uiItem,s=t.value,c=r.props,o=c.onItemChanged,u=c.onItemClick,!0!==c.stopEdit){e.next=7;break}return e.abrupt("return");case 7:if(void 0===u){e.next=11;break}return e.next=10,u(n,a,s);case 10:return e.abrupt("return");case 11:if(void 0!==t){e.next=14;break}return alert("undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);"),e.abrupt("return");case 14:return e.prev=14,e.next=17,t.start();case 17:if((l=e.sent)===s){e.next=26;break}if(r.props.data[n.name]=l,void 0!==o){e.next=24;break}alert("".concat(n.name," value changed, new: ").concat(l,", pre: ").concat(s)),e.next=26;break;case 24:return e.next=26,o(n,l,s);case 26:return e.next=28,t.end();case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(14),console.log("no value changed"),console.error(e.t0);case 34:case"end":return e.stop()}}),e,null,[[14,30]])})));return function(t){return e.apply(this,arguments)}}();var a=e.topBorderClassName,o=e.bottomBorderClassName,u=e.sepClassName,l=e.rowContainerClassName,h=e.uiSchema,f=e.stopEdit;return r.topBorder=d.createElement("div",{className:a||r.defaultSepClassName}),r.bottomBorder=d.createElement("div",{className:o||r.defaultSepClassName}),r.rowContainerClassName=l||r.defaultRowContainerClassName,!0!==f&&(r.rowContainerClassName+=" cursor-pointer"),r.sep=d.createElement("div",{className:u||r.defaultSepClassName}),r.uiSchema=h&&h.items||{},r}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.schema;return d.createElement("div",null,this.topBorder,n.map((function(n,r){var a,c,o=n.name,u=void 0===t.uiSchema?void 0:t.uiSchema[o];void 0!==u&&(a=u.label||o,c=u.labelHide);var l,h=function(e,t,n,r){var a,i;if(void 0!==t)switch(t.widget){default:break;case"id":i=g;break;case"text":i=m;break;case"textarea":i=C;break;case"image":i=b.a;break;case"select":i=k;break;case"range":i=m;break;case"radio":a=new y(e,t,n,r);break;case"tagSingle":a=new x(e,t,n,r);break;case"tagMulti":a=new E(e,t,n,r)}if(void 0===a){if(void 0===i)switch(e.type){case"string":i=m;break;case"image":i=b.a}if(void 0===i)return;a=new i(e,t,n,r)}return a.init(),a}(n,u,a,t.props.data[o]),f=!0===n.required&&d.createElement("span",{className:"text-danger"},"*"),p="flex-fill d-flex ";!0===c?l=void 0:(l=d.createElement("div",null,a," ",f),p+="justify-content-end");var v=d.createElement(d.Fragment,{key:r},e,d.createElement("div",{className:"d-flex align-items-center"+t.rowContainerClassName,onClick:Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.rowClick(h);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},l,d.createElement("div",{className:p},void 0===h?void 0:h.renderContent()),!0!==t.props.stopEdit&&d.createElement("div",{className:"w-2c text-right"},d.createElement("i",{className:"fa fa-angle-right"}))));return e=t.sep,v})),this.bottomBorder)}}]),n}(d.Component))||r;n.d(t,"a",(function(){return N}))},function(e,t,n){"use strict";var r=n(24),a=n(11),i=n(1),s=n.n(i),c=n(2),o=n(3),u=n(4),l=n(6),d=n(5),h=n(15),f=n(33),p=n(59),v=n(19),m=new(function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"userAppUnits",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-app-units",{app:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/user-name-nick-icon-from-id",{userId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(v.b))("tv/",void 0),b=n(0),y=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(t){var n=t.predefinedUnit,r=h.nav.user,a=r?r.name:"[\u672a\u767b\u5f55]",i=e.controller.uqsMan,s=i.appOwner,c=i.appName;return b.createElement(h.Page,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},b.createElement("div",{className:"m-3 text-danger container"},b.createElement("div",{className:"form-group row"},b.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u767b\u5f55\u7528\u6237"),b.createElement("div",{className:"col-sm text-body"},a)),b.createElement("div",{className:"form-group row"},b.createElement("div",{className:"col-sm-3 font-weight-bold"},"App"),b.createElement("div",{className:"col-sm text-body"},"".concat(s,"/").concat(c))),b.createElement("div",{className:"form-group row"},b.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u9884\u8bbe\u5c0f\u53f7"),b.createElement("div",{className:"col-sm text-body"},n||b.createElement("small",{className:""},"[\u65e0\u9884\u8bbe\u5c0f\u53f7]"))),b.createElement("div",{className:"form-group row"},b.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u53ef\u80fd\u539f\u56e0",b.createElement(h.FA,{name:"exclamation-triangle"})),b.createElement("div",{className:"col-sm text-body"},b.createElement("ul",{className:"p-0"},b.createElement("li",null,"\u6ca1\u6709\u5c0f\u53f7\u8fd0\u884c ",c),b.createElement("li",null,"\u7528\u6237 ",b.createElement("b",null,a)," \u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u4e00\u4e2a\u8fd0\u884c",c,"\u7684\u5c0f\u53f7"),n&&b.createElement("li",null,"\u9884\u8bbe\u5c0f\u53f7 ",b.createElement("b",null,n)," \u6ca1\u6709\u8fd0\u884cApp ",c)))),b.createElement("div",{className:"form-group row"},b.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u5c0f\u53f7",n),b.createElement("div",{className:"col-sm text-body"},"\u9884\u8bbe\u5c0f\u53f7\u5b9a\u4e49\u5728 public/unit.json \u6587\u4ef6\u4e2d\u3002 \u5b9a\u4e49\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u7531url\u76f4\u63a5\u542f\u52a8\u3002 \u7528\u6237\u7b2c\u4e00\u6b21\u8bbf\u95eeapp\u4e4b\u540e\uff0c\u4f1a\u7f13\u5b58\u5728localStorage\u91cc\u3002",b.createElement("br",null),"\u5982\u679c\u8981\u5220\u53bb\u7f13\u5b58\u7684\u9884\u5b9a\u4e49Unit\uff0clogout\u7136\u540e\u518dlogin\u3002"))))},e}return Object(u.a)(n,[{key:"open",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{predefinedUnit:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f.b),k=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderRow=function(e,t){var n=e.id,r=e.nick,a=e.name;return b.createElement(h.LMR,{className:"px-3 py-2",right:"id: "+n},b.createElement("div",null,r||a))},e.onRowClick=function(){var t=Object(c.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v.g.unit=n.id,t.next=3,e.controller.start();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.page=function(){return b.createElement(h.Page,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},b.createElement(h.List,{items:e.controller.appUnits,item:{render:e.renderRow,onClick:e.onRowClick}}))},e}return Object(u.a)(n,[{key:"open",value:function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(f.b),g=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){return b.createElement(h.Page,{header:"ERROR"},b.createElement("div",{className:"m-3"},b.createElement("div",{className:"p-3 d-flex justify-content-center align-items-center"},b.createElement("button",{className:"btn btn-danger",onClick:h.nav.resetAll},"\u91cd\u542f\u7f51\u9875")),b.createElement("div",null,"Load Uqs \u53d1\u751f\u9519\u8bef\uff1a"),e.errors.map((function(e,t){return b.createElement("div",{key:t},e)}))))},e}return Object(u.a)(n,[{key:"open",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{errors:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f.b),w=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){var t=e.error;return b.createElement(h.Page,{header:"App start error!"},b.createElement("pre",null,"string"===typeof t?t:t.message))},e}return Object(u.a)(n,[{key:"open",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{error:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f.b),O=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,void 0))._uqs=void 0,r.name=void 0,r.version=void 0,r.noUnit=void 0,r.uqsMan=void 0,r.appUnits=void 0;var a=e.appName,i=e.version,s=e.tvs,c=e.noUnit;if(r.name=a,void 0===a)throw new Error('appName like "owner/app" must be defined in MainConfig');return r.version=i,r.noUnit=c,r.uqsMan=new p.UQsMan(r.name,s),r}return Object(u.a)(n,[{key:"internalT",value:function(e){return Object(h.t)(e)}},{key:"setRes",value:function(e){Object(h.setGlobalRes)(e)}},{key:"hookElements",value:function(e){if(void 0!==e)for(var t in e){var n=document.getElementById(t);n&&e[t](n)}}},{key:"beforeStart",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.load();case 3:if(t=e.sent,n=v.g.predefinedUnit,!(void 0!==(r=h.nav.user)&&r.id>0)){e.next=28;break}return e.next=9,m.userAppUnits(this.uqsMan.id);case 9:if(this.appUnits=e.sent,!0!==this.noUnit){e.next=12;break}return e.abrupt("return",!0);case 12:e.t0=this.appUnits.length,e.next=0===e.t0?15:1===e.t0?17:23;break;case 15:return this.showUnsupport(n),e.abrupt("return",!1);case 17:if(!(void 0===(a=this.appUnits[0].id)||a<0||void 0!==n&&a!==n)){e.next=21;break}return this.showUnsupport(n),e.abrupt("return",!1);case 21:return v.g.unit=a,e.abrupt("break",28);case 23:if(!(n>0&&void 0!==this.appUnits.find((function(e){return e.id===n})))){e.next=26;break}return v.g.unit=n,e.abrupt("break",28);case 26:return this.openVPage(k),e.abrupt("return",!1);case 28:if(void 0===t){e.next=31;break}return this.openVPage(g,t),e.abrupt("return",!1);case 31:return e.abrupt("return",!0);case 34:return e.prev=34,e.t1=e.catch(0),this.openVPage(w,e.t1),e.abrupt("return",!1);case 38:case"end":return e.stop()}}),e,this,[[0,34]])})));return function(){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.userFromId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,i,c,o,u,l,d,h,f,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.uqsMan,n=t.appOwner,i=t.appName,c=this.uqsMan.localData,(o=c.get())&&o.version===this.version){e.next=13;break}return e.next=6,Object(v.j)(n,i);case 6:if((o=e.sent).id){e.next=9;break}return e.abrupt("return",["".concat(n,"/").concat(i,"\u4e0d\u5b58\u5728\u3002\u8bf7\u4ed4\u7ec6\u68c0\u67e5app\u5168\u540d\u3002")]);case 9:o.version=this.version,c.set(o),u=Object(a.a)(o.uqs);try{for(u.s();!(l=u.n()).done;)l.value.newVersion=!0}catch(s){u.e(s)}finally{u.f()}case 13:return h=(d=o).id,f=d.uqs,this.uqsMan.id=h,e.next=17,this.uqsMan.init(f);case 17:return e.next=19,this.uqsMan.load();case 19:if(0!==(p=e.sent).length){e.next=25;break}if(p.push.apply(p,Object(r.a)(this.uqsMan.setTuidImportsLocal())),0!==p.length){e.next=25;break}return this._uqs=this.uqsMan.buildUQs(),e.abrupt("return");case 25:return e.abrupt("return",p);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showUnsupport",value:function(e){h.nav.clear(),this.openVPage(y,e)}},{key:"uqs",get:function(){return this._uqs}}]),n}(f.a);function j(e,t){return x.apply(this,arguments)}function x(){return(x=Object(c.a)(s.a.mark((function e(t,n){var r,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.getElementsByTagName("html"),(a=r[0].getAttribute("data-version"))&&(n.version=a),i=new t(n),e.next=6,i.start();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=n(17),C=n(16),N=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,void 0))._uqs=void 0,r._cApp=void 0,r._cApp=e,r._uqs=e&&e.uqs,r}return Object(u.a)(n,[{key:"internalT",value:function(e){var t=Object(E.a)(Object(C.a)(n.prototype),"internalT",this).call(this,e);return void 0!==t?t:this._cApp.internalT(e)}},{key:"newC",value:function(e,t){var n=new e(this.cApp);return n.init(t),n}},{key:"newSub",value:function(e){return new e(this)}},{key:"uqs",get:function(){return this._uqs}},{key:"cApp",get:function(){return this._cApp}}]),n}(f.a),A=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e.cApp))._owner=void 0,r._owner=e,r}return Object(u.a)(n,[{key:"internalT",value:function(e){var t=Object(E.a)(Object(C.a)(n.prototype),"internalT",this).call(this,e);return void 0!==t?t:this._owner.internalT(e)}},{key:"owner",get:function(){return this._owner}}]),n}(N);n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return N})),n.d(t,"c",(function(){return A}))},function(e,t,n){"use strict";var r,a,i,s,c,o,u=n(3),l=n(4),d=n(6),h=n(5),f=n(0),p=n(14),v=n.n(p),m=n(12),b=n(9),y=n(8),k=(r=function(){function e(t){Object(u.a)(this,e),this.list=void 0,this.render=void 0,this.list=t}return Object(l.a)(e,[{key:"dispose",value:function(){}},{key:"renderContent",value:function(e,t){var n=this.list.props.item.render;return void 0===n?f.createElement("div",{className:"px-3 py-2"},JSON.stringify(e)):n(e,t)}},{key:"isPaged",get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)}},{key:"items",get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0}},{key:"loading",get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading}},{key:"selectedItems",get:function(){}}]),e}(),Object(b.a)(r.prototype,"loading",[y.g],Object.getOwnPropertyDescriptor(r.prototype,"loading"),r.prototype),r),g=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key,s=r.onClick;return f.createElement("li",{key:void 0===i?n:i(t),className:v()("va-row-clickable",a),onClick:function(){return s&&s(t)}},e.renderContent(t,n))},e}return n}(k),w=n(35),O=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key;if("string"===typeof t){var s=v()("va-list-gap","px-3","pt-1");return f.createElement("li",{key:Object(w.a)(),className:s},t)}return f.createElement("li",{key:void 0===i?n:i(t),className:v()(a)},e.renderContent(t,n))},e}return n}(k),j=n(11),x=n(24),E=n(10),C=n(13),N=(n(22),a=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r,a=this;return Object(u.a)(this,n),r=t.call(this,e),Object(E.a)(r,"_items",i,Object(C.a)(r)),r.inputItems={},r.buildItems=function(){var e,t=r.list.props,n=t.items,a=t.selectedItems,i=t.compare;if(void 0!==n)if(null!==n){var s;e=!0===Array.isArray(n)?n:n.items,s=void 0===i?function(e,t){return e===t}:i;var c=e.map((function(e){return{selected:void 0!==a&&void 0!==a.find((function(t){return s(e,t)})),item:e,labelId:Object(w.a)()}}));r._items=c}else r._items=null;else r._items=void 0},r.render=function(e,t){var n=r.list.props.item.key;return f.createElement(a.row,{item:e,index:t,key:void 0===n?t:n(e)})},r.row=Object(m.a)((function(e){var t=e.item,n=e.index,a=r.list.props.item.className,i=t.labelId,s=t.selected,c=t.item;return f.createElement("li",{className:v()(a)},f.createElement("div",{className:"d-flex align-items-center px-3"},f.createElement("input",{ref:function(e){e&&(r.inputItems[i]=e)},className:"",type:"checkbox",value:"",id:i,defaultChecked:s,onChange:function(e){r.onSelect(t,e.target.checked)}}),f.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:i},r.renderContent(c,n))))})),r.buildItems(),r.listenArraySplice(),r}return Object(l.a)(n,[{key:"listenArraySplice",value:function(){var e,t=this,n=this.list.props.items;void 0!==n&&(null!==n&&(e=!0===Array.isArray(n)?n:n.items,!0===Object(y.k)(n)&&Object(y.o)(e,(function(e){if("splice"===e.type){var n,r=e.index,a=e.removedCount,i=e.added,s=i&&i.map((function(e){return{selected:!1,item:e,labelId:Object(w.a)()}}));(n=t._items).splice.apply(n,[r,a].concat(Object(x.a)(s))),t.buildItems()}}),!0)))}},{key:"checkAll",value:function(e){for(var t in this.inputItems)this.inputItems[t].checked=e;var n,r=Object(j.a)(this._items);try{for(r.s();!(n=r.n()).done;){n.value.selected=e}}catch(a){r.e(a)}finally{r.f()}}},{key:"selectAll",value:function(){this.checkAll(!0),this.list.props.item.onSelect(void 0,!0,this.anySelected)}},{key:"unselectAll",value:function(){this.checkAll(!1),this.list.props.item.onSelect(void 0,!1,this.anySelected)}},{key:"onSelect",value:function(e,t){e.selected=t,this.list.props.item.onSelect(e.item,t,this.anySelected)}},{key:"items",get:function(){return this._items}},{key:"anySelected",get:function(){return this._items.some((function(e){return e.selected}))}},{key:"selectedItems",get:function(){return this._items.filter((function(e){return!0===e.selected})).map((function(e){return e.item}))}}]),n}(k),i=Object(b.a)(a.prototype,"_items",[y.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a),A=(n(111),n(32)),T=n(55);n.d(t,"a",(function(){return I}));var I=Object(m.a)((o=c=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).listBase=void 0,r.selectable=void 0,r._$scroll=function(e){console.log("############### items scroll to "+e)},r.buildBase(),r}return Object(l.a)(n,[{key:"buildBase",value:function(){var e=this.props.item,t=e.onClick;void 0!==e.onSelect?this.selectable=this.listBase=new N(this):this.listBase=void 0!==t?new g(this):new O(this)}},{key:"componentWillUnmount",value:function(){this.listBase.dispose()}},{key:"selectAll",value:function(){this.selectable&&this.selectable.selectAll()}},{key:"unselectAll",value:function(){this.selectable&&this.selectable.unselectAll()}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,a=t.header,i=t.footer,s=t.before,c=t.loading,o=t.none,u=t.onFocus;void 0===s&&(s="-"),void 0===c&&(c=function(){return f.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"})}),void 0===o&&(o=n.res.none);var l,d,h,p=this.listBase,m=p.items,b=p.loading;function y(e,t){if(e)switch(typeof e){default:case"string":return f.createElement("li",{className:"va-list-"+t},e);case"function":return f.createElement("li",{className:"va-list-"+t},e());case"object":return f.createElement("li",null,e)}}return l=null===m?y(s,"before"):void 0===m?y(c,"loading"):0===m.length?y(o,"none"):m.map((function(t,n){return e.listBase.render(t,n)})),!0===b&&m&&(d=y(c,"loading")),void 0!==u&&(h=-1),f.createElement("ul",{className:v()("va-list",r),onFocus:u,tabIndex:h},y(a,"header"),l,d,y(i,"footer"))}},{key:"selectedItems",get:function(){return this.listBase.selectedItems}}]),n}(f.Component),c.res=Object(A.a)(T.b),s=o))||s},function(e,t,n){"use strict";var r,a=n(11),i=n(3),s=n(4),c=n(6),o=n(5),u=n(0),l=n(14),d=n.n(l),h=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,[{key:"setValues",value:function(e){}}]),e}(),f=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(e){return u.createElement("div",{key:"_b_"+e,className:""},u.createElement("div",{className:"w-100"},u.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))}}]),n}(h),p=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this)).param=void 0,r.param=e,r}return Object(s.a)(n,[{key:"render",value:function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=d()(t);return u.createElement("div",{key:"_g_"+e,className:n})}}]),n}(h),v=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).gridProps=void 0,a._prop=void 0,a.content=void 0,a.col=void 0,a.gridProps=e,a._prop=r,a.col=!0===e.labelFixLeft?"col":"col-sm",a}return Object(s.a)(n,[{key:"prop",get:function(){return this._prop}}]),Object(s.a)(n,[{key:"render",value:function(e){var t=this.prop,n=t.onClick,r=t.bk,a=d()({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return u.createElement("div",{key:e,className:a,onClick:n},this.renderLabel(),this.renderProp())}},{key:"renderLabel",value:function(){var e=this.prop.label;return void 0===e?null:u.createElement("label",{className:this.col+"-3 col-form-label"},e)}},{key:"renderProp",value:function(){var e,t,n=this.prop.label;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var r=this.col+(void 0===n?"-12":"-9"),a=d()(e,t,r,"d-flex");return u.createElement("div",{className:a},this.renderPropBody())}},{key:"renderPropBody",value:function(){return u.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())}},{key:"renderPropContent",value:function(){return this.content}}]),n}(h),m=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}},{key:"prop",get:function(){return this._prop}}]),n}(v),b=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}},{key:"prop",get:function(){return this._prop}}]),n}(v),y=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setValues",value:function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}}},{key:"renderPropBody",value:function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?u.createElement("div",null):u.createElement("div",{className:"w-100"},r.map((function(e,t){return u.createElement(u.Fragment,{key:t},0===t?null:u.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),u.createElement(n,e))})))}},{key:"prop",get:function(){return this._prop}}]),n}(v),k=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"renderPropBody",value:function(){return this.prop.component}},{key:"renderProp",value:function(){var e,t,n,r=this.prop,a=r.label,i=r.full;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}n=!0!==i?this.col+(void 0===a?"-12":"-9"):"w-100";var s=d()(e,t,n,"d-flex");return u.createElement("div",{className:s},this.renderPropBody())}},{key:"prop",get:function(){return this._prop}}]),n}(v),g=function(){function e(t,n){Object(i.a)(this,e),this.gridProps=void 0,this.props=void 0,this.rows=void 0,this.gridProps=t,this.props=n,this.buildRows()}return Object(s.a)(e,[{key:"buildRows",value:function(){this.rows=[];var e,t=!0,n=Object(a.a)(this.props);try{for(n.s();!(e=n.n()).done;){var r=e.value;if("string"===typeof r)this.rows.push(new p(r)),t=!0;else{t||this.rows.push(new f);var i=void 0;switch(r.type){default:continue;case"string":i=new m(this.gridProps,r);break;case"number":i=new b(this.gridProps,r);break;case"list":i=new y(this.gridProps,r);break;case"component":i=new k(this.gridProps,r)}this.rows.push(i),t=!1}}}catch(s){n.e(s)}finally{n.f()}}},{key:"setValues",value:function(e){var t,n=Object(a.a)(this.rows);try{for(n.s();!(t=n.n()).done;){t.value.setValues(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"render",value:function(){return this.rows.map((function(e,t){return e.render(String(t))}))}}]),e}(),w=n(12);Object(w.a)(r=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.rows,r=e.values,a=new g(this.props,n);a.setValues(r);var i=d()("container-fluid",t);return u.createElement("div",{className:i},a.render())}}]),n}(u.Component))},function(e,t,n){"use strict";var r,a,i=n(1),s=n.n(i),c=n(2),o=n(10),u=n(3),l=n(4),d=n(13),h=n(6),f=n(5),p=n(9),v=(n(22),n(0)),m=n(8),b=n(15),y=n(19);r=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;Object(u.a)(this,n),(r=t.call(this,e)).schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],r.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},Object(o.a)(r,"data",a,Object(d.a)(r)),r.onItemChanged=function(){var e=Object(c.a)(s.a.mark((function e(t,n,a){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.name,e.next=3,y.p.userSetProp(i,n);case 3:r.data[i]=n,b.nav.user[i]=n,b.nav.saveLocalUser();case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var i=b.nav.user,l=i.nick,h=i.icon;return r.data={nick:l,icon:h},r}return Object(l.a)(n,[{key:"render",value:function(){return v.createElement(b.Page,{header:"\u4e2a\u4eba\u4fe1\u606f"},v.createElement(b.Edit,{schema:this.schema,uiSchema:this.uiSchema,data:this.data,onItemChanged:this.onItemChanged}))}}]),n}(v.Component),a=Object(p.a)(r.prototype,"data",[m.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null})},,,,function(e,t,n){},function(e,t,n){e.exports=n(117)},,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r,a,i,s,c=n(0),o=n.n(c),u=n(67),l=n.n(u),d=n(1),h=n.n(d),f=n(2),p=n(7),v=(n(114),n(95)),m=n(3),b=n(4),y=n(6),k=n(5),g=(n(115),{appName:"Bruce/todo",version:"1.0.0",noUnit:!0,tvs:{},oem:"\u767e\u7075\u5a01"}),w=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"cApp",get:function(){return this._cApp}},{key:"uqs",get:function(){return this._uqs}}]),n}(p.CBase),O=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"cApp",get:function(){return this.cApp}},{key:"uqs",get:function(){return this._uqs}},{key:"owner",get:function(){return this._owner}}]),n}(p.CSub),j=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"newC",value:function(e){var t=new e(this);return t.init(),t}},{key:"uqs",get:function(){return this._uqs}}]),n}(p.CAppBase),x=n(37);!function(e){e[e.Text=0]="Text",e[e.Assign=10]="Assign",e[e.Task=20]="Task"}(a||(a={})),function(e){e[e.start=0]="start",e[e.todo=20]="todo",e[e.doing=21]="doing",e[e.done=22]="done",e[e.pass=40]="pass",e[e.fail=41]="fail",e[e.rated=60]="rated",e[e.cancel=-40]="cancel"}(i||(i={})),function(e){e[e.todo=20]="todo",e[e.done=22]="done",e[e.check=40]="check",e[e.rate=60]="rate"}(s||(s={}));var E=(r={},Object(x.a)(r,i.start,{me:"\u6536\u5230",other:"\u6536\u5230",act:void 0,pending:!0}),Object(x.a)(r,i.todo,{me:"\u5f85\u529e",act:"\u9886\u529e",pending:!0}),Object(x.a)(r,i.doing,{me:"\u5728\u529e",act:"\u9886\u529e",pending:!0}),Object(x.a)(r,i.done,{me:"\u5df2\u5b8c\u6210",act:"\u5b8c\u6210",pending:!1}),Object(x.a)(r,i.pass,{me:"\u5df2\u9a8c\u6536",act:"\u9a8c\u6536",pending:!1}),Object(x.a)(r,i.fail,{me:"\u5df2\u62d2\u7b7e",act:"\u62d2\u7b7e",pending:!1}),Object(x.a)(r,i.rated,{me:"\u5df2\u8bc4\u4ef7",act:"\u8bc4\u4ef7",pending:!1}),Object(x.a)(r,i.cancel,{me:"\u5df2\u53d6\u6d88",act:"\u5f52\u6863",pending:!1}),r);function C(e){return E[e]}var N,A,T,I="\u529e\u7406",S="\u67e5\u9a8c",P="\u8bc4\u4ef7",R=function(e){return!0===e?"text-primary":"text-muted"},V=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t){var n=e.controller,r=n.cGroup,a=n.cReport,i=n.cMe,s=[{name:"note",label:"\u9996\u9875",icon:"home",content:r.tab},{name:"job",label:"\u67e5\u770b",icon:"list",content:a.tab,onShown:a.load,className:"job-tab"},{name:"me",label:"\u6211\u7684",icon:"user",content:i.tab}].map((function(e){var t=e.name,n=e.label,r=e.icon;return{name:t,caption:function(e){return Object(p.TabCaptionComponent)(n,r,R(e))},content:e.content,onShown:e.onShown,className:e.className}}));return c.createElement(p.Page,{tabsProps:{tabs:s}})},e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.render);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.VPage),F=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"init",value:function(e){}},{key:"logout",value:function(){return!0}},{key:"render",value:function(e){return this.init(e),this.renderPage()}},{key:"header",value:function(){return"\u6211\u7684"}},{key:"content",value:function(){return o.a.createElement("div",{className:"p-3"},o.a.createElement("div",{className:"mb-3"},this.renderMe()),o.a.createElement("div",{className:"small text-muted"},"\u6b63\u5728\u5efa\u8bbe\u4e2d..."))}}]),n}(p.VPage),L=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tab=function(){return e.renderView(F)},e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(w),M=n(10),D=n(13),U=n(9),_=(n(22),n(8)),B={maxWidth:"45%"},q=(N=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).schema=[{name:"a",type:"string"},{name:"b",type:"string"},{name:"c",type:"string"},{name:"submit",type:"submit"}],e.uiSchema=void 0,Object(M.a)(e,"data",A,Object(D.a)(e)),e.submit=function(){var e=Object(f.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:alert(t+": "+JSON.stringify(n.data));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.onEditItemChanged=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.data[n.name]=r;case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.renderListItem=function(e,t){return c.createElement("div",null,"1")},e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){this.uiSchema={items:{b:{label:"\u5355\u9009Radio",widget:"tagSingle",valuesView:this.controller.tagTest1.view},c:{label:"\u591a\u9009CheckBox",widget:"tagMulti",valuesView:this.controller.tagTest2.view,wrapClassName:"row-cols-sm-2"},submit:{label:"\u63d0\u4ea4",widget:"button",className:"btn btn-primary"}}};return c.createElement(p.Page,{header:"\u7ee9\u6548",headerClassName:"bg-info"},c.createElement("div",{className:"m-3"},c.createElement("button",{className:"mr-3 btn btn-outline-primary",onClick:this.controller.test},"Test"),c.createElement("button",{className:"mr-3 btn btn-outline-primary",onClick:this.controller.testParser},"\u6d4b\u8bd5\u8868\u8fbe\u5f0f"),c.createElement("button",{className:"mr-3 btn btn-outline-primary",onClick:this.controller.actionTestExpression},"actionTestExpression")),c.createElement(p.List,{items:[],item:{render:this.renderListItem},none:c.createElement("div",{className:"p-3 text-success"},"ok ok ok")}),c.createElement("div",{className:"d-flex flex-wrap m-3 justify-content-start"},["adfas1fd","asdfddddsadf","adsfasf","sdafsdf dsf a","adfasfd","asdfsadf","adsfasf","sdafsdf dsf a","adfasfd","asdfsadf","adsfasf","sdafsdf dsf a"].map((function(e,t){return c.createElement("div",{key:t,className:"p-3 border border-info mr-1 mb-1 w-10c cursor-pointer bg-white rounded",style:B,onClick:function(){return alert(e)}},e)}))),c.createElement(p.Form,{className:"p-3",schema:this.schema,uiSchema:this.uiSchema,formData:this.data,fieldLabelSize:2,onButtonClick:this.submit}),c.createElement(p.Edit,{className:"p-3",schema:this.schema,uiSchema:this.uiSchema,data:this.data,onItemChanged:this.onEditItemChanged}))}}]),n}(p.VPage),A=Object(U.a)(N.prototype,"data",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{b:3,c:"2|4"}}}),N),z=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(){return c.createElement(p.Page,{header:"\u8bd5\u9a8c"},c.createElement(p.Form,{className:"m-3",schema:[{name:"name1",type:"string",required:!0},{name:"name2",type:"string"},{name:"num",type:"number",min:10,max:50},{name:"submit",type:"button"}],uiSchema:{items:{name1:{widget:"text",label:"\u59d3\u540d",placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d"},name2:{widget:"textarea",label:"\u59d3\u540d2",placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d2"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-success"}}},fieldLabelSize:3}))},e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.VPage);!function(e){e[e.NONE=-1]="NONE",e[e._FINISHED=0]="_FINISHED",e[e.ADD=1]="ADD",e[e.SUB=2]="SUB",e[e.MUL=3]="MUL",e[e.DIV=4]="DIV",e[e.MOD=5]="MOD",e[e.XOR=6]="XOR",e[e.BITWISEAND=7]="BITWISEAND",e[e.BITWISEOR=8]="BITWISEOR",e[e.OR=9]="OR",e[e.AND=10]="AND",e[e.NOT=11]="NOT",e[e.GT=12]="GT",e[e.GE=13]="GE",e[e.LT=14]="LT",e[e.LE=15]="LE",e[e.NE=16]="NE",e[e.EQU=17]="EQU",e[e.DOT=18]="DOT",e[e.COMMA=19]="COMMA",e[e.COLON=20]="COLON",e[e.SEMICOLON=21]="SEMICOLON",e[e.AT=22]="AT",e[e.DOLLAR=23]="DOLLAR",e[e.LPARENTHESE=24]="LPARENTHESE",e[e.RPARENTHESE=25]="RPARENTHESE",e[e.LBRACE=26]="LBRACE",e[e.RBRACE=27]="RBRACE",e[e.NUM=28]="NUM",e[e.VAR=29]="VAR",e[e.HEX=30]="HEX",e[e.REM=31]="REM",e[e.STRING=32]="STRING",e[e.ADDEQU=33]="ADDEQU",e[e.SUBEQU=34]="SUBEQU",e[e.LBRACKET=35]="LBRACKET",e[e.RBRACKET=36]="RBRACKET",e[e.SHARP=37]="SHARP",e[e.CODE=38]="CODE",e[e.DOLLARVAR=39]="DOLLARVAR"}(T||(T={}));var W="+-*\\/%(){}[].,;:^=<>&|'\"_?09$@#",G="abcdefghijklmnopqrstuvwxyz",H="ABCDEFGHIJKLMNOPQRSTUVWXYZ",$=function e(){Object(m.a)(this,e)};$.NULL=0,$.TAB=9,$._R=10,$.ENTER=13,$.SPACE=32,$.PLUS=W.charCodeAt(0),$.MINUS=W.charCodeAt(1),$.STAR=W.charCodeAt(2),$.BACKSLASH=W.charCodeAt(3),$.SLASH=W.charCodeAt(4),$.PERCENT=W.charCodeAt(5),$.LParenthese=W.charCodeAt(6),$.RParenthese=W.charCodeAt(7),$.LBrace=W.charCodeAt(8),$.RBrace=W.charCodeAt(9),$.LBracket=W.charCodeAt(10),$.RBracket=W.charCodeAt(11),$.DOT=W.charCodeAt(12),$.COMMA=W.charCodeAt(13),$.SEMICOLON=W.charCodeAt(14),$.COLON=W.charCodeAt(15),$.TOPANGLE=W.charCodeAt(16),$.EQU=W.charCodeAt(17),$.LS=W.charCodeAt(18),$.GT=W.charCodeAt(19),$.AND=W.charCodeAt(20),$.OR=W.charCodeAt(21),$.Apostrophe=W.charCodeAt(22),$.QUOT=W.charCodeAt(23),$.UNDERLINE=W.charCodeAt(24),$.QUESTION=W.charCodeAt(25),$.ZERO=W.charCodeAt(26),$.NINE=W.charCodeAt(27),$.DOLLAR=W.charCodeAt(28),$.AT=W.charCodeAt(29),$.SHARP=W.charCodeAt(30),$.a=G.charCodeAt(0),$.b=G.charCodeAt(1),$.c=G.charCodeAt(2),$.d=G.charCodeAt(3),$.e=G.charCodeAt(4),$.f=G.charCodeAt(5),$.g=G.charCodeAt(6),$.h=G.charCodeAt(7),$.i=G.charCodeAt(8),$.j=G.charCodeAt(9),$.k=G.charCodeAt(10),$.l=G.charCodeAt(11),$.m=G.charCodeAt(12),$.n=G.charCodeAt(13),$.o=G.charCodeAt(14),$.p=G.charCodeAt(15),$.q=G.charCodeAt(16),$.r=G.charCodeAt(17),$.s=G.charCodeAt(18),$.t=G.charCodeAt(19),$.u=G.charCodeAt(20),$.v=G.charCodeAt(21),$.w=G.charCodeAt(22),$.x=G.charCodeAt(23),$.y=G.charCodeAt(24),$.z=G.charCodeAt(25),$.A=H.charCodeAt(0),$.B=H.charCodeAt(1),$.C=H.charCodeAt(2),$.D=H.charCodeAt(3),$.E=H.charCodeAt(4),$.F=H.charCodeAt(5),$.G=H.charCodeAt(6),$.H=H.charCodeAt(7),$.I=H.charCodeAt(8),$.J=H.charCodeAt(9),$.K=H.charCodeAt(10),$.L=H.charCodeAt(11),$.M=H.charCodeAt(12),$.N=H.charCodeAt(13),$.O=H.charCodeAt(14),$.P=H.charCodeAt(15),$.Q=H.charCodeAt(16),$.R=H.charCodeAt(17),$.S=H.charCodeAt(18),$.T=H.charCodeAt(19),$.U=H.charCodeAt(20),$.V=H.charCodeAt(21),$.W=H.charCodeAt(22),$.X=H.charCodeAt(23),$.Y=H.charCodeAt(24),$.Z=H.charCodeAt(25),$.USPACE=12288;var K=function(){function e(t,n,r){Object(m.a)(this,e),this.bracket=void 0,this.buffer=void 0,this.p=void 0,this.len=void 0,this.cur=void 0,this.log=void 0,this.dec=void 0,this.isInteger=void 0,this._var=void 0,this.varBrace=void 0,this.lowerVar=void 0,this.text=void 0,this.token=void 0,this.LastP=void 0,this.line=void 0,this.at=void 0,this.prevLine=void 0,this.prevAt=void 0,this.startLine=void 0,this.startAt=void 0,this.PrevToken=void 0,this.file=void 0,void 0!==r&&(this.bracket=r.bracket),this.log=t,this.LastP=1,this.buffer=n,this.len=n.length,this.p=0,this.at=0,this.line=0,this.advance()}return Object(b.a)(e,[{key:"getSourceAt",value:function(e){return this.buffer.substring(e,this.LastP-1)}},{key:"getSourceNearby",value:function(e){return" ..."+this.buffer.substr(e,50)+"... "}},{key:"errorAt",value:function(){var e=this.startLine+1,t=this.startAt+1;return this.file+" \u9519\u8bef\u5728"+e+"\u884c"+t+"\u5217: \n"+this.getSourceNearby(this.p)+"\n"}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+t.join("");throw this.log(r),r}},{key:"expectToken",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+"\u5e94\u8be5\u662f"+t.map((function(e){return T[e]})).join("\u6216");throw this.log(r),r}},{key:"expect",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+"\u5e94\u8be5\u662f"+t.join("\u6216");throw this.log(r),r}},{key:"assertToken",value:function(e){this.token!==e&&this.expectToken(e)}},{key:"assertVar",value:function(){this.token!==T.VAR&&this.expect("\u5e94\u8be5\u662f\u53d8\u91cf\u540d")}},{key:"assertKey",value:function(e){this.lowerVar===e&&!0!==this.varBrace||this.expect(e)}},{key:"advance",value:function(){this.cur=this.p>=this.len?0:this.buffer.charCodeAt(this.p++),this.cur===$.ENTER?(this.line++,this.at=1):this.at++}},{key:"isKeyword",value:function(e){return this.lowerVar===e&&!1===this.varBrace}},{key:"isKeywords",value:function(e){return!0!==this.varBrace&&e.indexOf(this.lowerVar)>=0}},{key:"showToken",value:function(){return T[this.token]}},{key:"PeekToken",value:function(){var e=this.PrevToken,t=this.cur,n=this._var,r=this.lowerVar,a=this.LastP,i=this.startLine,s=this.startAt,c=this.token,o=this.p,u=this.line,l=this.at;this.readToken();var d=this.token;return this.PrevToken=e,this.LastP=a,this.startLine=i,this.startAt=s,this.token=c,this._var=n,this.lowerVar=r,this.p=o,this.line=u,this.at=l,this.cur=t,d}},{key:"readToken",value:function(){for(this.PrevToken=this.token,this.LastP=this.p,this.prevLine=this.startLine,this.prevAt=this.startAt,this.startLine=this.line,this.startAt=this.at,this._var=void 0,this.lowerVar=void 0;;){switch(this.cur){case $.NULL:this.token=T._FINISHED;break;case $.TAB:case $.SPACE:case $.USPACE:case $._R:case $.ENTER:this.advance(),this.startLine=this.line,this.startAt=this.at,this.LastP=this.p;continue;case $.PLUS:this.token=T.ADD,this.advance(),this.cur===$.EQU&&(this.token=T.ADDEQU,this.advance());break;case $.MINUS:switch(this.advance(),this.cur){case $.EQU:this.token=T.SUBEQU,this.advance();break;case $.MINUS:this.readLineRemark();continue;default:this.token=T.SUB}break;case $.STAR:this.token=T.MUL,this.advance();break;case $.DOLLAR:this.readVar(),"$"===this._var?this.token=T.DOLLAR:this.token=T.DOLLARVAR;break;case $.AT:this.token=T.AT,this.advance();break;case $.SLASH:switch(this.advance(),this.cur){case $.SLASH:this.readLineRemark();continue;case $.STAR:this.readRemark();continue;case $.MINUS:this.readInlineCode();break;default:this.token=T.DIV}break;case $.PERCENT:this.token=T.MOD,this.advance();break;case $.LParenthese:this.token=T.LPARENTHESE,this.advance();break;case $.RParenthese:this.token=T.RPARENTHESE,this.advance();break;case $.LBrace:this.advance(),this.token=T.LBRACE;break;case $.RBrace:this.token=T.RBRACE,this.advance();break;case $.SHARP:this.token=T.SHARP,this.advance();break;case $.DOT:this.token=T.DOT,this.advance();break;case $.COMMA:this.token=T.COMMA,this.advance();break;case $.SEMICOLON:this.token=T.SEMICOLON,this.advance();break;case $.COLON:this.token=T.COLON,this.advance();break;case $.TOPANGLE:this.token=T.XOR,this.advance();break;case $.EQU:switch(this.advance(),this.cur){case $.GT:this.token=T.GE,this.advance();break;case $.LS:this.token=T.LE,this.advance();break;default:this.token=T.EQU}break;case $.GT:switch(this.advance(),this.cur){case $.EQU:this.token=T.GE,this.advance();break;case $.LS:this.token=T.NE,this.advance();break;default:this.token=T.GT}break;case $.LS:switch(this.advance(),this.cur){case $.EQU:this.token=T.LE,this.advance();break;case $.GT:this.token=T.NE,this.advance();break;default:this.token=T.LT}break;case $.AND:this.advance(),this.token=T.BITWISEAND;break;case $.OR:this.advance(),this.token=T.BITWISEOR;break;case $.LBracket:if(!0===this.bracket){this.token=T.LBRACKET,this.advance();break}this.readSquareVar();break;case $.RBracket:if(!0===this.bracket){this.token=T.RBRACKET,this.advance();break}this.error("unexpected ]");break;case $.Apostrophe:this.readString($.Apostrophe);break;case $.QUOT:this.readString($.QUOT);break;case $.UNDERLINE:this.readVar();break;default:this.cur>=$.ZERO&&this.cur<=$.NINE?this.readNumber(this.cur-$.ZERO):this.cur>=$.a&&this.cur<=$.z||this.cur>=$.A&&this.cur<=$.Z||this.cur>=256?this.readVar():this.error("PARSE_UnexpectChar")}return}}},{key:"readLineRemark",value:function(){for(;;)switch(this.advance(),this.cur){case $._R:case $.ENTER:case $.NULL:return}}},{key:"readInlineCode",value:function(){this.token=T.CODE;for(var e=this.p;this.advance(),this.cur!==$.NULL;)if(this.cur===$.MINUS&&(this.advance(),this.cur===$.SLASH)){this.advance();break}this.text=this.buffer.substring(e,this.p-3)}},{key:"readRemark",value:function(){for(this.advance();this.cur!==$.NULL;)if(this.cur===$.STAR){if(this.advance(),this.cur===$.SLASH){this.advance();break}}else this.advance()}},{key:"readSquareVar",value:function(){for(var e=this.p;;)switch(this.advance(),this.cur){case $.NULL:case $._R:case $.ENTER:return void this.error("PARSE_UnexpectEndVar");case $.RBracket:return this.token=T.VAR,this.varBrace=!0,this._var=this.buffer.substring(e,this.p-1),this.lowerVar=this._var.toLowerCase(),void this.advance()}}},{key:"readNumber",value:function(e){if(this.dec=e,this.isInteger=!0,this.advance(),0!==e||this.cur!==$.x&&this.cur!==$.X)for(this.token=T.NUM;;){if(this.cur>=$.ZERO&&this.cur<=$.NINE)this.dec=10*this.dec+(this.cur-$.ZERO);else{if(this.cur!==$.DOT)break;this.isInteger=!1;for(var t=.1;;){if(this.advance(),!(this.cur>=$.ZERO&&this.cur<=$.NINE))return;this.dec=this.dec+(this.cur-$.ZERO)*t,t/=10}}this.advance()}else for(this.token=T.HEX,this.advance(),this.text="";this.cur>=$.ZERO&&this.cur<=$.NINE||this.cur>=$.a&&this.cur<=$.f||this.cur>=$.A&&this.cur<=$.F;)this.text+=String.fromCharCode(this.cur),this.advance()}},{key:"readString",value:function(e){this.token=T.STRING;var t=this.p;for(this.advance();;){if(this.cur===$.NULL)return;if(this.cur===e)return this.text=this.buffer.substring(t,this.p-1),void this.advance();if(this.cur!==$.BACKSLASH)this.advance();else if(this.advance(),this.cur===e){this.advance();break}}}},{key:"readVar",value:function(){for(var e=this.p-1,t=!0;t;){if(this.advance(),this.cur===$.NULL)return this._var=this.buffer.substring(e,this.p-1),this.lowerVar=this._var.toLowerCase(),void(this.varBrace=!1);switch(this.cur){case $.UNDERLINE:break;default:if(this.cur>=$.ZERO&&this.cur<=$.NINE||this.cur>=$.a&&this.cur<=$.z||this.cur>=$.A&&this.cur<=$.Z||this.cur>=256)continue;t=!1}}this.token=T.VAR,this._var=this.buffer.substring(e,this.p-1),this.lowerVar=this._var.toLowerCase(),this.varBrace=!1}}]),e}(),Q=n(11),J=function e(){Object(m.a)(this,e)},Z=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.or()}},{key:"str",value:function(){return"||"}}]),n}(J),X=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.and()}},{key:"str",value:function(){return"&&"}}]),n}(J),Y=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.not()}},{key:"str",value:function(){return"!"}}]),n}(J),ee=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.le()}},{key:"str",value:function(){return"<="}}]),n}(J),te=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.lt()}},{key:"str",value:function(){return"<"}}]),n}(J),ne=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.eq()}},{key:"str",value:function(){return"="}}]),n}(J),re=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.ne()}},{key:"str",value:function(){return"<>"}}]),n}(J),ae=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.gt()}},{key:"str",value:function(){return">"}}]),n}(J),ie=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.ge()}},{key:"str",value:function(){return">="}}]),n}(J),se=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.add()}},{key:"str",value:function(){return"+"}}]),n}(J),ce=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.sub()}},{key:"str",value:function(){return"-"}}]),n}(J),oe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.mul()}},{key:"str",value:function(){return"*"}}]),n}(J),ue=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.div()}},{key:"str",value:function(){return"/"}}]),n}(J),le=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.mod()}},{key:"str",value:function(){return"%"}}]),n}(J),de=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.bitAnd()}},{key:"str",value:function(){return"&"}}]),n}(J),he=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.bitOr()}},{key:"str",value:function(){return"|"}}]),n}(J),fe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){e.neg()}},{key:"str",value:function(){return"-"}}]),n}(J),pe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"to",value:function(e){}},{key:"str",value:function(){return"()"}}]),n}(J),ve=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this)).text=void 0,r.text=e,r}return Object(b.a)(n,[{key:"to",value:function(e){e.str(this.text)}},{key:"str",value:function(){return"'"+this.text+"'"}}]),n}(J),me=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this)).num=void 0,r.num=e,r}return Object(b.a)(n,[{key:"to",value:function(e){e.num(this.num)}},{key:"str",value:function(){return String(this.num)}}]),n}(J),be=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this)).text=void 0,r.text=e,r}return Object(b.a)(n,[{key:"to",value:function(e){e.hex(this.text)}},{key:"str",value:function(){return"#h"}}]),n}(J),ye=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).dotFirst=!1,e._var=[],e}return Object(b.a)(n,[{key:"to",value:function(e){}},{key:"str",value:function(){return this._var.join(".")}},{key:"type",get:function(){return"var"}}]),n}(J),ke=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e,r){var a;return Object(m.a)(this,n),(a=t.call(this)).func=void 0,a.paramCount=void 0,a.func=e,a.paramCount=r,a}return Object(b.a)(n,[{key:"to",value:function(e){e.func(this.func,this.paramCount)}},{key:"str",value:function(){return this.func}}]),n}(J),ge=["unit","user","pagestart","pagesize","date","id","state","row","sheet_date","sheet_no","sheet_discription"],we=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this))._var=void 0,r._var=e,r}return Object(b.a)(n,null,[{key:"isValid",value:function(e){return void 0!==ge.find((function(t){return t===e}))}}]),Object(b.a)(n,[{key:"to",value:function(e){e.dollarVar(this._var)}},{key:"str",value:function(){return"$"+this._var}}]),n}(J),Oe=function(){function e(t){Object(m.a)(this,e),this.ts=void 0,this.at=void 0,this.line=void 0,this.sourceStart=void 0,this.atoms=[],this.ts=t}return Object(b.a)(e,[{key:"run",value:function(){var e,t="",n=Object(Q.a)(this.atoms);try{for(n.s();!(e=n.n()).done;){t+=e.value.str()+" "}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"savePos",value:function(){this.at=this.ts.prevAt,this.line=this.ts.prevLine,this.sourceStart=this.ts.LastP-1}},{key:"getSource",value:function(){return this.ts.getSourceAt(this.sourceStart)}},{key:"errorAt",value:function(){var e=this.ts.startLine+1,t=this.ts.startAt+1;return this.ts.file+" \u9519\u8bef\u5728"+e+"\u884c"+t+"\u5217: \n"+this.ts.getSourceNearby(this.sourceStart)+"\n"}},{key:"log",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0===this.line)e=n.join("");else{var a=this.line+1,i=this.at+1;e=this.ts.file+" \u9519\u8bef\u5728"+a+"\u884c"+i+"\u5217: \n"+this.ts.getSourceNearby(this.sourceStart)+"\n"+n.join("\n")}this.ts.log(e)}},{key:"msg",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0===this.line)e=n.join("");else{var a=this.line+1,i=this.at+1;e=this.ts.file+" \u63d0\u9192\u5728"+a+"\u884c"+i+"\u5217: "+n.join("")}this.ts.log(e)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+t.join("");throw this.ts.log(r),r}},{key:"expectToken",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+"\u5e94\u8be5\u662f"+t.map((function(e){return T[e]})).join("\u6216");throw this.ts.log(r),r}},{key:"expect",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.errorAt()+"\u5e94\u8be5\u662f"+t.join("\u6216");throw this.ts.log(r),r}},{key:"add",value:function(e){this.atoms.push(e)}},{key:"parse",value:function(){this._parse()}},{key:"_parse",value:function(){this.entry()}},{key:"expCompare",value:function(){for(this.B();this.ts.token===T.OR||!0===this.ts.isKeyword("or");)this.ts.readToken(),this.B(),this.add(new Z)}},{key:"B",value:function(){for(this.C();this.ts.token===T.AND||!0===this.ts.isKeyword("and");)this.ts.readToken(),this.C(),this.add(new X)}},{key:"C",value:function(){if(this.ts.token===T.NOT||this.ts.isKeyword("not"))return this.ts.readToken(),this.C(),void this.add(new Y);switch(this.expValue(),this.ts.token){default:break;case T.LE:this.ts.readToken(),this.expValue(),this.add(new ee);break;case T.LT:this.ts.readToken(),this.expValue(),this.add(new te);break;case T.EQU:this.ts.readToken(),this.expValue(),this.add(new ne);break;case T.NE:this.ts.readToken(),this.expValue(),this.add(new re);break;case T.GT:this.ts.readToken(),this.expValue(),this.add(new ae);break;case T.GE:this.ts.readToken(),this.expValue(),this.add(new ie)}}},{key:"expValue",value:function(){for(this.t();;)switch(this.ts.token){default:return;case T.ADD:this.ts.readToken(),this.t(),this.add(new se);break;case T.SUB:this.ts.readToken(),this.t(),this.add(new ce)}}},{key:"t",value:function(){for(this.bitWise();;)switch(this.ts.token){default:return;case T.MUL:this.ts.readToken(),this.bitWise(),this.add(new oe);break;case T.DIV:this.ts.readToken(),this.bitWise(),this.add(new ue);break;case T.MOD:this.ts.readToken(),this.bitWise(),this.add(new le)}}},{key:"bitWise",value:function(){for(this.f();;)switch(this.ts.token){default:return;case T.BITWISEAND:this.ts.readToken(),this.f(),this.add(new de);break;case T.BITWISEOR:this.ts.readToken(),this.f(),this.add(new he)}}},{key:"f",value:function(){var e;switch(this.ts.token){case T.SUB:return this.ts.readToken(),this.f(),void this.add(new fe);case T.LPARENTHESE:if(this.ts.readToken(),this.entry(),this.ts.token===T.RPARENTHESE){var t=new pe;return this.add(t),void this.ts.readToken()}return void this.expectToken(T.RPARENTHESE);case T.STRING:return this.add(new ve(this.ts.text)),void this.ts.readToken();case T.NUM:return this.add(new me(this.ts.dec)),void this.ts.readToken();case T.HEX:return this.add(new be(this.ts.text)),void this.ts.readToken();case T.DOLLARVAR:return e=this.ts.lowerVar.substr(1),!1===we.isValid(e)&&this.error(e+"\u4e0d\u662f\u7cfb\u7edf\u53d8\u91cf"),this.add(new we(e)),void this.ts.readToken();case T.VAR:switch(e=this.ts.lowerVar,this.ts.readToken(),this.ts.token){default:var n=new ye;return n._var.push(e),void this.add(n);case T.LPARENTHESE:return void this.func(e)}default:return void this.error("\u8bed\u6cd5\u9519\u8bef",this.ts._var)}}},{key:"func",value:function(t){if(this.ts.readToken(),!0!==this.predefinedFunc(t)){var n=e.funcs[t];void 0===n&&this.error("\u672a\u77e5\u7684\u51fd\u6570 "+t);var r=this.readFuncParameters();if(this.add(new ke(t,r)),Array.isArray(n)){var a=n[0],i=n[1];r<a?this.error("\u51fd\u6570 "+t+" \u81f3\u5c11 "+a+"\u4e2a\u53c2\u6570"):r>i&&this.error("\u51fd\u6570 "+t+" \u6700\u591a "+i+"\u4e2a\u53c2\u6570")}else n>=0&&n!==r&&this.error("\u51fd\u6570 "+t+" \u53ea\u80fd\u662f "+n+"\u4e2a\u53c2\u6570")}}},{key:"predefinedFunc",value:function(e){switch(e){default:return!1;case"year":case"month":case"day":case"len":case"ltrim":case"rtrim":case"from_unixtime":this.ReadFixCountFunc(e,1);break;case"rand":this.ReadFixCountFunc(e,0);break;case"left":case"right":case"ifnull":case"round":this.ReadFixCountFunc(e,2);break;case"replace":case"substring":this.ReadFixCountFunc(e,3);break;case"charindex":this.ReadVariableParameters(e,2,3)}return!0}},{key:"ReadFixCountFunc",value:function(e,t){t!==this.readFuncParameters()&&this.error("\u51fd\u6570"+e+"\u9700\u8981"+t+"\u4e2a\u53c2\u6570"),this.add(new ke(e,t))}},{key:"ReadVariableParameters",value:function(e,t,n){var r=this.readFuncParameters();r<t&&this.error("\u51fd\u6570"+e+"\u81f3\u5c11\u9700\u8981"+t+"\u4e2a\u53c2\u6570"),r>n&&this.error("\u51fd\u6570"+e+"\u6700\u591a\u9700\u8981"+n+"\u4e2a\u53c2\u6570"),this.add(new ke(e,r))}},{key:"readFuncParameters",value:function(){if(this.ts.token===T.RPARENTHESE)return this.ts.readToken(),0;for(var e=0;;)if(this.expValue(),e++,this.ts.token!==T.COMMA){if(this.ts.token===T.RPARENTHESE){this.ts.readToken();break}this.expectToken(T.COMMA,T.RPARENTHESE)}else this.ts.readToken();return e}}],[{key:"OperationExpression",value:function(){}}]),e}();Oe.funcs={concat:-1,concat_ws:-1,now:0,substr:[2,3],unix_timestamp:[0,1]};var je=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"entry",value:function(){this.expValue()}}]),n}(Oe);function xe(){try{var e=new K((function(e){return!1}),"a + 2 * [b] * 3");e.readToken();var t=new je(e);return t.parse(),t.run()}catch(n){return"error: "+n}}var Ee,Ce,Ne,Ae,Te,Ie,Se=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tab=function(){return e.renderView(q)},e.test=function(){e.openVPage(z)},e.testParser=function(){alert(xe())},e.actionTestExpression=Object(f.a)(h.a.mark((function t(){var n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=xe(),r={name:"subject3",a:n},t.next=4,e.uqs.performance.TestExpression.submitConvert(r);case 4:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.uqs.performance.test1.values,this.uqs.performance.test2.values;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tagTest1",get:function(){return this.uqs.performance.test1}},{key:"tagTest2",get:function(){return this.uqs.performance.test2}}]),n}(w),Pe=n(12),Re=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderGroup=function(e,t){var n=e.group,r=e.count,a=e.memberCount;return c.createElement("div",{className:"px-3 py-2"},Object(p.tv)(n,(function(e){var t,n=e.name,i={top:"0.0rem",right:"0.3rem"},s="position-absolute text-success";a<=1||(a<10?t=c.createElement("small",{className:s,style:i},a):a<100?t=c.createElement("small",{className:s,style:i},a):t=c.createElement("small",{className:s,style:i},"99+"));var o=c.createElement("div",{className:"red-dot num mr-3 d-flex w-2-5c h-2-5c rounded align-items-center justify-content-center position-relative text-white bg-warning text-right"},c.createElement(p.FA,{name:"user-circle",size:"lg"}),t),u=r>0&&c.createElement("small",{className:""},r);return c.createElement(p.LMR,{className:"w-100 align-items-center",left:o,right:u},n)})))},e.onClickGroup=function(t){e.controller.showGroupAssigns(t)},e.onClickSend=function(){e.form.buttonClick("send")},e.onFormSubmit=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.data,i=a.name,s=a.discription,t.next=3,e.controller.saveGroup(0,i,s);case 3:e.closePage();case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.form=void 0,e.onClickAdd=function(){var t=c.createElement("button",{onClick:e.onClickSend,className:"btn btn-sm btn-success align-self-center mr-2"},c.createElement(p.FA,{name:"paper-plane-o"}));e.openPageElement(c.createElement(p.Page,{header:"\u65b0\u5efa\u7fa4",right:t},c.createElement("div",{className:"m-3"},c.createElement(p.Form,{ref:function(t){return e.form=t},schema:[{name:"name",type:"string"}],uiSchema:{items:{name:{label:"\u540d\u79f0",placeholder:"\u8f93\u5165\u5de5\u4f5c\u7fa4\u7ec4\u540d\u79f0"}}},onButtonClick:e.onFormSubmit}))))},e.keyGroup=function(e){var t=e.group;return"object"===typeof t?t.id:t},e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(Pe.a)((function(){var t=e.controller,n=t.myGroupsPager,r=t.todosChanged,a=t.defaultGroupAssignCount,i=n.items,s=c.createElement("button",{onClick:e.onClickAdd,className:"btn btn-sm btn-primary align-self-center mr-2"},c.createElement(p.FA,{name:"plus"})),o=c.createElement("div",{className:"red-dot mx-3 d-flex w-2-5c h-2-5c text-center rounded text-white align-items-center justify-content-center bg-info"},c.createElement(p.FA,{name:"circle-o",fixWidth:!0,size:"lg"}),!0===r&&c.createElement("u",null)),u=a>0&&c.createElement("small",{className:"mr-3"},a);return c.createElement(p.Page,{header:"\u9996\u9875",headerClassName:"bg-info",right:s},c.createElement(p.LMR,{className:"py-2 bg-white align-items-center cursor-pointer mb-2",left:o,right:u,onClick:e.controller.showMyAssigns},"\u6211\u7684\u5f85\u529e"),c.createElement(p.List,{items:i,item:{render:e.renderGroup,onClick:e.onClickGroup,key:e.keyGroup},none:function(){return c.createElement(c.Fragment,null,"[\u65e0]")}}))}));return c.createElement(t)}}]),n}(p.VPage),Ve=n(14),Fe=n.n(Ve),Le=(Ee=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(M.a)(e,"inputed",Ce,Object(D.a)(e)),Object(M.a)(e,"commandsShown",Ne,Object(D.a)(e)),e.onUserLoaded=function(t){e.scrollToBottom()},e.renderNote=function(t,n){var r,a=t.owner;return r=!0===p.Tuid.equ(a,e.controller.user.id)?c.createElement("div",{className:"d-flex flex-column align-items-end my-2"},t.renderAsNote()):c.createElement(p.UserView,{user:a,onLoaded:e.onUserLoaded,render:function(e){var n=e.icon,r=e.nick,a=e.name;return c.createElement("div",{className:"d-flex align-items-start my-2"},c.createElement(p.Image,{src:n,className:"w-2c h-2c mr-3"}),c.createElement("div",{className:"flex-fill d-flex flex-column align-items-start"},c.createElement("div",{className:"small text-muted mb-1"},r||a),t.renderAsNote()))}}),c.createElement("div",{className:"d-block"},e.renderTime(t,n),r)},e.inputRef=function(t){t&&"hidden"!==window.getComputedStyle(t).visibility&&(e.input=t)},e.addTextNote=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.input){t.next=2;break}return t.abrupt("return");case 2:return n=e.input.value,e.input.value="",e.inputed=!1,t.next=7,e.controller.addTextNote(n);case 7:e.commandsShown=!1,e.scrollToBottom();case 9:case"end":return t.stop()}}),t)}))),e.divBottom=void 0,e.refDivBottom=function(t){e.divBottom=t},e.input=void 0,e.onKeyDown=function(t){13===t.keyCode&&e.addTextNote()},e.onInputChange=function(t){e.inputed=t.target.value.trim().length>0},e.showCommands=function(){e.commandsShown=!e.commandsShown,e.commandsShown&&e.scrollToBottom()},e.taskTodo=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.input.value="",e.inputed=!1;case 2:case"end":return t.stop()}}),t)}))),e.onListFocus=function(t){e.commandsShown=!1},e.onDetail=function(){e.controller.showGroupDetail()},e}return Object(b.a)(n,[{key:"init",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){var t;null===(t=e.divBottom)||void 0===t||t.scrollIntoView()}),100)}},{key:"renderTime",value:function(e,t){var n,r=e.$create;if(t>0&&(n=this.controller.groupNotesPager.items[t-1],r.getTime()-n.$create.getTime()<12e4))return;return c.createElement("div",{className:"pt-3 text-muted small text-center"},c.createElement(p.EasyTime,{date:r}))}},{key:"header",value:function(){var e=this,t=Object(Pe.a)((function(){var t=e.controller.currentGroup;return Object(p.tv)(t,(function(e){var t=e.name,n=e.count;return c.createElement(c.Fragment,null,t," \xa0 ",n&&c.createElement("small",null,"(",n,"\u6210\u5458)"))}))}));return c.createElement(t,null)}},{key:"footer",value:function(){var e=this,t=Object(Pe.a)((function(){var t=Fe()("w-100 d-flex flex-column justify-content-center",{}),n=Fe()("d-flex px-2 align-items-center py-1 border-top",{"align-items-start":e.commandsShown});return c.createElement("div",{className:t},c.createElement("div",{className:n},c.createElement("input",{className:"flex-fill form-control mr-2 mb-0",type:"text",ref:e.inputRef,onKeyDown:e.onKeyDown,onChange:e.onInputChange}),!0===e.inputed?c.createElement("button",{onClick:e.addTextNote,className:"btn btn-sm btn-success text-nowrap"},"\u53d1\u9001"):c.createElement("button",{onClick:e.showCommands,className:"btn btn-sm btn-outline-dark"},c.createElement(p.FA,{name:"plus"}))),!0===e.commandsShown&&c.createElement("div",{className:"d-flex flex-wrap px-3 py-4"},c.createElement("div",{className:"cursor-pointer",onClick:e.taskTodo},c.createElement("div",{className:"p-2 bg-white",style:{borderRadius:"0.6em"}},c.createElement(p.FA,{name:"tasks",size:"lg",fixWidth:!0})),c.createElement("div",{className:"text-center mt-1 small text-muted"},c.createElement("small",null,"\u4f5c\u4e1a")))))}));return c.createElement(t,null)}},{key:"right",value:function(){return c.createElement("div",{className:"d-flex px-3 align-items-center cursor-pointer",onClick:this.onDetail},c.createElement(p.FA,{name:"ellipsis-h"}))}},{key:"content",value:function(){var e=this,t=this.controller.groupNotesPager,n=Object(Pe.a)((function(){return c.createElement("div",{id:t.bottomDiv,ref:e.refDivBottom,className:"h-1c"})}));return c.createElement(c.Fragment,null,c.createElement(p.List,{className:"px-3 flex-fill bg-transparent",items:t.items,item:{render:this.renderNote},onFocus:this.onListFocus}),c.createElement(n))}},{key:"onPageScrollTop",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.groupNotesPager.more();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.VPage),Ce=Object(U.a)(Ee.prototype,"inputed",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ne=Object(U.a)(Ee.prototype,"commandsShown",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ee),Me=(Ae=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e,r=this;Object(m.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).groupMembersPager=void 0,e.onItemChanged=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){var i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.controller.currentGroup,s={id:i.id},t.t0=n.name,t.next="name"===t.t0?5:"discription"===t.t0?7:9;break;case 5:return i.name=s.name=r,t.abrupt("break",9);case 7:return i.discription=s.discription=r,t.abrupt("break",9);case 9:return t.next=11,e.controller.saveGroupProp(s);case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.onMember=function(t){e.controller.cApp.showMemberDetail(t)},e.renderMember=function(t){var n="object"===typeof t?t.id:t;return c.createElement("div",{key:n,className:"m-2 cursor-pointer",onClick:function(){return e.onMember(n)}},c.createElement(p.UserView,{id:n,render:function(e){var t=e.name,r=e.nick;return c.createElement(c.Fragment,null,c.createElement("div",{className:"w-3c h-3c rounded border "},c.createElement(p.UserIcon,{id:n,className:"w-100 h-100 rounded"})),c.createElement("div",{className:"w-3c d-inline-block text-truncate small text-muted text-center"},c.createElement("small",null,r||t)))}}))},e.onSubmitAddMember=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.userApi.fromKey(r.data.user);case 2:if(a=t.sent){t.next=6;break}return r.setError("user","\u8d26\u53f7\u4e0d\u5b58\u5728\u6216\u8005\u4e0d\u63a5\u53d7\u9080\u8bf7"),t.abrupt("return");case 6:return t.next=8,e.controller.groupAddMember(a);case 8:Object(p.useUser)(a.id),e.groupMembersPager.items.push({member:a.id}),e.closePage();case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.onAddMember=function(){e.openPageElement(c.createElement(p.Page,{header:"\u6dfb\u52a0\u6210\u5458"},c.createElement(p.Form,{onButtonClick:e.onSubmitAddMember,onEnter:e.onSubmitAddMember,className:"m-5 px-5 py-3 bg-white",schema:[{name:"user",type:"string",maxLength:100,required:!0},{name:"submit",type:"submit"}],uiSchema:{items:{user:{widget:"text",label:"\u6210\u5458",placeholder:"\u8bf7\u8f93\u5165\u6210\u5458\u8d26\u53f7"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-primary"}}}})))},Object(M.a)(e,"disabled",Te,Object(D.a)(e)),e.listRemoveMember=void 0,e.renderRemoveButton=Object(Pe.a)((function(){return c.createElement("button",{onClick:e.onRemoveMemberList,className:"btn btn-sm btn-success mr-2 align-self-center",disabled:e.disabled},"\u5220\u9664")})),e.renderRemoveMemberItem=function(e,t){var n=e.member,r="object"===typeof n?n.id:n;return c.createElement(p.UserView,{id:r,render:function(e){var t=e.name,n=e.nick;return c.createElement("div",{className:"d-flex align-items-center py-2"},c.createElement("div",{className:"w-3c h-3c rounded border mx-3"},c.createElement(p.UserIcon,{id:r,className:"w-100 h-100 rounded"})),c.createElement("div",{className:""},n||t))}})},e.onRemoveMemberList=Object(f.a)(h.a.mark((function t(){var n,r,a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.listRemoveMember.selectedItems,t.next=3,e.controller.groupRemoveMembers(n);case 3:r=e.groupMembersPager.items,a=Object(Q.a)(n);try{for(s=function(){var e=i.value,t=r.findIndex((function(t){return t.member===e.member}));t>=0&&r.splice(t,1)},a.s();!(i=a.n()).done;)s()}catch(c){a.e(c)}finally{a.f()}e.closePage();case 7:case"end":return t.stop()}}),t)}))),e.onSelectRemoveMember=function(t,n,r){e.disabled=!1===r},e.onRemoveMember=function(){e.openPageElement(c.createElement(p.Page,{header:"\u6210\u5458",right:c.createElement(r.renderRemoveButton,null)},c.createElement(p.List,{ref:function(t){return e.listRemoveMember=t},items:e.groupMembersPager.items,item:{render:e.renderRemoveMemberItem,onSelect:e.onSelectRemoveMember}})))},e.renderMemberAction=function(t,n){var r=e.controller,a=r.currentGroup,i=r.user;if(!1!==p.Tuid.equ(a.owner,i.id))return c.createElement("div",{onClick:n,className:"d-flex m-2 w-3c h-3c rounded border text-muted justify-content-center align-items-center cursor-pointer"},c.createElement(p.FA,{name:t}))},e.renderMembers=function(){var t=e.groupMembersPager.items;if(void 0===t)return c.createElement(p.Loading,null);var n,r=[],a=Object(Q.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.push(e.renderMember(i.member))}}catch(s){a.e(s)}finally{a.f()}return c.createElement("div",{className:"mb-3 bg-white d-flex flex-wrap p-2"},r,e.renderMemberAction("plus",e.onAddMember),e.renderMemberAction("minus",e.onRemoveMember))},e.schema=[{name:"name",type:"string",maxLength:100},{name:"discription",type:"string",maxLength:1e3}],e.uiSchema={items:{name:{label:"\u7ec4\u540d\u79f0",widget:"text"},discription:{label:"\u7ec4\u516c\u544a",widget:"textarea"}}},e.page=Object(Pe.a)((function(){var t=e.controller.currentGroup;return c.createElement(p.Page,{header:"\u8be6\u60c5"},e.renderMembers(),c.createElement(p.Edit,{schema:e.schema,uiSchema:e.uiSchema,data:t,onItemChanged:e.onItemChanged}))})),e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.groupMembersPager=t,this.openPage(this.page);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.VPage),Te=Object(U.a)(Ae.prototype,"disabled",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ae),De=function e(t){Object(m.a)(this,e),this.id=void 0,this.owner=void 0,this.$create=void 0,this.cGroup=void 0,this.cGroup=t},Ue=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).content=void 0,e}return Object(b.a)(n,[{key:"renderAsNote",value:function(){var e=p.Tuid.equ(this.owner,this.cGroup.user.id),t=Fe()("p-3 rounded",{"bg-white":!e}),n={maxWidth:"75%"};return!0===e&&(n.backgroundColor="#8f8"),o.a.createElement("div",{className:t,style:n},this.content)}},{key:"renderInView",value:function(){return this.renderAsNote()}}]),n}(De);!function(e){e[e.start=0]="start",e[e.todo=10]="todo",e[e.doing=20]="doing",e[e.done=30]="done",e[e.verified=40]="verified",e[e.canceled=50]="canceled"}(Ie||(Ie={}));var _e={0:c.createElement(p.FA,{name:"bullhorn"}),10:c.createElement(p.FA,{name:"ellipsis-h"}),20:c.createElement(p.FA,{name:"circle-o-notch",className:"text-primary"}),30:c.createElement(p.FA,{name:"flag",className:"text-success"}),40:c.createElement(p.FA,{name:"check-circle-o",className:"text-waning"}),50:c.createElement(p.FA,{name:"times",className:"text-danger"})};var Be=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).assignId=void 0,e.caption=void 0,e.discription=void 0,e.time=void 0,e.x=0,e.onClick=function(){},e}return Object(b.a)(n,[{key:"renderAsNote",value:function(){return 1===this.x?o.a.createElement("div",{className:"w-100 d-flex justify-content-center"},o.a.createElement("div",{className:"bg-light py-1 px-3 small text-muted"},"\u64a4\u9500\u4e86 ",o.a.createElement("del",null,this.discription))):this.renderInternal()}},{key:"renderInView",value:function(){return this.renderInternal()}},{key:"renderInternal",value:function(){var e;return o.a.createElement("div",{className:"bg-info rounded border border-info w-75 cursor-pointer",onClick:this.onClick},o.a.createElement("div",{className:"d-flex align-items-center "},o.a.createElement("div",{className:"d-flex align-items-center justify-content-center text-danger w-3c h-3c  bg-white border-info rounded-left"},((e=void 0)||(e=0),_e[e])),o.a.createElement("div",{className:"flex-fill px-3 py-2 text-white"},o.a.createElement("div",null,o.a.createElement("b",null,this.caption)),o.a.createElement("div",null,o.a.createElement("span",{className:""},this.discription))),o.a.createElement("div",{className:"small px-3 py-1 text-light"},o.a.createElement(p.EasyTime,{date:this.$create}))))}}]),n}(De),qe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).taskId=void 0,e.caption=void 0,e.discription=void 0,e.time=void 0,e.owner=void 0,e.x=void 0,e.step=void 0,e.state=void 0,e.onClick=function(){},e}return Object(b.a)(n,[{key:"renderAsNote",value:function(){return 1===this.x?o.a.createElement("div",{className:"w-100 d-flex justify-content-center"},o.a.createElement("div",{className:"bg-light py-1 px-3 small text-muted"},"\u64a4\u9500\u4e86 ",o.a.createElement("del",null,this.discription))):this.renderInternal()}},{key:"renderInView",value:function(){return this.renderInternal()}},{key:"renderInternal",value:function(){var e;switch(this.step){default:e="\u672a\u77e5 "+this.step;break;case s.todo:e="\u9886\u529e";break;case s.done:e="\u5df2\u529e";break;case s.check:e="\u67e5\u9a8c";break;case s.rate:e="\u8bc4\u4ef7"}return o.a.createElement("div",{className:"border rounded px-3 py-1 text-muted bg-light cursor-pointer",onClick:this.onClick},o.a.createElement(p.FA,{className:"text-danger mr-1",name:"chevron-circle-right"}),o.a.createElement("span",{className:"text-success mr-3"},e),o.a.createElement("span",{className:"text-dark mr-1"},this.caption),o.a.createElement("small",{className:""},this.discription))}}]),n}(De);function ze(e,t,n){switch(t.type){default:throw new Error("unknow note type");case a.Text:return function(e,t,n){var r=new Ue(e),a=t.id,i=t.owner,s=t.content;return r.id=a,r.owner=i,r.$create=t.$create,r.content=s,r}(e,t);case a.Assign:return function(e,t,n){var r=new Be(e),a=t.id,i=t.owner,s=t.$create,c=t.obj;r.id=a,r.owner=i,r.$create=s;var o=n.assigns.find((function(e){return e.assignId===c}));if(void 0!==o){var u=o.assignId,l=o.caption,d=o.discription;r.assignId=u,r.caption=l,r.discription=d,r.x=t.x}return r}(e,t,n);case a.Task:return function(e,t,n){var r=new qe(e),a=t.id,i=t.owner,s=t.$create,c=t.content,o=t.obj;if(r.id=a,r.owner=i,r.$create=s,c){var u=c.split("|");r.step=Number(u[0]),r.state=Number(u[1])}var l=n.tasks.find((function(e){return e.taskId===o}));if(void 0!==l){var d=l.taskId,h=l.caption,f=l.discription;r.taskId=d,r.caption=h,r.discription=f,r.x=t.x}return r}(e,t,n)}}function We(e,t,n){var r=new Ue(e);return r.owner=t,r.content=n,r.$create=new Date,r}function Ge(e,t,n){var r=new Be(e);return r.owner=t,r.$create=new Date,r.assignId=n,r}var He,$e,Ke,Qe,Je,Ze,Xe,Ye,et,tt,nt,rt,at,it,st,ct,ot,ut,lt,dt,ht,ft,pt,vt,mt,bt,yt,kt,gt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).divTop=void 0,e.refTop=function(t){t&&(e.divTop=t.parentElement.previousElementSibling)},e.divBottom=void 0,e}return Object(b.a)(n,[{key:"scrollToTop",value:function(){var e=this;setTimeout((function(){var t;null===(t=e.divTop)||void 0===t||t.scrollIntoView()}),100)}},{key:"renderDivTop",value:function(){return o.a.createElement("div",{ref:this.refTop,style:{height:"0.01rem"}})}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){var t;null===(t=e.divBottom)||void 0===t||t.scrollIntoView()}),100)}},{key:"renderDivBottom",value:function(){var e=this;return o.a.createElement("div",{ref:function(t){return e.divBottom=t},style:{height:"0.01rem"}})}}]),n}(p.VPage),wt=(He=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(M.a)(e,"isFocused",$e,Object(D.a)(e)),Object(M.a)(e,"inputContent",Ke,Object(D.a)(e)),e.props=void 0,e.input=void 0,e.lostFocusTimeoutHandler=void 0,e.onKeyDown=function(t){13===t.keyCode&&e.onAddAction()},e.onBlur=function(t){e.lostFocusTimeoutHandler=setTimeout((function(){e.lostFocusTimeoutHandler=void 0,e.isFocused=!1}),200)},e.onInputChange=function(t){e.inputContent=e.input.value.trim()},e.inputRef=function(t){t&&"hidden"!==window.getComputedStyle(t).visibility&&(e.input=t,e.input.focus(),e.inputContent&&(e.input.value=e.inputContent))},e.onAddAction=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(clearTimeout(e.lostFocusTimeoutHandler),e.input){t.next=3;break}return t.abrupt("return");case 3:if(e.inputContent){t.next=5;break}return t.abrupt("return");case 5:e.input.disabled=!0,clearTimeout(e.lostFocusTimeoutHandler),(null===(n=e.props)||void 0===n?void 0:n.onAdd)&&e.props.onAdd(e.inputContent),e.input.value="",e.inputContent=void 0,e.input.disabled=!1,e.input.focus();case 12:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"render",value:function(e){var t=this;return this.props=e,o.a.createElement(Object(Pe.a)((function(){return!0===t.isFocused?o.a.createElement("div",{className:"d-flex p-3 align-items-center border-top"},o.a.createElement("input",{className:"flex-fill form-control mr-1 mb-0",type:"text",ref:t.inputRef,onBlur:t.onBlur,onKeyDown:t.onKeyDown,onChange:t.onInputChange}),o.a.createElement("button",{onClick:t.onAddAction,disabled:!t.inputContent,className:"btn btn-success"},o.a.createElement(p.FA,{name:"plus"}))):o.a.createElement("div",{className:"p-3 border-top cursor-pointer",onClick:function(){return t.isFocused=!0}},o.a.createElement(p.FA,{className:"mr-3 text-success",name:"plus"}),t.props.caption)})))}}]),n}(p.View),$e=Object(U.a)(He.prototype,"isFocused",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ke=Object(U.a)(He.prototype,"inputContent",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He),Ot=(Qe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(M.a)(e,"endItemsVisible",Je,Object(D.a)(e)),e.onToggleEndItems=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==e.endItemsVisible){t.next=5;break}e.endItemsVisible=!1,e.controller.endListItems=void 0,t.next=8;break;case 5:return e.endItemsVisible=!0,t.next=8,e.controller.loadEndItems();case 8:case"end":return t.stop()}}),t)}))),e.keyAssign=function(e){return e.assign.id},e.onClickAssign=function(t){e.controller.showAssign(t.assign)},e.renderAssignItem=function(t,n){return e.renderAssignItemBase(t,!1)},e.renderEndItem=function(t,n){return e.renderAssignItemBase(t,!0)},e}return Object(b.a)(n,[{key:"header",value:function(){return this.controller.caption}},{key:"content",value:function(){var e=this,t=Object(Pe.a)((function(){var t=e.controller.assignListItems;return o.a.createElement(o.a.Fragment,null,e.renderDivTop(),e.renderList("\u5f85\u529e",e.renderAssignItem,t),e.renderEndItems(),e.renderDivBottom())}));return o.a.createElement(t)}},{key:"renderList",value:function(e,t,n){var r=o.a.createElement("div",{className:"px-3 py-3 text-muted small border-top border-bottom d-flex align-items-center"},o.a.createElement(p.FA,{className:"text-warning mr-3",name:"circle-thin"}),"\u65e0",e,"\u4efb\u52a1");return o.a.createElement(p.List,{className:"bg-transparent mb-3",items:n,item:{render:t,onClick:this.onClickAssign,key:this.keyAssign,className:"bg-transparent"},none:r})}},{key:"renderEndItems",value:function(){var e=this,t=function(t){return o.a.createElement("button",{className:"btn btn-info mx-3 my-2",onClick:e.onToggleEndItems},o.a.createElement(p.FA,{className:"mr-2",name:t})," \u5df2\u5b8c\u6210")};return!1===this.endItemsVisible?t("chevron-right"):o.a.createElement(o.a.Fragment,null,t("chevron-down"),this.renderList("\u5b8c\u6210",this.renderEndItem,this.controller.endListItems))}},{key:"footer",value:function(){var e=this,t={onAdd:function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.newAssign(n);case 2:e.scrollToTop();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),caption:"\u65b0\u589e\u4efb\u52a1"};return this.renderVm(wt,t)}},{key:"renderAssignItemBase",value:function(e,t){var n,r,a,i=e.assign;return!0===t?(n="check-circle-o",r="text-warning",a="text-muted"):(n="circle-o",r="text-info"),Object(p.tv)(i,(function(e){var t=e.caption;return o.a.createElement("div",{className:"px-3 bg-white align-items-center"},o.a.createElement("div",{className:"py-3"},o.a.createElement(p.FA,{className:"mr-3 "+r,name:n,size:"lg",fixWidth:!0})),o.a.createElement("div",{className:"py-2 "+a},o.a.createElement("div",null,t)))}))}}]),n}(gt),Je=Object(U.a)(Qe.prototype,"endItemsVisible",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qe),jt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return n}(Ot),xt=n(17),Et=n(16),Ct=(Ze=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(M.a)(e,"disabled",Xe,Object(D.a)(e)),e.inputText=void 0,e.props=void 0,e.onEditInfo=function(){e.disabled=!0,e.openPageElement(o.a.createElement(Object(Pe.a)((function(){var t=function(){var t=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==e.disabled){t.next=2;break}return t.abrupt("return");case 2:return n=e.inputText.trim(),t.next=5,e.props.onUpdate(n);case 5:e.closePage();case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",disabled:e.disabled,onClick:t},"\u4fdd\u5b58");return o.a.createElement(p.Page,{header:"\u8bf4\u660e",back:"close",right:n},o.a.createElement("div",{className:"p-3"},o.a.createElement("input",{className:"form-control",type:"text",onChange:function(t){e.inputText=t.target.value,e.disabled=e.props.content===e.inputText},onKeyDown:function(e){13===e.keyCode&&t()},defaultValue:e.props.content})))}))))},e}return Object(b.a)(n,[{key:"render",value:function(e){return this.props=e,this.inputText=this.props.content,o.a.createElement("div",{className:"p-2 cursor-pointer",onClick:this.onEditInfo},o.a.createElement(p.FA,{name:Fe()("pencil-square-o",this.props.color)}))}}]),n}(p.View),Xe=Object(U.a)(Ze.prototype,"disabled",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ze),Nt=(Ye=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e,r){var a;return Object(m.a)(this,n),a=t.call(this,e),Object(M.a)(a,"disabled",et,Object(D.a)(a)),a.inputText=void 0,a.props=void 0,a.onUpdate=function(){a.disabled=!0,a.openPageElement(o.a.createElement(Object(Pe.a)((function(){var e=function(){var e=Object(f.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==a.disabled){e.next=2;break}return e.abrupt("return");case 2:return t=a.inputText.trim(),e.next=5,a.props.onUpdate(t);case 5:a.closePage();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",disabled:a.disabled,onClick:e},"\u4fdd\u5b58");return o.a.createElement(p.Page,{header:a.props.header,back:"close",right:t},o.a.createElement("div",{className:"p-3"},o.a.createElement("input",{className:"form-control",type:"text",onChange:function(e){a.inputText=e.target.value,a.disabled=a.props.content===a.inputText},onKeyDown:function(t){13===t.keyCode&&e()},defaultValue:a.props.content})))}))))},a.props=r,a.inputText=a.props.content,a}return Object(b.a)(n,[{key:"render",value:function(e){return this.props=e,this.inputText=this.props.content,o.a.createElement(o.a.Fragment,null)}}]),n}(p.View),et=Object(U.a)(Ye.prototype,"disabled",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye),At=o.a.createElement(p.FA,{name:"square-o",className:"text-danger small"}),Tt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).assign=void 0,e}return Object(b.a)(n,[{key:"init",value:function(e){this.assign=this.controller.assign,Object(p.useUser)(this.assign.owner)}},{key:"header",value:function(){return"\u4efb\u52a1\u8be6\u60c5"}},{key:"renderCaption",value:function(){var e=this.assign,t=e.caption,n=1===e.end?"check-circle-o":"circle-o";return o.a.createElement("div",{className:"bg-white p-3 d-flex align-items-center"},o.a.createElement(p.FA,{className:"mr-3 text-success",name:n,size:"lg"}),o.a.createElement("b",null,t))}},{key:"renderFrom",value:function(){var e,t=this.assign,n=t.owner,r=t.$create,a=t.$update;return a.getTime()-r.getTime()>216e5&&(e=o.a.createElement(o.a.Fragment,null,o.a.createElement(p.Muted,null,"\u66f4\u65b0:")," ",o.a.createElement(p.EasyTime,{date:a}))),o.a.createElement("div",{className:"d-flex px-3 py-2 border-top bg-white align-items-center text-muted"},o.a.createElement("small",null,this.renderUser(n)),o.a.createElement("span",{className:"mr-3 small"},"\u521b\u5efa\u4e8e",o.a.createElement(p.EasyTime,{date:r})," ",e))}},{key:"renderDiscription",value:function(){var e=this.assign.discription;if(e){var t=e.split("\n");return o.a.createElement("div",{className:"bg-white px-3 py-2 border-top"},t.map((function(e,t){return o.a.createElement("div",{key:t,className:"py-2"},e)})))}}},{key:"renderAssignItem",value:function(e){var t=this,n=this.isMe(this.assign.owner),r=e.id,a=e.discription,i=e.x,s=void 0;if(n){var c=1===i?"undo":"minus-circle",u=1===i?"text-success":"text-danger",l={onUpdate:function(){var n=Object(f.a)(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.controller.setAssignItemContent(e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),content:a,header:"\u7f16\u8f91\u4e8b\u9879"},d=new Nt(this.controller,l);s=o.a.createElement(o.a.Fragment,null,1===i?o.a.createElement("del",{className:"flex-fill ml-3"},a):o.a.createElement("div",{className:"flex-fill ml-3 cursor-ponter",onClick:d.onUpdate},a),o.a.createElement("div",{className:"p-2 cursor-pointer",onClick:function(){t.controller.setAssignItemFlag(e,1===i?0:1)}},o.a.createElement(p.FA,{name:c,className:u})))}else s=1===i?o.a.createElement("del",{className:"flex-fill ml-3"},a):o.a.createElement("div",{className:"flex-fill ml-3"},a);return o.a.createElement("div",{key:r,className:"pl-5 pr-3 py-2 d-flex align-items-center bg-white border-top"},o.a.createElement("small",null,o.a.createElement(p.FA,{name:"circle",className:"text-primary",fixWidth:!0})),s)}},{key:"renderTodoWithCheck",value:function(e,t,n,r){return o.a.createElement("label",{key:e,className:"px-3 py-2 m-0 d-flex align-items-center bg-white border-top cursor-point"},o.a.createElement("input",{type:"checkbox",onChange:function(e){n&&n(e.target.checked)},defaultChecked:r}),o.a.createElement("div",{className:"flex-fill ml-3"},t))}},{key:"renderAssignItems",value:function(){var e=this;return this.controller.assign.items.map((function(t,n){return e.renderAssignItem(t)}))}},{key:"renderTodos",value:function(){var e=this,t=this.controller.assign.tasks.find((function(t){return e.isMe(t.worker)}));if(!t)return this.renderAssignItems();var n=t.todos;return o.a.createElement("div",{className:"border-top border-bottom"},o.a.createElement("div",{className:"border-bottom bg-light small py-1 px-3 text-muted"},"\u4e8b\u9879"),n.map((function(t,n){return e.renderTodo(t,n)})))}},{key:"renderTodo",value:function(e,t){var n=this,r=e.id,a=e.discription,i=e.done,s=e.doneMemo,c=e.x,u=function(){var t=Object(f.a)(h.a.mark((function t(r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.controller.saveTodoDone(e,r?1:0);case 2:return t.abrupt("return");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=1===c?"undo":"minus-circle",d=1===c?"text-success":"text-danger",v={onUpdate:function(){var t=Object(f.a)(h.a.mark((function t(r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.controller.saveTodoContent(e,r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),content:a,header:"\u7f16\u8f91\u4e8b\u9879"},m=new Nt(this.controller,v);return o.a.createElement("div",{className:"d-flex bg-white "},o.a.createElement("label",{key:r,className:"flex-grow-1 px-3 py-2 m-0 d-flex cursor-point"},o.a.createElement("input",{className:"mt-1 mr-3",type:"checkbox",onChange:function(e){u&&u(e.target.checked)},defaultChecked:1===i,disabled:1===c}),o.a.createElement("div",{className:"flex-grow-1"},1===c?o.a.createElement("del",{className:""},a):o.a.createElement("div",{className:"cursor-pointer",onClick:function(e){e.preventDefault(),m.onUpdate()}},a),1!==c&&s&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},s)))),1!==c&&this.renderMemo(e),o.a.createElement("div",{className:"p-2 cursor-pointer",onClick:function(){n.controller.setTodoFlag(e,1===c?0:1)}},o.a.createElement(p.FA,{name:l,className:d})))}},{key:"renderMemo",value:function(e){var t=this,n={onUpdate:function(){var n=Object(f.a)(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.controller.saveTodoDoneMemo(e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),content:e.doneMemo,color:"text-info"};return this.renderVm(Ct,n)}},{key:"renderTaskItem",value:function(e){var t=e.state,n=e.actionTime,r=C(t).me;return o.a.createElement(o.a.Fragment,null,r," ",o.a.createElement(p.EasyTime,{date:n}))}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(Pe.a)((function(){return e.renderContent()})))}},{key:"renderContent",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderFrom(),this.renderCaption(),this.renderDiscription(),this.renderTodos())}}]),n}(gt),It=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).editDiscription=function(){var t,n=function(){var n=Object(f.a)(h.a.mark((function n(){var r;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.value,n.next=3,e.controller.saveAssignDiscription(r);case 3:e.assign.discription=r,e.closePage();case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r=o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",onClick:n},"\u4fdd\u5b58"),a=e.assign.discription;e.openPageElement(o.a.createElement(p.Page,{header:"\u8bf4\u660e",right:r},o.a.createElement("div",{className:"m-3 border"},o.a.createElement("textarea",{ref:function(e){return t=e},className:"w-100 border-0 form-control",rows:8,defaultValue:a}))))},e}return Object(b.a)(n,[{key:"renderContent",value:function(){return o.a.createElement(o.a.Fragment,null,Object(xt.a)(Object(Et.a)(n.prototype),"renderContent",this).call(this),o.a.createElement("div",{className:"pt-3"},this.renderDraft()))}},{key:"renderSelfDone",value:function(){return o.a.createElement("div",{className:"px-3 py-2 border-top bg-white cursor-pointer",onClick:this.controller.selfDone},o.a.createElement(p.FA,{className:"mr-3 text-danger",name:"chevron-circle-right",fixWidth:!0})," ",this.selfDoneCaption)}},{key:"renderDraft",value:function(){return this.renderSelfDone()}},{key:"renderDiscription",value:function(){var e=this;return o.a.createElement(Object(Pe.a)((function(){var t,r=e.assign.discription,a=e.controller.isMyAssign;return r?(!0===a&&(t=o.a.createElement("div",{className:"small muted pt-2 pb-1 px-3 cursor-pointer",onClick:e.editDiscription},"\u8bf4\u660e ",o.a.createElement(p.FA,{name:"pencil-square-o ml-3"}))),o.a.createElement("div",null,t,Object(xt.a)(Object(Et.a)(n.prototype),"renderDiscription",e).call(e))):a?o.a.createElement("div",{className:"bg-white border-top px-3 py-2 cursor-pointer",onClick:e.editDiscription},o.a.createElement(p.FA,{className:"mr-3",name:"pencil-square-o"})," ",o.a.createElement(p.Muted,null,"\u6dfb\u52a0\u8bf4\u660e")):void 0})))}},{key:"footer",value:function(){var e=this;if(!this.controller.isMyAssign)return null;var t={onAdd:function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveAssignItem(n);case 2:return e.scrollToTop(),t.abrupt("return");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),caption:"\u6dfb\u52a0\u4e8b\u9879"};return this.renderVm(wt,t)}},{key:"selfDoneCaption",get:function(){return"\u81ea\u5df1\u5b8c\u6210"}}]),n}(Tt),St=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderTodos",value:function(){var e=this,t=this.controller.assign.tasks.find((function(t){return e.isMe(t.worker)}));return t?t.todos.map((function(e,t){var n,r,a=e.assignItem,i=e.discription,s=e.id;return a?(n="text-primary",r="circle"):(n="text-info",r="circle-o"),o.a.createElement("div",{key:s,className:"px-3 py-2 d-flex align-items-center bg-white border-top"},o.a.createElement("small",null,o.a.createElement("small",null,o.a.createElement(p.FA,{name:r,className:n,fixWidth:!0}))),o.a.createElement("div",{className:"flex-fill ml-3"},i))})):Object(xt.a)(Object(Et.a)(n.prototype),"renderTodos",this).call(this)}}]),n}(Tt),Pt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderAssignItem",value:function(e){}},{key:"footer",value:function(){var e=this,t={onAdd:function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveTodoItem(n);case 2:e.scrollToTop();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),caption:"\u6dfb\u52a0\u6211\u7684\u4efb\u52a1\u4e8b\u9879"};return this.renderVm(wt,t)}},{key:"selfDoneCaption",get:function(){return"\u5b8c\u6210"}}]),n}(It),Rt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderContent",value:function(){var e=this.assign.tasks[0];return o.a.createElement(o.a.Fragment,null,Object(xt.a)(Object(Et.a)(n.prototype),"renderContent",this).call(this),o.a.createElement("div",{className:"mt-3 px-3 py-2 bg-white"},this.renderTaskItem(e),o.a.createElement("span",{className:"mx-3"},At)))}},{key:"selfDoneCaption",get:function(){return"\u5b8c\u6210"}}]),n}(St),Vt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.controller.showGroupDetail},o.a.createElement(p.FA,{name:"ellipsis-h"}))}}]),n}(Ot),Ft=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderAssignItem",value:function(e){var t=e.id,n=e.discription;return o.a.createElement("div",{className:"pl-4 bg-white"},this.renderTodoWithCheck(t,n,(function(e){}),!1))}},{key:"footer",value:function(){var e=this,t={onAdd:function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveTodoItem(n);case 2:e.scrollToTop();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),caption:"\u6dfb\u52a0\u6211\u7684\u4efb\u52a1\u4e8b\u9879"};return this.renderVm(wt,t)}},{key:"renderContent",value:function(){return Object(xt.a)(Object(Et.a)(n.prototype),"renderContent",this).call(this)}},{key:"selfDoneCaption",get:function(){return"\u5b8c\u6210"}}]),n}(It),Lt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"selfDoneCaption",get:function(){return"\u5b8c\u6210"}}]),n}(St),Mt=n(20),Dt=n.n(Mt),Ut=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).task=void 0,e.rendTodoListItem=function(t,n){return 1===t.x?null:e.renderTodo(t,n)},e}return Object(b.a)(n,[{key:"init",value:function(e){Object(xt.a)(Object(Et.a)(n.prototype),"init",this).call(this),this.task=e}},{key:"afterAct",value:function(){this.closePage(2),this.controller.showAssign()}},{key:"renderContent",value:function(){return o.a.createElement("div",{className:"m-3"},o.a.createElement("div",{className:"border rounded"},this.renderCaption(),this.renderDiscription(),this.renderTodos()),this.renderMore())}},{key:"renderTodos",value:function(){if(!this.task)return this.renderAssignItems();var e=this.task.todos;return 0!==e.length?o.a.createElement("div",{className:"border-top border-bottom"},o.a.createElement("div",{className:"border-bottom bg-light small py-1 px-3 text-muted"},"\u4e8b\u9879"),o.a.createElement(p.List,{items:e,item:{render:this.rendTodoListItem}})):void 0}},{key:"renderTodo",value:function(e,t){var n=e.discription,r=e.doneMemo,a=e.checkMemo;return o.a.createElement("div",{className:"py-2 d-flex"},o.a.createElement("div",{className:"mx-3"},this.renderTodoDot(e)),o.a.createElement("div",{className:"flex-fill"},o.a.createElement("div",{className:"d-flex"},o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:"flex-fill"},n),r&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},r)),a&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comments-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},a))))))}},{key:"renderTodoRadio",value:function(e){return o.a.createElement(o.a.Fragment,null)}},{key:"renderMemoBase",value:function(e,t,n,r){if(e)return o.a.createElement("div",{className:"mt-1"},o.a.createElement("span",{className:"small text-"+t},o.a.createElement("span",{className:"mr-3"},o.a.createElement(p.FA,{className:"mr-1",name:n}),o.a.createElement("span",{className:"text-muted"},r)),e))}},{key:"renderTodoDot",value:function(e){var t,n;return e.assignItem?(n="circle",t="text-black"):(n="circle",t="text-primary"),o.a.createElement("small",null,o.a.createElement("small",null,o.a.createElement(p.FA,{name:n,className:t,fixWidth:!0})))}},{key:"back",get:function(){return"close"}}]),n}(Tt),_t=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).done=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=0,!e.task){t.next=6;break}return t.next=4,e.controller.doneTask(e.task.id,n,void 0);case 4:t.next=8;break;case 6:return t.next=8,e.controller.doneAssign(n,void 0);case 8:e.afterAct();case 9:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"header",value:function(){return"\u5b8c\u6210"}},{key:"renderMore",value:function(){var e=this.calcEnabled(this.task.todos);return o.a.createElement("div",{className:"mt-3 text-center"},o.a.createElement("button",{className:"btn btn-success",onClick:this.done,disabled:!e},"\u786e\u8ba4\u5b8c\u6210"))}},{key:"calcEnabled",value:function(e){if(void 0===e||0===e.length)return!0;var t,n=Object(Q.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value.done;if(void 0===r||0===r)return!1}}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"renderTodo",value:function(e,t){var n=this,r=e.id,a=e.discription,i=e.done,s=e.doneMemo,c=function(){var t=Object(f.a)(h.a.mark((function t(r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.controller.saveTodoDone(e,r?1:0);case 2:return t.abrupt("return");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return o.a.createElement("div",{className:"d-flex"},o.a.createElement("label",{key:r,className:"flex-grow-1 px-3 py-2 m-0 d-flex bg-white cursor-point"},o.a.createElement("input",{className:"mt-1 mr-3",type:"checkbox",onChange:function(e){c&&c(e.target.checked)},defaultChecked:1===i}),o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:""},a),s&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},s)))),this.renderMemo(e))}},{key:"renderMemo",value:function(e){var t=this,n={onUpdate:function(){var n=Object(f.a)(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.controller.saveTodoDoneMemo(e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),content:e.doneMemo,color:"text-info"};return this.renderVm(Ct,n)}},{key:"renderAssignItem",value:function(e){var t=e.id,n=e.discription;return this.renderTodoWithCheck(t,n,(function(e){}),!1)}}]),n}(Ut),Bt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).pass=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 0,t.next=3,e.controller.passTask(e.task.id,0,void 0);case 3:e.afterAct();case 4:case"end":return t.stop()}}),t)}))),e.fail=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.failTask(e.task.id,void 0);case 2:e.afterAct();case 3:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"header",value:function(){return"\u67e5\u9a8c"}},{key:"calcEnabled",value:function(e){if(void 0===e||0===e.length)return!0;var t,n=Object(Q.a)(e);try{for(n.s();!(t=n.n()).done;){if(void 0===t.value.check)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}},{key:"renderMore",value:function(){var e=this.calcEnabled(this.task.todos);return o.a.createElement("div",{className:"mt-3 d-flex"},o.a.createElement("button",{className:"btn btn-success mx-auto px-4",onClick:this.pass,disabled:!e},o.a.createElement(p.FA,{className:"mr-2",name:"check"})," \u9a8c\u6536"),o.a.createElement("button",{className:"btn btn-outline-danger",onClick:this.fail},o.a.createElement(p.FA,{name:"times"})," \u62d2\u7b7e"))}},{key:"renderTodos",value:function(){return Object(xt.a)(Object(Et.a)(n.prototype),"renderTodos",this).call(this)}},{key:"renderTodo",value:function(e,t){var n=e.id,r=e.discription,a=e.doneMemo,i=e.checkMemo;return o.a.createElement("div",{className:"d-flex"},o.a.createElement("label",{key:n,className:"flex-grow-1 px-3 py-2 m-0 d-flex bg-white cursor-point"},o.a.createElement("div",{className:"mx-3"},this.renderTodoDot(e)),o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:""},r),a&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},a)),i&&o.a.createElement("div",{className:"mt-1 small"},o.a.createElement(p.FA,{name:"comments-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},i))),this.renderTodoRadio(e)),this.renderCheckMemo(e))}},{key:"renderTodoRadio",value:function(e){var t=this,n=e.id,r=e.check,a=function(){var n=Object(f.a)(h.a.mark((function n(r){var a;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=Number(r.target.value),n.next=3,t.controller.saveTodoCheck(e,a);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return o.a.createElement("div",null,[{val:1,text:"\u9a8c\u6536"},{val:0,text:"\u62d2\u7b7e"}].map((function(e,t){var i=e.val,s=e.text;return o.a.createElement("label",{key:t,className:"mb-0 mx-3"},o.a.createElement("input",{className:"mr-1",type:"radio",value:i,defaultChecked:r===i,name:"rg"+n,onChange:a}),s)})))}},{key:"renderCheckMemo",value:function(e){var t=this,n={onUpdate:function(){var n=Object(f.a)(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.controller.saveTodoCheckMemo(e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),content:e.checkMemo,color:"text-info"};return this.renderVm(Ct,n)}}]),n}(Ut),qt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).done=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 0,t.next=3,e.controller.rateTask(e.task.id,0,void 0);case 3:e.afterAct();case 4:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"header",value:function(){return"\u8bc4\u4ef7"}},{key:"renderMore",value:function(){return o.a.createElement("div",{className:"mt-3 text-center"},o.a.createElement("button",{className:"btn btn-success",onClick:this.done},"\u8bc4\u4ef7"))}},{key:"renderTodoRadio",value:function(e){var t=1===e.check?"\u9a8c\u6536":"\u62d2\u7b7e";return o.a.createElement("div",{className:"mb-0 mx-3"},t)}}]),n}(Ut),zt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"header",value:function(){return"\u4efb\u52a1\u8fc7\u7a0b"}},{key:"renderFrom",value:function(){}},{key:"renderMore",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"d-flex mx-3 mt-3 mb-1 align-items-center"},this.renderUser(this.task.worker)),this.renderFlows())}},{key:"renderFlows",value:function(){var e=this,t=this.task,n=t.flows,r=t.worker;return n.map((function(t,n){var a=t.date,i=t.user,c=t.state,u=t.act,l=C(c).me,d=function(e){switch(e){default:return"";case s.todo:return"\u529e\u7406";case s.done:return"\u5b8c\u6210";case s.check:return"\u67e5\u9a8c";case s.rate:return"\u8bc4\u4ef7"}}(u);return o.a.createElement("div",{key:n,className:"px-3 py-2 d-flex align-items-center"},o.a.createElement("span",{className:"mr-3 w-8c text-warning"},o.a.createElement(p.FA,{name:"angle-double-right",className:"mr-1",fixWidth:!0}),o.a.createElement("span",{className:"small text-muted"},o.a.createElement(p.EasyTime,{date:a,always:!0}))),o.a.createElement("span",{className:"mr-3 text-success"},l),i!==r&&o.a.createElement(o.a.Fragment,null,e.renderUser(i),o.a.createElement("span",{className:"mr-3"}),d&&o.a.createElement("span",{className:"mr-3 text-info"},d)))}))}}]),n}(Ut),Wt=(tt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).performance=void 0,Object(M.a)(e,"assign",nt,Object(D.a)(e)),Object(M.a)(e,"assignListItems",rt,Object(D.a)(e)),Object(M.a)(e,"endListItems",at,Object(D.a)(e)),e.showList=Object(f.a)(h.a.mark((function t(){var n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={group:e.groupId,end:0},t.next=3,e.performance.GetAssigns.query(n,!0);case 3:r=t.sent,e.assignListItems=r.ret,e.openVList();case 6:case"end":return t.stop()}}),t)}))),e.showAssign=function(){var t=Object(f.a)(h.a.mark((function t(n){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n,n||(r=e.assign.id),t.next=4,e.loadAssign(r);case 4:e.openVAssign();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showFlowDetail=function(){var t=Object(f.a)(h.a.mark((function t(n){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uqs.performance.GetTaskFlow.query({taskId:n.id},!0);case 2:r=t.sent,n.flows=r.ret,e.openVPage(zt,n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.newAssign=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i,s,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={group:e.groupId,caption:n},a=e.performance.CreateAssign,t.next=4,a.submit(r);case 4:i=t.sent,s=i.id,c=e.performance.Assign.boxId(s),e.assignListItems.unshift({assign:c});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.saveAssignItem=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={id:void 0,assign:e.assign.id,discription:n,x:0},t.next=3,e.performance.AssignItem.save(void 0,r);case 3:return a=t.sent,r.id=a.id,e.assign.items.push({id:a.id,discription:n,x:0}),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setAssignItemFlag=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.AssignItem.saveProp(n.id,"x",r);case 2:n.x=r;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.setAssignItemContent=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.AssignItem.saveProp(n.id,"discription",r);case 2:n.discription=r;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.selfDone=Object(f.a)(h.a.mark((function t(){var n,r,a,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.assign.tasks,!(r=n.find((function(t){return e.isMe(t.worker)})))){t.next=6;break}e.openVPage(_t,r),t.next=15;break;case 6:return(a=[]).push({to:e.user.id}),i={assignId:e.assign.id,toList:a},t.next=11,e.uqs.performance.SendAssign.submit(i);case 11:return t.next=13,e.loadAssign(e.assign.id);case 13:e.backPage(),e.openVAssign();case 15:case"end":return t.stop()}}),t)}))),e.showDone=Object(f.a)(h.a.mark((function t(){var n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.assign.tasks,r=n.find((function(t){return e.isMe(t.worker)})),e.openVPage(_t,r);case 3:case"end":return t.stop()}}),t)}))),e.setTodoFlag=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.Todo.saveProp(n.id,"x",r);case 2:n.x=r;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.saveTodoContent=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.Todo.saveProp(n.id,"discription",r);case 2:n.discription=r;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.saveTodoDone=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.id,t.next=3,e.performance.Todo.saveProp(a,"done",r);case 3:n.done=r;case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.saveTodoDoneMemo=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.id,t.next=3,e.performance.Todo.saveProp(a,"donememo",r);case 3:n.doneMemo=r;case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.saveTodoCheck=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.id,t.next=3,e.performance.Todo.saveProp(a,"check",r);case 3:n.check=r;case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.saveTodoCheckMemo=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.id,t.next=3,e.performance.Todo.saveProp(a,"checkmemo",r);case 3:n.checkMemo=r;case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.meAct=Object(f.a)(h.a.mark((function t(){var n,r,a,s,c,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.assign.tasks.find((function(t){return!0===e.isMe(t.worker)}))){t.next=4;break}return alert("task cannot be undefined"),t.abrupt("return");case 4:r=n.state,a=e.assign,s=a.checker,c=a.rater,t.t0=r,t.next=t.t0===i.start||t.t0===i.todo||t.t0===i.doing?11:t.t0===i.done?13:t.t0===i.pass?15:9;break;case 9:return alert("unkown state "+r),t.abrupt("return");case 11:return o=_t,t.abrupt("break",17);case 13:return s>0?o=Bt:c>0&&(o=qt),t.abrupt("break",17);case 15:return c>0&&(o=qt),t.abrupt("break",17);case 17:e.openVPage(o,n);case 18:case"end":return t.stop()}}),t)}))),e.doneAssign=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.DoneAssign.submit({assign:e.assign.id,point:n,comment:r});case 2:a=t.sent,e.afterAct(a);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.doneTask=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){var i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.DoneTask.submit({task:n,point:r,comment:a});case 2:i=t.sent,e.afterAct(i);case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.passTask=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){var i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.PassTask.submit({task:n,point:r,comment:a});case 2:i=t.sent,e.afterAct(i);case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.failTask=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.FailTask.submit({task:n,comment:r});case 2:a=t.sent,e.afterAct(a);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.rateTask=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){var i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.RateTask.submit({task:n,point:r,comment:a});case 2:i=t.sent,e.afterAct(i);case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(e){this.performance=this.uqs.performance}},{key:"loadEndItems",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={group:this.groupId,end:1},e.next=3,this.performance.GetAssigns.query(t,!0);case 3:n=e.sent,this.endListItems=n.ret;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadAssign",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,a,i,s,c,o,u,l,d,f;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.GetAssign.query({assignId:t},!0);case 2:n=e.sent,r=n.assign,a=n.items,i=n.tasks,s=n.todos,c=n.tolist,o={items:a,tasks:i,toList:c},Dt.a.mergeWith(o,r[0]),(u=o.discription)&&(o.discription=u.replace(/\\n/g,"\n")),l=Object(Q.a)(i);try{for(f=function(){var e=d.value;e.todos=s.filter((function(t){return t.task===e.id}));var t,n=Object(Q.a)(e.todos);try{var r=function(){var e=t.value,n=e.assignItem,r=e.discription;if(n&&!r){var i=a.find((function(e){return e.id===n}));i&&(e.discription=i.discription)}};for(n.s();!(t=n.n()).done;)r()}catch(i){n.e(i)}finally{n.f()}},l.s();!(d=l.n()).done;)f()}catch(h){l.e(h)}finally{l.f()}this.assign=o,this.onAssignLoaded();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAssignLoaded",value:function(){}},{key:"saveAssignDiscription",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.Assign.saveProp(this.assign.id,"discription",t);case 2:this.assign.discription=t;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTaskAction",value:function(e){var t=this.assign,n=t.checker,r=t.rater;switch(e){case i.start:case i.todo:case i.doing:return I;case i.done:return n?!0===this.isMe(n)?S:void 0:r&&this.isMe(r)?P:void 0;case i.pass:return r&&this.isMe(r)?P:void 0;case i.fail:case i.rated:case i.cancel:return}}},{key:"afterAct",value:function(e){if(0!==e.end){var t=this.assign.id,n=this.assignListItems.findIndex((function(e){return p.Tuid.equ(e.assign,t)}));if(!(n<0)){if(this.assignListItems.splice(n,1),this.endListItems){var r=this.assignListItems[n];this.endListItems.unshift(r)}this.cApp.addGroupAssignCount(this.groupId,-1)}}}},{key:"isMyAssign",get:function(){var e;return this.isMe(null===(e=this.assign)||void 0===e?void 0:e.owner)}}]),n}(w),nt=Object(U.a)(tt.prototype,"assign",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt=Object(U.a)(tt.prototype,"assignListItems",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=Object(U.a)(tt.prototype,"endListItems",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(U.a)(tt.prototype,"isMyAssign",[_.g],Object.getOwnPropertyDescriptor(tt.prototype,"isMyAssign"),tt.prototype),tt),Gt=(it=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e,r=this;Object(m.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).groupMembersPager=void 0,e.onItemChanged=function(){var t=Object(f.a)(h.a.mark((function t(n,r,a){var i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.controller.group,s={id:i.id},t.t0=n.name,t.next="name"===t.t0?5:"discription"===t.t0?7:9;break;case 5:return i.name=s.name=r,t.abrupt("break",9);case 7:return i.discription=s.discription=r,t.abrupt("break",9);case 9:return t.next=11,e.controller.saveGroupProp(s);case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.onMember=function(t){e.controller.cApp.showMemberDetail(t)},e.renderMember=function(t){var n="object"===typeof t?t.id:t;return c.createElement("div",{key:n,className:"m-2 cursor-pointer",onClick:function(){return e.onMember(n)}},c.createElement(p.UserView,{id:n,render:function(e){var t=e.name,r=e.nick;return c.createElement(c.Fragment,null,c.createElement("div",{className:"w-3c h-3c rounded border "},c.createElement(p.UserIcon,{id:n,className:"w-100 h-100 rounded"})),c.createElement("div",{className:"w-3c d-inline-block text-truncate small text-muted text-center"},c.createElement("small",null,r||t)))}}))},e.onSubmitAddMember=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.userApi.fromKey(r.data.user);case 2:if(a=t.sent){t.next=6;break}return r.setError("user","\u8d26\u53f7\u4e0d\u5b58\u5728\u6216\u8005\u4e0d\u63a5\u53d7\u9080\u8bf7"),t.abrupt("return");case 6:return t.next=8,e.controller.groupAddMember(a);case 8:Object(p.useUser)(a.id),e.groupMembersPager.items.push({member:a.id}),e.closePage();case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.onAddMember=function(){e.openPageElement(c.createElement(p.Page,{header:"\u6dfb\u52a0\u6210\u5458"},c.createElement(p.Form,{onButtonClick:e.onSubmitAddMember,onEnter:e.onSubmitAddMember,className:"m-5 px-5 py-3 bg-white",schema:[{name:"user",type:"string",maxLength:100,required:!0},{name:"submit",type:"submit"}],uiSchema:{items:{user:{widget:"text",label:"\u6210\u5458",placeholder:"\u8bf7\u8f93\u5165\u6210\u5458\u8d26\u53f7"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-primary"}}}})))},Object(M.a)(e,"disabled",st,Object(D.a)(e)),e.listRemoveMember=void 0,e.renderRemoveButton=Object(Pe.a)((function(){return c.createElement("button",{onClick:e.onRemoveMemberList,className:"btn btn-sm btn-success mr-2 align-self-center",disabled:e.disabled},"\u5220\u9664")})),e.renderRemoveMemberItem=function(e,t){var n=e.member,r="object"===typeof n?n.id:n;return c.createElement(p.UserView,{id:r,render:function(e){var t=e.name,n=e.nick;return c.createElement("div",{className:"d-flex align-items-center py-2"},c.createElement("div",{className:"w-3c h-3c rounded border mx-3"},c.createElement(p.UserIcon,{id:r,className:"w-100 h-100 rounded"})),c.createElement("div",{className:""},n||t))}})},e.onRemoveMemberList=Object(f.a)(h.a.mark((function t(){var n,r,a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.listRemoveMember.selectedItems,t.next=3,e.controller.groupRemoveMembers(n);case 3:r=e.groupMembersPager.items,a=Object(Q.a)(n);try{for(s=function(){var e=i.value,t=r.findIndex((function(t){return t.member===e.member}));t>=0&&r.splice(t,1)},a.s();!(i=a.n()).done;)s()}catch(c){a.e(c)}finally{a.f()}e.closePage();case 7:case"end":return t.stop()}}),t)}))),e.onSelectRemoveMember=function(t,n,r){e.disabled=!1===r},e.onRemoveMember=function(){e.openPageElement(c.createElement(p.Page,{header:"\u6210\u5458",right:c.createElement(r.renderRemoveButton,null)},c.createElement(p.List,{ref:function(t){return e.listRemoveMember=t},items:e.groupMembersPager.items,item:{render:e.renderRemoveMemberItem,onSelect:e.onSelectRemoveMember}})))},e.renderMemberAction=function(t,n){var r=e.controller,a=r.group,i=r.user;if(!1!==p.Tuid.equ(a.owner,i.id))return c.createElement("div",{onClick:n,className:"d-flex m-2 w-3c h-3c rounded border text-muted justify-content-center align-items-center cursor-pointer"},c.createElement(p.FA,{name:t}))},e.renderMembers=function(){var t=e.groupMembersPager.items;if(void 0===t)return c.createElement(p.Loading,null);var n,r=[],a=Object(Q.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.push(e.renderMember(i.member))}}catch(s){a.e(s)}finally{a.f()}return c.createElement("div",{className:"mb-3 bg-white d-flex flex-wrap p-2"},r,e.renderMemberAction("plus",e.onAddMember),e.renderMemberAction("minus",e.onRemoveMember))},e.schema=[{name:"name",type:"string",maxLength:100},{name:"discription",type:"string",maxLength:1e3}],e.uiSchema={items:{name:{label:"\u540d\u79f0",widget:"text"},discription:{label:"\u63cf\u8ff0",widget:"textarea"}}},e.page=Object(Pe.a)((function(){var t=e.controller.group;return c.createElement(p.Page,{header:"\u7ec4\u8be6\u60c5"},e.renderMembers(),c.createElement(p.Edit,{schema:e.schema,uiSchema:e.uiSchema,data:t,onItemChanged:e.onItemChanged}))})),e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.groupMembersPager=t,this.openPage(this.page);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(gt),st=Object(U.a)(it.prototype,"disabled",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),it),Ht=(ct=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).groupBoxId=void 0,Object(M.a)(e,"group",ot,Object(D.a)(e)),e.showGroupDetail=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.groupBoxId.assure();case 2:e.group=e.groupBoxId.obj,(n=new p.QueryPager(e.performance.GetGroupMembers,10,30)).setEachPageItem((function(e){Object(p.useUser)(e.member)})),n.first({group:e.group.id}),e.openVPage(Gt,n);case 7:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"init",value:function(e){Object(xt.a)(Object(Et.a)(n.prototype),"init",this).call(this,e),this.groupBoxId=e}},{key:"saveGroupProp",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.SaveGroupProp.submit(t);case 2:this.performance.Group.resetCache(t.id);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"groupAddMember",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.AddGroupMember.submit({group:this.groupId,member:t});case 2:this.group&&this.group.count++;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"groupRemoveMembers",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.RemoveGroupMember.submit({group:this.groupId,members:t});case 2:this.group&&this.group.count--;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"caption",get:function(){return Object(p.tv)(this.groupBoxId,(function(e){return o.a.createElement(o.a.Fragment,null,e.name)}))}},{key:"groupId",get:function(){return this.groupBoxId.id}}]),n}(Wt),ot=Object(U.a)(ct.prototype,"group",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct),$t=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).newAssign=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i,s,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={group:e.groupId,caption:n},a=e.performance.CreateAndSendAssign,t.next=4,a.submit(r);case 4:i=t.sent,s=i.id,c=e.performance.Assign.boxId(s),e.assignListItems.unshift({assign:c});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.saveTodoItem=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i,s,c,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=void 0,a=void 0,i=e.assign.tasks,s=i.find((function(t){return e.isMe(t.worker)}))){t.next=6;break}return t.abrupt("return");case 6:return c={id:r,task:s.id,assignItem:a,discription:n,x:0,$update:new Date},t.next=9,e.uqs.performance.Todo.save(void 0,c);case 9:return o=t.sent,c.id=o.id,s.todos.push(c),t.abrupt("return",c);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(n,[{key:"openVList",value:function(){this.openVPage(Vt)}},{key:"openVAssign",value:function(){this.openVPage(1===this.assign.end?Lt:Ft)}}]),n}(Ht),Kt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).showGroupDetail=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e}return Object(b.a)(n,[{key:"openVList",value:function(){this.openVPage(jt)}},{key:"openVAssign",value:function(){this.openVPage(1===this.assign.end?Rt:Pt)}},{key:"caption",get:function(){return"\u6211\u7684\u5f85\u529e"}},{key:"groupId",get:function(){return 0}}]),n}($t),Qt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.controller.showGroupDetail},o.a.createElement(p.FA,{name:"ellipsis-h"}))}}]),n}(Ot),Jt=(ut=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"header",value:function(){return"\u5206\u914d\u4efb\u52a1"}},{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.controller.cancel},"\u53d6\u6d88")}},{key:"renderCaption",value:function(e){return o.a.createElement("div",{className:"d-flex align-items-center justify-content-center my-3"},Zt.map((function(t,n){var r,a,i=t.caption;return n>0&&(r=o.a.createElement(p.FA,{className:"mx-2 mx-sm-3 text-muted",name:"arrow-right"})),a=n===e?o.a.createElement("b",{className:"h4 mb-0 text-primary"},i):o.a.createElement("div",{className:"text-muted"},i),o.a.createElement(o.a.Fragment,null,r,a)})))}},{key:"content",value:function(){var e=this,t=this.controller,n=t.step,r=t.prev,a=t.next,i=t.sendout,s=n<Zt.length-1?o.a.createElement(Object(Pe.a)((function(){return o.a.createElement("button",{className:"btn btn-primary",onClick:a,disabled:e.nextDisabled},o.a.createElement(p.FA,{className:"mr-2",name:"arrow-right"})," \u4e0b\u4e00\u6b65")}))):o.a.createElement("button",{className:"btn btn-primary",onClick:i},"\u53d1\u51fa\u4efb\u52a1"),c=o.a.createElement("button",{className:"btn btn-outline-primary mr-3",style:{visibility:0===n?"hidden":"visible"},onClick:r},o.a.createElement(p.FA,{className:"mr-2",name:"arrow-left"})," \u4e0a\u4e00\u6b65");return o.a.createElement("div",null,this.renderCaption(this.controller.step),o.a.createElement("div",{className:"mx-3 my-3"},this.renderMiddlePart()),o.a.createElement("div",{className:"mx-3 my-3 text-center"},c," ",s))}},{key:"renderMiddlePart",value:function(){}},{key:"renderUserWithCheck",value:function(e,t){var n="mr-5 my-2 d-flex align-items-center w-min-12c",r=function(){return o.a.createElement(p.FA,{name:"check",className:"text-primary mr-2"})};return e?!0===this.isMe(e)?o.a.createElement("div",{className:n+" text-info"},r(),"\u6211\u81ea\u5df1"):o.a.createElement("div",{className:n},r(),this.renderUser(e)):o.a.createElement("div",{className:n},o.a.createElement(p.FA,{name:"times",className:"text-danger mr-2"})," ",t)}},{key:"renderToList",value:function(){var e,t=[],n=this.controller.members;for(var r in n)if(!0===n[r]){if(!0===this.isMe(r)){e=r;continue}t.push(this.renderUserWithCheck(r))}return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:""},"\u6267\u884c\u4eba"),o.a.createElement("div",{className:""},o.a.createElement("div",{className:"form-control-plaintext border bg-light px-3 py-2"},o.a.createElement("div",{className:"d-flex flex-wrap"},t),e&&this.renderUserWithCheck(e))))}},{key:"renderChecker",value:function(){return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:""},"\u68c0\u67e5\u4eba"),o.a.createElement("div",{className:""},o.a.createElement("div",{className:"form-control-plaintext border bg-light px-3 py-2"},this.renderUserWithCheck(this.controller.checker,"\u65e0\u9700\u68c0\u67e5"))))}},{key:"renderRater",value:function(){return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:""},"\u8bc4\u4ef7\u4eba"),o.a.createElement("div",{className:""},o.a.createElement("div",{className:"form-control-plaintext border bg-light px-3 py-2"},this.renderUserWithCheck(this.controller.rater,"\u65e0\u9700\u8bc4\u4ef7"))))}},{key:"renderRadios",value:function(e,t,n,r,a){var i=this,s="mr-5 my-2 d-flex align-items-center w-min-12c",c=this.controller.membersPager.items;return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:""},e),o.a.createElement("div",{className:"px-3 py-2 bg-white border rounded"},o.a.createElement("div",{className:"d-flex flex-wrap"},o.a.createElement("label",{className:s+" text-warning"},o.a.createElement("input",{name:t,type:"radio",className:"mx-2",defaultChecked:0===n,onChange:function(){return r(0)}}),a),o.a.createElement("label",{className:s+" text-info"},o.a.createElement("input",{name:t,type:"radio",className:"mx-2",defaultChecked:this.isMe(n),onChange:function(){return r(i.controller.user.id)}}),"\u6211\u81ea\u5df1")),o.a.createElement("div",{className:"d-flex flex-wrap"},c.map((function(e,a){var c=e.member;if(c===i.controller.user.id)return null;return o.a.createElement("label",{className:s},o.a.createElement("input",{name:t,type:"radio",className:"mx-2",defaultChecked:c===n,value:c,onChange:function(e){r(Number(e.target.value))}}),i.renderUser(c))})))))}},{key:"back",get:function(){return"none"}},{key:"nextDisabled",get:function(){return!1}}]),n}(p.VPage),Object(U.a)(ut.prototype,"nextDisabled",[_.g],Object.getOwnPropertyDescriptor(ut.prototype,"nextDisabled"),ut.prototype),ut),Zt=[{caption:"\u6307\u5b9a\u6267\u884c\u4eba",VPage:(lt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderMiddlePart",value:function(){var e=this,t="mr-5 my-2 d-flex align-items-center w-min-12c";return o.a.createElement(Object(Pe.a)((function(){var n=e.controller.membersPager.items,r=e.controller,a=r.members,i=r.user.id;return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:""},"\u6267\u884c\u4eba"),o.a.createElement("div",{className:"px-3 py-2 bg-white border rounded"},o.a.createElement("div",{className:"d-flex flex-wrap"},n.map((function(n,r){var i=n.member;if(!0!==e.isMe(i)){return o.a.createElement("label",{className:t},o.a.createElement("input",{type:"checkbox",className:"mx-2",value:i,defaultChecked:!0===a[i],onChange:function(e){a[i]=e.target.checked}}),e.renderUser(i))}}))),o.a.createElement("label",{className:t},o.a.createElement("input",{type:"checkbox",className:"mx-2",value:i,defaultChecked:!0===a[i],onChange:function(e){return a[i]=e.target.checked}}),o.a.createElement("div",{className:"text-info"},"\u6211\u81ea\u5df1"))))})))}},{key:"nextDisabled",get:function(){var e=this.controller.members,t=!1;for(var n in e)if(!0===e[n]){t=!0;break}return!t}}]),n}(Jt),Object(U.a)(lt.prototype,"nextDisabled",[_.g],Object.getOwnPropertyDescriptor(lt.prototype,"nextDisabled"),lt.prototype),lt)},{caption:"\u6307\u5b9a\u68c0\u67e5\u4eba",VPage:function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderMiddlePart",value:function(){var e=this;return o.a.createElement("div",null,this.renderToList(),this.renderRadios("\u68c0\u67e5\u4eba","checker",this.controller.checker,(function(t){return e.controller.checker=t}),"\u65e0\u9700\u68c0\u67e5"))}}]),n}(Jt)},{caption:"\u6307\u5b9a\u8bc4\u4ef7\u4eba",VPage:function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderMiddlePart",value:function(){var e=this;return o.a.createElement("div",null,this.renderToList(),this.renderChecker(),this.renderRadios("\u8bc4\u4ef7\u4eba","rater",this.controller.rater,(function(t){return e.controller.rater=t}),"\u65e0\u9700\u8bc4\u4ef7"))}}]),n}(Jt)},{caption:"\u5b8c\u6210",VPage:function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderMiddlePart",value:function(){return o.a.createElement("div",null,this.renderToList(),this.renderChecker(),this.renderRater())}}]),n}(Jt)}],Xt=(dt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).step=0,e.membersPager=void 0,Object(M.a)(e,"members",ht,Object(D.a)(e)),Object(M.a)(e,"checker",ft,Object(D.a)(e)),Object(M.a)(e,"rater",pt,Object(D.a)(e)),e.prev=function(){e.popToTopPage(),e.openVPage(Zt[--e.step].VPage)},e.next=function(){e.popToTopPage(),e.openVPage(Zt[++e.step].VPage)},e.sendout=Object(f.a)(h.a.mark((function t(){var n,r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in n=[],e.members)!0===e.members[r]&&n.push({to:Number(r)});return a={assignId:e.owner.assign.id,checkerId:e.checker,raterId:e.rater,toList:n},t.next=5,e.uqs.performance.SendAssign.submit(a);case 5:e.popToTopPage(),e.owner.showAssign();case 7:case"end":return t.stop()}}),t)}))),e.cancel=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.popToTopPage();case 1:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.startAction(),this.step=0,this.membersPager=new p.QueryPager(this.uqs.performance.GetGroupMembers,100),e.next=5,this.membersPager.first({group:this.owner.groupId});case 5:this.openVPage(Zt[0].VPage);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(O),ht=Object(U.a)(dt.prototype,"members",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ft=Object(U.a)(dt.prototype,"checker",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=Object(U.a)(dt.prototype,"rater",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dt),Yt=n(24),en=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return this.renderTasks()}},{key:"renderTasks",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderMy(),this.renderSelf(),this.renderOthers())}},{key:"renderSelf",value:function(){var e=this.controller.tasksToCategory,t=e.checks,n=e.rates;if(0!==t.length||0!==n.length)return o.a.createElement("div",{className:"pt-3"},this.renderChecks(t),this.renderRates(n))}},{key:"renderMy",value:function(){var e=this,t=this.controller.tasksToCategory.my;if(t){var n=t.state,r=t.end,a=this.controller.getTaskAction(n);if(!a){var i=C(n).me;return o.a.createElement("div",{className:"px-3 py-2 bg-white border-top cursor-pointer d-flex align-items-center",onClick:function(){return e.controller.showFlowDetail(t)}},o.a.createElement("span",{className:"mr-2"},"\u6211\u7684\u4efb\u52a1"),o.a.createElement("span",{className:"text-warning"},i),this.renderEndFlag(r),o.a.createElement(p.FA,{name:"angle-right",className:"ml-auto"}))}return o.a.createElement("div",{className:"px-3 py-3 bg-white border-top cursor-pointer",onClick:this.controller.meAct},o.a.createElement(p.FA,{name:"chevron-circle-right",className:"text-danger mr-3"}),o.a.createElement("span",{className:"text-primary "},a)," \u6211\u7684\u4efb\u52a1")}}},{key:"renderActions",value:function(e,t,n){var r=this;if(0!==n.length)return n.map((function(n,a){var i=n.worker;return o.a.createElement("div",{key:a,className:"px-3 py-3 bg-white border-bottom cursor-pointer d-flex align-items-center",onClick:function(){return t(n)}},o.a.createElement(p.FA,{name:"chevron-circle-right",className:"text-danger mr-3"}),o.a.createElement("span",{className:"text-primary mr-2"},e),r.renderUser(i))}))}},{key:"renderChecks",value:function(e){var t=this.controller.showCheck;return this.renderActions("\u68c0\u67e5",t,e)}},{key:"renderRates",value:function(e){var t=this.controller.showRate;return this.renderActions("\u8bc4\u4ef7",t,e)}},{key:"renderEndFlag",value:function(e){if(1===e)return o.a.createElement("span",{className:"mx-3"},At)}},{key:"renderOthers",value:function(){var e=this,t=this.controller.tasksToCategory,n=t.starts,r=t.dones,a=t.passes,i=t.fails,s=t.rateds,c=t.cancels,u=[].concat(Object(Yt.a)(n),Object(Yt.a)(r),Object(Yt.a)(a),Object(Yt.a)(i),Object(Yt.a)(s),Object(Yt.a)(c));if(!(u.length<=0))return o.a.createElement("div",{className:"pt-3"},u.map((function(t,n){var r=t.id,a=t.end,i=C(t.state).me;return o.a.createElement("div",{key:r,className:"d-flex px-3 py-2 bg-white border-bottom cursor-pointer align-items-center",onClick:function(){return e.controller.showFlowDetail(t)}},e.renderUser(t.worker),o.a.createElement("span",{className:"ml-3 small text-info"},"\u4efb\u52a1",i),e.renderEndFlag(a),o.a.createElement(p.FA,{name:"angle-right",className:"ml-auto"}))})))}}]),n}(p.View),tn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderDraft",value:function(){return this.controller.isMyAssign?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"px-3 py-2 border-top bg-white cursor-pointer",onClick:this.controller.showAssignTo},o.a.createElement(p.FA,{className:"mr-3 text-info",name:"user-plus",fixWidth:!0})," \u5206\u914d\u7ed9"),this.renderSelfDone()):null}}]),n}(It),nn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderContent",value:function(){return o.a.createElement(o.a.Fragment,null,Object(xt.a)(Object(Et.a)(n.prototype),"renderContent",this).call(this),this.renderVm(en))}},{key:"renderTodos",value:function(){var e=this.controller.tasksToCategory,t=e.my,r=e.myCanEdit;return t?r?Object(xt.a)(Object(Et.a)(n.prototype),"renderTodos",this).call(this):t.todos.map((function(e,t){var n,r,a=e.assignItem,i=e.discription,s=e.doneMemo,c=e.checkMemo,u=e.id;return a?(n="text-primary",r="circle"):(n="text-info",r="circle-o"),o.a.createElement("div",{key:u,className:"px-3 py-2 d-flex align-items-center bg-white border-top"},o.a.createElement("small",null,o.a.createElement("small",null,o.a.createElement(p.FA,{name:r,className:n,fixWidth:!0}))),o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:"flex-fill ml-3"},i),s&&o.a.createElement("div",{className:"mt-1 ml-3 small"},o.a.createElement(p.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},s)),c&&o.a.createElement("div",{className:"mt-1 ml-3 small"},o.a.createElement(p.FA,{name:"comments-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info"},c))))})):this.renderAssignItems()}}]),n}(Tt),rn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"renderContent",value:function(){return o.a.createElement(o.a.Fragment,null,Object(xt.a)(Object(Et.a)(n.prototype),"renderContent",this).call(this),this.renderFlow())}},{key:"renderFlow",value:function(){var e=this,t="border border-warning rounded px-2 py-1 d-flex align-items-center",n=this.assign,r=n.checker,a=n.rater,i=o.a.createElement(p.FA,{name:"angle-right",className:"mx-2 mx-sm-3 text-muted"}),s=function(n,r){if(n)return o.a.createElement(o.a.Fragment,null,i,o.a.createElement("div",{className:t},o.a.createElement("small",{className:"mr-2"},e.renderUser(n)),o.a.createElement("small",{className:"text-muted"},r)))};return o.a.createElement("div",{className:"d-flex mt-3 px-3 py-2 border-top bg-white align-items-center"},o.a.createElement(p.FA,{name:"circle-o text-primary small"}),i,o.a.createElement("div",{className:t+" small"},"\u6267\u884c"),s(r,"\u67e5\u9a8c"),s(a,"\u8bc4\u5206"),i,At)}},{key:"footer",value:function(){var e=this,t=this.controller.tasksToCategory,n=t.my,r=t.myCanEdit;if(n&&!1!==r){switch(n.state){default:return;case i.start:case i.todo:case i.doing:}var a={onAdd:function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveTodoItem(n);case 2:e.scrollToTop();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),caption:"\u6dfb\u52a0\u6211\u7684\u4efb\u52a1\u4e8b\u9879"};return this.renderVm(wt,a)}}}]),n}(nn),an=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return n}(nn),sn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tasksToCategory=void 0,e.showAssignTo=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.newSub(Xt).start();case 2:case"end":return t.stop()}}),t)}))),e.showCheck=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.openVPage(Bt,n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showRate=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.openVPage(qt,n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.saveTodoItem=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.tasksToCategory.my)||alert("something wrong"),void 0,void 0,a={id:void 0,task:r.id,assignItem:void 0,discription:n,x:0,$update:new Date},t.next=7,e.uqs.performance.Todo.save(void 0,a);case 7:return i=t.sent,a.id=i.id,r.todos.push(a),t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(n,[{key:"openVList",value:function(){this.openVPage(Qt)}},{key:"openVAssign",value:function(){var e,t=this.assign,n=t.end,r=t.tasks;e=1===n?an:0===r.length?tn:rn,this.openVPage(e)}},{key:"onAssignLoaded",value:function(){var e,t,n=this.assign,r=n.tasks,a=n.checker,s=n.rater,c=!1,o=[],u=[],l=[],d=[],h=[],f=[],p=[],v=[],m=[],b=this.isMe(a),y=this.isMe(s),k=Object(Q.a)(r);try{for(k.s();!(t=k.n()).done;){var g=t.value,w=g.worker,O=g.state;if(!0===this.isMe(w))switch(e=g,O){case i.start:case i.todo:case i.doing:c=!0}else switch(O){case i.start:l.push(g);break;case i.done:(!0===b?o:d).push(g);break;case i.pass:(!0===y?u:h).push(g);break;case i.fail:f.push(g);break;case i.rated:p.push(g);break;case i.cancel:v.push(g);break;default:m.push(g)}}}catch(j){k.e(j)}finally{k.f()}this.tasksToCategory={my:e,myCanEdit:c,checks:o,rates:u,starts:l,dones:d,passes:h,fails:f,rateds:p,cancels:v,invalids:m}}}]),n}(Ht),cn=(vt=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).performance=void 0,e.currentGroupItem=void 0,Object(M.a)(e,"currentGroup",mt,Object(D.a)(e)),Object(M.a)(e,"currentTask",bt,Object(D.a)(e)),e.lastTick=0,Object(M.a)(e,"todosChanged",yt,Object(D.a)(e)),e.defaultGroupId=void 0,Object(M.a)(e,"defaultGroupAssignCount",kt,Object(D.a)(e)),e.myGroupsPager=void 0,e.groupNotesPager=void 0,e.tab=function(){return e.renderView(Re)},e.noteItemConverter=function(t,n){return ze(Object(D.a)(e),t,n)},e.showGroup=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.groupNotesPager.first({group:n.group});case 2:n.unread=0,e.openVPage(Le,void 0,(function(t){e.currentGroup=void 0})),e.setCurrentGroupItem(n),e.cApp.resetTick();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showMyAssigns=Object(f.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.todosChanged=!1,n=e.newC(Kt),t.next=4,n.showList();case 4:case"end":return t.stop()}}),t)}))),e.showGroupAssigns=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.todosChanged=!1,!(n.memberCount>1)){t.next=7;break}return r=e.newC(sn,n.group),t.next=5,r.showList();case 5:t.next=10;break;case 7:return a=e.newC($t,n.group),t.next=10,a.showList();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showMyTodos=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.todosChanged=!1,t.next=3,e.cApp.showMyTodos();case 3:case"end":return t.stop()}}),t)}))),e.addTextNote=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={group:e.currentGroup,content:n},t.next=3,e.performance.PushNote.submit(r);case 3:a=t.sent,i=null===a||void 0===a?void 0:a.note,(s=We(Object(D.a)(e),e.user.id,n)).id=i,e.groupNotesPager.items.push(s),e.afterAddNote();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.saveTaskProp=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.Assign.saveProp(e.currentTask.id,n,r);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.publishAssign=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a,i,s,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.PublishAssign.submit({assignId:n.id,groupId:e.currentGroup.id});case 2:(r=t.sent)||alert("publish assign error"),(a=Ge(Object(D.a)(e),e.user.id,r.note)).id=r.note,i=n.id,s=n.caption,c=n.discription,a.assignId=i,a.caption=s,a.discription=c,e.groupNotesPager.items.push(a),e.afterAddNote();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.saveTodo=function(){var t=Object(f.a)(h.a.mark((function t(n){var r,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={id:void 0,task:e.currentTask.id,state:0,discription:n},t.next=3,e.performance.Todo.save(void 0,r);case 3:return a=t.sent,r.id=a.id,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.taskAct=function(){var t=Object(f.a)(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.TaskAct.submit({task:void 0,toState:r});case 2:t.sent;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.revokeTask=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.performance.RemoveTask.submit({noteItem:n,undefined:void 0});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.performance=this.uqs.performance,this.myGroupsPager=new on(this.performance.GetMyGroups,10,500,!0),this.groupNotesPager=new p.QueryPager(this.performance.GetGroupNotes,10,30,!0),this.groupNotesPager.setItemConverter(this.noteItemConverter),this.groupNotesPager.setReverse()}},{key:"load",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.myGroupsPager.first(void 0)],e.next=3,Promise.all(t);case 3:(n=this.myGroupsPager.items.findIndex((function(e){return 1===e.isDefault})))>=0&&(r=this.myGroupsPager.items.splice(n,1),a=r[0],this.defaultGroupId=a.id,this.defaultGroupAssignCount=a.count);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addGroupAssignCount",value:function(e,t){if(e===this.defaultGroupId)this.defaultGroupAssignCount+=t;else{var n=this.myGroupsPager.items.find((function(t){return!0===p.Tuid.equ(t.group,e)}));n&&(n.count+=t)}}},{key:"saveGroup",value:function(){var e=Object(f.a)(h.a.mark((function e(t,n,r){var a,i,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={parent:t,name:n,discription:r},e.next=3,this.performance.SaveGroup.submit(a);case 3:i=e.sent,s=null===i||void 0===i?void 0:i.group,c=this.performance.Group.boxId(s),this.myGroupsPager.items.unshift({id:s,group:c,count:1,time:new Date,unread:0,owner:this.user.id,isDefault:0,memberCount:1});case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveGroupProp",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.SaveGroupProp.submit(t);case 2:this.performance.Group.resetCache(t.id);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCurrentGroupItem",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentGroupItem=t,n=this.performance.Group,"object"===typeof(r=t.group)&&(r=r.id),e.next=6,n.assureBox(r);case 6:this.currentGroup=e.sent,this.currentGroup.count=t.count;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.performance.MyTickTodo.query({lastTick:this.lastTick},!1),this.myGroupsPager.refresh()],this.currentGroup&&t.push(this.groupNotesPager.attach()),e.next=4,Promise.all(t);case 4:n=e.sent,this.lastTick=Date.now()/1e3,(r=n[0])&&(a=r.ret,this.todosChanged=a.length>0),this.currentGroup&&(i=this.currentGroup.id,(s=this.myGroupsPager.items.find((function(e){return p.Tuid.equ(e.group,i)})))&&(s.time=new Date,s.unread=0));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"afterAddNote",value:function(){this.groupNotesPager.scrollToBottom()}},{key:"showGroupDetail",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new p.QueryPager(this.performance.GetGroupMembers,10,30)).setEachPageItem((function(e){Object(p.useUser)(e.member)})),t.first({group:this.currentGroup}),this.openVPage(Me,t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"groupAddMember",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.AddGroupMember.submit({group:this.currentGroup,member:t});case 2:this.currentGroupItem&&this.currentGroupItem.count++,this.currentGroup&&this.currentGroup.count++;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"groupRemoveMembers",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performance.RemoveGroupMember.submit({group:this.currentGroup,members:t});case 2:this.currentGroupItem&&this.currentGroupItem.count--,this.currentGroup&&this.currentGroup.count--;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w),mt=Object(U.a)(vt.prototype,"currentGroup",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt=Object(U.a)(vt.prototype,"currentTask",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt=Object(U.a)(vt.prototype,"todosChanged",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kt=Object(U.a)(vt.prototype,"defaultGroupAssignCount",[_.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt),on=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"getRefreshPageId",value:function(e){if(void 0!==e){var t=e.group;return"object"===typeof t?t.id:t}}}]),n}(p.QueryPager),un="d-flex justify-content-center align-items-center rounded border border-info text-danger w-3c h-3c font-1-5c mr-3",ln=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderTaskItem=function(e,t,n){var r=t.assign,a=t.$create,i=t.stepDate,s=t.stepComment,o=C(t.state),u=o.me;o.act;return Object(p.tv)(r,(function(e){var t=e.caption,n=e.discription,r=c.createElement("div",{className:un},t[0].toUpperCase()),o=c.createElement("div",null,c.createElement(p.Muted,null,c.createElement(p.EasyTime,{date:i,always:!0})));return c.createElement(p.LMR,{className:"py-3 px-3",left:r,right:o},c.createElement("div",{className:"small text-muted pb-1"},c.createElement(p.FA,{className:"text-danger mr-1",name:"chevron-circle-right"}),c.createElement("span",{className:"text-primary"},u)," \xa0",c.createElement(p.EasyTime,{date:a,always:!0}),"\u5f00\u59cb",c.createElement(p.Muted,null,s)),c.createElement("div",null,c.createElement("b",null,t)," \xa0 ",n))}))},e.onTaskClick=function(e){},e.cnTabSelected=function(e){return Fe()({"bg-white border border-warning":e,border:!e},"cursor-pointer px-4 py-2 rounded")},e.tabs=[{name:"todo",caption:function(t){return c.createElement("div",{className:e.cnTabSelected(t)},"\u9886\u529e")},content:function(){return c.createElement("div",null,c.createElement(p.List,{items:e.controller.myTasksPager,item:{render:function(t,n){return e.renderTaskItem("\u9886\u529e",t,n)},onClick:e.onTaskClick}}))},onShown:function(){return e.controller.loadTaskArchive(s.todo)}},{name:"done",caption:function(t){return c.createElement("div",{className:e.cnTabSelected(t)},"\u5b8c\u6210")},content:function(){return c.createElement("div",null,c.createElement(p.List,{items:e.controller.myTasksPager,item:{render:function(t,n){return e.renderTaskItem("\u5b8c\u6210",t,n)},onClick:e.onTaskClick}}))},onShown:function(){return e.controller.loadTaskArchive(s.done)}},{name:"check",caption:function(t){return c.createElement("div",{className:e.cnTabSelected(t)},"\u67e5\u9a8c")},content:function(){return c.createElement("div",null,c.createElement(p.List,{items:e.controller.myTasksPager,item:{render:function(t,n){return e.renderTaskItem("\u67e5\u9a8c",t,n)},onClick:e.onTaskClick}}))},onShown:function(){return e.controller.loadTaskArchive(s.check)}},{name:"rate",caption:function(t){return c.createElement("div",{className:e.cnTabSelected(t)},"\u8bc4\u4ef7")},content:function(){return c.createElement("div",null,c.createElement(p.List,{items:e.controller.myTasksPager,item:{render:function(t,n){return e.renderTaskItem("\u8bc4\u4ef7",t,n)},onClick:e.onTaskClick}}))},onShown:function(){return e.controller.loadTaskArchive(s.rate)}}],e}return Object(b.a)(n,[{key:"header",value:function(){return"\u4efb\u52a1"}},{key:"content",value:function(){return c.createElement(p.Tabs,{tabs:this.tabs,tabPosition:"top",size:"sm"})}}]),n}(p.VPage),dn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).showCatProject=function(){e.controller.cApp.showProjects()},e.catMember={icon:"user-o",bgIcon:"bg-info",content:"\u540c\u4e8b",action:e.controller.cApp.cMember.showList},e.catProject={icon:"sitemap",bgIcon:"bg-primary",content:"\u9879\u76ee",action:e.showCatProject},e.catAssigns={icon:"list-ol",bgIcon:"bg-success",content:"\u4f5c\u4e1a",action:void 0},e.catTasks={icon:"list-ol",bgIcon:"bg-info",content:"\u4efb\u52a1",action:e.controller.showMyTasks},e.items=[e.catMember,e.catTasks,e.catAssigns,e.catProject],e}return Object(b.a)(n,[{key:"open",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"header",value:function(){return"\u67e5\u770b"}},{key:"content",value:function(){return c.createElement("div",{className:""},this.items.map((function(e,t){var n=e.icon,r=e.bgIcon,a=e.content,i=e.action;return c.createElement("div",{key:t,className:"d-flex py-2 px-3 cursor-pointer mb-1 bg-white align-items-center",onClick:i},c.createElement("div",{className:"d-flex w-2c h-2c text-center mr-3 rounded text-white align-items-center justify-content-center "+r},c.createElement(p.FA,{name:n,fixWidth:!0,size:"lg"})),c.createElement("div",null,a))})))}}]),n}(p.VPage),hn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).keyDoing=function(e){return e.task},e.onClickDoing=function(e){},e.renderDoing=function(t,n){var r=t.assign,a=t.worker,i=t.$create,s=function(e){var t=e.icon;return c.createElement(p.Image,{className:"w-2c h-2c mt-1",src:t})},o=function(e){var t=e.name,n=e.nick;return c.createElement("small",null,n||t)};return Object(p.tv)(r,(function(n){var r=n.caption,u=n.discription;return c.createElement("div",{className:"my-1 bg-white"},c.createElement("div",{className:"px-3 py-2"},c.createElement(p.UserView,{user:a,render:s})),c.createElement("div",{className:"flex-fill"},c.createElement("div",{className:"d-flex pt-1 pb-2"},c.createElement("div",{className:"flex-fill pl-2"},c.createElement(p.UserView,{user:a,render:o}),c.createElement("div",null,c.createElement("b",null,r)," \xa0 ",c.createElement(p.Muted,null,u))),c.createElement("div",{className:"pr-2"},c.createElement(p.Muted,null,c.createElement(p.EasyTime,{date:i})))),c.createElement("div",{className:"text-primary pl-2 py-1 border-top"},e.renderState(t))))}))},e}return Object(b.a)(n,[{key:"header",value:function(){return"\u5f85\u529e\u5de5\u4f5c"}},{key:"content",value:function(){var e=this,t=Object(Pe.a)((function(){var t=c.createElement("div",{className:"px-3 py-2 text-muted small border-top"},"[\u65e0]");return c.createElement(p.List,{className:"bg-transparent",items:e.controller.myDoingsPager,item:{render:e.renderDoing,onClick:e.onClickDoing,key:e.keyDoing,className:"bg-transparent"},none:t})}));return c.createElement(t)}},{key:"renderState",value:function(e){var t=e.state,n=e.date,r=c.createElement(p.FA,{className:"text-danger mr-1",name:"chevron-circle-right"}),a=C(t),i=a.me,s=a.act;return c.createElement(c.Fragment,null,r," ",c.createElement("small",null,i)," \xa0 ",c.createElement(p.Muted,null,s,"\u4e8e",c.createElement(p.EasyTime,{date:n})))}}]),n}(p.VPage),fn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).performance=void 0,e.myDoingsPager=void 0,e.myArchiveTodosPager=void 0,e.myTasksPager=void 0,e.tab=function(){return e.renderView(dn)},e.load=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.refresh=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.showMyTasks=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.myTasksPager.first({});case 2:e.openVPage(ln);case 3:case"end":return t.stop()}}),t)}))),e.showMyTodos=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.myDoingsPager.first({});case 2:e.openVPage(hn);case 3:case"end":return t.stop()}}),t)}))),e.testText=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"a\nb\ncc",t.next=3,e.uqs.performance.TestText.submit({i:1,tIn:"a\nb\ncc"});case 3:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.performance=this.uqs.performance,this.myDoingsPager=new p.QueryPager(this.uqs.performance.GetMyTasks,10,100)}},{key:"loadTaskArchive",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.myTasksPager.reset(),e.next=3,this.myTasksPager.first({step:t});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w),pn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"header",value:function(){return"\u8be6\u60c5"}},{key:"content",value:function(){return o.a.createElement("div",{className:"p-3"},"\u540c\u4e8b\u8be6\u60c5 \u6b63\u5728\u5b9e\u73b0\u4e2d...")}}]),n}(p.VPage),vn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderMemberItem=function(t,n){var r=t.member,a=t.count;return o.a.createElement("div",{className:"d-flex px-3 py-2"},e.renderUser(r,"w-2c h-2c mr-3","flex-grow-1"),o.a.createElement("div",null,a>0&&o.a.createElement(p.Muted,null,a,"\u7fa4")))},e.onMemberItem=function(t){e.controller.showMemberDetail(t)},e}return Object(b.a)(n,[{key:"header",value:function(){return"\u540c\u4e8b"}},{key:"content",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"d-flex py-2 px-3 cursor-pointer mb-1 bg-white align-items-center",onClick:this.controller.showDepartment},o.a.createElement("div",{className:"d-flex w-2c h-2c text-center mr-3 rounded text-white align-items-center justify-content-center bg-info"},o.a.createElement(p.FA,{name:"building-o",fixWidth:!0,size:"lg"})),o.a.createElement("div",{className:"flex-grow-1"},"\u5355\u4f4d"),o.a.createElement("div",null)),o.a.createElement(p.List,{className:"my-3",items:this.controller.myMembersPager,item:{render:this.renderMemberItem,onClick:this.onMemberItem},none:"\u65e0"}))}}]),n}(p.VPage),mn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"header",value:function(){return"\u5355\u4f4d"}},{key:"content",value:function(){return o.a.createElement("div",{className:"p-3"},"\u6309\u5355\u4f4d\u67e5\u770b\u540c\u4e8b \u6b63\u5728\u5b9e\u73b0\u4e2d...")}}]),n}(p.VPage),bn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).performance=void 0,e.myMembersPager=void 0,e.showMemberDetail=function(){var t=Object(f.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.openVPage(pn);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showList=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.myMembersPager.first(void 0);case 2:e.openVPage(vn);case 3:case"end":return t.stop()}}),t)}))),e.showDepartment=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.openVPage(mn);case 1:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.performance=this.uqs.performance,this.myMembersPager=new p.QueryPager(this.performance.GetMyMembers,10,500,!0)}}]),n}(w),yn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).projectListContent=Object(Pe.a)((function(){var t=e.controller.projectsPager;return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.List,{className:"flex-fill bg-transparent",items:t.items,item:{render:e.renderProject}}))})),e.renderProject=function(e,t){return o.a.createElement(p.LMR,{className:"py-3 px-3 mb-1 bg-white"},o.a.createElement("div",null,o.a.createElement("b",null,e.name)," \xa0 ",e.content))},e.onClickSend=function(){e.form.buttonClick("send")},e.onFormSubmit=function(){var t=Object(f.a)(h.a.mark((function t(n,r){var a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.data,i=a.name,s=a.content,t.next=3,e.controller.saveProject(i,s);case 3:t.sent>0&&e.closePage();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.form=void 0,e.onClickAdd=function(){var t=o.a.createElement("button",{onClick:e.onClickSend,className:"btn btn-sm btn-success align-self-center mr-2"},o.a.createElement(p.FA,{name:"paper-plane-o"}));e.openPageElement(o.a.createElement(p.Page,{header:"\u65b0\u5efa\u9879\u76ee",right:t},o.a.createElement("div",{className:"m-3"},o.a.createElement(p.Form,{ref:function(t){return e.form=t},schema:[{name:"name",type:"string"},{name:"content",type:"string"}],uiSchema:{items:{name:{label:"\u540d\u79f0",placeholder:"\u8f93\u5165\u9879\u76ee\u540d\u79f0"},content:{label:"\u63cf\u8ff0",placeholder:"\u8f93\u5165\u9879\u76ee\u63cf\u8ff0"}}},onButtonClick:e.onFormSubmit}))))},e}return Object(b.a)(n,[{key:"header",value:function(){return"\u9879\u76ee"}},{key:"right",value:function(){return o.a.createElement("button",{onClick:this.onClickAdd,className:"btn btn-sm btn-primary align-self-center mr-2"},o.a.createElement(p.FA,{name:"plus"}))}},{key:"content",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(this.projectListContent))}},{key:"onClickProjectItem",value:function(e){this.controller.onSelectItem(e)}}]),n}(p.VPage),kn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).projectListContent=Object(Pe.a)((function(){var t=e.controller.projectsPager;return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.List,{className:"flex-fill bg-transparent",items:t.items,item:{render:e.renderProject}}))})),e.renderProject=function(t,n){return o.a.createElement(p.LMR,{className:"py-3 px-3 mb-1 bg-white",onClick:function(){return e.onClickProjectItem(t)}},o.a.createElement("div",null,o.a.createElement("b",null,t.name)," \xa0 ",t.content))},e}return Object(b.a)(n,[{key:"header",value:function(){return"\u9009\u62e9\u9879\u76ee"}},{key:"content",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(this.projectListContent))}},{key:"afterBack",value:function(){this.controller.onSelectItem(void 0)}},{key:"onClickProjectItem",value:function(e){this.controller.onSelectItem(e),this.controller.closePage()}}]),n}(p.VPage),gn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).performance=void 0,e.projectsPager=void 0,e.showList=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.load(),e.openVPage(yn);case 2:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.performance=this.uqs.performance,this.projectsPager=new wn(this.performance.GetMyProjects,10,500,!0)}},{key:"load",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.projectsPager.first(void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveProject",value:function(){var e=Object(f.a)(h.a.mark((function e(t,n){var r,a,i,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={name:t,content:n},e.next=3,this.performance.SaveProject.submit(r);case 3:return a=e.sent,(i=null===a||void 0===a?void 0:a.projectId)>0&&(s=this.performance.Project.boxId(i),c={id:this.projectsPager.items.length+1,project:s,name:t,content:n,owner:this.user.id},this.projectsPager.items.unshift(c)),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onSelectItem",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w),wn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"getRefreshPageId",value:function(e){if(void 0!==e){var t=e.project;return"object"===typeof t?t.id:t}}}]),n}(p.QueryPager),On=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).performance=void 0,r.projectsPager=void 0,r}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.performance=this.uqs.performance,this.projectsPager=new wn(this.performance.GetMyProjects,10,500,!0)}},{key:"load",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.projectsPager.first(void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showDialog",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.next=4,this.vCall(kn);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSelectItem",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.returnCall(null===t||void 0===t?void 0:t.project);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w),jn=[10,3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60],xn=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cGroup=void 0,e.cReport=void 0,e.cHome=void 0,e.cMe=void 0,e.cMember=void 0,e.cProject=void 0,e.cSelectProject=void 0,e.tick=0,e.gapIndex=0,e.callTick=Object(f.a)(h.a.mark((function t(){var n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.user){t.next=3;break}return t.abrupt("return");case 3:if(++e.tick,!(e.tick<jn[e.gapIndex])){t.next=6;break}return t.abrupt("return");case 6:return console.error("tick ",new Date),e.tick=0,e.gapIndex<jn.length-1&&++e.gapIndex,t.next=11,e.uqs.performance.$Poked.query(void 0,!1);case 11:if(n=t.sent,void 0!==(r=n.ret[0])){t.next=15;break}return t.abrupt("return");case 15:if(r.poke){t.next=17;break}return t.abrupt("return");case 17:e.gapIndex=1,e.cGroup.refresh(),t.next=23;break;case 21:t.prev=21,t.t0=t.catch(0);case 23:case"end":return t.stop()}}),t,null,[[0,21]])}))),e.showMyTasks=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cReport.showMyTasks();case 2:case"end":return t.stop()}}),t)}))),e.showMyTodos=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cReport.showMyTodos();case 2:case"end":return t.stop()}}),t)}))),e.showProjects=function(){e.cProject.showList()},e}return Object(b.a)(n,[{key:"internalStart",value:function(){var e=Object(f.a)(h.a.mark((function e(){var t,n,r,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 0,t=this.uqs.performance,n=t.test1,r=t.test2,e.next=4,Promise.all([n.loadValues(),r.loadValues()]);case 4:a=e.sent,i=Object(v.a)(a,2),i[0],i[1],this.cGroup=this.newC(cn),this.cGroup.load(),this.cReport=this.newC(fn),this.cReport.start(),this.cHome=this.newC(Se),this.cMe=this.newC(L),this.cMember=this.newC(bn),this.cProject=this.newC(gn),this.cSelectProject=this.newC(On),this.showMain(),setInterval(this.callTick,1e3);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showMain",value:function(e){this.openVPage(V,e)}},{key:"afterStart",value:function(){var e=this,t={aId:function(e){e.innerText=r},bId:function(e){e.innerText=r+", world!"},cId:function(e){l.a.render(o.a.createElement("b",{className:"text-success"},r,", great"),e)}},n=1,r="hello";this.hookElements(t),window.onfocus=function(){r+=++n,e.hookElements(t)}}},{key:"addGroupAssignCount",value:function(e,t){this.cGroup.addGroupAssignCount(e,t)}},{key:"showMemberDetail",value:function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cMember.showMemberDetail(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pushTaskNote",value:function(){var e=Object(f.a)(h.a.mark((function e(t){var n,r,i,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.error("task action return undefined"),e.abrupt("return");case 3:return n=t.task,r=t.step,i=t.state,s=t.group,c={group:s,content:r+"|"+i,type:a.Task,obj:n},e.next=7,this.uqs.performance.PushNote.submit(c);case 7:this.resetTick(),this.cGroup.refresh();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetTick",value:function(){this.tick=0,this.gapIndex=1}},{key:"showSelectProject",value:function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cSelectProject.showDialog();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j);p.nav.setSettings(g);var En=function(){var e=function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.start)(xn,g);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(p.NavView,{onLogined:e})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(116);var Cn=document.getElementById("root");Cn||((Cn=document.createElement("div")).style.display="none",document.body.append(Cn)),l.a.render(o.a.createElement(En,null),Cn),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[97,1,2]]]);
//# sourceMappingURL=main.c7e98d54.chunk.js.map