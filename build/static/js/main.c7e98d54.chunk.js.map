{"version":3,"sources":["tonva/index.ts","tonva/components/index.ts","tonva/net/netToken.ts","tonva/components/fetchErrorView.tsx","tonva/components/reloadPage.tsx","tonva/components/nav.tsx","tonva/net/guestApi.ts","tonva/net/caller.ts","tonva/net/index.ts","tonva/tool/cacheIds.ts","tonva/tool/local.ts","tonva/tool/index.ts","tonva/components/page/pageHeader.tsx","tonva/components/page/page.tsx","tonva/net/appBridge.ts","tonva/uq/caller.ts","tonva/uq/entity.ts","tonva/components/edit/itemEdit.tsx","tonva/net/httpChannel.ts","tonva/net/httpChannelUI.ts","tonva/net/uqApi.ts","tonva/net/wsChannel.ts","tonva/res/res.ts","tonva/vm/controller.tsx","tonva/vm/view.tsx","tonva/vm/vpage.tsx","tonva/vm/index.ts","tonva/uq/query.ts","tonva/tool/uid.ts","tonva/components/image.tsx","tonva/tool/user.ts","tonva/net/host.ts","tonva/uq/action.ts","tonva/components/simple/LMR.tsx","tonva/components/simple/Badge.tsx","tonva/components/simple/FA.tsx","tonva/components/simple/Muted.tsx","tonva/components/simple/IconText.tsx","tonva/components/simple/index.ts","tonva/uq/tuid/idCache.ts","tonva/uq/tuid/tuid.ts","tonva/tool/localDb.ts","tonva/uq/tuid/reactBoxId.tsx","tonva/components/page/scrollView.tsx","tonva/components/loading.tsx","tonva/tool/env.ts","tonva/uq/tuid/index.ts","tonva/net/apiBase.ts","tonva/components/edit/imageItemEdit.tsx","tonva/res/formRes.ts","tonva/res/listRes.ts","tonva/res/entry/login.ts","tonva/res/entry/register.ts","tonva/res/index.ts","tonva/tool/pageItems.ts","tonva/components/page/tabs.tsx","tonva/components/resUploader.tsx","tonva/uq/index.ts","tonva/uq/uqMan.ts","tonva/uq/sheet.ts","tonva/uq/book.ts","tonva/uq/history.ts","tonva/uq/map.ts","tonva/uq/pending.ts","tonva/uq/tag/tagView.tsx","tonva/uq/tag/tag.ts","tonva/components/page/index.ts","tonva/components/schema/index.ts","tonva/components/rules/index.ts","tonva/components/dropDownActions/index.tsx","tonva/components/easyDate/index.tsx","tonva/components/media.tsx","tonva/components/searchBox.tsx","tonva/components/userIcon.tsx","tonva/uq/tuid/tuidsCache.ts","tonva/uq/uqsMan.ts","tonva/components/form/rules/index.ts","tonva/components/form/widgets/widget.tsx","tonva/components/form/widgets/textWidget.tsx","tonva/components/form/widgets/textareaWidget.tsx","tonva/components/form/widgets/passwordWidget.tsx","tonva/components/form/widgets/numberWidget.tsx","tonva/components/form/widgets/updownWidget.tsx","tonva/components/form/widgets/dateWidget.tsx","tonva/components/form/widgets/checkBoxWidget.tsx","tonva/components/form/widgets/selectWidget.tsx","tonva/components/form/widgets/radioWidget.tsx","tonva/components/form/widgets/rangeWidget.tsx","tonva/components/form/widgets/idWidget.tsx","tonva/components/form/widgets/unknown.tsx","tonva/components/form/widgets/buttonWidget.tsx","tonva/components/form/context.tsx","tonva/components/form/widgets/arrComponent.tsx","tonva/components/form/widgets/imageWidget.tsx","tonva/components/form/widgets/tagWidget.tsx","tonva/components/form/widgets/factory.tsx","tonva/components/form/form.tsx","tonva/components/form/field.tsx","tonva/components/form/index.ts","tonva/components/edit/stringItemEdit.tsx","tonva/components/edit/radioItemEdit.tsx","tonva/components/edit/selectItemEdit.tsx","tonva/components/edit/idItemEdit.tsx","tonva/components/edit/tagItemEdit.tsx","tonva/components/edit/textAreaItemEdit.tsx","tonva/components/edit/edit.tsx","tonva/components/edit/index.tsx","tonva/app/centerApi.ts","tonva/app/vMain.tsx","tonva/app/CAppBase.ts","tonva/app/start.ts","tonva/app/CBase.ts","tonva/app/index.ts","tonva/components/list/base.tsx","tonva/components/list/clickable.tsx","tonva/components/list/static.tsx","tonva/components/list/selectable.tsx","tonva/components/list/index.tsx","tonva/components/propGrid/row.tsx","tonva/components/propGrid/propView.tsx","tonva/components/propGrid/PropGrid.tsx","tonva/entry/meInfo.tsx","tapp/uqs.ts","tapp/appConfig.ts","tapp/appName.ts","tapp/CBase.ts","parser/token.ts","tapp/main.tsx","me/VMe.tsx","me/CMe.tsx","test/VMain.tsx","test/VTestForm.tsx","parser/char.ts","parser/tokenStream.ts","parser/atom.ts","parser/expression.ts","parser/test.ts","test/CTest.ts","tools/state.tsx","home/VMain.tsx","home/VGroup.tsx","home/VGroupDetail.tsx","home/NoteItem/NoteItem.tsx","home/NoteItem/NoteText.tsx","home/NoteItem/NoteAssign.tsx","home/NoteItem/NoteTaskTodo.tsx","home/NoteItem/index.ts","assigns/VBase.tsx","assigns/VFooterInput.tsx","assigns/VList.tsx","assigns/group/self/VListForSelf.tsx","assigns/VInfoInput.tsx","assigns/VEditTextItem.tsx","assigns/VAssign.tsx","assigns/group/self/VAssignSelf.tsx","assigns/group/noMember/VListNoMember.tsx","assigns/group/noMember/VAssignNoMember.tsx","assigns/task/VTask.tsx","assigns/task/VDone.tsx","assigns/task/VCheck.tsx","assigns/task/VRate.tsx","assigns/task/VFlowDetail.tsx","assigns/CAssigns.ts","assigns/group/VGroupDetail.tsx","assigns/group/CAssignsForGroup.tsx","assigns/group/noMember/CAssignsNoMember.tsx","assigns/group/self/CAssignsSelf.ts","assigns/group/withMember/VListForGroup.tsx","assigns/group/withMember/send/VSendBase.tsx","assigns/group/withMember/send/CSend.ts","assigns/group/withMember/send/VSelectToList.tsx","assigns/group/withMember/send/VSelectChecker.tsx","assigns/group/withMember/send/VSelectRater.tsx","assigns/group/withMember/send/VSendOut.tsx","assigns/group/withMember/VAssignTasks.tsx","assigns/group/VAssignWithMember.tsx","assigns/group/withMember/CAssignsWithMember.tsx","home/CHome.ts","report/VMyTasks.tsx","report/VReport.tsx","report/VMyTodos.tsx","report/CReport.ts","member/VMemberDetail.tsx","member/VMain.tsx","member/VDepartmentList.tsx","member/CMember.ts","project/VProjectList.tsx","project/VSelectProject.tsx","project/CProject.ts","tapp/CApp.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["netToken","userId","token","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","this","error","err","i","push","key","style","wordWrap","className","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","timerHandler","reload","clearInterval","nav","seconds","undefined","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","logMark","isMobile","RegExp","test","navigator","userAgent","logs","stackKey","NavView","stack","htmlTitle","waitCount","waitTimeHandler","upgradeUq","start","isHistoryBack","navBack","tick","Date","now","console","log","length","len","window","self","top","postMessage","confirmClose","pop","fetchError","wait","addEventListener","set","env","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","clear","removeCeased","history","pushState","ceased","refresh","item","dispose","level","p","backLevel","popAndDispose","find","v","elWait","elError","testing","left","zIndex","name","map","index","visibility","position","ws","wsHost","local","LocalData","navSettings","language","culture","resUrl","hashParam","centerHost","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","ev","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","showPrivacyPage","privacy","getPrivacyContent","privacyPage","getPrivacy","html","content","__html","marked","dangerouslySetInnerHTML","waiting","Promise","race","serviceWorker","ready","registration","unregister","document","location","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","handler","onWsReceiveAny","handlerId","endWsReceive","receive","unitJsonPath","fetch","unitRes","json","res","unit","remove","el","getElementById","loadUnitJson","innerHTML","JSON","parse","envUnit","process","REACT_APP_UNIT","Number","get","isDevelopment","id","getPredefinedUnitName","unitName","guestApi","unitFromName","unitId","settings","origin","pathname","toLowerCase","endsWith","substr","onerror","onunhandledrejection","onselectstart","oncontextmenu","host","hash","pos","getExHashPos","substring","startWait","resHost","resUrlFromHost","setCenterUrl","guest","setGuest","exHash","getExHash","appInFrame","setAppInFrame","parent","wsBridge","loadPredefinedUnit","predefinedUnit","user","notLogined","logined","endWait","onLogined","userApi","me","icon","nick","callback","logoutApis","stringify","saveLocalUser","showAppView","connect","defaultTop","loginTop","headers","Headers","indexOf","http","method","text","withBack","lv","loginView","default","footer","logout","logoutClear","cp","ChangePasswordPage","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","apiId","sheetType","sheetId","sheet","includes","uh","appUrl","src","String","open","date","getTime","toTimeString","step","href","ret","r","parser","DOMParser","htmlDoc","parseFromString","elHtml","getElementsByTagName","newVersion","getAttribute","g","oem","observable","decodeGuestToken","CenterApiBase","Caller","params","_params","maxCount","arr","ids","dict","loadId","shift","delete","_loadIds","items","_loadId","setItem","e","Map","localDb","child","_user","_guest","_unit","forEach","d","PageHeader","afterBack","logoutClick","showLogout","debugLogout","b","right","center","ex","role","rightView","Page","observer","tabsView","tabsProps","TabsView","headerClassName","elFooter","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","uqTokens","logoutUqTokens","appsInFrame","page","param","val","isBridged","subFrameStarted","evt","data","subWin","setSubAppWindow","hidden","hideFrameBack","_","clone","initSubWin","onReceiveAppApiMessage","apiName","db","parts","split","uqOwner","uqName","appOwner","appName","uqTokenApi","onAppApiReturn","urlTest","action","uqTokenActions","Error","realUrl","getUrlOrTest","appHash","slice","lastIndexOf","u","uid","getUnit","realUnit","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","startsWith","buildAppUq","uqToken","centerToken","at","opener","appUq","brideCenterApis","bridgeCenterApi","body","callId","from","callCenterapi","directCall","result","bca","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","uqApi","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","schema","rebuildSchema","buildEntities","setSchema","ver","uqVersion","en","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageStart","pageSize","Entity","typeId","jName","sys","cache","fields","arrFields","returns","face","fieldMaps","localMap","f","loadEntitySchema","buildFieldsTuid","loadValues","setJName","buildFieldTuid","buildArrFieldsTuid","value","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","buildDateTimeParam","_tuid","getIdFromObj","dt","Math","floor","toISOString","packRow","arrData","packArr","join","row","charCodeAt","escape","values","boxId","ln","unpackRow","unpackArr","ch0","ch","c","fLen","to","n","isNaN","vals","ItemEdit","itemSchema","uiItem","label","_itemSchema","_uiItem","newValue","internalStart","internalEnd","divValue","labelHide","templet","Templet","widget","list","rules","nv","Array","isArray","verifyRule","rule","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","showError","post","urlPrefix","caller","buildOptions","path","h","append","encodeURI","innerFetch","keys","Object","k","innerFetchResult","buildError","retErr","that","timeOutHandler","statusText","ct","then","retJson","retError","catch","buildHeaders","CenterHttpChannel","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","UqApi","basePath","access","showWaiting","channelUI","init","acc","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","centerChannel","centerChannelUI","loginedUserId","t","un","localCache","nowTick","appUqParams","call","loadAppUqs","uqs","decodeUserToken","account","verify","password","prop","subAppWindow","win","WsBase","wsBaseId","handlerSeed","anyHandlers","msgHandlers","seed","$type","wsBaseSeed","WebSocket","onopen","onmessage","wsMessage","onclose","netThis","send","$lang","$district","resLang","merge","l","languages","toUpperCase","setResOptions","resGlobal","setRes","target","str","setGlobalRes","Controller","_t","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","internalT","vp","render","onEvent","alert","openPage","registerReceiveHandler","beforeStart","afterStart","onClosePage","caption","yes","no","classNames","closePage","buttons","View","controller","isMe","vm","vCall","returnCall","imageClassName","textClassName","renderUser","replacePage","backPage","ceasePage","popToTopPage","VPage","retOnClosePage","_onClosePage","openPageElement","renderPage","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","QueryPager","query","firstSize","itemObservable","$page","idFieldName","appendPosition","sortOrder","order","_items","startIndex","getPageId","load","splice","newItem","newId","oldItem","oldId","PageItems","Query","more","startField","isPaged","size","array","deep","pageCaller","request","queryCaller","table","obj","ALPHABET","rtn","charAt","random","Image","altImage","alt","currentTarget","jwtDecode","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","fetchOptions","mode","tryLocal","getCenterHost","getResHost","promises","hostArr","findIndex","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","debugHost","getUrlOrDebug","urlDebug","fetchLocalCheck","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","badge","color","badgeAlign","badgeVertical","cn","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","Muted","IdCache","tuidLocal","queue","loading","localArr","waitingIds","tuidInner","divName","initLocalArr","defer","isNumber","has","cacheTuids","moveToHead","removeItem","_id","getValue","useId","loadIds","tuidValues","cacheIdValues","tuids","unpackTuidIds","tuidValue","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","filter","getItem","netIds","loadTuidIds","netRet","IdDivCache","div","Tuid","noCache","typeName","idName","cached","unique","isImport","TuidBox","id1","id2","equ","TuidInner","divs","cacheFields","idCache","removeAll","tuidDiv","TuidDiv","createBoxId","resetCache","assureObj","cacheIds","modifyIds","IdsCaller","valueFromId","GetCaller","cacheFieldsInValue","arrValues","mainFields","unpackTuidIdsOfFields","SaveCaller","SavePropCaller","AllCaller","searchArr","owner","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","TuidImport","assureBox","loadMain","save","saveProp","search","loadArr","saveArr","posArr","hasDiv","ownerField","TuidBoxDiv","__ls","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","ks","unshift","saveIndex","max","ls","TuidContent","tuidName","s","uqStringify","ReactBoxId","isUndefined","boxName","Tv","nullUI","ttv","divObj","bi","logContent","boxIdContent","tv","Scroller","scrollTo","scrollTop","offsetHeight","ScrollView","bottomTime","topTime","refDiv","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","toString","eachChild","ref","Component","Loading","testingTags","pn","isTesting","tag","ms","args","global","handle","getHttpChannel","callFetch","put","ImageItemEdit","resId","onSaved","formRes","required","number","integer","min","zh","listRes","none","loginRes","registerRes","isFirst","pageItemAction","itemConverter","scrollToTop","scrollIntoView","topDiv","scrollToBottom","bottomDiv","changing","divId","loadResults","pageList","beforeLoad","loaded","allLoaded","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","onLoad","setPageStart","onLoaded","reverse","computed","Tab","contentBuilder","notify","onShown","_content","selected","TabCaptionComponent","tabBg","sep","tabClick","tab","selectedTab","tabArr","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","display","Tabs","ResUploader","fileInput","upload","formData","buildFormData","onFilesChange","files","names","fileName","maxSize","FormData","file","multiple","onChange","formatSize","pointLength","units","toFixed","ImageUploader","imgBaseSize","suffix","resUploader","onFileChange","fileError","uploaded","enableUploadButton","imageTypes","reader","FileReader","readAsDataURL","onload","srcImage","setSize","desImgSize","desImage","compress","img","width","height","srcImgWidth","srcImgHeight","w","scale","desImgWidth","round","desImgHeight","canvas","createElement","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","isChanged","showOrgImage","maxWidth","urlData","mime","match","bstr","atob","u8arr","Uint8Array","Blob","defaultChecked","disabled","levelDiv","padding","AudioUploader","audioTypes","fileSize","uploading","UqMan","uqData","tvs","actions","sheets","queries","books","maps","histories","pendings","tags","tuidsCache","localAccess","localModifyMax","createBoxIdFromTVs","tuidArr","actionArr","sheetArr","queryArr","bookArr","mapArr","historyArr","pendingArr","tagArr","clearTuids","trim","TuidsCache","accesses","loadAccess","buildTuids","buildAccess","newTuid","entityName","fromType","fromObj","book","Book","Tag","History","pending","Pending","Sheet","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","buildSheet","build","buildTuidBox","buildTuidDivBox","modifyMax","states","ops","op","discription","app","flow","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","count","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","renderView","checked","renderCheck","wrapClassName","inputs","inputName","onInputChange","input","coll","_view","lines","line","ext","mobileRegex","emailRegex","timeRes","md","month","ymd","year","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","getDate","getMonth","getFullYear","appendTime","dPart","hm","EasyTime","allowEmptySearch","onSubmit","preventDefault","initKey","onSearch","inputSize","inputClassName","onFocus","placeholder","buttonText","maxLength","defaultValue","userCache","loader","UserIcon","noneImage","UserView","idProp","useUser","use","cacheTimer","clearCacheTimer","tuidCached","innerPullModify","tuidLists","queueModify","group","modify","UQsMan","tonvaAppName","collection","localData","buildTVs","uqTVs","lj","uqsData","promiseInits","uqFullName","lower","retErrors","loadEntities","uqMan","Proxy","receiver","showReload","setInner","tuidImport","fromName","iName","setFrom","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","maxMsg","template","checkMore","RuleInt","isInteger","Widget","context","fieldProps","_ui","readOnly","isChanging","changeValue","container","visible","form","inNode","requiredFlag","FieldContainer","renderBody","getUiItem","errors","contextErrors","buildRules","check","removeErrorWidget","addErrorWidget","initData","fromElement","onChanging","onChanged","prev","allowChange","setDataValue","setElementValue","elDiscription","hasError","discriptionClassName","errorList","fieldClass","FieldClass","uiLabel","TextWidget","inputType","onKeyDown","internalOnKeyDown","keyCode","onEnter","blur","setError","onBlur","checkRules","checkContextRules","hasFocus","clearErrors","renderTemplet","renderErrors","TextAreaWidget","setValue","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","rowKey","isRow","RangeWidget","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","submit","observerRender","widgetType","button","ButtonClass","Context","uiSchema","subContexts","widgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","errorWidgets","ew","onButtonClick","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","clearContextErrors","checkHasError","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","edit","imageSrc","end","TagWidget","widgetsFactory","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","defaultArr","def","renderChecks","range","typeWidget","getItemSchema","getTypeWidget","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","fieldLabelSize","labelView","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","contextType","StringItemEdit","preValue","verifyValue","onSave","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","onItemChanged","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","divLabel","ie","createItemEdit","requireFlag","centerApi","VUnsupportedUnit","userName","uqsMan","VUnitSelect","renderRow","onRowClick","appUnits","VErrorsPage","VStartError","CAppBase","config","_uqs","noUnit","elements","userAppUnits","showUnsupport","appUnit","openVPage","userFromId","uqAppData","setTuidImportsLocal","buildUQs","CApp","appConfig","cApp","CBase","_cApp","CSub","_owner","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","selectedItems","compare","comp","selectItem","retItems","si","labelId","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","on","checkAll","anySelected","some","List","listBase","buildBase","selectAll","unselectAll","before","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","full","PropView","buildRows","isGap","setValues","propView","userSetProp","EnumNoteType","EnumTaskState","EnumTaskAct","CUqBase","CUqSub","CUqApp","stateTexts","other","act","todo","doing","done","pass","fail","rated","cancel","stateText","Token","TaskAct","VMain","cGroup","cReport","cMe","faceTabs","VMe","renderMe","CMe","itemStyle","onEditItemChanged","renderListItem","tagTest1","tagTest2","testParser","actionTestExpression","VTestForm","name1","name2","chars","lowercase","uppercase","Char","NULL","TAB","_R","ENTER","SPACE","PLUS","MINUS","STAR","BACKSLASH","SLASH","PERCENT","LParenthese","RParenthese","LBrace","RBrace","LBracket","RBracket","DOT","COMMA","SEMICOLON","COLON","TOPANGLE","EQU","LS","GT","AND","OR","Apostrophe","QUOT","UNDERLINE","QUESTION","ZERO","NINE","DOLLAR","AT","SHARP","m","o","q","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","USPACE","TokenStream","bracket","buffer","cur","dec","_var","varBrace","lowerVar","LastP","prevLine","prevAt","startLine","startAt","PrevToken","advance","sourceAt","getSourceNearby","errorAt","tokens","expectToken","VAR","expect","prevToken","lastP","lastLineNum","lastChatAt","lineNum","readToken","_FINISHED","ADD","ADDEQU","SUBEQU","readLineRemark","SUB","MUL","readVar","DOLLARVAR","readRemark","readInlineCode","DIV","MOD","LPARENTHESE","RPARENTHESE","LBRACE","RBRACE","XOR","GE","LE","NE","LT","BITWISEAND","BITWISEOR","LBRACKET","readSquareVar","RBRACKET","readString","readNumber","CODE","firstDigit","NUM","rate","HEX","fromCharCode","quote","STRING","loop","Atom","OpOr","or","OpAnd","and","OpNot","not","OpLE","le","OpLT","lt","OpEQ","eq","OpNE","ne","OpGT","gt","OpGE","ge","OpAdd","OpSub","sub","OpMul","mul","OpDiv","OpMod","mod","OpBitwiseAnd","bitAnd","OpBitwiseOr","bitOr","OpNeg","neg","OpBrace","TextOperand","NumberOperand","HexOperand","hex","VarOperand","dotFirst","OpFunction","paramCount","dollarVars","OpDollarVar","dollarVar","Expression","ts","sourceStart","atoms","getSourceAt","atom","_parse","entry","isKeyword","NOT","expValue","bitWise","isValid","predefinedFunc","funcs","readFuncParameters","ReadFixCountFunc","ReadVariableParameters","concat","concat_ws","unix_timestamp","ValueExpression","exp","run","stateDefs","CTest","rev","performance","TestExpression","submitConvert","test1","test2","renderGroup","memberCount","vCount","onClickGroup","showGroupAssigns","onClickSend","buttonClick","onFormSubmit","saveGroup","onClickAdd","keyGroup","myGroupsPager","todosChanged","defaultGroupAssignCount","myLeft","myRight","showMyAssigns","VGroup","onUserLoaded","renderNote","noteItem","vNote","renderAsNote","renderTime","inputRef","getComputedStyle","addTextNote","inputed","commandsShown","divBottom","refDivBottom","divButtom","showCommands","taskTodo","onListFocus","onDetail","showGroupDetail","lastNoteItem","$create","groupNotesPager","Header","currentGroup","Footer","cnFooter","cnInputRow","borderRadius","bottomMark","VGroupDetail","groupMembersPager","saveGroupProp","onMember","memberId","showMemberDetail","renderMember","member","onSubmitAddMember","fromKey","groupAddMember","onAddMember","listRemoveMember","renderRemoveButton","onRemoveMemberList","renderRemoveMemberItem","members","groupRemoveMembers","onSelectRemoveMember","onRemoveMember","renderMemberAction","renderMembers","divMembers","NoteItem","NoteText","cnDiv","bgStyle","stateIcons","NoteAssign","assignId","renderInternal","NoteTaskTodo","taskId","dataToNoteItem","note","queryResults","Text","buildNoteText","Assign","noteAssign","assign","assigns","buildNoteAssign","Task","annItem","tasks","buildNoteTaskTodo","createNoteText","createNoteAssign","VBase","divTop","refTop","parentElement","previousElementSibling","VFooterInput","lostFocusTimeoutHandler","onAddAction","isFocused","inputContent","focus","onAdd","VList","onToggleEndItems","endItemsVisible","endListItems","loadEndItems","keyAssign","assignItem","onClickAssign","showAssign","renderAssignItem","renderAssignItemBase","renderEndItem","assignItems","assignListItems","renderDivTop","renderList","renderEndItems","renderDivBottom","renderItem","btnToggle","newAssign","renderVm","textColor","VListForSelf","VInfoInput","inputText","onEditInfo","onClickSave","onUpdate","VEditTextItemInput","vStopFlag","VAssign","spanUpdate","$update","ismy","oinfo","eIcon","eColor","eprops","setAssignItemContent","vEdit","setAssignItemFlag","onCheckChanged","isChecked","my","worker","renderAssignItems","todos","renderTodo","doneMemo","saveTodoDone","saveTodoContent","renderMemo","setTodoFlag","saveTodoDoneMemo","task","actionTime","renderFrom","renderCaption","renderDiscription","renderTodos","VAssignDraft","editDiscription","saveDiscription","disc","saveAssignDiscription","renderDraft","selfDone","selfDoneCaption","renderSelfDone","vTitle","isMyAssign","saveAssignItem","VAssignEnd","VAssignDraftSelf","saveTodoItem","VAssignEndSelf","renderTaskItem","VListNoMember","VAssignDraftNoMember","renderTodoWithCheck","VAssignEndNoMember","VTask","rendTodoListItem","renderMore","checkMemo","renderTodoDot","memo","dotColor","dotIcon","VDone","point","doneTask","doneAssign","afterAct","enabled","calcEnabled","VCheck","passTask","failTask","renderTodoRadio","renderCheckMemo","saveTodoCheck","saveTodoCheckMemo","VRate","rateTask","checkStr","VFlowDetail","renderFlows","actText","CAssigns","showList","groupId","GetAssigns","openVList","loadAssign","openVAssign","showFlowDetail","GetTaskFlow","CreateAssign","todoContent","AssignItem","toList","SendAssign","showDone","Todo","vDone","vCheck","meAct","checker","rater","comment","DoneAssign","DoneTask","PassTask","FailTask","RateTask","GetAssign","retAssign","tolist","assignObj","mergeWith","onAssignLoaded","retAct","addGroupAssignCount","CAssignsForGroup","groupBoxId","assure","GetGroupMembers","setEachPageItem","SaveGroupProp","Group","AddGroupMember","RemoveGroupMember","CAssignsNoMember","CreateAndSendAssign","CAssignsSelf","VListForGroup","VSendBase","steps","next","sendout","btnNext","nextDisabled","btnPrev","renderMiddlePart","renderUserWithCheck","radioName","setter","membersPager","meId","renderToList","renderChecker","renderRater","CSend","checkerId","raterId","startAction","VAssignTasks","renderTasks","renderMy","renderSelf","renderOthers","tasksToCategory","checks","rates","renderRates","getTaskAction","renderEndFlag","actName","showCheck","renderActions","showRate","starts","dones","passes","fails","rateds","cancels","VAssignDraftWithMember","showAssignTo","VAssignWithMemberTasks","myCanEdit","VAssignDoingWithMember","renderFlow","angle","renderAdmin","admin","VAssignEndWithMember","CAssignsWithMember","newSub","invalids","isChecker","isRater","CHome","currentGroupItem","lastTick","defaultGroupId","noteItemConverter","showGroup","unread","setCurrentGroupItem","resetTick","cAssignsMy","newC","cAssigns","showMyTodos","PushNote","retNoteId","nts","afterAddNote","saveTaskProp","currentTask","publishAssign","PublishAssign","saveTodo","taskAct","toState","revokeTask","RemoveTask","GroupsPager","GetMyGroups","GetGroupNotes","setItemConverter","setReverse","myDefaultGroupIndex","isDefault","r0","delta","groupItem","SaveGroup","retGroupId","GroupTuid","MyTickTodo","attach","tickTodo","retTickTodo","pageId","cnIcon","VMyTasks","stepText","myTaskItem","stepDate","stepComment","onTaskClick","cnTabSelected","myTasksPager","loadTaskArchive","VReport","showCatProject","showProjects","catMember","bgIcon","cMember","catProject","catAssigns","catTasks","showMyTasks","cat","VMyTodos","keyDoing","onClickDoing","renderDoing","renderIcon","renderNick","renderState","myDoingsPager","pointer","CReport","myArchiveTodosPager","testText","TestText","tIn","GetMyTasks","VMemberDetail","renderMemberItem","memberItem","onMemberItem","showDepartment","myMembersPager","VDepartmentList","CMember","GetMyMembers","VProjectList","projectListContent","projectsPager","renderProject","projectItem","saveProject","onSelectItem","VSelectProject","onClickProjectItem","CProject","ProjectPager","GetMyProjects","SaveProject","retProjectId","projectId","projectBoxId","Project","nitem","project","CSelectProject","gaps","cHome","cProject","cSelectProject","gapIndex","callTick","$Poked","poke","showMain","initTabName","aId","innerText","hello","bId","cId","ReactDOM","hookElements","onfocus","retAfterTaskAction","showDialog","setSettings","App","Boolean","hostname","elRoot"],"mappings":"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","file":"static/js/main.c7e98d54.chunk.js","sourcesContent":["export * from './tool';\nexport * from './net';\nexport * from './components';\nexport * from './entry';\nexport * from './uq';\n//export * from './CApp';\nexport * from './app';\nexport * from './vm';\n","export * from './nav';\nexport * from './page';\nexport * from './schema';\nexport * from './form';\nexport * from './edit';\nexport * from '../res/res';\nexport * from './loading';\nexport * from './image';\nexport * from './resUploader';\nexport * from './rules';\nexport * from './list';\nexport * from './dropDownActions';\nexport * from './easyDate';\nexport * from './propGrid';\nexport * from './simple';\nexport * from './media';\nexport * from './searchBox';\nexport * from './userIcon';\n\n","\nimport {setCenterToken} from './uqApi';\nimport {WSChannel} from './wsChannel';\n\nexport const netToken = {\n    set(userId:number, token:string) {\n        setCenterToken(userId, token);\n        WSChannel.setCenterToken(token);\n    },\n    clear() {\n        setCenterToken(0, undefined);\n        WSChannel.setCenterToken(undefined);\n    }\n};\n","import * as React from 'react';\nimport {FetchError} from '../net/fetchError';\nimport { refetchApi } from '../net';\nimport { Page } from './page/page';\n\nexport interface FetchErrorProps extends FetchError {\n    clearError: ()=>void\n}\n\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\n    private reApi = async () => {\n        this.props.clearError();\n        const {channel, url, options, resolve, reject} = this.props;\n        await refetchApi(channel, url, options, resolve, reject);\n    }\n    private close = async () => {\n        this.props.clearError();\n    }\n    render() {\n        let {error, url} = this.props;\n        let errContent:any;\n        if (typeof error === 'object') {\n            let err = [];\n            for (let i in error) {\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\n            }\n            errContent = <ul>{err}</ul>;\n        }\n        else {\n            errContent = <div>{error}</div>;\n        }\n        return <div>\n            <article>\n\t\t\t\t<main className=\"va-error\">\n\t\t\t\t\t<div>网络出现问题</div>\n\t\t\t\t\t<div>点击重新访问</div>\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\n\t\t\t\t\t{errContent}\n\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t<button type='button' onClick={this.reApi}>重新API</button>\n\t\t\t\t\t\t<button type='button' onClick={this.close}>关闭</button>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n            </article>\n        </div>;\n    }\n}\n\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\n    return <Page header=\"系统提醒\">\n        <div className=\"px-3\">{message}</div>\n    </Page>;\n}","import * as React from 'react';\nimport { nav } from './nav';\nimport { Page } from './page/page';\n\ninterface Props {\n    message: string,\n    seconds: number\n}\n\ninterface State {\n    seconds: number\n}\n\nexport class ReloadPage extends React.Component<Props, State> {\n    private timerHandler:any;\n    constructor(props:Props) {\n\t\tsuper(props);\n\t\tlet {seconds} = props;\n\t\tif (seconds===undefined) return;\n        this.state = {seconds};\n\t\tif (seconds <= 0) return;\n        this.timerHandler = setInterval(() => {\n\t\t\tlet {seconds} = this.state;\n            seconds--;\n            if (seconds <= 0) {\n                this.reload();\n            }\n            else {\n                this.setState({seconds: seconds});\n            }\n        }, 1000);\n    }\n    private reload = () => {\n        clearInterval(this.timerHandler);\n        nav.reload();\n    }\n    render() {\n\t\tlet {seconds} = this.state;\n\t\tlet title:string, msg:string;\t\t\n\t\tif (seconds > 0) {\n\t\t\ttitle = '程序升级中...';\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\n\t\t}\n\t\telse {\n\t\t\ttitle = '程序需要升级';\n\t\t\tmsg = '请点击下面按钮重启';\n\t\t}\n        return <Page header={false}>\n            <div className=\"text-center p-5\">\n                <div className=\"text-info py-5\">\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\n\t\t\t\t\t<br/>\n\t\t\t\t\t{msg}\n                    <br/>\n                    <span className=\"small text-muted\">{this.props.message}</span>\n                </div>\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\n            </div>\n        </Page>;\n    }\n}\n\ninterface ConfirmReloadPageProps {\n    confirm: (ok: boolean)=>Promise<void>;\n}\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\n    return <Page header=\"升级软件\" back=\"close\">\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\n            <div className=\"text-center text-info\">\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\n            </div>\n            <div className=\"text-center mt-5\">\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\n            </div>\n        </div>\n    </Page>;\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\n}\n","import * as React from 'react';\nimport {observable} from 'mobx';\nimport marked from 'marked';\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\nimport {Page} from './page/page';\nimport {netToken} from '../net/netToken';\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\nimport {FetchError} from '../net/fetchError';\nimport {appUrl, setAppInFrame, getExHash, getExHashPos} from '../net/appBridge';\nimport {LocalData, env} from '../tool';\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, WSChannel, appInFrame, host, resUrlFromHost} from '../net';\nimport { WsBase, wsBridge } from '../net/wsChannel';\nimport { resOptions } from '../res/res';\nimport { Loading } from './loading';\n\nimport 'font-awesome/css/font-awesome.min.css';\nimport '../css/va-form.css';\nimport '../css/va.css';\nimport '../css/animation.css';\nimport { FA } from './simple';\nimport { userApi } from '../net';\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\n\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\n    'BlackBerry|Windows Phone|'  +\n    'Opera Mini|IEMobile|Mobile' , \n    'i');\nconst isMobile = regEx.test(navigator.userAgent);\n\n/*\nexport const mobileHeaderStyle = isMobile? {\n    minHeight:  '3em'\n} : undefined;\n*/\n//const logo = require('../img/logo.svg');\nlet logMark: number;\nconst logs:string[] = [];\n\nexport interface Props //extends React.Props<Nav>\n{\n    //view: JSX.Element | (()=>JSX.Element);\n    //start?: ()=>Promise<void>;\n    onLogined: ()=>Promise<void>;\n    notLogined?: ()=>Promise<void>;\n};\nlet stackKey = 1;\nexport interface StackItem {\n    key: number;\n    view: JSX.Element;\n    ceased: boolean;\n    confirmClose?: ()=>Promise<boolean>;\n    disposer?: ()=>void;\n}\nexport interface NavViewState {\n    stack: StackItem[];\n    wait: 0|1|2;\n    fetchError: FetchError\n}\n\nexport class NavView extends React.Component<Props, NavViewState> {\n    private stack: StackItem[];\n    private htmlTitle: string;\n    private waitCount: number = 0;\n    private waitTimeHandler?: NodeJS.Timer;\n\n    constructor(props:Props) {\n        super(props);\n        //this.back = this.back.bind(this);\n        //this.navBack = this.navBack.bind(this);\n        this.stack = [];\n        this.state = {\n            stack: this.stack,\n            wait: 0,\n            fetchError: undefined\n        };\n    }\n    async componentDidMount()\n    {\n        window.addEventListener('popstate', this.navBack);\n        nav.set(this);\n        await nav.start();\n    }\n\n    get level(): number {\n        return this.stack.length;\n    }\n\n    startWait() {\n        if (this.waitCount === 0) {\n            this.setState({wait: 1});\n            this.waitTimeHandler = env.setTimeout(\n                'NavView.startWait',\n                () => {\n                    this.waitTimeHandler = undefined;\n                    this.setState({wait: 2});\n                },\n                1000) as NodeJS.Timer;\n        }\n        ++this.waitCount;\n        this.setState({\n            fetchError: undefined,\n        });\n    }\n\n    endWait() {\n        env.setTimeout(\n            undefined, //'NavView.endWait',\n            () => {\n            /*\n            this.setState({\n                fetchError: undefined,\n            });*/\n            --this.waitCount;\n            if (this.waitCount === 0) {\n                if (this.waitTimeHandler !== undefined) {\n                    env.clearTimeout(this.waitTimeHandler);\n                    this.waitTimeHandler = undefined;\n                }\n                this.setState({wait: 0});\n            }\n        },100);\n    }\n\n    async onError(fetchError: FetchError)\n    {\n        let err = fetchError.error;\n        if (err !== undefined) {\n            if (err.unauthorized === true) {\n                await nav.showLogin(undefined);\n                return;\n            }\n            switch (err.type) {\n                case 'unauthorized':\n                    await nav.showLogin(undefined);\n                    return;\n                case 'sheet-processing':\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\n                    return;\n            }\n        }\n        this.setState({\n            fetchError: fetchError,\n        });\n    }\n\n    private upgradeUq = () => {\n        nav.start();\n    }\n\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        this.show(<Page header={false}>\n            <div>\n                UQ升级了，请点击按钮升级 <br />\n                <small className=\"text-muted\">{uq} ver-{version}</small>\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\n            </div>\n        </Page>)\n    }\n\n    show(view: JSX.Element, disposer?: ()=>void): number {\n        this.clear();\n        return this.push(view, disposer);\n    }\n\n    push(view: JSX.Element, disposer?: ()=>void): number {\n        this.removeCeased();\n        if (this.stack.length > 0) {\n            window.history.pushState('forward', null, null);\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key,\n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        this.refresh();\n        //console.log('push: %s pages', this.stack.length);\n        return key;\n    }\n\n    replace(view: JSX.Element, disposer?: ()=>void): number {\n        let item:StackItem = undefined;\n        let stack = this.stack;\n        if (stack.length > 0) {\n            item = stack.pop();\n            //this.popAndDispose();\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key, \n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        if (item !== undefined) this.dispose(item.disposer);\n        this.refresh();\n        //console.log('replace: %s pages', this.stack.length);\n        return key;\n    }\n\n    ceaseTop(level:number = 1) {\n        let p = this.stack.length - 1;\n        for (let i=0; i<level; i++, p--) {\n            if (p < 0) break;\n            let item = this.stack[p];\n            item.ceased = true;\n        }\n    }\n\n    pop(level:number = 1) {\n        let stack = this.stack;\n        let len = stack.length;\n        //console.log('pop start: %s pages level=%s', len, level);\n        if (level <= 0 || len <= 1) return;\n        if (len < level) level = len;\n        let backLevel = 0;\n        for (let i = 0; i < level; i++) {\n            if (stack.length === 0) break;\n            //stack.pop();\n            this.popAndDispose();\n            ++backLevel;\n        }\n        if (backLevel >= len) backLevel--;\n        this.refresh();\n        if (this.isHistoryBack !== true) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(backLevel);\n            //window.addEventListener('popstate', this.navBack);\n        }\n        //console.log('pop: %s pages', stack.length);\n    }\n\n    popTo(key: number) {\n        if (key === undefined) return;\n        if (this.stack.find(v => v.key === key) === undefined) return;\n        while (this.stack.length >0) {\n            let len = this.stack.length;\n            let top = this.stack[len-1];\n            if (top.key === key) break;\n            this.pop();\n        }\n    }\n\n    topKey():number {\n        let len = this.stack.length;\n        if (len === 0) return undefined;\n        return this.stack[len-1].key;\n    }\n\n    removeCeased() {\n        for (;;) {\n            let p=this.stack.length-1;\n            if (p < 0) break;\n            let top = this.stack[p];\n            if (top.ceased === false) break;\n            let item = this.stack.pop();\n            let {disposer} = item;\n            this.dispose(disposer);\n        }\n        this.refresh();\n    }\n\n    private popAndDispose() {\n        this.removeCeased();\n        let item = this.stack.pop();\n        if (item === undefined) return;\n        let {disposer} = item;\n        this.dispose(disposer);\n        this.removeCeased();\n        return item;\n    }\n\n    private dispose(disposer:()=>void) {\n        if (disposer === undefined) return;\n        let item = this.stack.find(v => v.disposer === disposer);\n        if (item === undefined) disposer();\n    }\n\n    clear() {\n        let len = this.stack.length;\n        while (this.stack.length > 0) this.popAndDispose();\n        //this.refresh();\n        if (len > 1) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(len-1);\n            //window.addEventListener('popstate', this.navBack);\n        }\n    }\n\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        let top = stack[len-1];\n        top.confirmClose = confirmClose;\n    }\n\n    private isHistoryBack:boolean = false;\n    navBack = () => {\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\n        let tick = Date.now();\n        this.isHistoryBack = true;\n        this.back(true);\n        this.isHistoryBack = false;\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\n    }\n\n    back = async (confirm:boolean = true) => {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        if (len === 1) {\n            if (window.self !== window.top) {\n                window.top.postMessage({type:'pop-app'}, '*');\n            }\n            return;\n        }\n        let top = stack[len-1];\n        if (confirm===true && top.confirmClose) {\n            if (await top.confirmClose()===true) this.pop();\n        }\n        else {\n            this.pop();\n        }\n    }\n\n    confirmBox(message?:string): boolean {\n        return window.confirm(message);\n    }\n    clearError = () => {\n        this.setState({fetchError: undefined});\n    }\n    render() {\n        const {wait, fetchError} = this.state;\n        let stack = this.state.stack;\n        let top = stack.length - 1;\n        let elWait = null, elError = null;\n        switch (wait) {\n            case 1:\n                elWait = <div className=\"va-wait va-wait1\">\n                </div>;\n                break;\n            case 2:\n                elWait = <div className=\"va-wait va-wait2\">\n                    <Loading />\n                </div>;\n                break;\n        }\n        if (fetchError)\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\n        let test = nav.testing===true && \n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\n                <FA className=\"text-warning\" name=\"info-circle\" />\n            </span>;\n        return <>\n\t\t\t{stack.map((item, index) => {\n\t\t\t\tlet {key, view} = item;\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\n\t\t\t\t\t{view}\n\t\t\t\t</div>\n\t\t\t})}\n\t\t\t{elWait}\n\t\t\t{elError}\n\t\t\t{test}\n        </>;\n    }\n\n    private refresh() {\n        this.setState({stack: this.stack });\n    }\n}\n\nexport interface NavSettings {\n    oem?: string;\n    loginTop?: JSX.Element;\n    privacy?: string;\n}\n\nexport class Nav {\n    private nav:NavView;\n    private ws: WsBase;\n    private wsHost: string;\n    private local: LocalData = new LocalData();\n    private navSettings: NavSettings;\n    @observable user: User/*InNav*/ = undefined;\n    testing: boolean;\n    language: string;\n    culture: string;\n    resUrl: string;\n\n    constructor() {\n        let {lang, district} = resOptions;\n        this.language = lang;\n        this.culture = district;\n        this.testing = false;\n    }\n\n    get guest(): number {\n        let guest = this.local.guest;\n        if (guest === undefined) return 0;\n        let g = guest.get();\n        if (g === undefined) return 0;\n        return g.guest;\n    }\n\n    set(nav:NavView) {\n        //this.logo = logo;\n        this.nav = nav;\n    }\n\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\n        if (this.ws === undefined) return;\n        return this.ws.onWsReceiveAny(handler);\n    }\n\n    unregisterReceiveHandler(handlerId:number) {\n        if (this.ws === undefined) return;\n        if (handlerId === undefined) return;\n        this.ws.endWsReceive(handlerId);\n    }\n\n    async onReceive(msg:any) {\n        if (this.ws === undefined) return;\n        await this.ws.receive(msg);\n    }\n\n\tprivate async loadUnitJson() {\n\t\ttry {\n\t\t\tlet unitJsonPath = this.unitJsonPath();\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\n\t\t\tlet res = await unitRes.json();\n\t\t\treturn res.unit;\n\t\t}\n\t\tcatch (err1) {\n\t\t\tthis.local.unit.remove();\n\t\t\treturn;\n\t\t}\n\t}\n\n    private async getPredefinedUnitName() {\n\t\tlet el = document.getElementById('unit.json');\n\t\tif (!el) {\n\t\t\treturn await this.loadUnitJson();\n\t\t}\n\t\ttry {\n            let json = el.innerHTML;\n            let res = JSON.parse(json);\n            return res.unit;\n        }\n        catch (err) {\n\t\t\treturn await this.loadUnitJson();\n        }\n    }\n\n    private async loadPredefinedUnit() {\n        let envUnit = process.env.REACT_APP_UNIT;\n        if (envUnit !== undefined) {\n            return Number(envUnit);\n        }\n        let unitName:string;\n        let unit = this.local.unit.get();\n        if (unit !== undefined) {\n            if (env.isDevelopment !== true) return unit.id;\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n            if (unit.name === unitName) return unit.id;\n        }\n        else {\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n        }\n        let unitId = await guestApi.unitFromName(unitName);\n        if (unitId !== undefined) {\n            this.local.unit.set({id: unitId, name: unitName});\n        }\n        return unitId;\n    }\n\n    setSettings(settings?: NavSettings) {\n        this.navSettings = settings;\n    }\n\n    get oem():string {\n        return this.navSettings && this.navSettings.oem;\n    }\n\n    hashParam: string;\n    private centerHost: string;\n    private arrs = ['/test', '/test/'];\n    private unitJsonPath():string {\n        let {origin, pathname} = document.location;\n        //href = href.toLowerCase();\n        pathname = pathname.toLowerCase();\n        for (let item of this.arrs) {\n            if (pathname.endsWith(item) === true) {\n                pathname = pathname.substr(0, pathname.length - item.length);\n                break;\n            }\n        }\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\n            pathname = pathname.substr(0, pathname.length-1);\n        }\n        return origin + pathname + '/unit.json';\n    }\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\n        console.error('windowOnError');\n        console.error(error);\n    }\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\n        console.error('windowOnUnhandledRejection');\n        console.error(ev.reason);\n    }\n    private windowOnClick = (ev: MouseEvent) => {\n        console.error('windowOnClick');\n    }\n    private windowOnMouseMove = (ev: MouseEvent) => {\n        console.log('navigator.userAgent: ' + navigator.userAgent);\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\n    }\n    private windowOnScroll = (ev: Event) => {\n        console.log('scroll event');\n    }\n    async start() {\n        try {\n            window.onerror = this.windowOnError;\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\n            //window.addEventListener('click', this.windowOnClick);\n            //window.addEventListener('mousemove', this.windowOnMouseMove);\n            //window.addEventListener('touchmove', this.windowOnMouseMove);\n            //window.addEventListener('scroll', this.windowOnScroll);\n            if (isMobile === true) {\n                document.onselectstart = function() {return false;}\n                document.oncontextmenu = function() {return false;}\n            }\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\n            this.testing = env.testing;\n            await host.start(this.testing);\n            let hash = document.location.hash;\n            if (hash !== undefined && hash.length > 0) {\n                let pos = getExHashPos();\n                if (pos < 0) pos = undefined;\n                this.hashParam = hash.substring(1, pos);\n            }\n            nav.clear();\n            this.startWait();\n            let {url, ws, resHost} = host;\n            this.centerHost = url;\n            this.resUrl = resUrlFromHost( resHost);\n            this.wsHost = ws;\n            setCenterUrl(url);\n            \n            let guest:Guest = this.local.guest.get();\n            if (guest === undefined) {\n                guest = await guestApi.guest();\n            }\n            nav.setGuest(guest);\n\n            let exHash = getExHash();\n            let appInFrame = setAppInFrame(exHash);\n            if (exHash !== undefined && window !== window.parent) {\n                // is in frame\n                if (appInFrame !== undefined) {\n                    this.ws = wsBridge;\n                    console.log('this.ws = wsBridge in sub frame');\n                    //nav.user = {id:0} as User;\n                    if (window.self !== window.parent) {\n                        window.parent.postMessage({type:'sub-frame-started', hash: appInFrame.hash}, '*');\n                    }\n                    // 下面这一句，已经移到 appBridge.ts 里面的 initSubWin，也就是响应从main frame获得user之后开始。\n                    //await this.showAppView();\n                    return;\n                }\n            }\n\n            let predefinedUnit = await this.loadPredefinedUnit();\n            appInFrame.predefinedUnit = predefinedUnit;\n\n            let user: User = this.local.user.get();\n            if (user === undefined) {\n                let {notLogined} = this.nav.props;\n                if (notLogined !== undefined) {\n                    await notLogined();\n                }\n                else {\n                    await nav.showLogin(undefined);\n                }\n                return;\n            }\n\n            await nav.logined(user);\n        }\n        catch (err) {\n        }\n        finally {\n            this.endWait();\n        }\n    }\n\n    async showAppView() {\n        let {onLogined} = this.nav.props;\n        if (onLogined === undefined) {\n            nav.push(<div>NavView has no prop onLogined</div>);\n            return;\n        }\n        nav.clear();\n        await onLogined();\n        //console.log('logined: AppView shown');\n    }\n\n    setGuest(guest: Guest) {\n        this.local.guest.set(guest);\n        netToken.set(0, guest.token);\n    }\n\n    saveLocalUser() {\n        this.local.user.set(this.user);\n    }\n\n    async loadMe() {\n        let me = await userApi.me();\n        this.user.icon = me.icon;\n        this.user.nick = me.nick;\n    }\n\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\n        logoutApis();\n        console.log(\"logined: %s\", JSON.stringify(user));\n        this.user = user;\n        this.saveLocalUser();\n        netToken.set(user.id, user.token);\n        if (callback !== undefined) //this.loginCallbacks.has)\n            callback(user);\n            //this.loginCallbacks.call(user);\n        else {\n            await this.showAppView();\n        }\n    }\n\n    wsConnect() {\n        let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\n        ws.connect();\n    }\n\n    loginTop(defaultTop:JSX.Element) {\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\n    }\n\n    privacyEntry() {\n        if (!this.getPrivacyContent()) return;\n        return <div className=\"text-center\">\n            <button className=\"btn btn-sm btn-link\"\n                onClick={this.showPrivacyPage}>\n                <small className=\"text-muted\">隐私政策</small>\n            </button>\n        </div>;\n    }\n\n    private getPrivacyContent():string {\n        if (!this.navSettings) return;\n        let {privacy} = this.navSettings;\n        return privacy;\n    }\n\n    showPrivacyPage = () => {\n        let privacy = this.getPrivacyContent();\n        if (privacy) {\n            this.privacyPage(privacy);\n        }\n        else {\n            nav.push(<Page header=\"隐私政策\">\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\n            </Page>);\n        }\n    }\n\n    private privacyPage = async (privacy:string) => {\n        let html = await this.getPrivacy(privacy);\n        let content = {__html: marked(html)};\n        nav.push(<Page header=\"隐私政策\">\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\n        </Page>);\n    }\n\n    private async getPrivacy(privacy:string):Promise<string> {\n        const headers = new  Headers({\n            \"Content-Type\":'text/plain'\n       })\n        let pos = privacy.indexOf('://');\n        if (pos > 0) {\n            let http = privacy.substring(0, pos).toLowerCase();\n            if (http === 'http' || http === 'https') {\n                try {\n                    let res = await fetch(privacy, {\n                        method:'GET',\n                        headers: headers,\n                    });\n                    let text = await res.text();\n                    return text;\n                }\n                catch (err) {\n                    return err.message;\n                }\n            }\n        }\n        return privacy;\n    }\n\n    async showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\n        let lv = await import('../entry/login');\n        let loginView = <lv.default \n            withBack={withBack} \n            callback={callback} />;\n        if (withBack !== true) {\n            this.nav.clear();\n            this.pop();\n        }\n        this.nav.push(loginView);\n    }\n\n    async showLogout(callback?: ()=>Promise<void>) {\n        let footer = <div className=\"text-center justify-content-center\">\n            <button className=\"btn btn-outline-danger\" onClick={this.resetAll}>升级软件</button>\n        </div>;\n        nav.push(<Page header=\"安全退出\" back=\"close\" footer={footer}>\n            <div className=\"my-5 mx-1 border border-info bg-white rounded p-3 text-center\">\n                <div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\n                <div className=\"mt-3 text-center\">\n                        <button className=\"btn btn-danger\" onClick={()=>this.logout(callback)}>安全退出</button>\n                </div>\n            </div>\n        </Page>);\n    }\n\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\n        appInFrame.unit = undefined;\n        this.local.logoutClear();\n        this.user = undefined; //{} as User;\n        logoutApis();\n        let guest = this.local.guest.get();\n        setCenterToken(0, guest && guest.token);\n        this.ws = undefined;\n        /*\n        if (this.loginCallbacks.has)\n            this.logoutCallbacks.call();\n        else {\n            if (notShowLogin === true) return;\n        }\n        await nav.start();\n        */\n        if (callback === undefined)\n            await nav.start();\n        else\n            await callback();\n    }\n\n    async changePassword() {\n        let cp = await import('../entry/changePassword');\n        nav.push(<cp.ChangePasswordPage />);\n    }\n\n    get level(): number {\n        return this.nav.level;\n    }\n    startWait() {\n        this.nav.startWait();\n    }\n    endWait() {\n        this.nav.endWait();\n    }\n    async onError(error: FetchError) {\n        await this.nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await this.nav.showUpgradeUq(uq, version);\n    }\n\n    show (view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.show(view, disposer);\n    }\n    push(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.push(view, disposer);\n    }\n    replace(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.replace(view, disposer);\n    }\n    pop(level:number = 1) {\n        this.nav.pop(level);\n    }\n    topKey():number {\n        return this.nav.topKey();\n    }\n    popTo(key:number) {\n        this.nav.popTo(key);\n    }\n    clear() {\n        this.nav.clear();\n    }\n    navBack() {\n        this.nav.navBack();\n    }\n    ceaseTop(level?:number) {\n        this.nav.ceaseTop(level);\n    }\n    removeCeased() {\n        this.nav.removeCeased();\n    }\n    async back(confirm:boolean = true) {\n        await this.nav.back(confirm);\n    }\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.nav.regConfirmClose(confirmClose);\n    }\n    confirmBox(message?:string): boolean {\n        return this.nav.confirmBox(message);\n    }\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\n            let uh = sheetId === undefined?\n                    appUrl(url, unitId) :\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\n            console.log('navToApp: %s', JSON.stringify(uh));\n            nav.push(<article className='app-container'>\n                <span id={uh.hash} onClick={()=>this.back()} /*style={mobileHeaderStyle}*/>\n                    <i className=\"fa fa-arrow-left\" />\n                </span>\n                {\n                    // eslint-disable-next-line \n                    <iframe src={uh.url} title={String(sheetId)} />\n                }\n            </article>, \n            ()=> {\n                resolve();\n            });\n        });\n    }\n\n    navToSite(url: string) {\n        // show in new window\n        window.open(url);\n    }\n\n    get logs() {return logs};\n    log(msg:string) {\n        logs.push(msg);\n    }\n    logMark() {\n        let date = new Date();\n        logMark = date.getTime();\n        logs.push('log-mark: ' + date.toTimeString());\n    }\n    logStep(step:string) {\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\n    }\n\n    showReloadPage(msg: string) {\n        let seconds = -1;\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\n\t\t/*\n\t\tif (seconds > 0) {\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\n\t\t}\n\t\t*/\n    }\n\n    reload = async () => {\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\n            setTimeout(resolve, 100);\n        });\n\n        if ('serviceWorker' in navigator) {\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\n            if (registration) registration.unregister();\n        }\n        window.document.location.reload();\n    }\n\n    resetAll = () => {\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\n            if (ok === true) {\n                this.showReloadPage('彻底升级');\n\t\t\t\tlocalStorage.clear();\n\t\t\t\t/*\n                this.local.readToMemory();\n                env.localDb.removeAll();\n\t\t\t\tthis.local.saveToLocalStorage();\n\t\t\t\t*/\n            }\n            else {\n                this.pop();\n            }\n            return;\n        }} />);\n    }\n\n    async checkVersion():Promise<string> {\n        let {href} = document.location;\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\n        let ret = await fetch(href);\n        let r = await ret.text();\n        let parser = new DOMParser();\n        let htmlDoc = parser.parseFromString(r, 'text/html');\n        let elHtml = htmlDoc.getElementsByTagName('html');\n        let newVersion = elHtml[0].getAttribute('data-version');\n        return newVersion;\n    }\n}\nexport const nav: Nav = new Nav();\n","import { decodeGuestToken } from '../tool/user';\nimport { CenterApiBase } from './uqApi';\n\nexport class GuestApi extends CenterApiBase {\n    async guest(): Promise<any> {\n        //let guest = nav.local.guest.get();\n        let ret = await this.get('', {});\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeGuestToken(ret);\n            case 'object':\n                let guest = decodeGuestToken(ret.token);\n                return guest;\n        }\n    }\n\n    async unitFromName(unitName:string): Promise<number> {\n        let ret = await this.get(unitName);\n        return ret && ret.unit;\n    }\n}\n\nexport const guestApi = new GuestApi('tv/guest/', undefined);\n","export abstract class Caller<T> {\n    protected readonly _params: T;\n    constructor(params: T, waiting: boolean) {\n        this._params = params;\n        this.waiting = waiting;\n    }\n    protected get params():any {return this._params;}\n    buildParams():any {return this.params;}\n    method: string  = 'POST';\n    abstract get path(): string;\n    get headers(): {[header:string]: string} {return undefined}\n    waiting: boolean;\n}\n","export {WSChannel, wsBridge, postWsToTop} from './wsChannel';\nexport * from './apiBase';\nexport * from './guestApi';\nexport * from './caller';\nexport * from './uqApi';\nexport {appInFrame, isBridged, getExHash} from './appBridge';\nexport * from './host';\n//export {userApi} from './userApi';","import {observable} from 'mobx';\n\nexport interface Id {\n    id: number;\n}\n\nexport abstract class CacheIds<T extends Id> {\n    constructor(maxCount:number = 100) {\n        this.maxCount = maxCount;\n    }\n    private maxCount:number;\n    private arr:T[] = [];\n    @observable dict = new Map<number, T>();\n\n    loadIds(ids:number[]) {\n        let arr:number[] = [];\n        for (let id of ids) {\n            if (id === null) continue;\n            let item = this.dict.get(id);\n            if (item === undefined) {\n                arr.push(id);\n                item = {id:id} as T;\n                this.dict.set(id, item);\n            }\n        }                \n        this.loadId(arr);\n    }\n\n    get(id:number):T {\n        if (id === undefined || id === null) return null;\n        let item = this.dict.get(id);\n        if (item === undefined) {\n            this.dict.set(id, {id:id} as T);\n            this.loadId([id]);\n            item = this.dict.get(id);\n        }\n        return item;\n    }\n    private setItem(id:number, item:T) {\n        if (item === undefined) {\n            this.dict.set(id, null);\n            this.arr.push({id: id} as T);\n        }\n        else {\n            this.dict.set(id, item);\n            this.arr.push(item);\n        }\n        if (this.arr.length > this.maxCount) {\n            item = this.arr.shift();\n            this.dict.delete(item.id);\n        }\n    }\n    private async loadId(ids:number[]) {\n        let items = await this._loadIds(ids);\n        if (items === undefined) {\n            for (let id of ids) {\n                if (id === null) continue;\n                let item = await this._loadId(id);\n                this.setItem(id, item);\n            }\n        }\n        else {\n            for (let id of ids) {\n                let item = items.find(v => v.id === id);\n                this.setItem(id, item);\n            }\n        }\n    }\n\n    protected abstract async _loadIds(ids:number[]):Promise<T[]>;\n    protected abstract async _loadId(id:number):Promise<T>;\n}\n","import { env } from './env';\n\nexport class LocalData {\n    user = env.localDb.child('user');\n    guest = env.localDb.child('guest');\n    unit = env.localDb.child('unit');\n\n    private _user:string;\n    private _guest:string;\n    private _unit:string;\n    readToMemory() {\n        this._user = this.user.get();\n        this._guest = this.guest.get();\n        this._unit = this.unit.get();\n    }\n    saveToLocalStorage() {\n        this.user.set(this._user);\n        this.guest.set(this._guest);\n        this.unit.set(this._unit);\n    }\n\n    logoutClear() {\n        [\n            this.user,\n            this.unit,\n        ].forEach(d => d.remove());\n    }\n}\n","export {left0} from './left0';\nexport * from './user';\nexport * from './uid';\nexport {PageItems} from './pageItems';\nexport {CacheIds} from './cacheIds';\nexport {LocalMap, LocalArr, LocalCache} from './localDb';\nexport {LocalData} from './local';\nexport {env} from './env';","import * as React from 'react';\nimport {nav} from '../nav';\n\nexport interface PageHeaderProps {\n    back?: 'back' | 'close' | 'none';\n    center: string | JSX.Element;\n    right?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n    className?: string;\n\tafterBack?: () => void;\n\tex?: JSX.Element;\n}\n\nexport class PageHeader extends React.Component<PageHeaderProps> {\n    private back = async () => {\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\n\t\tlet {afterBack} = this.props;\n\t\tif (afterBack) afterBack();\n    }\n    openWindow() {\n        window.open(document.location.href);\n    }\n    private logoutClick = () => {\n        nav.showLogout(this.logout);\n    }\n    private logout = async () => {\n        let {logout} = this.props;\n        if (typeof logout === 'function') {\n            await logout(); \n        }\n        await nav.logout(undefined);\n    }\n    render() {\n        let b = nav.level > 1 || window.self !== window.top;\n        let {right, center, logout, className, ex} = this.props;\n        let back:any, debugLogout:any;\n        if (logout !== undefined && window.self === window.top) {\n            if ((typeof logout === 'boolean' && logout === true)\n                || typeof logout === 'function')\n            {\n                let {user} = nav;\n                if (user !== undefined) {\n                    let {nick, name} = user;\n                    debugLogout = <div className=\"d-flex align-items-center\">\n                        <small className=\"text-light\">{nick || name}</small>\n                        {\n                            // eslint-disable-next-line\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\n                                role=\"button\"\n                                onClick={this.logoutClick}>\n                                <i className=\"fa fa-sign-out fa-lg\" />\n                            </div>\n                        }\n                    </div>;\n                }\n            }\n        }\n        if (b) {\n            switch (this.props.back) {\n                case 'none':\n                    back = undefined;\n                    break;\n                default:\n                case 'back':\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\n                    break;\n                case 'close':\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\n                    break;\n            }\n        }\n        if (window.self !== window.top) {\n            console.log(document.location.href);\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\n        }\n        if (back === undefined && typeof center === 'string') {\n            center = <div className=\"px-3\">{center}</div>;\n        }\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\n\t\tlet header = <header className={className}>\n\t\t\t<nav>\n\t\t\t\t{back}\n\t\t\t\t{/*pop 弹出window暂时停止作用 */}\n\t\t\t\t<div>{center}</div>\n\t\t\t\t{rightView}\n\t\t\t</nav>\n\t\t\t{ex}\n\t\t</header>;\n        return <>\n\t\t\t<section className=\"tv-page-header\">{header}</section>\n\t\t\t{header}\n\t\t</>;\n\t\t/*\n\t\t\t<header className={className}>\n\t\t\t<section>\n\t\t\t\t<header>\n\t\t\t\t\t{back}\n\t\t\t\t\t<div>{center}</div>\n\t\t\t\t\t{rightView}\n\t\t\t\t</header>\n\t\t\t</section>\n            {back}\n            <div>{center}</div>\n            {rightView}\n        </header>;*/\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport {PageHeader} from './pageHeader';\nimport { TabsProps, TabsView } from './tabs';\nimport { ScrollProps, ScrollView } from './scrollView';\n\nexport interface IVPage {\n\tcontent():JSX.Element;\n\theader():JSX.Element;\n\tfooter():JSX.Element;\n}\n\n\nexport interface PageProps extends ScrollProps {\n    back?: 'close' | 'back' | 'none';\n    header?: boolean | string | JSX.Element;\n    right?: JSX.Element;\n    footer?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n\theaderClassName?: string;\n\tclassName?: string;\n\tafterBack?: () => void;\n\ttabsProps?: TabsProps;\n}\n\n@observer\nexport class Page extends React.Component<PageProps> {\n\tprivate tabsView: TabsView;\n    constructor(props: PageProps) {\n\t\tsuper(props);\n\t\tlet {tabsProps} = props;\n\t\tif (tabsProps) {\n\t\t\tthis.tabsView = new TabsView(tabsProps);\n\t\t}\n\t}\n\n\tprivate renderHeader() {\n\t\tconst {back, header, right, headerClassName, afterBack} = this.props;\n\t\tlet pageHeader = header !== false && <PageHeader \n\t\t\tback={back} \n\t\t\tcenter={header as any}\n\t\t\tright={right}\n\t\t\tlogout={this.props.logout}\n\t\t\tclassName={headerClassName}\n\t\t\tafterBack={afterBack}\n\t\t\t/>;\n\t\treturn pageHeader;\n\t}\n\n\tprivate renderFooter() {\n\t\tconst {footer} = this.props;\n\t\tif (footer) {\n\t\t\tlet elFooter = <footer>{footer}</footer>;\n\t\t\treturn <>\n\t\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\n\t\t\t\t{elFooter}\n\t\t\t</>;\n\t\t}\n\t}\n\n    render() {\n\t\tif (this.tabsView) {\n\t\t\treturn React.createElement(this.tabsView.content);\n\t\t}\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className} = this.props;\n\t\treturn <ScrollView\n\t\t\tonScroll={onScroll}\n\t\t\tonScrollTop={onScrollTop}\n\t\t\tonScrollBottom={onScrollBottom}\n\t\t\tclassName={className}\n\t\t>\n\t\t\t{this.renderHeader()}\n\t\t\t<main>{children}</main>\n\t\t\t{this.renderFooter()}\n\t\t</ScrollView>;\n\t}\n}\n","import _ from 'lodash';\nimport {nav} from '../components';\nimport {uid} from '../tool/uid';\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\nimport {setSubAppWindow} from './wsChannel';\nimport { host } from './host';\n\nexport interface UqToken {\n    name: string;\n    db: string;\n    url: string;\n    token: string;\n}\nconst uqTokens:{[uqName:string]: UqToken}  = {};\nexport function logoutUqTokens() {\n    for (let i in uqTokens) {\n        uqTokens[i] = undefined;\n    }\n}\n\nexport interface AppInFrame {\n    hash: string;\n    unit: number;       // unit id\n    page?: string;\n    param?: string[];\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\n}\nconst appsInFrame:{[key:string]:AppInFrame} = {};\n\nclass AppInFrameClass implements AppInFrame {\n    hash: string;\n    private _unit: number;\n    get unit(): number {return this._unit;}       // unit id\n    set unit(val:number) { this._unit=val;}\n    page?: string;\n    param?: string[];\n}\n\nexport let appInFrame:AppInFrame = new AppInFrameClass();\n/* {\n    hash: undefined,\n    get unit():number {return } undefined, //debugUnitId,\n    page: undefined;\n    param: undefined,\n}*/\n\nexport function isBridged():boolean {\n    return window.self !== window.parent;\n}\n\nwindow.addEventListener('message', async function(evt) {\n    var message = evt.data;\n    switch (message.type) {\n        case 'sub-frame-started':\n            subFrameStarted(evt);\n            break;\n        case 'ws':\n            //wsBridge.receive(message.msg);\n            await nav.onReceive(message.msg);\n            break;\n        case 'init-sub-win':\n            await initSubWin(message);\n            break;\n        case 'pop-app':\n            window.console.log('///\\\\\\\\\\\\ pop-app');\n            nav.navBack();\n            break;\n        case 'center-api':\n            await callCenterApiFromMessage(evt.source as Window, message);\n            break;\n        case 'center-api-return':\n            bridgeCenterApiReturn(message);\n            break;\n        case 'app-api':\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\n            (evt.source as Window).postMessage({\n                type: 'app-api-return', \n                apiName: message.apiName,\n                db: ret.db,\n                url: ret.url,\n                token: ret.token} as any, \"*\");\n            break;\n        case 'app-api-return':\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\n            console.log('await onAppApiReturn(message);');\n            await onAppApiReturn(message);\n            break;\n        default:\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\n            window.console.log('message: %s', JSON.stringify(message));\n            break;\n    }\n});\n\nfunction subFrameStarted(evt:any) {\n    var message = evt.data;\n    let subWin = evt.source as Window;\n    setSubAppWindow(subWin);\n    hideFrameBack(message.hash);\n    let msg:any = _.clone(nav.user);\n    msg.type = 'init-sub-win';\n    subWin.postMessage(msg, '*');\n}\nfunction hideFrameBack(hash:string) {\n    let el = document.getElementById(hash);\n    if (el !== undefined) el.hidden = true;\n}\nasync function initSubWin(message:any) {\n    console.log('initSubWin: set nav.user', message);\n    let user = nav.user = message; // message.user;\n    setCenterToken(user.id, user.token);\n    await nav.showAppView();\n}\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\n    let appInFrame = appsInFrame[hash];\n    if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\n    //let unit = getUnit();\n    let {unit, predefinedUnit} = appInFrame;\n    unit = unit || predefinedUnit;\n    if (!unit) {\n        console.error('no unit defined in unit.json or not logined in', unit);\n    }\n    let parts = apiName.split('/');\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\n    let ret = await uqTokenApi.uq(param);\n    let {db, url, token} = ret;\n    return {name: apiName, db:db, url: url, token: token};\n}\n\nasync function onAppApiReturn(message:any) {\n    let {apiName, db, url, urlTest, token} = message;\n    let action = uqTokenActions[apiName];\n    if (action === undefined) {\n        throw new Error('error app api return');\n        //return;\n    }\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\n    //action.url = realUrl;\n    //action.token = token;\n    action.resolve({\n        name: apiName,\n        db: db,\n        url: realUrl,\n        token: token,\n    } as UqToken);\n}\n\nexport function setAppInFrame(appHash: string):AppInFrame {\n    if (appHash) {\n        let parts = appHash.split('-');\n        let len = parts.length;\n        if (len > 0) {\n            let p = 1;\n            appInFrame.hash = parts[p++];\n            if (len>0) appInFrame.unit = Number(parts[p++]);\n            if (len>1) appInFrame.page = parts[p++];\n            if (len>2) appInFrame.param = parts.slice(p++);\n        }\n    }\n    return appInFrame;\n}\n\nexport function getExHashPos():number {\n    let hash = document.location.hash;\n    if (hash !== undefined && hash.length > 0) {\n        let pos = hash.lastIndexOf('#tv-');\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\n        return pos;\n    }\n    return -1;\n}\n\nexport function getExHash():string {\n    let pos = getExHashPos();\n    if (pos < 0) return undefined;\n    return document.location.hash.substring(pos);\n}\n\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\n    let u:string;\n    for (;;) {\n        u = uid();\n        let a = appsInFrame[u];\n        if (a === undefined) {\n            appsInFrame[u] = {hash:u, unit:unitId};\n            break;\n        }\n    }\n    url += '#tv-' + u + '-' + unitId;\n    if (page !== undefined) {\n        url += '-' + page;\n        if (param !== undefined) {\n            for (let i=0; i<param.length; i++) {\n                url += '-' + param[i];\n            }\n        }\n    }\n    return {url: url, hash: u};\n}\n\nfunction getUnit():number {\n    let {unit, predefinedUnit} = appInFrame;\n    let realUnit = unit || predefinedUnit;\n    if (realUnit === undefined) {\n        throw new Error('no unit defined in unit.json or not logined in');\n    }\n    return realUnit;\n}\n\ninterface UqTokenAction {\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\n    reject: (reason?: any) => void;\n}\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string, appOwner:string, appName:string):Promise<void> {\n    if (!isBridged()) {\n        let unit = getUnit();\n        let uqToken = await uqTokenApi.uq({unit:unit,  uqOwner:uqOwner, uqName:uqName, appOwner:appOwner, appName:appName});\n        if (uqToken.token === undefined) uqToken.token = centerToken;\n        let {db, url, urlTest} = uqToken;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        console.log('realUrl: %s', realUrl);\n        uqToken.url = realUrl;\n        uqTokens[uq] = uqToken;\n        return uqToken;\n    }\n    console.log(\"**** before buildAppUq ****\", appInFrame);\n    let bp = uqTokenActions[uq];\n    if (bp !== undefined) return;\n    return new Promise<void>((resolve, reject) => {\n        uqTokenActions[uq] = {\n            resolve: async (at:any) => {\n                let {db, url, token} = await at;\n                uqTokens[uq] = {\n                    name: uq,\n                    db: db,\n                    url: url,\n                    token: token,\n                };\n                uqTokenActions[uq] = undefined;\n                console.log(\"**** after buildAppUq ****\", appInFrame);\n                resolve();\n            },\n            reject: reject,\n        };\n        (window.opener || window.parent).postMessage({\n            type: 'app-api',\n            apiName: uq,\n            hash: appInFrame.hash,\n        }, \"*\");\n    });\n}\n\nexport function appUq(uq:string):UqToken {\n    let uts = uqTokens;\n    return uts[uq];\n}\n\ninterface BridgeCenterApi {\n    id: string;\n    resolve: (value?:any)=>any;\n    reject: (reason?:any)=>void;\n}\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\n    return await new Promise<any>(async (resolve, reject) => {\n        let callId:string;\n        for (;;) {\n            callId = uid();\n            let bca = brideCenterApis[callId];\n            if (bca === undefined) {\n                brideCenterApis[callId] = {\n                    id: callId,\n                    resolve: resolve,\n                    reject: reject,\n                }\n                break;\n            }\n        }\n        (window.opener || window.parent).postMessage({\n            type: 'center-api',\n            callId: callId,\n            url: url,\n            method: method,\n            body: body\n        }, '*');\n    });\n}\n\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\n    let {callId, url, method, body} = message;\n    let result = await callCenterapi.directCall(url, method, body);\n    from.postMessage({\n        type: 'center-api-return',\n        callId: callId,\n        result: result,\n    }, '*');\n}\n\nfunction bridgeCenterApiReturn(message:any) {\n    let {callId, result} = message;\n    let bca = brideCenterApis[callId];\n    if (bca === undefined) return;\n    brideCenterApis[callId] = undefined;\n    bca.resolve(result);\n}\n","//import _ from 'lodash';\nimport { Caller } from '../net';\nimport { Entity } from './entity';\nimport { Action } from './action';\nimport { Query } from './query';\n\ninterface UqResponseSchema {\n    uq: any;\n    entity: any;\n}\n\nexport abstract class EntityCaller<T> extends Caller<T> {\n    private tries: number;\n    protected _entity: Entity;\n\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\n        super(params, waiting);\n        this.tries = 0;\n        this._entity = entity;\n    }\n\n    protected get entity(): Entity {return this._entity;}\n\n    //大多的entityCaller都不需要这个\n    //buildParams() {return this.entity.buildParams(this.params);}\n    \n    async request(): Promise<any> {\n        await this.entity.loadSchema();\n        let ret = await this.innerRequest();\n        return ret;\n    }\n\n    protected async innerCall(): Promise<any> {\n        return await this.entity.uqApi.xcall(this);\n    }\n\n    async innerRequest(): Promise<any> {\n        let jsonResult = await this.innerCall();\n        let {$uq, $modify, res} = jsonResult;\n        this.entity.uq.pullModify($modify);\n        if ($uq === undefined) {\n            //if (res === undefined) debugger;\n            let ret = this.xresult(res);\n            //if (ret === undefined) debugger;\n            return ret;\n        }\n        return await this.retry($uq);\n    }\n\n    xresult(res:any):any {return res}\n\n    get headers(): {[header:string]: string} {\n        let {ver, uq} = this.entity;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }\n\n    private async retry(schema: UqResponseSchema) {\n        ++this.tries;\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\n        this.rebuildSchema(schema);\n        return await this.innerRequest();\n    }\n\n    private rebuildSchema(schema: UqResponseSchema) {\n        let {uq, entity} = schema;\n        if (uq !== undefined) this.entity.uq.buildEntities(uq);\n        if (entity !== undefined) {\n\t\t\tthis.entity.setSchema(entity);\n\t\t}\n    }\n}\n\nexport abstract class ActionCaller extends EntityCaller<any> {\n    protected get entity(): Action {return this._entity as Action;}\n}\n\nexport class QueryQueryCaller extends EntityCaller<any> {\n    protected get entity(): Query {return this._entity as Query};\n    get path():string {return `query/${this.entity.name}`;}\n    xresult(res:any) {\n        let data = this.entity.unpackReturns(res);\n        return data;\n    }\n    buildParams() {return this.entity.buildParams(this.params);}\n}\n\nexport class QueryPageCaller extends EntityCaller<any> {\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\n\tprotected get entity(): Query {return this._entity as Query};\n\t//results: {[name:string]:any[]};\n\tget path():string {return `query-page/${this.entity.name}`;}\t\n    buildParams() {\n        let {pageStart, pageSize, params} = this.params;\n        let p:any;\n        if (params === undefined) {\n            p = {key: ''};\n        }\n        else {\n            p = this.entity.buildParams(params);\n        }\n        /*\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        */\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return p;\n    };\n    xresult(res:any): {[name:string]:any[]} {\n        let ret = this.entity.unpackReturns(res);\n\t\t//return this.results.$page;// as any[];\n\t\treturn ret;\n    }\n}\n","import { UqApi } from '../net';\nimport { LocalCache } from '../tool';\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\nimport { Tuid } from './tuid';\n//import { EntityCache } from './caches';\n\nconst tab = '\\t';\nconst ln = '\\n';\n\nexport abstract class Entity {\n    private jName: string;\n    schema: any;\n    ver: number = 0;\n    sys?: boolean;\n    readonly uq: UqMan;\n    readonly name: string;\n    readonly typeId: number;\n    readonly cache: LocalCache;\n    readonly uqApi: UqApi;\n    abstract get typeName(): string;\n    get sName():string {return this.jName || this.name}\n    fields: Field[];\n    arrFields: ArrFields[];\n    returns: ArrFields[];\n\n    constructor(uq:UqMan, name:string, typeId:number) {\n        this.uq = uq;\n        this.name = name;\n        this.typeId = typeId;\n        this.sys = this.name.indexOf('$') >= 0;\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\n        this.uqApi = this.uq.uqApi;\n    }\n\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\n\n    //getApiFrom() {return this.entities.uqApi;}\n\n    private fieldMaps: {[arr:string]: FieldMap} = {};\n    fieldMap(arr?:string): FieldMap {\n        if (arr === undefined) arr = '$';\n        let ret = this.fieldMaps[arr];\n        if (ret === undefined) {\n            let fields:Field[];\n            if (arr === '$') fields = this.fields;\n            else if (this.arrFields !== undefined) {\n                let arrFields = this.arrFields.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            else if (this.returns !== undefined) {\n                let arrFields = this.returns.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            if (fields === undefined) return {};\n            ret = {};\n            for (let f of fields) ret[f.name] = f;\n            this.fieldMaps[arr] = ret;\n        }\n        return ret;\n    }\n\n    public async loadSchema():Promise<void> {\n        if (this.schema !== undefined) return;\n        let schema = this.cache.get();\n        if (!schema) {\n            schema = await this.uq.loadEntitySchema(this.name);\n        }\n        this.setSchema(schema);\n\t\tthis.buildFieldsTuid();\n\t\tawait this.loadValues();\n\t}\n\t\n\tprotected async loadValues():Promise<any> {}\n\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\n    public clearSchema() {\n        this.schema = undefined;\n    }\n\n    public setSchema(schema:any) {\n        if (schema === undefined) return;\n        let {name, version} = schema;\n        this.ver = version || 0;\n\t\tthis.setJName(name);\n        this.cache.set(schema);\n\t\tthis.schema = schema;\n\t\tthis.buildFieldsTuid();\n\t}\n\t\n\tprotected setJName(name:string) {\n        if (name !== this.name) this.jName = name;\n\t}\n\n    public buildFieldsTuid() {\n        let {fields, arrs, returns} = this.schema;\n        this.uq.buildFieldTuid(this.fields = fields);\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\n    }\n\n    schemaStringify():string {\n        return JSON.stringify(this.schema, (key:string, value:any) => {\n            if (key === '_tuid') return undefined;\n            return value;\n        }, 4);\n    }\n\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\n        if (this.schema === undefined) return;\n        let {fields, arrs} = this.schema;\n        let entities = this.uq;\n        function getTuid(fn:string, fieldArr:Field[]) {\n            if (fieldArr === undefined) return;\n            let f = fieldArr.find(v => v.name === fn);\n            if (f === undefined) return;\n            return entities.getTuid(f.tuid);\n        }\n        let fn = fieldName.toLowerCase();\n        if (arrName === undefined) return getTuid(fn, fields);\n        if (arrs === undefined) return;\n        let an = arrName.toLowerCase();\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\n        if (arr === undefined) return;\n        return getTuid(fn, arr.fields);\n    }\n\n    buildParams(params:any):any {\n        let result:any = {};\n        let fields = this.fields;\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\n        let arrs = this.arrFields;\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let {name, fields} = arr;\n                let paramsArr:any[] = params[name];\n                if (paramsArr === undefined) continue;\n                let arrResult:any[] = [];\n                result[name] = arrResult;\n                for (let pa of params) {\n                    let rowResult = {};\n                    this.buildFieldsParams(rowResult, fields, pa);\n                    arrResult.push(rowResult);\n                }\n            }\n        }\n        return result;\n    }\n\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\n        for (let field of fields) {\n            let {name, type} = field;            \n            let d = params[name];\n            let val:any;\n            if (type === 'datetime') {\n                val = this.buildDateTimeParam(d);\n            }\n            else {\n                switch (typeof d) {\n                    default: val = d; break;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) val = d.id;\n                        else val = tuid.getIdFromObj(d);\n                        break;\n                }\n            }\n            result[name] = val;\n        }\n    }\n\n    buildDateTimeParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'object': dt = (val as Date); break;\n            case 'string':\n            case 'number': dt = new Date(val); break;\n        }\n        return Math.floor(dt.getTime()/1000);\n    }\n\n    buildDateParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'string': return val;\n            case 'object': dt = (val as Date); break;\n            case 'number': dt = new Date(val); break;\n        }\n        let ret = dt.toISOString();\n        let p = ret.indexOf('T');\n        return p>0? ret.substr(0, p) : ret;\n    }\n\n    pack(data:any):string {\n        let ret:string[] = [];\n        let fields = this.fields;\n        if (fields !== undefined) this.packRow(ret, fields, data);\n        let arrs = this.arrFields; \n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n\t\t\t\tlet {name, fields} = arr;\n\t\t\t\tlet arrData = data[name];\n\t\t\t\tif (!arrData) arrData = data[name.toLowerCase()];\n                this.packArr(ret, fields, arrData);\n            }\n        }\n        return ret.join('');\n    }\n\n    private escape(row:any, field:Field):any {\n        let d = row[field.name];\n        switch (field.type) {\n            case 'datetime':\n                return this.buildDateTimeParam(d);\n            default:\n                switch (typeof d) {\n                    default: return d;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) return d.id;\n                        return tuid.getIdFromObj(d);\n                    case 'string':\n                        let len = d.length;\n                        let r = '', p = 0;\n                        for (let i=0;i<len;i++) {\n                            let c:number = d.charCodeAt(i);\n                            switch(c) {\n                                case 9: r += d.substring(p, i) + '\\\\t'; p = i+1; break;\n\t\t\t\t\t\t\t\tcase 10: r += d.substring(p, i) + '\\\\n'; p = i+1; break;\n\t\t\t\t\t\t\t\tcase 92: r += d.substring(p, i) + '\\\\\\\\'; p = i+1; break;\n                            }\n                        }\n                        return r + d.substring(p);\n                    case 'undefined': return '';\n                }\n        }\n    }\n\n    private packRow(result:string[], fields:Field[], data:any) {\n        let len = fields.length;\n        if (len === 0) return;\n        let ret = '';\n        ret += this.escape(data, fields[0]);\n        for (let i=1;i<len;i++) {\n            let f = fields[i];\n            ret += tab + this.escape(data, f);\n        }\n        result.push(ret + ln);\n    }\n\n    private packArr(result:string[], fields:Field[], data:any[]) {\n        if (data !== undefined) {\n            for (let row of data) {\n                this.packRow(result, fields, row);\n            }\n        }\n        result.push(ln);\n    }\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\n        for (let f of fields as Field[]) {\n            let {name, _tuid} = f;\n            if (_tuid === undefined) continue;\n            let id = values[name];\n            //_tuid.useId(id);\n            values[name] = _tuid.boxId(id);\n        }\n    }\n\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\n        if (fields === undefined) return values as any[];\n        //if (this.fields === undefined) return values as any[];\n        let ret:any[] = []\n        for (let ln of values) {\n            if (!ln) continue;\n            let len = ln.length;\n            let p = 0;\n            while (p<len) {\n                let ch = ln.charCodeAt(p);\n                if (ch === 10) {\n                    ++p;\n                    break;\n                }\n                let row = {};\n                p = this.unpackRow(row, fields, ln, p);\n                ret.push(row);\n            }\n        }\n        return ret;\n    }\n\n    unpackSheet(data:string):any {\n        let ret = {} as any; //new this.newMain();\n        //if (schema === undefined || data === undefined) return;\n        let fields = this.fields;\n        let p = 0;\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\n        let arrs = this.arrFields; //schema['arrs'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    unpackReturns(data:string):{[name:string]:any[]} {\n        if (data === undefined) debugger;\n        let ret = {} as any;\n        //if (schema === undefined || data === undefined) return;\n        //let fields = schema.fields;\n        let p = 0;\n        //if (fields !== undefined) p = unpackRow(ret, schema.fields, data, p);\n        let arrs = this.returns; //schema['returns'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                //let creater = this.newRet[arr.name];\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\n        for (;p<len;p++) {\n            ch0 = ch;\n            ch = data.charCodeAt(p);\n            if (ch === 9) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                c = p+1;\n                ++i;\n                if (i>=fLen) {\n                    p = data.indexOf('\\n', c);\n                    if (p >= 0) ++p;\n                    else p = len;\n                    return p;\n                }\n            }\n            else if (ch === 10) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                ++p;\n                ++i;\n                return p;\n            }\n        }\n        let f = fields[i];\n        let {name} = f;\n        if (ch0 !== 8) {\n            let v = data.substring(c);\n            ret[name] = this.to(ret, v, f);\n        }\n        return len;\n    }\n\n    private to(ret:any, v:string, f:Field):any {\n        switch (f.type) {\n            default: return v;\n            case 'datetime':\n            case 'time':\n\t\t\tcase 'timestamp':\n                let n = Number(v);\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\n                return date;\n            case 'date':\n                let parts = v.split('-');\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\n            case 'tinyint':\n            case 'smallint':\n            case 'int':\n            case 'bigint':\n            case 'dec':\n                return Number(v);\n            case 'id':\n                let id = Number(v);\n                let {_tuid} = f;\n                if (_tuid === undefined) return id;\n                return _tuid.boxId(id);\n        }\n    }\n\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\n        let vals:any[] = [], len = data.length;\n        let {name, fields} = arr;\n        while (p<len) {\n            let ch = data.charCodeAt(p);\n            if (ch === 10) {\n                ++p;\n                break;\n            }\n            let val = {} as any; //new creater();\n            vals.push(val);\n            p = this.unpackRow(val, fields, data, p);\n        }\n        ret[name] = vals;\n        return p;\n    }\n}\n","import * as React from 'react';\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\nimport { nav } from '../nav';\nimport { observable } from 'mobx';\nimport { FieldRule } from '../form/rules';\nimport { Image } from '../image';\n\nexport abstract class ItemEdit {\n\tprotected name: string;\n\tprotected _itemSchema: ItemSchema;\n    get itemSchema(): ItemSchema {return this._itemSchema}\n    protected _uiItem:UiItem;\n    get uiItem():UiItem {return this._uiItem}\n    value: any;\n    label: string;\n\n    @observable protected error: string;\n    @observable protected isChanged: boolean = false;\n    protected newValue: any;\n\n    constructor(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) {\n        this._itemSchema = itemSchema;\n        this._uiItem = uiItem\n        this.value = value;\n        let {name} = itemSchema;\n        this.name = name;\n        this.label = label;\n\t}\n\t\n\tinit() {\t\t\n\t}\n\n    async start():Promise<any> {\n        return await this.internalStart();\n    }\n\n    protected abstract internalStart():Promise<any>;\n\n    async end():Promise<any> {\n        await this.internalEnd()\n    }\n\n\trenderContent() {\t\t\n        let {name, type} = this._itemSchema;\n        let divValue:any;\n        let uiItem = this._uiItem;\n        let label:string, labelHide:boolean;\n        if (uiItem === undefined) {\n            label = name;\n        }\n        else {\n\t\t\tlabel = uiItem.label;\n\t\t\tlabelHide = uiItem.labelHide;\n            let templet = uiItem.Templet;\n            if (templet !== undefined) {\n                if (typeof templet === 'function') {\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\n\t\t\t\t}\n                else {\n\t\t\t\t\tdivValue = {templet};\n\t\t\t\t}\n            }\n            else if (this.value !== undefined) {\n                switch (uiItem.widget) {\n                    case 'radio':\n                    case 'select':\n                        let {list} = uiItem as UiSelectBase;\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\n                        break;\n                    case 'id':\n                        divValue = <b>no templet for {name}={this.value}</b>\n                        break;\n                }\n            }\n        }\n        if (divValue === undefined) {\n            switch (type) {\n                default:\n                    divValue = this.value? \n\t\t\t\t\t\t<b>{this.value}</b> \n\t\t\t\t\t\t:\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\n                    break;\n                case 'image':\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\n                    break;\n            }\n\t\t}\n\t\treturn divValue;\n\t}\n\n    protected async internalEnd():Promise<void> {nav.pop()}\n\n    protected verifyValue() {\n        if (this.uiItem === undefined) return;\n        let {rules} = this.uiItem;\n        if (rules === undefined) return;\n        let nv = this.newValue;\n        function verifyRule(rule:FieldRule, value: any):string {\n            let error = rule(nv);\n            if (error !== undefined) {\n                if (typeof error !== 'object')\n                    return error;\n                else\n                    return JSON.stringify(error);\n            }\n        }\n        if (Array.isArray(rules)) {\n            for (let rule of rules) {\n                let error = verifyRule(rule as FieldRule, nv);\n                if (error !== undefined) {\n                    this.error = error;\n                    break;\n                }\n            }\n        }\n        else {\n            this.error = verifyRule(rules as FieldRule, nv);\n        }\n    }\n}\n","import {bridgeCenterApi, isBridged} from './appBridge';\nimport {FetchError} from './fetchError';\nimport {HttpChannelUI} from './httpChannelUI';\nimport {nav} from '../components/nav';\nimport { Caller } from './caller';\nimport { env } from '../tool';\n\n/*\nexport async function httpGet(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.get('', params);\n    return ret;\n}\n\nexport async function httpPost(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.post('', params);\n    return ret;\n}\n*/\n\nconst methodsWithBody = ['POST', 'PUT'];\n\nexport abstract class HttpChannel {\n    private timeout: number;\n    protected ui?: HttpChannelUI;\n    protected hostUrl: string;\n    protected apiToken: string;\n\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\n        this.hostUrl = hostUrl;\n        this.apiToken = apiToken;\n        this.ui = ui;\n        this.timeout = env.isDevelopment === true? 500000:50000;\n    }\n\n    private startWait = (waiting: boolean) => {\n        if (waiting === true) {\n            if (this.ui !== undefined) this.ui.startWait();\n        }\n    }\n\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\n        if (this.ui !== undefined) this.ui.endWait();\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\n    }\n\n    private showError = async (error:FetchError) => {\n        if (this.ui !== undefined) await this.ui.showError(error);\n    }\n\n    used() {\n        this.post('', {});\n    }\n\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\n        let options = this.buildOptions();\n        let {headers, path, method} = caller;\n        if (headers !== undefined) {\n            let h = options.headers;\n            for (let i in headers) {\n                h.append(i, encodeURI(headers[i]));\n            }\n        }\n        options.method = method;\n        let p = caller.buildParams();\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\n            options.body = JSON.stringify(p)\n        }\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\n    }\n\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\n        let ret = await this.innerFetch(url, options, waiting);\n        return ret.res;\n    }\n\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\n        if (params) {\n            let keys = Object.keys(params);\n            if (keys.length > 0) {\n                let c = '?';\n                for (let k of keys) {\n                    let v = params[k];\n                    if (v === undefined) continue;\n                    url += c + k + '=' + params[k];\n                    c = '&';\n                }\n            }\n        }\n        let options = this.buildOptions();\n        options.method = 'GET';\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'POST';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'PUT';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'DELETE';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\n        let that = this;\n        this.startWait(waiting);\n        let path = url;\n        function buildError(err: any, ex?: string) {\n            switch (typeof err) {\n                case 'string':\n                    if (ex !== undefined) err += ' ' + ex;\n                    break;\n                case 'object':\n                    let keys = Object.keys(err);\n                    let retErr:any = {\n                        ex: ex,\n                    };\n                    for (let key of keys) {\n                        retErr[key] = err[key];\n                    }\n                    err = retErr;\n                    break;\n            }\n            return {\n                channel: that,\n                url: path,\n                options: options,\n                resolve: resolve,\n                reject: reject,\n                error: err,\n            }\n        }\n        try {\n            console.log('%s-%s %s', options.method, path, options.body || '');\n            let now = Date.now();\n            let timeOutHandler = env.setTimeout(\n                undefined, //'httpChannel.fetch',\n                () => {\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\n                },\n                this.timeout);\n            let res = await fetch(encodeURI(path), options);\n            if (res.ok === false) {\n                env.clearTimeout(timeOutHandler);\n                console.log('ok false endWait');       \n                that.endWait();\n                console.log('call error %s', res.statusText);\n                throw res.statusText;\n            }\n            let ct = res.headers.get('content-type');\n            if (ct && ct.indexOf('json')>=0) {\n                return res.json().then(async retJson => {\n                    env.clearTimeout(timeOutHandler);\n                    that.endWait();\n                    if (retJson.ok === true) {\n                        if (typeof retJson !== 'object') {\n                            debugger;\n                        }\n                        else if (Array.isArray(retJson) === true) {\n                            debugger;\n                        }\n                        return resolve(retJson);\n                    }\n                    let retError = retJson.error;\n                    if (retError === undefined) {\n                        await that.showError(buildError('not valid tonva json'));\n                    }\n                    else {\n                        await that.showError(buildError(retError, 'retJson.error'));\n                        reject(retError);\n                    }\n                }).catch(async error => {\n                    await that.showError(buildError(error, 'catch res.json()'));\n                });\n            }\n            else {\n                let text = await res.text();\n                env.clearTimeout(timeOutHandler);\n                console.log('text endWait');\n                that.endWait();\n                resolve(text);\n            }\n        }\n        catch(error) {\n            this.endWait(url, reject);\n            if (typeof error === 'string') {\n                let err = error.toLowerCase();\n                if (err.startsWith('unauthorized') === true) {\n                    nav.logout();\n                    return;\n                }\n            }\n            console.error('fecth error (no nav.showError): ' + url);\n            // await this.showError(buildError(error, 'catch outmost'));\n        };\n    }\n\n    protected abstract async innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\n\n    async callFetch(url:string, method:string, body:any):Promise<any> {\n        let options = this.buildOptions();\n        options.method = method;\n        options.body = body;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(url, options, true, resolve, reject);\n        });\n    }\n\n    private buildOptions(): {method:string; headers:Headers; body:any} {\n        let headers = this.buildHeaders();\n        let options = {\n            headers: headers,\n            method: undefined as any,\n            body: undefined as any,\n            // cache: 'no-cache',\n        };\n        return options;\n    }\n\n    protected buildHeaders():Headers {\n        let {language, culture} = nav;\n        let headers = new Headers();\n        //headers.append('Access-Control-Allow-Origin', '*');\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\n        let lang = language;\n        if (culture) lang += '-' + culture;\n        headers.append('Accept-Language', lang);\n        if (this.apiToken) { \n            headers.append('Authorization', this.apiToken); \n        }\n        return headers;\n    }\n}\n\nexport class CenterHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        if (this.apiToken === undefined && isBridged())\n            return await bridgeCenterApi(u, options.method, options.body);\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n\nexport class UqHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n","import {nav} from '../components/nav';\nimport {FetchError} from './fetchError';\n\nexport interface HttpChannelUI {\n    startWait():void;\n    endWait():void;\n    showError(error:FetchError):Promise<void>;\n    showUpgradeUq(uq:string, version:number):Promise<void>;\n}\n\nexport class HttpChannelNavUI implements HttpChannelUI {\n    startWait() {\n        nav.startWait();\n    }\n    endWait() {\n        nav.endWait();\n    }\n    async showError(error:FetchError):Promise<void> {\n        nav.endWait();\n        /*\n        if (error.name === 'SyntaxError') {\n            error = {\n                name: error.name,\n                message: error.message,\n            }\n        }*/\n        await nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await nav.showUpgradeUq(uq, version);\n    }\n}\n\n","import _ from 'lodash';\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\nimport {HttpChannelNavUI} from './httpChannelUI';\nimport {appUq, logoutUqTokens, buildAppUq} from './appBridge';\nimport {ApiBase} from './apiBase';\nimport { host } from './host';\nimport { LocalMap, env } from '../tool';\nimport {decodeUserToken} from '../tool/user';\n\nlet channelUIs:{[name:string]: HttpChannel} = {};\nlet channelNoUIs:{[name:string]: HttpChannel} = {};\n\nexport function logoutApis() {\n    channelUIs = {};\n    channelNoUIs = {};\n    logoutUnitxApis();\n    logoutUqTokens();\n}\n\ninterface UqLocal {\n    user: number;\n    unit: number;\n    value: any;\n    tick?: number;\n    isNet?: boolean;\n}\ninterface UqLocals {\n    user: number;\n    unit: number;\n    uqs: {[uq:string]: UqLocal};\n}\n/*\nconst uqLocalEntities = 'uqLocalEntities';\nclass CacheUqLocals {\n    private local:UqLocals;\n\n    async loadAccess(uqApi: UqApi):Promise<any> {\n        try {\n            let {uqOwner, uqName} = uqApi;\n            if (this.local === undefined) {\n                let ls = null; // localStorage.getItem(uqLocalEntities);\n                if (ls !== null) {\n                    this.local = JSON.parse(ls);\n                }\n            }\n            if (this.local !== undefined) {\n                let {user, uqs} = this.local;\n                if (user !== loginedUserId || uqs === undefined) {\n                    this.local = undefined;\n                }\n                else {\n                    for (let i in uqs) {\n                        let ul = uqs[i];\n                        ul.isNet = undefined;\n                    }\n                }\n            }\n            if (this.local === undefined) {\n                this.local = {\n                    user: loginedUserId,\n                    unit: undefined,\n                    uqs: {}\n                };\n            }\n\n            let ret: any;\n            let un = uqOwner+'/'+uqName;\n            let uq = this.local.uqs[un];\n            if (uq !== undefined) {\n                let {value} = uq;\n                ret = value;\n            }\n            if (ret === undefined) {\n                ret = await uqApi.__loadAccess();\n                //this.saveLocal(un, ret);\n            }\n            return _.cloneDeep(ret);\n        }\n        catch (err) {\n            this.local = undefined;\n            localStorage.removeItem(uqLocalEntities);\n            throw err;\n        }\n    }\n\n    private saveLocal(uqName:string, accessValue: any) {\n        this.local.uqs[uqName] = {\n            value: accessValue,\n            isNet: true,\n        }\n        let str = JSON.stringify(this.local);\n        localStorage.setItem(uqLocalEntities, str);\n    }\n\n    async checkAccess(uqApi: UqApi):Promise<boolean> {\n        if (this.local === undefined) return false;\n        let {uqOwner, uqName} = uqApi;\n        let un = uqOwner+'/'+uqName;\n        let uq = this.local.uqs[un];\n        if (uq === undefined) return false;\n        let {isNet, value} = uq;\n        if (isNet === true) return true;\n        let ret = await uqApi.__loadAccess();\n        let isMatch = _.isMatch(value, ret);\n        if (isMatch === false) {\n            this.saveLocal(un, ret);\n            return false;\n        }\n        uq.isNet = true;\n        return true;\n    }\n}\n\nconst localUqs = new CacheUqLocals;\n*/\nexport class UqApi extends ApiBase {\n    private access:string[];\n    appOwner:string;\n    appName:string;\n    uqOwner: string;\n    uqName: string;\n    uq: string;\n\n    constructor(basePath:string, appOwner:string, appName:string, uqOwner:string, uqName:string, access:string[], showWaiting?: boolean) {\n        super(basePath, showWaiting);\n        this.appOwner = appOwner;\n        this.appName = appName;\n        if (uqName) {\n            this.uqOwner = uqOwner;\n            this.uqName = uqName;\n            this.uq = uqOwner + '/' + uqName;\n        }\n        this.access = access;\n        this.showWaiting = showWaiting;\n    }\n\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\n\n    async init() {\n        await buildAppUq(this.uq, this.uqOwner, this.uqName, this.appOwner, this.appName);\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channels: {[name:string]: HttpChannel};\n        let channelUI: HttpChannelNavUI;\n        if (this.showWaiting === true || this.showWaiting === undefined) {\n            channels = channelUIs;\n            channelUI = new HttpChannelNavUI();\n        }\n        else {\n            channels = channelNoUIs;\n        }\n        let channel = channels[this.uq];\n        if (channel !== undefined) return channel;\n        let uqToken = appUq(this.uq); //, this.uqOwner, this.uqName);\n        if (!uqToken) {\n            //debugger;\n            await this.init();\n            uqToken = appUq(this.uq);\n        }\n        let {url, token} = uqToken;\n        this.token = token;\n        channel = new UqHttpChannel(url, token, channelUI);\n        return channels[this.uq] = channel;\n    }\n\n    /*async update():Promise<string> {\n        return await this.get('update');\n    }*/\n\n    /*\n    async __loadAccess():Promise<any> {\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n    */\n    async loadAccess():Promise<any> {\n        //return await localUqs.loadAccess(this);\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n\n    /*async loadEntities():Promise<any> {\n        return await this.get('entities');\n    }*/\n\n    /*\n    async checkAccess():Promise<boolean> {\n        return await localUqs.checkAccess(this);\n    }\n    */\n\n    async schema(name:string):Promise<any> {\n        return await this.get('schema/' + name);\n    }\n\n    async queueModify(start:number, page:number, entities:string) {\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\n    }\n\n    /*async schemas(names:string[]):Promise<any[]> {\n        return await this.post('schema', names);\n    }*/\n\n    /*\n    async tuidGet(name:string, id:number):Promise<any> {\n        return await this.get('tuid/' + name + '/' + id);\n    }\n\n    async tuidGetAll(name:string):Promise<any[]> {\n        return await this.get('tuid-all/' + name + '/');\n    }\n\n    async tuidSave(name:string, params:any):Promise<any> {\n        return await this.post('tuid/' + name, params);\n    }\n\n    async tuidSearch(name:string, arr:string, owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        let ret = await this.post('tuids/' + name, {\n            arr: arr,\n            owner: owner,\n            key: key,\n            pageStart: pageStart,\n            pageSize: pageSize\n        });\n        return ret;\n    }\n    async tuidArrGet(name:string, arr:string, owner:number, id:number):Promise<any> {\n        return await this.get('tuid-arr/' + name + '/' + owner + '/' + arr + '/' + id);\n    }\n    async tuidArrGetAll(name:string, arr:string, owner:number):Promise<any[]> {\n        return await this.get('tuid-arr-all/' + name + '/' + owner + '/' + arr + '/');\n    }\n    async tuidArrSave(name:string, arr:string, owner:number, params:any):Promise<any> {\n        return await this.post('tuid-arr/' + name + '/' + owner + '/' + arr + '/', params);\n    }\n    async tuidArrPos(name:string, arr:string, owner:number, id:number, order:number):Promise<any> {\n        return await this.post('tuid-arr-pos/' + name + '/' + owner + '/' + arr + '/', {\n            id: id,\n            $order: order\n        });\n    }\n\n    async tuidIds(name:string, arr:string, ids:number[]):Promise<any[]> {\n        try {\n            let url = 'tuidids/' + name + '/';\n            if (arr !== undefined) url += arr;\n            else url += '$';\n            let ret = await this.post(url, ids);\n            return ret;\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    */\n    /*async sheetSave(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name, data);\n    }*/\n\n    /*async sheetAction(name:string, data:object) {\n        return await this.put('sheet/' + name, data);\n    }*/\n\n    /*async stateSheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/states', data);\n    }*/\n\n    /*async stateSheetCount(name:string):Promise<any> {\n        return await this.get('sheet/' + name + '/statecount');\n    }*/\n\n    /*async mySheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/my-sheets', data);\n    }*/\n\n    /*async getSheet(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/get/' + id);\n    }*/\n\n    /*async sheetArchives(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name + '/archives', data);\n    }\n\n    async sheetArchive(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/archive/' + id);\n    }*/\n\n    /*async action(name:string, data:object):Promise<any> {\n        return await this.post('action/' + name, data);\n    }\n\n    async actionReturns(name:string, data:object):Promise<any[][]> {\n        return await this.post('action/' + name + '/returns', data);\n    }\n\n    async page(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p:any;\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return await this.post('query-page/' + name, p);\n    }\n\n    async query(name:string, params:any):Promise<any> {\n        let ret = await this.post('query/' + name, params);\n        return ret;\n    }\n    */\n/*\n    async history(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n\n    async book(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n*/\n    /*async user():Promise<any> {\n        return await this.get('user');\n    }*/\n}\n\nlet channels:{[unitId:number]: HttpChannel} = {};\n\nexport function logoutUnitxApis() {\n    channels = {};\n}\n\nexport class UnitxApi extends UqApi {\n    private unitId:number;\n    constructor(unitId:number) {\n        super('tv/', undefined, undefined, undefined, undefined, undefined, true);\n        this.unitId = unitId;\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channel = channels[this.unitId];\n        if (channel !== undefined) return channel;\n        return channels[this.unitId] = await this.buildChannel();\n    }\n\n    private async buildChannel():Promise<HttpChannel> {\n        let channelUI = new HttpChannelNavUI();\n        let centerAppApi = new CenterAppApi('tv/', undefined);\n        let ret = await centerAppApi.unitxUq(this.unitId);\n        let {token, db, url, urlTest} = ret;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        this.token = token;\n        return new UqHttpChannel(realUrl, token, channelUI);\n    }\n}\n\nlet centerHost:string;\n\nexport function setCenterUrl(url:string) {\n    console.log('setCenterUrl %s', url);\n    centerHost = url;\n    centerToken = undefined;\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nexport let centerToken:string|undefined = undefined;\n\nlet loginedUserId:number = 0;\nexport function setCenterToken(userId:number, t?:string) {\n    loginedUserId = userId;\n    centerToken = t;\n    console.log('setCenterToken %s', t);\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nlet centerChannelUI:HttpChannel;\nlet centerChannel:HttpChannel;\nfunction getCenterChannelUI():HttpChannel {\n    if (centerChannelUI !== undefined) return centerChannelUI;\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\n}\nfunction getCenterChannel():HttpChannel {\n    if (centerChannel !== undefined) return centerChannel;\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\n}\n\nexport abstract class CenterApiBase extends ApiBase {\n    /*\n    constructor(path: string, showWaiting?: boolean) {\n        super(path, showWaiting);\n    }*/\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        return (this.showWaiting === true || this.showWaiting === undefined)?\n            getCenterChannelUI():\n            getCenterChannel();\n    }\n}\n\nconst uqTokensName = 'uqTokens';\nexport class UqTokenApi extends CenterApiBase {\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\n\n    async uq(params: {unit:number, uqOwner:string, uqName:string, appOwner:string, appName:string}):Promise<any> {\n        let {uqOwner, uqName} = params;\n        let un = uqOwner+'/'+uqName;\n        let localCache = this.localMap.child(un);\n        try {\n            let uqToken:UqLocal = localCache.get();\n            if (uqToken !== undefined) {\n                let {unit, user} = uqToken;\n                if (unit !== params.unit || user !== loginedUserId) {\n                    localCache.remove();\n                    uqToken = undefined;\n                }\n            }\n            let nowTick = Math.floor(Date.now() / 1000);\n            if (uqToken !== undefined) {\n                let {tick, value} = uqToken;\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\n                    return _.clone(value);\n                }\n            }\n            let appUqParams:any = _.clone(params);\n            appUqParams.testing = host.testing;\n            let ret = await this.get('app-uq', appUqParams);\n            if (ret === undefined) {\n                let {unit, uqOwner, uqName} = params;\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\n                throw err;\n            }\n\n            uqToken = {\n                unit: params.unit,\n                user: loginedUserId,\n                tick: nowTick,\n                value: ret,\n            }\n            localCache.set(uqToken);\n            return _.clone(ret);\n        }\n        catch (err) {\n            localCache.remove();\n            throw err;\n        }\n    }\n}\n\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\n\nexport class CallCenterApi extends CenterApiBase {\n    directCall(url:string, method:string, body:any):Promise<any> {\n        return this.call(url, method, body);\n    }\n}\nexport const callCenterapi = new CallCenterApi('', undefined);\n\nexport interface UqAppData {\n    appName: string;\n    appOwner: string;\n    id: number;\n    version: string;        // AppUI version\n    uqs: UqData[];\n}\n\nexport interface UqData {\n    id: number;\n    uqOwner: string;\n    uqName: string;\n    access: string;\n    newVersion: boolean;\n}\n\nexport interface UqServiceData {\n    id: number;\n    db: string;\n    url: string;\n    urlTest: string;\n    token: string;\n}\n\n//const appUqsName = 'appUqs';\n\nexport class CenterAppApi extends CenterApiBase {\n    //private local: LocalCache = env.localDb.item(appUqsName);\n    //private cachedUqs: UqAppData;\n    async uqs(appOwner:string, appName:string):Promise<UqAppData> {\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n        return ret;\n        /*\n        let ret:UqAppData;\n        let appUqs = this.local.get();\n        if (appUqs) {\n            let {appOwner:rAppOwner, appName:rAppName} = appUqs;\n            if (appOwner === rAppOwner && appName === rAppName) ret = appUqs;\n        }\n        if (ret === undefined) {\n            ret = await this.uqsPure(appOwner, appName);\n            ret.appName = appName;\n            ret.appOwner = appOwner;\n            //localStorage.setItem(JSON.stringify(obj));\n            this.local.set(ret);\n        }\n        //return this.cachedUqs = _.cloneDeep(ret);\n        return ret;\n        */\n    }\n    private async uqsPure(appOwner:string, appName:string):Promise<UqAppData> {\n        return await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n    }\n    /*\n    private async isOkCheckUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.uqsPure(appOwner, appName);\n        let {id:cachedId, uqs:cachedUqs} = this.local.get(); //.cachedUqs;\n        let {id:retId, uqs:retUqs} = ret;\n        if (cachedId !== retId) return false;\n        if (cachedUqs.length !== retUqs.length) return false;\n        let len = cachedUqs.length;\n        for (let i=0; i<len; i++) {\n            if (_.isMatch(cachedUqs[i], retUqs[i]) === false) return false;\n        }\n        return true;\n    }\n    async checkUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.isOkCheckUqs(appOwner, appName);\n        if (ret === false) {\n            this.local.remove();\n            nav.start();\n        }\n        return ret;\n    }\n    */\n    async unitxUq(unit:number):Promise<UqServiceData> {\n        return await this.get('tie/unitx-uq', {unit:unit});\n    }\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\n        return await this.post('tie/change-password', param);\n    }\n}\n\nexport async function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\n    let centerAppApi = new CenterAppApi('tv/', undefined);\n    //let unit = meInFrame.unit;\n    let ret = await centerAppApi.uqs(appOwner, appName);\n    //await centerAppApi.checkUqs(appOwner, appName);\n    /*\n    .then(v => {\n        if (v === false) {\n            localStorage.removeItem(appUqs);\n            nav.start();\n        }\n    });\n    */\n    return ret;\n}\n\n//import { nav } from '../ui';\n\nexport interface RegisterParameter {\n    nick:string, \n    user:string, \n    pwd:string,\n    country:number, \n    mobile:number, \n    mobileCountry:number,\n    email:string,\n    verify:string,\n};\n\nexport class UserApi extends CenterApiBase {\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\n        //(params as any).device = nav.local.device.get();\n        let ret = await this.get('user/login', params);\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeUserToken(ret);\n            case 'object':\n                let token = ret.token;\n                let user = decodeUserToken(token);\n                let {nick, icon} = ret;\n                if (nick) user.nick = nick;\n                if (icon) user.icon = icon;\n                return user;\n        }\n        // !== undefined) return decodeToken(token);\n    }\n    async register(params: RegisterParameter): Promise<any>\n    {\n        return await this.post('user/register', params);\n    }\n\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\n    }\n\n    async checkVerify(account:string, verify:string) {\n        return await this.post('user/check-verify', {account:account, verify:verify});\n    }\n\n    async isExists(account:string) {\n        return await this.get('user/is-exists', {account:account});\n    }\n\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\n        return await this.post('user/reset-password', {account:account, password, verify, type});\n    }\n    \n    async userSetProp(prop:string, value:any) {\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\n    }\n\n    async me():Promise<any> {\n        return await this.get('tie/me');\n    }\n\n    async user(id:number): Promise<any> {\n        return await this.get('tie/user', {id:id});\n\t}\n\t\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\n\t\treturn await this.get('tie/user-from-key', {key});\n\t}\n}\n\nexport const userApi = new UserApi('tv/', undefined);\n","\nlet subAppWindow:Window;\nfunction postWsToSubApp(msg:any) {\n    if (subAppWindow === undefined) return;\n    subAppWindow.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport function setSubAppWindow(win:Window) {\n    subAppWindow = win;\n}\n\nexport function postWsToTop(msg:any) {\n    window.top.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport abstract class WsBase {\n    wsBaseId:string;\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.anyHandlers[seed] = handler;\n        return seed;\n    }\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.msgHandlers[seed] = {type:type, handler: handler};\n        return seed;\n    }\n    endWsReceive(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n    }\n    async receive(msg:any) {\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n        }\n    }\n}\n\nlet wsBaseSeed = 1;\nexport class WsBridge extends WsBase {\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\n}\n\nexport const wsBridge = new WsBridge();\n\nexport class WSChannel extends WsBase {\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\n    static centerToken:string;\n    private wsHost: string;\n    private token: string;\n    private ws: WebSocket;\n\n    constructor(wsHost: string, token: string) {\n        super();\n        this.wsHost = wsHost;\n        this.token = token;\n    }\n\n    static setCenterToken(token?: string) {\n        WSChannel.centerToken = token;\n    }\n    \n    connect():Promise<void> {\n        //this.wsHost = wsHost;\n        //this.token = token || WSChannel.centerToken;\n        if (this.ws !== undefined) return;\n        let that = this;\n        return new Promise((resolve, reject) => {\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\n            console.log('connect webSocket %s', this.wsHost);\n            ws.onopen = (ev) => {\n                console.log('webSocket connected %s', this.wsHost);\n                that.ws = ws;\n                resolve();\n            };\n            ws.onerror = (ev) => {\n                reject('webSocket can\\'t open!');\n            };\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\n            ws.onclose = (ev) => {\n                that.ws = undefined;\n                console.log('webSocket closed!');\n            }\n        });\n    }\n    close() {\n        if (this.ws !== undefined) {\n            this.ws.close();\n            this.ws = undefined;\n        }\n    }\n    private async wsMessage(event:any):Promise<void> {\n        try {\n            console.log('websocket message: %s', event.data);\n            let msg = JSON.parse(event.data);\n            postWsToSubApp(msg);\n            await this.receive(msg);\n        }\n        catch (err) {\n            console.log('ws msg error: ', err);\n        }\n    }\n    sendWs(msg:any) {\n        let netThis = this;\n        this.connect().then(() => {\n            netThis.ws.send(msg);\n        });\n    }\n}\n","import _ from 'lodash';\n\nexport interface KeyValueRes {\n    [key:string]: any;\n}\n\nexport interface Res<T extends KeyValueRes> {\n    [lang:string]: T | {[district:string]: T};\n}\n\nexport const resOptions:{\n\tlang: string;\n\t$lang: string;\n\tdistrict: string;\n\t$district: string;\n} = {\n\tlang: undefined,\n\t$lang: undefined,\n\tdistrict: undefined,\n\t$district: undefined,\n}\n\nexport function setResOptions(lang:string, district:string) {\n\tresOptions.lang = lang;\n\tresOptions.$lang = '$' + lang;\n    resOptions.district = district;\n    resOptions.$district = '$' + district;\n}\n\n(function() {\n    let lang: string, district: string;\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\n        || navigator.language; // ||   // All browsers\n    //navigator.userLanguage; // IE <= 10\n    if (!language) {\n        lang = 'zh';\n        district = 'CN';\n    }\n    else {\n        let parts = language.split('-');\n        lang = parts[0];\n        if (parts.length > 1) district = parts[1].toUpperCase();\n    }\n    setResOptions(lang, district);\n}());\n\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\n    let {lang, district} = resOptions;\n    let ret:T = {} as T;\n    if (res === undefined) return ret;\n    _.merge(ret, res._);\n    let l = res[lang];\n    if (l === undefined) return ret;\n    _.merge(ret, l._);\n    let d = l[district];\n    if (d === undefined) return ret;\n    _.merge(ret, d);\n    let {entity} = ret;\n    if (entity !== undefined) {\n        for (let i in entity) {\n            entity[i.toLowerCase()] = entity[i];\n        }\n    }\n    return ret;\n}\n\nconst resGlobal:any = {};\nexport function setRes(target: any, res: any):(str:string)=>any {\n\tif (res === undefined) return;\n\tlet {$lang, $district} = resOptions;\n\t_.merge(target, res);\n\tif ($lang !== undefined) {\n\t\tlet l = res[$lang];\n\t\tif (l !== undefined) {\n\t\t\t_.merge(target, l);\n\t\t\tlet d = l[$district];\n\t\t\tif (d !== undefined) {\n\t\t\t\t_.merge(target, d);\n\t\t\t}\n\t\t}\n\t}\n\treturn function(str:string) {\n\t\treturn target[str] || str;\n\t}\n}\nexport function setGlobalRes(res: any) {\n\tsetRes(resGlobal, res);\n}\nexport function t(str:string):any {\n\treturn resGlobal[str] || str;\n}\n","import * as React from 'react';\nimport _ from 'lodash';\nimport {nav, Page, resOptions} from '../components';\nimport { User, env } from '../tool';\nimport { VPage } from './vpage';\nimport { View } from './view';\n\nexport interface ConfirmOptions {\n    caption?: string;\n    message: string | JSX.Element;\n    classNames?: string;\n    ok?: string;\n    yes?: string;\n    no?: string;\n}\n\nexport abstract class Controller {\n    readonly res: any;\n\treadonly x: any;\n\tprivate _t: any = {};\n\treadonly t: (str:string)=>any;\n    icon: string|JSX.Element;\n    label:string;\n    readonly isDev:boolean = env.isDevelopment;\n    get user():User {return nav.user}\n    get isLogined():boolean {\n        let {user} = nav;\n        if (user === undefined) return false;\n        return user.id > 0;\n    }\n    constructor(res:any) {\n        this.res = res || {};\n\t\tthis.x = this.res.x || {};\n\t\tthis.t = (str:string):any => this.internalT(str) || str;\n\t}\n\n\tinit(param?: any) {}\n\n\tinternalT(str:string):any {\n\t\treturn this._t[str];\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tif (res === undefined) return;\n\t\tlet {$lang, $district} = resOptions;\n\t\t_.merge(this._t, res);\n\t\tif ($lang !== undefined) {\n\t\t\tlet l = res[$lang];\n\t\t\tif (l !== undefined) {\n\t\t\t\t_.merge(this._t, l);\n\t\t\t\tlet d = l[$district];\n\t\t\t\tif (d !== undefined) {\n\t\t\t\t\t_.merge(this._t, d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t}\n\n    private receiveHandlerId:number;\n    private disposer:()=>void;\n\n    private dispose = () => {\n        // message listener的清理\n        nav.unregisterReceiveHandler(this.receiveHandlerId);\n        this.onDispose();\n    }\n\n    protected onDispose() {\n    }\n\n\tisMe(id:any):boolean {\n\t\tif (id === null) return false;\n\t\tlet {user} = this;\n\t\tlet userId = user.id;\n\t\tswitch (typeof id) {\n\t\t\tdefault: return false;\n\t\t\tcase 'string': return Number(id) === userId;\n\t\t\tcase 'number': return id === userId;\n\t\t\tcase 'object': return id.id === userId;\n\t\t}\n\t}\n\n    protected async openVPage<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:(ret:any)=>void):Promise<void> {\n        await (new vp((this as any) as C)).open(param, afterBack);\n    }\n\n    protected renderView<C extends Controller>(view: new (controller: C)=>View<C>, param?:any) {\n        return (new view((this as any) as C)).render(param);\n    }\n\n    async event(type:string, value:any) {\n        await this.onEvent(type, value);\n    }\n\n    protected async onEvent(type:string, value:any) {\n    }\n\n    protected msg(text:string) {\n        alert(text);\n    }\n    protected errorPage(header:string, err:any) {\n        this.openPage(<Page header=\"App error!\">\n            <pre>\n                {typeof err === 'string'? err : err.message}\n            </pre>\n        </Page>);\n    }\n\n    protected onMessage(message:any):Promise<void> {\n        return;\n    }\n\n    private onMessageReceive = async (message:any):Promise<void> => {\n        await this.onMessage(message);\n    }\n\n    protected async beforeStart():Promise<boolean> {\n        /*\n        console.log('this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);');\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n        console.log('return true');\n        */\n        return true;\n\t}\n\tprotected async afterStart():Promise<void> {\n\t}\n    protected registerReceiveHandler() {\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n    }\n\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\n    async start(param?:any, ...params:any[]):Promise<void> {\n        this.disposer = this.dispose;\n        this.registerReceiveHandler();\n        let ret = await this.beforeStart();\n        if (ret === false) return;\n\t\tawait this.internalStart(param, ...params);\n\t\tawait this.afterStart();\n    }\n\n    get isCalling():boolean {return this._resolve_$ !== undefined}\n\n    private _resolve_$:((value:any) => void)[];\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<T> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await this.start(param, ...params);\n        });\n    }\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<any> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await (new vp(this as any)).open(param);\n        });\n    }\n\n    returnCall(value:any) {\n        if (this._resolve_$ === undefined) return;\n        let resolve = this._resolve_$.pop();\n        if (resolve === undefined) {\n            alert('the Controller call already returned, or not called');\n            return;\n        }\n        resolve(value);\n    }\n\n    openPage(page:JSX.Element, onClosePage?: ()=>void) {\n\t\tlet disposer: ()=>void;\n\t\tif (onClosePage !== undefined) {\n\t\t\tdisposer = () => {\n\t\t\t\tif (this.disposer) this.disposer();\n\t\t\t\tonClosePage();\n\t\t\t}\n\t\t}\n\n        nav.push(page, disposer);\n        this.disposer = undefined;\n    }\n\n    replacePage(page:JSX.Element) {\n        nav.replace(page, this.disposer);\n        this.disposer = undefined;\n    }\n\n    backPage() {\n        nav.back();\n    }\n\n    closePage(level?:number) {\n        nav.pop(level);\n    }\n\n    ceasePage(level?:number) {\n        nav.ceaseTop(level);\n    }\n\n    removeCeased() {\n        nav.removeCeased();\n    }\n\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        nav.regConfirmClose(confirmClose);\n\t}\n\n\tprivate topPageKey:any;\n\tprotected startAction() {\n\t\tthis.topPageKey = nav.topKey();\n\t}\n\tpublic popToTopPage() {\n\t\tnav.popTo(this.topPageKey);\n\t}\n\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\n            let {caption, message, ok, yes, no, classNames} = options;\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\n                this.closePage();\n                resolve(res);\n            }\n            let buttons:any[] = [];\n            if (ok !== undefined) {\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\n            }\n            if (yes !== undefined) {\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\n            }\n            if (no !== undefined) {\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\n            }\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\n                    <div className=\"d-flex align-items-center justify-content-center\">\n                        {message}\n                    </div>\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\n                        {buttons}\n                    </div>\n                </div>\n            </Page>);\n            nav.regConfirmClose(async ():Promise<boolean> => {\n                resolve(undefined);\n                return true;\n            });\n        });\n    }\n}\n","import * as React from 'react';\nimport { Page, Image, UserView } from '../components';\nimport { env, User } from '../tool';\nimport { Controller } from './controller';\nimport { VPage } from './vpage';\n\nexport abstract class View<C extends Controller> {\n    protected controller: C;\n    protected readonly res: any;\n\tprotected readonly x: any;\n\tprotected readonly t: (str:string)=>any;\n\n    constructor(controller: C) {\n        this.controller = controller;\n        this.res = controller.res;\n\t\tthis.x = controller.x;\n\t\tthis.t = controller.t;\n    }\n\n\tprotected get isDev() {return  env.isDevelopment}\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\n    abstract render(param?:any): JSX.Element;\n\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\n        return (new vm(this.controller)).render(param);\n    }\n\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\n        await (new vp(this.controller)).open(param, afterBack);\n    }\n\n    protected async event(type:string, value?:any) {\n        await this.controller.event(type, value);\n    }\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        return await this.controller.vCall(vp, param);\n    }\n\n    protected returnCall(value:any) {\n        this.controller.returnCall(value);\n    }\n\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderUserText(user:any) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <>{nick || name}</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\n\t\tlet {user} = this.controller;\n\t\tif (!user) return;\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\n\t}\n\n    protected openPage(view: React.StatelessComponent<any>, param?:any) {\n        let type = typeof param;\n        if (type === 'object' || type === 'undefined') {\n            this.controller.openPage(React.createElement(view, param));\n        }\n        else {\n            this.controller.openPage(<Page header=\"param type error\">\n                View.openPage param must be object, but here is {type}\n            </Page>);\n        }\n    }\n\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\n        this.controller.replacePage(React.createElement(view, param));\n    }\n\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\n        this.controller.openPage(page, onClosePage);\n    }\n\n    protected replacePageElement(page: JSX.Element) {\n        this.controller.replacePage(page);\n    }\n\n    protected backPage() {\n        this.controller.backPage();\n    }\n\n    protected closePage(level?:number) {\n        this.controller.closePage(level);\n    }\n\n    protected ceasePage(level?:number) {\n        this.controller.ceasePage(level);\n    }\n\n    protected removeCeased() {\n        this.controller.removeCeased();\n    }\n\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.controller.regConfirmClose(confirmClose);\n\t}\n\n\tprotected popToTopPage() {\n\t\tthis.controller.popToTopPage();\n\t}\n}\n","import * as React from 'react';\nimport { Page, Scroller, TabsProps } from \"../components\";\nimport { View } from \"./view\";\nimport { Controller } from \"./controller\";\n\nexport abstract class VPage<C extends Controller> extends View<C> {\n\tprotected retOnClosePage: any;\n\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\n\t\tthis.init(param);\n\t\tlet _onClosePage: ()=>void;\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\n\t\treturn;\n\t}\n\n\trender(param?:any):JSX.Element {\n\t\tthis.init(param);\n\t\treturn this.renderPage();\n\t}\n\n\tinit(param?:any):void {return;}\n\n\theader():string|boolean|JSX.Element {return null;}\n\tright():JSX.Element {return null;}\n\tcontent():JSX.Element {return null;}\n\tfooter():JSX.Element {return null;}\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\n\tprotected renderPage():JSX.Element {\n\t\tlet header = this.header();\n\t\tif (!header) header = false;\n\t\treturn <Page\n\t\t\theader={header} right={this.right()} footer={this.footer()}\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\n\t\t\tback={this.back}\n\t\t\theaderClassName={this.headerClassName}\n\t\t\tclassName={this.className}\n\t\t\tafterBack={()=>this.afterBack()}\n\t\t\ttabsProps={this.tabsProps}\n\t\t\tlogout={this.logout()}\n\t\t>\n\t\t\t{this.content()}\n\t\t</Page>;\n\t}\n\n\tprotected onPageScroll(e:any) {}\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\n\tprotected afterBack():void {}\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\n\tprotected get headerClassName(): string {return null;}\n\tprotected get className(): string {return null;}\n\tprotected get tabsProps(): TabsProps {return null;}\n}\n","export * from './controller';\nexport * from './view';\nexport * from './vpage';","import _ from 'lodash';\nimport {observable, IObservableArray} from 'mobx';\nimport { PageItems } from '../tool';\nimport {Field, ArrFields} from './uqMan';\nimport {Entity} from './entity';\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\n\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\n\nexport class QueryPager<T extends any> extends PageItems<T> {\n\tprivate query: Query;\n\tprivate $page: any;\n\tprotected idFieldName: any;\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\n        super(itemObservable);\n        this.query = query;\n        if (pageSize !== undefined) this.pageSize = pageSize;\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\n\t}\n\n\tsetReverse() {\n\t\tthis.appendPosition = 'head';\n\t}\n\n    protected async onLoad() {\n\t\tif (this.$page) return;\n        let {schema} = this.query;\n        if (schema === undefined) {\n\t\t\tawait this.query.loadSchema();\n\t\t\tschema = this.query.schema;\n\t\t}\n\t\tif (schema === undefined) return;\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\n\t\tif ($page === undefined) return;\n\t\tthis.sortOrder = $page.order;\n\t\tlet fields = $page.fields;\n\t\tif (fields !== undefined) {\n\t\t\tlet field = fields[0];\n\t\t\tif (field) this.idFieldName = field.name;\n\t\t}\n    }\n\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\n\t\treturn ret;\n\t}\n\tprotected getPageId(item:T) {\n\t\tif (item === undefined) return;\n\t\tif (typeof item === 'number') return item;\n\t\tlet start = (item as any)[this.idFieldName];\n\t\tif (start === null) return;\n\t\tif (start === undefined) return;\n\t\tif (typeof start === 'object') {\n\t\t\tlet id = start.id;\n\t\t\tif (id !== undefined) return id;\n\t\t}\n\t\treturn start;\n\t}\n\tasync refreshItems(item:T) {\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index < 0) return;\n\t\tlet startIndex:number;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\tstartIndex = index - 1;\n\t\t}\n\t\telse {\n\t\t\tstartIndex = index + 1;\n\t\t}\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\n\t\tlet pageSize = 1;\n        let ret = await this.load(\n\t\t\tthis.param, \n\t\t\tpageStart,\n\t\t\tpageSize);\n\t\tlet len = ret.length;\n\t\tif (len === 0) {\n\t\t\tthis._items.splice(index, 1);\n\t\t\treturn;\n\t\t}\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet newItem = ret[i];\n\t\t\tif (!newItem) continue;\n\t\t\tlet newId = newItem[this.idFieldName];\n\t\t\tif (newId === undefined || newId === null) continue;\n\t\t\tif (typeof newId === 'object') newId = newId.id;\n\t\t\tlet oldItem = this._items.find(v => {\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\n\t\t\t\treturn oldId = newId;\n\t\t\t});\n\t\t\tif (oldItem) {\n\t\t\t\t_.merge(oldItem, newItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Query extends Entity {\n    get typeName(): string { return 'query';}\n    private pageStart: any;\n    private pageSize:number;\n    private params:any;\n    private more: boolean;\n    private startField: Field;\n    @observable list:IObservableArray; // = observable.array([], {deep: false});\n    returns: ArrFields[];\n    isPaged: boolean;\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        let {returns} = schema;\n        //this.returns = returns;\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\n    }\n\n    resetPage(size:number, params:any) {\n        this.pageStart = undefined;\n        this.pageSize = size;\n        this.params = params;\n        this.more = false;\n        this.list = undefined;\n    }\n    get hasMore() {return this.more;}\n    async loadPage():Promise<void> {\n        if (this.pageSize === undefined) {\n            throw new Error('call resetPage(size:number, params:any) first');\n        }\n        let pageStart:any;\n        if (this.pageStart !== undefined) {\n            switch (this.startField.type) {\n                default: pageStart = this.pageStart; break;\n                case 'date':\n                case 'time':\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\n            }\n        }\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\n\t\tlet page = ret.$page;\n        /*\n        await this.loadSchema();\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\n        let data = await this.unpackReturns(res);\n        let page = data['$page'] as any[];\n        */\n        this.list = observable.array([], {deep: false});\n        if (page !== undefined) {\n            if (page.length > this.pageSize) {\n                this.more = true;\n                page.pop();\n                let ret = this.returns.find(r => r.name === '$page');\n                this.startField = ret.fields[0];\n                this.pageStart = page[page.length-1][this.startField.name];\n            }\n            else {\n                this.more = false;\n            }\n            this.list.push(...page);\n        }\n        //this.loaded = true;\n    }\n\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\n        return new QueryPageCaller(this, params, showWaiting);\n    }\n\n    async page(params:any, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<{[name:string]:any[]}> {\n        /*\n        await this.loadSchema();\n        let res = await this.uqApi.page(this.name, pageStart, pageSize+1, this.buildParams(params));\n        */\n        let p = {pageStart:pageStart, pageSize:pageSize, params:params};\n        let res = await this.pageCaller(p, showWaiting).request();\n        //let data = this.unpackReturns(res);\n        //return data.$page;// as any[];\n        return res;\n    }\n    protected queryCaller(params: any, showWaiting: boolean = true): QueryQueryCaller {\n        return new QueryQueryCaller(this, params, showWaiting);\n    }\n    async query(params:any, showWaiting:boolean = true):Promise<any> {\n        /*\n        await this.loadSchema();\n        let res = await this.uqApi.query(this.name, this.buildParams(params));\n        */\n        let res = await this.queryCaller(params, showWaiting).request();\n        //let data = this.unpackReturns(res);\n        //return data;\n        return res;\n    }\n    async table(params:any, showWaiting:boolean = true): Promise<any[]> {\n        let ret = await this.query(params, showWaiting);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.table(params, showWaiting);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.obj(params, showWaiting);\n        for (let i in ret) return ret[i];\n    }\n}\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst ID_LENGTH = 8;\n\nexport function uid():string {\n    let len = ALPHABET.length;\n    let rtn = '';\n    for (let i = 0; i < ID_LENGTH; i++) {\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\n    }\n    return rtn;\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\n\nexport interface ImageProps {\n    src: string;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n}\n\nexport function Image(props: ImageProps) {\n    let {className, style, src, altImage} = props;\n    if (!src) {\n        return <div className={classNames(className, 'image-none')} style={style}>\n            <i className=\"fa fa-file-o\" />\n        </div>;\n    }\n    if (src.startsWith(':') === true) {\n        src = nav.resUrl + src.substr(1);\n    }\n    return <img src={src} className={className} alt=\"img\"\n        style={style}\n        onError={evt=>{\n            if (altImage) evt.currentTarget.src=altImage;\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n        }} />;\n}\n","import jwtDecode from 'jwt-decode';\n\nexport interface Unit {\n    id: number;\n    name: string;\n}\n\nexport interface Guest {\n    id: number;             // id = 0\n    guest: number;\n    token: string;\n}\n\nexport interface User extends Guest {\n    id: number;\n    name: string;\n    nick?: string;\n    icon?: string;\n}\n\nexport function decodeUserToken(token: string): User {\n    let ret:any = jwtDecode(token);\n    let user: User = {\n        id: ret.id,\n        name: ret.name,\n        guest: ret.guest,\n        token: token,\n    };\n    return user;\n}\n\nexport function decodeGuestToken(token: string): Guest {\n    let ret:any = jwtDecode(token);\n    let guest: Guest = {\n        id: 0,\n        guest: ret.guest,\n        token: token,\n    };\n    return guest;\n}\n","import { env } from '../tool';\n\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugBuilderHost = 'localhost:3009';\ninterface HostValue {\n    value: string;\n    local: boolean;\n}\nconst hosts:{[name:string]:HostValue} = {\n    centerhost: {\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \n        local: false\n    },\n    reshost: {\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\n        local: false\n    },\n    uqhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    unitxhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    \"uq-build\": {\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \n        local: false\n    }\n}\n\nconst httpArr = ['https://', 'http://'];\nfunction isAbsoluteUrl(url:string):boolean {\n    for (let str of httpArr) {\n        if (url.startsWith(str) === true) return true;\n    }\n    return false;\n}\n\nfunction urlFromHost(host:string):string {\n    if (isAbsoluteUrl(host) === true) {\n        if (host.endsWith('/')) return host;\n        return host + '/';\n    }\n    return `http://${host}/`;\n}\n\nfunction centerUrlFromHost(host:string):string {\n    return urlFromHost(host);\n}\nfunction centerWsFromHost(host:string) {\n    let https = 'https://';\n    if (host.startsWith(https) === true) {\n        host = host.substr(https.length);\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\n        return 'wss://' + host + '/tv/';\n    }\n    return `ws://${host}/tv/`\n}\nexport function resUrlFromHost(host:string) {\n    let url = urlFromHost(host);\n    return url + 'res/';\n}\n\nconst fetchOptions = {\n    method: \"GET\",\n    mode: \"no-cors\", // no-cors, cors, *same-origin\n    headers: {\n        \"Content-Type\": \"text/plain\"\n    },\n};\n\nclass Host {\n    testing: boolean;\n    url: string;\n    ws: string;\n    resHost: string;\n\n    async start(testing:boolean) {\n        this.testing = testing;\n        if (env.isDevelopment === true) {\n            await this.tryLocal();\n        }\n        let host = this.getCenterHost();\n        this.url = centerUrlFromHost(host);\n        this.ws = centerWsFromHost(host);\n        this.resHost = this.getResHost();\n    }\n\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\n    private async tryLocal() {\n        let promises:PromiseLike<any>[] = [];\n        let hostArr:string[] = [];\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            let {value} = hostValue;\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\n        }\n\n        for (let host of hostArr) {\n            let fetchUrl = this.debugHostUrl(host);\n            promises.push(localCheck(fetchUrl));\n        }\n        let results = await Promise.all(promises);\n        let len = hostArr.length;\n        for (let i=0; i<len; i++) {\n            let local = results[i];\n            let host = hostArr[i];\n            for (let j in hosts) {\n                let hostValue = hosts[j];\n                if (hostValue.value === host) {\n                    hostValue.local = local;\n                }\n            }\n        }\n        /*\n        let p = 0;\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            hostValue.local = results[p];\n            ++p;\n        }\n        */\n    }\n\n    private getCenterHost():string {\n        let {value, local} = hosts.centerhost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return centerHost;\n    }\n\n    private getResHost():string {\n        let {value, local} = hosts.reshost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return resHost;\n    }\n\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\n        if (env.isDevelopment === false) return url;\n        let host = hosts[debugHost];\n        if (host === undefined) return url;\n        let {value, local} = host;\n        if (local === false) return url;\n        return `http://${value}/`;\n    }\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\n\t\tlet path:string;\n\t\tif (!urlTest) {\n\t\t\turlTest = url;\n\t\t\tif (!urlTest) {\n\t\t\t\tconsole.error('no server set for ' + db);\n\t\t\t\tdebugger;\t\t\t\t\n\t\t\t}\n\t\t}\n        if (this.testing === true) {\n            if (urlTest !== '-') url = urlTest;\n            path = 'uq/test/' + db + '/';\n        }\n        else {\n            path = 'uq/prod/' + db + '/';\n        }\n\t\turl = this.getUrlOrDebug(url);\n\t\tif (url.endsWith('/') === false) {\n\t\t\turl += '/';\n\t\t}\n        return url + path;\n    }\n\n    async localCheck(urlDebug: string):Promise<boolean> {\n        return await localCheck(urlDebug);\n    }\n}\n\nexport const host:Host = new Host();\n\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\n// 网上找了上面的fetch timeout代码。\n// 尽管timeout了，fetch仍然继续，没有cancel\n\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\n//const timeout = 2000;\nconst timeout = 200;\n\nfunction fetchLocalCheck(url:string):Promise<any> {\n    return new Promise((resolve, reject) => {\n      fetch(url, fetchOptions as any)\n      .then(v => {\n          v.text().then(resolve).catch(reject);\n      })\n      .catch(reject);\n      const e = new Error(\"Connection timed out\");\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\n    });\n}\n\nasync function localCheck(url:string):Promise<boolean> {\n    try {\n        await fetchLocalCheck(url);\n        return true;\n    }\n    catch (err) {\n        return false;\n    }\n}\n\n/*\nexport interface IUqForChannel {\n    uq: string;\n    uqVersion: number;\n}\n*/","import { Entity } from './entity';\nimport { ActionCaller } from './caller';\n\nexport class Action extends Entity {\n    get typeName(): string { return 'action';}\n    async submit(data:object) {\n\t\tlet caller = new ActionSubmitCaller(this, data)\n\t\tlet ret = await caller.request();\n\t\treturn ret;\n    }\n    async submitReturns(data:object):Promise<{[ret:string]:any[]}> {\n       return await new SubmitReturnsCaller(this, data).request();\n    }\n    async submitConvert(data:object) {\n        return await new SubmitConvertCaller(this, data).request();\n    }\n}\n\nexport class ActionSubmitCaller extends ActionCaller {\n    get path():string {return 'action/' + this.entity.name;}\n    buildParams():any {\n\t\treturn {data: this.entity.pack(this.params)}\n\t}\n}\n\nclass SubmitReturnsCaller extends ActionSubmitCaller {\n    get path():string {return 'action/' + this.entity.name + '/returns';}\n    xresult(res:any):any {\n        let {returns} = this.entity;\n        let len = returns.length;\n        let ret:{[r:string]:any[]} = {};\n        for (let i=0; i<len; i++) {\n            let retSchema = returns[i];\n            ret[retSchema.name] = res[i];\n        }\n        return ret;\n    }\n}\n\nclass SubmitConvertCaller extends ActionSubmitCaller {\n    get path():string {return 'action-convert/' + this.entity.name;}\n    buildParams():any {\n        return {\n            data: this.params\n        };\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-lmr.css';\n\nexport interface LMRProps {\n    className?: string | string[];\n    left?: string|JSX.Element;\n    right?: string|JSX.Element;\n    onClick?: ()=>void;\n}\n\n@observer\nexport class LMR extends React.Component<LMRProps> {\n    render() {\n        let {className, left, children, right, onClick} = this.props;\n        let l, r;\n        if (left !== undefined) l = <header>{left}</header>;\n        if (right !== undefined) r = <footer>{right}</footer>;\n        let cursor;\n        if (onClick !== undefined) cursor = 'cursor-pointer';\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\n            {l}\n            <div>{children}</div>\n            {r}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-badge.css';\n\nexport interface BadgeProps {\n    className?: string;\n    badge?: string|number;\n    size?: 'xs' | 'sm' | 'lg';\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\n    badgeAlign?: 'left'|'center'|'right';\n    badgeVertical?: 'top'|'middle'|'bottom';\n}\n\n@observer\nexport class Badge extends React.Component<BadgeProps> {\n    render() {\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\n        let cn = classNames(\n            className,\n            'va-badge',\n            size && 'va-badge-'+size,\n            'va-badge-' + (color||'secondary'),\n            badgeAlign && 'va-badg-'+badgeAlign,\n            badgeVertical && 'va-badg-'+badgeVertical,\n        );\n        let b;\n        if (badge) b = <b>{badge}</b>;\n        return <div className={cn}>\n            {children}\n            {b}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface FAProps {\n    name: string;\n    className?: string;\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\n    spin?: boolean;\n    fixWidth?: boolean;\n    border?: boolean;\n    pull?: 'left'|'right';\n    pulse?: boolean;\n    rotate?: 90|180|270;\n    flip?: 'horizontal'|'vertical';\n    inverse?: boolean;\n}\n\nexport class FA extends React.Component<FAProps> {\n    render() {\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\n        let cn = classNames(className, 'fa',\n            name && ('fa-' + name),\n            size && 'fa-'+size,\n            fixWidth && 'fa-fw',\n            border && 'fa-border',\n            pull && 'fa-pull-' + pull,\n            spin && 'fa-spin',\n            pulse && 'fa-pulse',\n            rotate && 'fa-rotate-' + rotate,\n            flip && 'fa-flip-' + flip,\n            inverse && 'fa-inverse',\n        );\n        return <i className={cn} />\n    }\n}\n\nexport interface StackedFAProps {\n    className?: string;\n    size?: 'lg',\n}\nexport class StackedFA extends React.Component<StackedFAProps> {\n    render() {\n        let {className, size, children} = this.props;\n        let cn = classNames(\n            'fa-stack',\n            className,\n            size && 'fa-' + size);\n        return <span className={cn}>\n            {children}\n        </span>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport const Muted = (props:any) => \n<small className={classNames('text-muted', props.className)} style={props.style}>\n    {props.children}\n</small>;\n","import * as React from 'react';\nimport {FA} from './FA';\n\nexport interface IconTextProps {\n    icon: string;\n    iconClass?: string;\n    text: string;\n    textClass?: string;\n}\n\nexport class IconText extends React.Component<IconTextProps> {\n    render() {\n        let {icon, iconClass, text, textClass} = this.props;\n        return <div className=\"py-2\">\n            <FA className={iconClass} name={icon} fixWidth={true} />\n            <span className={textClass}>{text}</span>\n        </div>;\n    }\n}\n","export * from './Badge';\nexport * from './LMR';\nexport * from './FA';\nexport * from './IconText';\nexport * from './Muted';\n","import { observable } from 'mobx';\nimport { isNumber } from 'util';\nimport _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { BoxId } from './boxId';\nimport { TuidInner, TuidDiv } from './tuid';\n\nconst maxCacheSize = 1000;\n\nexport class IdCache {\n    private queue: number[] = [];               // 每次使用，都排到队头\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\n\tprivate loading:boolean = false;\n\n    protected localArr:LocalArr;\n    protected waitingIds: number[] = [];          // 等待loading的\n    protected tuidInner: TuidInner;\n\n    constructor(tuidLocal: TuidInner) {\n        this.tuidInner = tuidLocal;\n        this.initLocalArr();\n    }\n\n    protected initLocalArr() {\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    useId(id:number, defer?:boolean) {\n        if (!id) return;\n        if (isNumber(id) === false) return;\n        if (this.cache.has(id) === true) {\n            this.moveToHead(id);\n            return;\n        }\n        this.tuidInner.cacheTuids(defer===true?70:20);\n        this.cache.set(id, id);\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\n            this.moveToHead(id);\n            return;\n        }\n\n        if (this.queue.length >= maxCacheSize) {\n            // 缓冲已满，先去掉最不常用的\n            let r = this.queue.shift();\n            if (r === id) {\n                // 如果移除的，正好是现在用的，则插入\n                this.queue.push(r);\n                return;\n            }\n\n            //let rKey = String(r);\n            if (this.cache.has(r) === true) {\n                // 如果移除r已经缓存\n                this.cache.delete(r);\n            }\n            else {\n                // 如果移除r还没有缓存\n                let index = this.waitingIds.findIndex(v => v === r);\n                this.waitingIds.splice(index, 1);\n            }\n        }\n        this.waitingIds.push(id);\n        this.queue.push(id);\n        return;\n    }\n\n    private moveToHead(id:number) {\n        let index = this.queue.findIndex(v => v === id);\n        this.queue.splice(index, 1);\n        this.queue.push(id);\n    }\n\n    getValue(id:number) {\n        return this.cache.get(id);\n    }\n\n    remove(id:number) {\n        this.cache.delete(id);\n        let index = this.queue.findIndex(v => v === id);\n\t\tthis.queue.splice(index, 1);\n\t\tthis.localArr.removeItem(id);\n    }\n\n    valueFromId(id:number|BoxId):any {\n        let _id:number;\n        switch (typeof id) {\n            case 'object': _id = (id as BoxId).id; break;\n            case 'number': _id = id as number; break;\n            default: return;\n        }\n        return this.getValue(_id);\n    }\n\n    resetCache(id:number) {\n        this.remove(id);\n        this.useId(id);\n    }\n\n    cacheValue(val:any):boolean {\n        if (val === undefined) return false;\n        let id = this.getIdFromObj(val);\n        if (id === undefined) return false;\n        let index = this.waitingIds.findIndex(v => v === id);\n        if (index>=0) this.waitingIds.splice(index, 1);\n        this.cache.set(id, val);\n        return true;\n    }\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\n\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n\t\tlet tuidValues = await this.loadIds();\n\t\tif (tuidValues === undefined) return;\n        this.cacheIdValues(tuidValues);\n    }\n\n    private cacheIdValues(tuidValues: any[]) {\n        if (tuidValues === undefined) return;\n        let tuids = this.unpackTuidIds(tuidValues);\n        for (let tuidValue of tuids) {\n            if (this.cacheValue(tuidValue) === false) continue;\n            this.cacheTuidFieldValues(tuidValue);\n        }\n    }\n    async modifyIds(ids:any[]):Promise<void> {\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\n        let localedValues = tuidValues.filter(v => {\n            let p = v.indexOf('\\t');\n            if (p<0) p = v.length;\n            let id = Number(v.substr(0, p));\n            let val = this.localArr.getItem(id);\n            return (val !== undefined);\n        });\n        if (localedValues.length === 0) return;\n        this.cacheIdValues(localedValues);\n    }\n    protected divName:string = undefined;\n    protected async loadIds(): Promise<any[]> {\n\t\tif (this.loading === true) return;\n\t\tthis.loading = true;\n\t\tlet ret = await this.loadTuidIdsOrLocal(this.waitingIds);\n\t\tthis.loading = false;\n        return ret;\n    }\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.tuidInner.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\n    }\n\n    async assureObj(id:number):Promise<void> {\n        let val = this.cache.get(id);\n        switch (typeof val) {\n            case 'object': return val;\n            case 'number': this.cache.set(id, id); break;\n        }\n        let ret = await this.loadTuidIdsOrLocal([id]);\n        this.cacheIdValues(ret);\n    }\n\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\n        let ret:string[] = [];        \n        let netIds:number[] = [];\n        for (let id of ids) {\n            let value = this.localArr.getItem(id);\n            //if (value === undefined)\n            // 值不存在或者是空字符串，重新获取\n            if (!value)\n                netIds.push(id);\n            else\n                ret.push(value);\n        }\n        let len = netIds.length;\n        if (len > 0) {\n            let netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\n            for (let i=0; i<len; i++) {\n                //有些id可能没有内容，不会返回\n                //let id = netIds[i]; \n                let row:string = netRet[i];\n                if (!row) continue;\n                let p = row.indexOf('\\t');\n                if (p < 0) p = row.length;\n                let id = Number(row.substr(0, p));\n                _.remove(netIds, v => v === id);\n                ret.push(row);\n                this.localArr.setItem(id, row);\n            }\n            len = netIds.length;\n            for (let i=0; i<len; i++) {\n                this.localArr.setItem(netIds[i], '');\n            }\n        }\n        return ret;\n    }\n}\n\nexport class IdDivCache extends IdCache {\n    private div: TuidDiv;\n    protected divName:string;\n\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\n        super(tuidLocal);\n        this.div = div;\n        this.divName = div.name;\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\n    }\n\n    protected initLocalArr() {\n        // 这个不需要，必须去掉\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.div.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.div.cacheTuidFieldValues(tuidValue);\n    }\n\n    /*\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n        let tuidValues = await this.loadIds();\n        if (tuidValues !== undefined) {\n            let tuids = this.tuidLocal.unpackTuidIds(tuidValues);\n            for (let tuidValue of tuids) {\n                if (this.cacheValue(tuidValue) === false) continue;\n                this.tuidLocal.cacheTuidFieldValues(tuidValue);\n                this.afterCacheValue(tuidValue);\n            }\n        }\n    }\n    */\n}\n","import _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { Entity } from '../entity';\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\nimport { EntityCaller } from '../caller';\nimport { BoxId } from './boxId';\nimport { IdCache, IdDivCache } from './idCache';\n\nexport interface TuidSaveResult {\n    id: number;\n    inId: number;\n}\n\nexport abstract class Tuid extends Entity {\n    protected noCache: boolean;\n    readonly typeName:string = 'tuid';\n    protected idName: string;\n    cached: boolean;\n    unique: string[];\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {id} = schema;\n        this.idName = id;\n    }\n\n    buildTuidBox(): TuidBox {\n        return new TuidBox(this);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    stopCache():void {this.noCache = true}\n    abstract useId(id:number):void;\n    abstract boxId(id:number):BoxId;\n    abstract valueFromId(id:number):any;\n\tabstract resetCache(id:number|BoxId):void;\n    abstract async assureBox<T> (id:number): Promise<T>;\n    static equ(id1:BoxId|number, id2:BoxId|number): boolean {\n        if (id1 === undefined) return false;\n        if (id2 === undefined) return false;\n        if (typeof id1 === 'object') {\n            return id1.equ(id2);\n        }\n        if (typeof id2 === 'object') {\n            return id2.equ(id1);\n        }\n        return id1 === id2;\n    }\n    cacheIds() {}\n    async modifyIds(ids:any[]) {}\n    isImport = false;\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\n    abstract div(name:string):TuidDiv;\n    abstract async loadMain(id:number|BoxId):Promise<any>;\n\tabstract async load(id:number|BoxId):Promise<any>;\n    abstract async all():Promise<any[]>;\n\tabstract async save(id:number, props:any):Promise<TuidSaveResult>;\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\n    abstract async search(key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async loadArr(arr:string, owner:number, id:number):Promise<any>;\n    abstract async saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\n    abstract async posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\n}\n\nexport class TuidInner extends Tuid {\n    private divs: {[div:string]: TuidDiv};\n    protected cacheFields: Field[];\n    protected idCache: IdCache;\n    protected localArr:LocalArr;\n    constructor(uq:UqMan, name:string, typeId:number) {\n        super(uq, name, typeId);\n        this.idCache = new IdCache(this);\n        this.localArr = this.cache.arr(this.name + '.whole');\n        if (uq.newVersion === true) this.localArr.removeAll();\n    }\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {arrs} = schema;\n        if (arrs !== undefined) {\n            this.divs = {};\n            for (let arr of arrs) {\n                let {name} = arr;\n                let tuidDiv = new TuidDiv(this.uq, this, name);\n                this.divs[name] = tuidDiv;\n                tuidDiv.setSchema(arr);\n                tuidDiv.buildFieldsTuid();\n            }\n        }\n    }\n    \n    useId(id:number, defer?:boolean) {\n        if (this.noCache === true) return;\n        if (!id) return;\n        this.idCache.useId(id, defer);\n    }\n    boxId(id:number):BoxId {\n        if (!id) return;\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        let {createBoxId} = this.uq;\n        if (!createBoxId) return {id: id} as BoxId;\n        return createBoxId(this, id);\n    }\n    valueFromId(id:number) {return this.idCache.getValue(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tif (typeof id === 'object') id = id.id;\n\t\tthis.idCache.resetCache(id);\n\t}\n    async assureBox<T> (id:number):Promise<T> {\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    cacheIds() {\n        this.idCache.cacheIds();\n        if (this.divs === undefined) return;\n        for (let i in this.divs) this.divs[i].cacheIds();\n    }\n    async modifyIds(ids:any[]) {\n        await this.idCache.modifyIds(ids);\n    }\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\n    get hasDiv():boolean {return this.divs!==undefined}\n    div(name:string):TuidDiv {\n        return this.divs && this.divs[name];\n    }\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\n        if (ret.length > 0) this.cached = true;\n        return ret;\n    }\n    async loadMain(id:number|BoxId):Promise<any> {\n        if (typeof id === 'object') id = id.id;\n        await this.idCache.assureObj(id);\n        return this.idCache.valueFromId(id);\n    }\n    async load(id:number|BoxId):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let cacheValue = this.idCache.valueFromId(id); \n        //if (typeof cacheValue === 'object') return cacheValue;\n        if (typeof id === 'object') id = id.id;\n        let valuesText = undefined; //this.localArr.getItem(id);\n        let values: any;\n        if (valuesText) {\n            values = JSON.parse(valuesText);\n        }\n        else {\n            values = await new GetCaller(this, id).request();\n            if (values !== undefined) {\n                // this.localArr.setItem(id, JSON.stringify(values));\n            }\n        }\n        if (values === undefined) return;\n        for (let f of this.schema.fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.uq.getTuid(tuid);\n            if (t === undefined) continue;\n            let n = f.name;\n            values[n] = t.boxId(values[n]);\n        }\n        this.idCache.cacheValue(values);\n        this.cacheTuidFieldValues(values);\n        return values;\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let {fields, arrs} = this.schema;\n        this.cacheFieldsInValue(values, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs as ArrFields[]) {\n                let {name, fields} = arr;\n                let arrValues = values[name];\n                if (arrValues === undefined) continue;\n                let tuidDiv = this.div(name);\n                for (let row of arrValues) {\n                    //row._$tuid = tuidDiv;\n                    //row.$owner = this.boxId(row.owner);\n                    tuidDiv.cacheValue(row);\n                    this.cacheFieldsInValue(row, fields);\n                }\n            }\n        }\n    }\n\n    public buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields} = this.schema;\n        if (mainFields === undefined) debugger;\n        this.uq.buildFieldTuid(this.cacheFields = mainFields || this.fields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\n        if (id !== undefined) {\n            this.idCache.remove(id);\n            this.localArr.removeItem(id);\n        }\n        return ret;\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\n\t\tthis.idCache.remove(id);\n\t\tawait this.idCache.assureObj(id);\n\t}\n    async all():Promise<any[]> {\n        let ret: any[] = await new AllCaller(this, {}).request();\n        return ret;\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\n        return ret;\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        //let api = this.uqApi;\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\n        let ret = await new SearchCaller(this, params).request();\n        let {fields} = this.schema;\n        for (let row of ret) {\n            this.cacheFieldsInValue(row, fields);\n        }\n        return ret;\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let api = this.uqApi;\n        //return await api.tuidArrGet(this.name, arr, owner, id);\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any) {\n        //let params = _.clone(props);\n        //params[\"$id\"] = id;\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\n    }\n\n    async posArr(arr:string, owner:number, id:number, order:number) {\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\n    }\n}\n\nabstract class TuidCaller<T> extends EntityCaller<T> {\n    protected get entity(): Tuid {return this._entity as Tuid};\n}\n\n// 包含main字段的load id\n// 当前为了兼容，先调用的包含所有字段的内容\nclass GetCaller extends TuidCaller<number> {\n    method = 'GET';\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\n}\n\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\n    get path():string {\n        let {divName} = this.params;\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\n    }\n    buildParams():any {return this.params.ids}\n    xresult(res:any):any {\n        return (res as string).split('\\n');\n    }\n}\n\n\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\n    get path():string {return `tuid/${this.entity.name}`}\n    buildParams():any {\n        let {fields, arrs} = this.entity.schema;\n        let {id, props} = this.params;\n        let params:any = {$id: id};\n        this.transParams(params, props, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let arrName = arr.name;\n                let arrParams = [];\n                let arrFields = arr.fields;\n                let arrValues = props[arrName];\n                if (arrValues !== undefined) {\n                    for (let arrValue of arrValues) {\n                        let row = {};\n                        this.transParams(row, arrValue, arrFields);\n                        arrParams.push(row);\n                    }\n                }\n                params[arrName] = arrParams;\n            }\n        }\n        return params;\n    }\n    private transParams(values:any, params:any, fields:Field[]) {\n        if (params === undefined) return;\n        for (let field of fields) {\n            let {name, tuid, type} = field;\n            let val = params[name];\n            if (tuid !== undefined) {\n                if (typeof val === 'object') {\n                    if (val !== null) val = val.id;\n                }\n            }\n            else {\n                switch (type) {\n                    case 'date':\n                        val = this.entity.buildDateParam(val); \n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                    case 'datetime':\n                        val = this.entity.buildDateTimeParam(val);\n                        //val = new Date(val).toISOString();\n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                }\n            }\n            values[name] = val;\n        }\n    }\n}\n\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\n    get path():string {return `tuids/${this.entity.name}`}\n}\n\nclass AllCaller extends TuidCaller<{}> {\n    method = 'GET';\n    get path():string {return `tuid-all/${this.entity.name}`}\n}\n\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\n    method = 'GET';\n    get path():string {\n        let {arr, owner, id} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\n    }\n}\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\n}\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, props} = this.params;\n        let params = _.clone(props);\n        params['$id'] = id;\n        return params;\n    }\n}\n\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, order} = this.params;\n        return { bid: id, $order: order}\n    }\n}\n\nexport class TuidImport extends Tuid {\n    private tuidLocal: TuidInner;\n\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\n        super(uq, name, typeId);\n        this.from = from;\n    }\n\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\n    \n    readonly from: SchemaFrom;\n    isImport = true;\n\n    useId(id:number) {this.tuidLocal.useId(id);}\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tthis.tuidLocal.resetCache(id);\n\t}\n    async assureBox<T>(id:number):Promise<T> {\n        await this.tuidLocal.assureBox(id);\n\t\treturn this.tuidLocal.valueFromId(id);\n    }\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\n    async loadMain(id:number|BoxId):Promise<any> {\n        let ret = await this.tuidLocal.loadMain(id);\n        return ret;\n    }\n    async load(id:number|BoxId):Promise<any> {\n        return await this.tuidLocal.load(id);\n    }\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        return await this.tuidLocal.save(id, props);\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\n\t}\n    async all():Promise<any[]> {\n        return await this.tuidLocal.all();\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.search(key, pageStart, pageSize);\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        return await this.tuidLocal.loadArr(arr, owner, id);\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\n        await this.tuidLocal.saveArr(arr, owner, id, props);\n    }\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\n        await this.tuidLocal.posArr(arr, owner, id, order);\n    }\n}\n\n// field._tuid 用这个接口\n// Tuid, TuidDiv 实现这个接口\nexport class TuidBox {\n    tuid: Tuid;\n    ownerField:Field = undefined;\n    constructor(tuid: Tuid) {\n        this.tuid = tuid;\n    }\n\n    boxId(id:number):BoxId {\n        return this.tuid.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.tuid.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.tuid.useId(id);\n    }\n    async showInfo() {\n        alert('showInfo not implemented');\n    }\n}\n\n\nexport class TuidDiv extends TuidInner /* Entity*/ {\n    readonly typeName:string = 'div';\n    protected cacheFields: Field[];\n    protected tuid: TuidInner;\n    protected idName: string;\n    protected idCache: IdDivCache;\n\n    //ui: React.StatelessComponent<any>;\n    //res: any;\n\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\n        super(uq, name, 0);\n        this.tuid = tuid;\n        this.idName = 'id';\n        this.idCache = new IdDivCache(tuid, this);\n    }\n\n    get owner() {return this.tuid}\n\n    /*\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.buildFieldsTuid();\n    }*/\n\n    /*\n    setUIRes(ui:any, res:any) {\n        this.ui = ui && ui.content;\n        this.res = res;\n    }\n    */\n\n    buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields} = this.schema;\n        if (mainFields === undefined) debugger;\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\n    }\n\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\n        return new TuidBoxDiv(this.tuid, this, ownerField);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    cacheValue(value:any):void {\n        this.idCache.cacheValue(value);\n    }\n\n    useId(id:number, defer?:boolean):void {\n        if (this.noCache === true) return;\n        this.idCache.useId(id, defer);\n    }\n\n    /*\n    boxId(id:number):BoxId {\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        //return new BoxDivId(this.tuid, this, id);\n        return this.tuid.boxDivId(this, id);\n    }\n    */\n    valueFromId(id:number):any {\n        return this.idCache.getValue(id)\n    }\n\n    async assureBox<T>(id:number):Promise<T> {\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    async cacheIds() {\n        await this.idCache.cacheIds();\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let fields = this.schema.fields;\n        this.cacheFieldsInValue(values, fields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n}\n\nexport class TuidBoxDiv extends TuidBox {\n    ownerField: Field;\n    private div: TuidDiv;\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\n        super(tuid);\n        this.div = div;\n        this.ownerField = ownerField;\n    }\n\n    boxId(id:number):BoxId {\n        return this.div.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.div.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.div.useId(id);\n    }\n}\n","import _ from 'lodash';\n\nclass _LocalStorage {\n    getItem(key:string) {\n        return localStorage.getItem(key)\n    }\n    setItem(key:string, value:string) {\n        localStorage.setItem(key, value);\n    }\n    removeItem(key:string) {\n        localStorage.removeItem(key);\n    }\n}\n\nconst __ls = new _LocalStorage(); // new Ls;\n\nexport class LocalCache {\n    private readonly local: Local;\n    //private value: T;\n    readonly key: string|number;\n\n    constructor(local:Local, key:string|number) {\n        this.local = local;\n        this.key = key;\n    }\n    get():any {\n        try {\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\n            //if (this.value !== undefined) return this.value;\n            let text = this.local.getItem(this.key);\n            if (text === null) return;\n            if (text === undefined) return undefined;\n            //return this.value = \n            return JSON.parse(text);\n        }\n        catch (err) {\n            this.local.removeItem(this.key);\n            return;\n        }\n    }\n    set(value:any) {\n\t\tlet t = JSON.stringify(value, (key, value) => {\n\t\t\tif (key !== '_tuid') return value;\n\t\t});\n\t\tthis.local.setItem(this.key, t);\n    }\n    remove(local?:Local) {\n        if (local === undefined) {\n            this.local.removeItem(this.key);\n        }\n        else {\n            this.local.removeLocal(local);\n        }\n    }\n    child(key:string|number):LocalCache {\n        return this.local.child(key);\n    }\n    arr(key:string|number):LocalArr {\n        return this.local.arr(key);\n    }\n    map(key:string|number):LocalMap {\n        return this.local.map(key);\n    }\n}\n\nabstract class Local {\n    private readonly caches: {[key:string]:LocalCache};\n    private readonly locals: {[key:string]:Local};\n    protected readonly name: string;\n    constructor(name: string) {\n        this.name = name;\n        this.caches = {};\n        this.locals = {};\n    }\n\n    protected abstract keyForGet(key:string|number):string;\n    protected abstract keyForSet(key:string|number):string;\n    protected abstract keyForRemove(key:string|number):string;\n    abstract removeAll():void;\n    getItem(key:string|number):string {\n        let k = this.keyForGet(key);\n        if (k === undefined) return;\n        return __ls.getItem(k);\n    }\n    setItem(key:string|number, value: string):void {\n        let k = this.keyForSet(key);\n        __ls.setItem(k, value);\n    }\n    removeItem(key:string|number):void {\n        let k = this.keyForSet(key);\n        if (k === undefined) return;\n        localStorage.removeItem(k);\n    }\n    arr(key:string|number):LocalArr {\n        let sk = String(key);\n        let arr = this.locals[sk] as LocalArr;\n        if (arr === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = arr = new LocalArr(k);\n        }\n        return arr;\n    }\n    map(key:string|number):LocalMap {\n        let sk = String(key);\n        let map = this.locals[sk] as LocalMap;\n        if (map === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = map = new LocalMap(k);\n        }\n        return map;\n    }\n    removeLocal(local:Local) {\n        let sk = local.name;\n        let k = this.keyForRemove(sk);\n        if (k === undefined) return;\n        let arr = this.locals[sk];\n        if (arr === undefined) arr = new LocalArr(k);\n        else this.locals[sk] = undefined;\n        arr.removeAll();\n    }\n    child(key:string|number):LocalCache {\n        let ks = String(key);\n        let ret = this.caches[ks];\n        if (ret !== undefined) return ret;\n        return this.caches[ks] =ret = new LocalCache(this, key);\n    }\n}\n\nconst maxArrSize = 500;\nexport class LocalArr extends Local {\n    private readonly index: number[];\n    constructor(name: string) {\n        super(name);\n        let index = __ls.getItem(this.name);\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\n    }\n    private saveIndex() {\n        __ls.setItem(this.name, this.index.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i < 0) return undefined;\n        return `${this.name}.${key}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) {\n            this.index.unshift(key);\n            if (this.index.length > maxArrSize) this.index.pop();\n        }\n        else {\n            this.index.splice(i, 1);\n            this.index.unshift(key)\n        }\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    protected keyForRemove(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) return;\n        this.index.splice(i, 1);\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    removeAll():void {\n        for (let i of this.index) {\n            __ls.removeItem(`${this.name}.${i}`);\n        }\n        __ls.removeItem(this.name);\n        this.index.splice(0);\n    }\n    item(index:number):LocalCache {\n        return this.child(index);\n    }\n}\n\nexport class LocalMap extends Local {\n    private readonly index: {[key:string]:number};\n    private max: number;\n    constructor(name: string) {\n        super(name);\n        this.max = 0;\n        this.index = {};\n        let index = __ls.getItem(this.name);\n        if (index !== null) {\n            let ls = index.split('\\n');\n            ls.forEach(l => {\n                let p = l.indexOf('\\t');\n                if (p<0) return;\n                let key = l.substr(0, p);\n                let i = Number(l.substr(p+1));\n                if (isNaN(i) === true) return;\n                this.index[key] = i;\n                if (i>this.max) this.max = i;\n            });\n        }\n    }\n    private saveIndex() {\n        let ls:string[] = [];\n        for (let k in this.index) {\n            let v = this.index[k];\n            if (v === undefined) continue;\n            ls.push(`${k}\\t${v}`);\n        }\n        __ls.setItem(this.name, ls.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) return undefined;\n        return `${this.name}.${i}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) {\n            ++this.max;\n            i = this.max;\n            this.index[key] = i;\n            this.saveIndex();\n        }\n        return `${this.name}.${i}`;\n    }\n    protected keyForRemove(key:string|number):string {\n        let i = this.index[key];\n        if (i===undefined) return;\n        this.index[key] = undefined;\n        this.saveIndex();\n        return `${this.name}.${i}`;\n    }\n    removeAll():void {\n        for (let i in this.index) {\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\n            this.index[i] = undefined;\n        }\n        __ls.removeItem(this.name);\n        this.max = 0;\n    }\n    item(key:string):LocalCache {\n        return this.child(key);\n    }\n}\n","import * as React from 'react';\nimport { BoxId } from './boxId';\nimport { Tuid } from './tuid';\nimport { observer } from 'mobx-react';\n\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\n    return <>{tuidName}: {uqStringify(values)}</>;\n};\n\nexport function uqStringify(values: any): string {\n    let s = '{';\n    if (values === undefined) return 'undefined';\n    for (let i in values) {\n        let v = values[i];\n        s += i + ': ';\n        if (v === undefined) {\n            s += 'undefined';\n        }\n        else if (v === null) {\n            s += 'null';\n        }\n        else {\n            switch (typeof v) {\n                default:\n                    s += v;\n                    break;\n                case 'function':\n                    s += 'function';\n                    break;\n                case 'object':\n                    s += '{obj}';\n                    break;\n            }\n        }\n        s += ', ';\n    }\n    return s + '}';\n}\n\nexport class ReactBoxId implements BoxId {\n    readonly id: number;\n    protected tuid: Tuid;\n    protected ui: (values:any) => JSX.Element;\n    readonly isUndefined:boolean;\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\n        this.id = Number(id);\n        this.tuid = tuid;\n        this.ui = ui;\n        this.isUndefined = (this.tuid === undefined);\n    }\n\n    get obj():any {\n        return this.tuid.valueFromId(this.id);\n    }\n\n    equ(id:BoxId|number): boolean {\n        if (id === undefined || id === null) return false;\n        if (typeof id === 'object') return this.id === id.id;\n        return this.id === id;\n    }\n\n    render(ui:TvTemplet, x:any):JSX.Element {\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\n        let boxName = this.boxName; // this.tuid.name;\n        let val = this.obj; // this.tuid.valueFromId(this.id);\n        if (this.isUndefined === true) {\n            if (ui !== undefined) return ui(val, x);\n            return TuidContent(boxName, val, x);\n        }\n        switch (typeof val) {\n            case 'undefined':\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\n            case 'number':\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\n        }\n        if (ui === undefined) {\n            ui = this.ui;\n        }\n        if (ui !== undefined) {\n            if (typeof ui !== 'function') {\n                ui = (ui as any).content;\n            }\n            if (ui !== undefined) {\n                let ret = ui(val/*, this.tuidUR.res*/);\n                if (ret !== undefined) return ret;\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\n            }\n        }\n\n        return TuidContent(boxName, val);\n    }\n\n    get boxName():string {return this.tuid.name}\n    // ui(): TvTemplet {return this.tuid.ui}\n    // res(): any {return this.tuid.res}\n\n    async assure(): Promise<BoxId> {\n        await this.tuid.assureBox(this.id);\n        return this;\n    }\n}\n\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\n    let logContent:any;\n    let boxId:ReactBoxId = bi as ReactBoxId;\n    switch(typeof bi) {\n        case 'undefined': logContent = <>boxId undefined</>; break;\n        case 'number': logContent = <>id:{bi}</>; break;\n        default:\n            if (typeof boxId.render !== 'function') {\n                if (ui === undefined) {\n                    logContent = TuidContent(boxId.boxName, bi, x);\n                }\n                else {\n                    return ui(bi, x);\n                }\n            }\n            break;\n    }\n    if (logContent !== undefined) {\n        return <del className=\"text-danger\">{logContent}</del>;\n    }\n    return boxId.render(ui, x);\n}\n\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\n\ninterface Props {\n    tuidValue: number|BoxId, \n    ui?: TvTemplet,\n    x?: any,\n    nullUI?: ()=>JSX.Element\n}\n\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\n    if (tuidValue === undefined) {\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\n        return nullUI();\n    }\n    if (tuidValue === null) {\n        if (nullUI === undefined) return <>[null]</>;\n        return nullUI();\n    }\n    let ttv = typeof tuidValue;\n    switch (ttv) {\n        default:\n            if (ui === undefined)\n                return <>{ttv}-{tuidValue}</>;\n            else {\n                let ret = ui(tuidValue, x);\n                if (ret !== undefined) return ret;\n                return <>{tuidValue}</>;\n            }\n        case 'object':\n            let divObj = boxIdContent(tuidValue, ui, x);\n            if (divObj !== undefined) return divObj;\n            return nullUI === undefined? <>id null</>: nullUI();\n        case 'number':\n            return <>id...{tuidValue}</>;\n    }\n});\n\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\n};\n","import React from 'react';\nimport classNames from 'classnames';\n\nconst scrollAfter = 20; // 20ms之后，scroll执行\nexport class Scroller {\n    private el: HTMLBaseElement;\n    constructor(el: HTMLBaseElement) {\n        this.el = el;\n    }\n\n    scrollToTop():void {\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\n    }\n    scrollToBottom():void {\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\n    }\n}\n\nexport interface ScrollProps {\n    onScroll?: (e:any) => void;\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\n\tclassName?: string;\n}\ninterface ScrollViewProps extends ScrollProps {\n\tclassName?: string;\n\tstyle?: React.CSSProperties;\n}\nconst scrollTimeGap = 100;\nexport class ScrollView extends React.Component<ScrollViewProps, null> {\n    private bottomTime:number = 0;\n\tprivate topTime:number = 0;\n\tprivate div: HTMLDivElement;\n\n\tprivate refDiv = (div:HTMLDivElement) => {\n\t\tif (!div) {\n\t\t\tif (this.div) {\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tthis.div = div;\n\t\tthis.div.addEventListener('resize', this.onResize);\n\t}\n\n\tprivate onResize = (ev:UIEvent) => {\n\t\tconsole.error('div resize');\n\t};\n\n    private onScroll = async (e:any) => {\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\n        if (onScroll) this.props.onScroll(e);\n        let el = e.target as HTMLBaseElement;\n        let scroller = new Scroller(el);\n        if (el.scrollTop < 30) {\n            if (onScrollTop !== undefined) {\n                let topTime = new Date().getTime();\n                if (topTime-this.topTime > scrollTimeGap) {\n                    this.topTime = topTime;\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\n\t\t\t\t\t\t // has more\n\t\t\t\t\t\tif (ret === true) {\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\n\t\t\t\t\t\t\tlet top = 200;\n\t\t\t\t\t\t\tif (top > sh) top = sh;\n\t\t\t\t\t\t\tel.scrollTop = top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n                }\n            }\n        }\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\n            //this.eachChild(this, 'bottom');\n            if (onScrollBottom !== undefined) {\n                let bottomTime = new Date().getTime();\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\n                    this.bottomTime = bottomTime;\n                    onScrollBottom(scroller);\n                }\n            }\n        }\n    }\n    private eachChild(c:any, direct:'top'|'bottom') {\n        let { props } = c;\n        if (props === undefined)\n            return;\n        let { children } = props;\n        if (children === undefined)\n            return;\n        React.Children.forEach(children, (child, index) => {\n            let {_$scroll} = child as any;\n            if (_$scroll) _$scroll(direct);\n            console.log(child.toString());\n            this.eachChild(child, direct);\n        });\n\t}\n\t\n    render() {\n\t\tlet {className, style} = this.props;\n\t\treturn <div ref={this.refDiv} className={classNames('tv-page')}\n\t\t\tonScroll={this.onScroll} style={style}>\n\t\t\t<article className={className}>\n\t\t\t\t{this.props.children}\n\t\t\t</article>\n\t\t</div>;\n    }\n}\n\n","import * as React from 'react';\n\nexport function Loading() {\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\n    </div>;\n}\n","import { LocalMap } from './localDb';\n\nconst testingTags:string[] = ['/test', '/test/', '-test', '-test/'];\nfunction isTesting():boolean {\n    let {pathname} = document.location;\n    let pn = pathname.toLowerCase();\n    for (let item of testingTags) {\n        if (pn.endsWith(item) === true) return true;\n    }\n    return false;\n}\n\nexport const env = (function () {\n    let testing = isTesting();\n    let localDb = new LocalMap(testing===true? '$$':'$');\n    return {\n        testing: testing,\n        isDevelopment: process.env.NODE_ENV === 'development',\n        localDb: localDb,\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\n            //if (tag !== undefined) console.log('setTimeout ' + tag);\n            return global.setTimeout(callback, ms, ...args);\n        },\n        clearTimeout: (handle:NodeJS.Timer):void => {\n            global.clearTimeout(handle);\n        },\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\n            return global.setInterval(callback, ms, ...args);\n        },\n        clearInterval: (handle:NodeJS.Timer):void => {\n            global.clearInterval(handle);\n        }\n    }\n}());\n","\nexport * from './boxId';\nexport { Tuid, TuidImport, TuidInner, TuidDiv, TuidBox } from './tuid';\nexport { TuidsCache } from './tuidsCache';\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import {HttpChannel} from './httpChannel';\nimport { Caller } from './caller';\n\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \n    resolve:(values:any)=>any, reject:(reason:any)=>void)\n{\n    await channel.fetch(url, options, false, resolve, reject);\n}\n\nexport abstract class ApiBase {\n    protected token: string;\n    protected path: string;\n    protected showWaiting: boolean;\n\n    constructor(path: string, showWaiting: boolean) {\n        this.path = path || '';\n        this.showWaiting = showWaiting;\n    }\n\n    protected abstract async getHttpChannel(): Promise<HttpChannel>;\n\n    async xcall(caller:Caller<any>):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.xcall(this.path, caller);\n    }\n\n    public async call(url:string, method:string, body:any):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.callFetch(url, method, body);\n    }\n\n    public async get(path:string, params:any=undefined): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.get(this.path + path, params);\n    }\n\n    public async post(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.post(this.path + path, params);\n    }\n\n    public async put(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.put(this.path + path, params);\n    }\n\n    public async delete(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.delete(this.path + path, params);\n    }\n}\n","import * as React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { UiImageItem } from '../schema';\nimport { ImageUploader } from '../resUploader';\nimport { nav } from '../nav';\nimport { ItemEdit } from './itemEdit';\n\nexport class ImageItemEdit extends ItemEdit {\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\n    @observable private resId: string;\n\n    protected async internalStart():Promise<any> {\n        this.resId = this.value;\n        return new Promise<any>((resolve, reject) => {\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\n        });\n    }\n\n    /*\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let ret = await this.resUploader.upload();\n        if (ret === null) {\n            this.overSize = true;\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.value);\n    }\n    */\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let size:any = this.uiItem && this.uiItem.size;\n\n        /*\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>resolve(this.resId)}>保存</button>;\n        let overSize:any;\n        if (this.overSize === true) {\n            overSize = <div className=\"text-danger\">\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\n            </div>;\n        }\n        */\n        return <ImageUploader \n            label={'更改' + this.label}\n            id={this.resId}\n            size={size}\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\n        /*\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div>上传图片：</div>\n                    <div className=\"my-3\">\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\n                    </div>\n                    <div>\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\n                    </div>\n                </div>\n                {overSize}\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\n                <div className=\"d-flex\">\n                    <div className=\"w-12c h-12c mr-4\"\n                        style={{border: '1px dotted gray', padding: '8px'}}>\n                        <Image className=\"w-100 h-100\" src={this.resId} />\n                    </div>\n                    <div>\n                        <div className=\"small\">图片预览</div>\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\n                    </div>\n                </div>\n            </div>\n        </Page>;\n        */\n    })\n}\n","//import _ from 'lodash';\nimport { KeyValueRes, Res } from './res';\n\nexport interface FormRes extends KeyValueRes {\n    required: string;\n    number: string;\n    integer: string;\n    min: string;\n    max: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const formRes:Res<FormRes> = {\n    _: {\n        required: 'required',\n        number: 'not valid number',\n        integer: 'not valid integer',\n        min: 'min value is ${min}',\n        max: 'max value is ${max}',\n    },\n    zh: {\n        _: {\n            required: '必须填',\n            number: '需要数字',\n            integer: '需要整数',\n            min: '不能小于${min}',\n            max: '不能大于${max}',\n        }\n    },\n}\n","import { KeyValueRes, Res } from './res';\n\nexport interface ListRes extends KeyValueRes {\n    none: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const listRes:Res<ListRes> = {\n    _: {\n        none: '[none]',\n    },\n    zh: {\n        _: {\n            none: '[无]',\n        }\n    },\n}\n","import { Res } from '../res';\n\nexport interface LoginRes {\n    a: string;\n}\n\nexport const loginRes: Res<LoginRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import { Res } from '../res';\n\nexport interface RegisterRes {\n    a: string;\n}\n\nexport const registerRes: Res<RegisterRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","export * from './res';\nexport * from './formRes';\nexport * from './listRes';\nexport * from './entry';\n\n/*\nexport const res = {\n    _: {\n        form: {\n            required: 'required',\n            number: 'not valid number',\n            integer: 'not valid integer',\n            min: 'min value is ',\n            max: 'max value is ',\n        },\n        entry: {\n            \n        }\n    },\n    zh: {\n        _: {\n            form: {\n                required: '必须填',\n                number: '需要数字',\n                integer: '需要整数',\n                min: '不能小于',\n                max: '不能大于',\n            },\n            entry: {\n\n            }\n        }\n    }\n}\n*/","import _ from 'lodash';\nimport {observable, IObservableArray, computed} from 'mobx';\n\nexport abstract class PageItems<T> {\n    constructor(itemObservable:boolean = false) {\n        this._items = observable.array<T>([], {deep:itemObservable});\n    }\n\tprivate isFirst: boolean = true;\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\n    @observable loading: boolean = false;\n    @observable private beforeLoad: boolean = true;\n    @observable protected loaded: boolean = false;\n    protected _items:IObservableArray<T>;\n    @observable allLoaded: boolean = false;\n    @computed get items():IObservableArray<T> {\n        if (this.beforeLoad === true) return null;\n        if (this.loaded === false) return undefined;\n        return this._items;\n\t}\n\t\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\n\t\tthis.pageItemAction = pageItemAction;\n\t}\n\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\n\t\tthis.itemConverter = itemConverter;\n\t}\n\n    @observable topDiv:string = '$$top';\n    @observable bottomDiv:string = '$$bottom';\n    scrollToTop = () => {\n\t\tthis.scrollIntoView(this.topDiv);\n\t\t//let id = '$$top'+uid();\n\t\t//this.topDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.topDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n    }\n    scrollToBottom = () => {\n\t\tthis.scrollIntoView(this.bottomDiv);\n\t\t//let id = '$$bottom'+uid();\n\t\t//this.bottomDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.bottomDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n\t}\n\tprivate scrollIntoView(divId:string) {\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(divId);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t}\n\n    protected param: any;\n    protected firstSize = 100;\n    protected pageStart:any = undefined;\n    protected pageSize = 30;\n    protected appendPosition:'head'|'tail' = 'tail';\n\n\tprotected sortOrder:'asc'|'desc';\n\tprotected abstract async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\n\tprotected getPageId(item:T):any {return;}\n\tprotected setPageStart(item:T) {\n\t\tthis.pageStart = this.getPageId(item);\n\t}\n\t\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\n\t\tlet pageList = results.$page;\n\t\tif (this.itemConverter) {\n\t\t\tlet ret:T[] = [];\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\n\t\t\t\tret.push(item);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\tif (this.pageItemAction !== undefined) {\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tthis.pageItemAction(pageList[i], results);\n\t\t\t}\n\t\t}\n\t\treturn pageList;\n\t}\n\n    reset() {\n        this.isFirst = true;\n        this.beforeLoad = true;\n        this.loaded = false;\n        this.param = undefined;\n\t\tthis.allLoaded = false;\n\t\tthis.pageStart = undefined;\n        this._items.clear();\n        //this.setPageStart(undefined);\n    }\n\n    append(item:T) {\n        if (this.appendPosition === 'tail')\n            this._items.unshift(item);\n        else\n            this._items.push(item);\n    }\n\n    async first(param:any):Promise<void> {\n        this.reset();\n        this.beforeLoad = false;\n        this.param = param;\n        await this.more();\n\t}\n\n\tprivate changing = false;\n\tasync attach(): Promise<void> {\n\t\tif (this.sortOrder === undefined) {\n\t\t\tconsole.error('没有定义增减序，无法attach');\n\t\t\treturn;\n\t\t}\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet items = this._items;\n\t\tlet isAsc = this.sortOrder === 'asc';\n\t\t//let isTail:boolean, \n\t\tlet endItem:T;\n\t\tlet scrollToEnd:() => void;\n\t\tlet pushItem:(item:T) => void;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\t//isTail = true;\n\t\t\tendItem = items[0];\n\t\t\tscrollToEnd = this.scrollToTop;\n\t\t\tpushItem = (item:T) => items.unshift(item);\n\n\t\t}\n\t\telse {\n\t\t\t//isTail = false;\n\t\t\tlet endIndex = items.length;\n\t\t\tendItem = items[endIndex-1];\n\t\t\tscrollToEnd = this.scrollToBottom;\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\n\t\t}\n\t\tlet startId = this.getPageId(endItem);\n\t\tlet pid = undefined;\n\t\tlet sum = 0, max = 50;\n\t\tfor (;sum < max;) {\n\t\t\tlet ret = await this.load(this.param, pid, 3);\n\t\t\tlet len = ret.length;\n\t\t\tif (len === 0) break;\n\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = ret[i];\n\t\t\t\tpid = this.getPageId(item);\n\t\t\t\tif (isAsc === true) {\n\t\t\t\t\tif (pid >= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pid <= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpushItem(item);\n\t\t\t\t/*\n\t\t\t\tif (isTail === true) {\n\t\t\t\t\tthis._items.unshift(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t\tthis.changing = false;\n\t\tif (sum > 0) {\n\t\t\tscrollToEnd();\n\t\t\t/*\n\t\t\tif (isTail === true) this.scrollToTop();\n\t\t\telse this.scrollToBottom();\n\t\t\t*/\n\t\t}\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\n\t\tthis._items.clear();\n\t\tthis.setLoaded(ret);\n\t\t/*\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet item = ret[i];\n\t\t\tlet pid = this.getRefreshPageId(item);\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\n\t\t\t//let oldItem = this._items[index];\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\n\t\t\tif (index >= 0) {\n\t\t\t\t_.merge(this._items[index], item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.splice(0, 0, item);\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.changing = false;\n\t}\n\n\tprotected getRefreshPageId(item:T) {\n\t\treturn this.getPageId(item);\n\t}\n\n    protected async onLoad(): Promise<void> {}\n    protected async onLoaded(): Promise<void> {}\n\n    async more():Promise<boolean> {\n        if (this.allLoaded === true) return false;\n\t\tif (this.loading === true) return true;\n\t\tif (this.changing === true) return true;\n\t\tthis.loading = true;\n\t\tthis.changing = true;\n        await this.onLoad();\n        if (this.pageStart === undefined) this.setPageStart(undefined);\n        let pageSize = this.pageSize + 1;\n        if (this.isFirst === true) {\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\n        }\n        let ret = await this.load(\n                this.param, \n                this.pageStart,\n\t\t\t\tpageSize);\n        this.loaded = true;\n\t\tlet len = ret.length;\n        if ((this.isFirst===true && len>this.firstSize) ||\n            (this.isFirst===false && len>this.pageSize))\n        {\n            this.allLoaded = false;\n            --len;\n            ret.splice(len, 1);\n        }\n        else {\n            this.allLoaded = true;\n\t\t}\n\t\t/*\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(ret[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...ret);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...ret.reverse());\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.setLoaded(ret);\n\t\tthis.isFirst = false;\n\t\tthis.onLoaded();\n\t\tthis.changing = false;\n\t\tthis.loading = false;\n\t\treturn !this.allLoaded;\n\t}\n\t\n\tprivate setLoaded(data:any[]) {\n\t\tlet len = data.length;\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(data[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...data.reverse());\n\t\t\t}\n\t\t}\n\t}\n\n\tfindItem(item:any):T {\n\t\tlet pid = this.getPageId(item);\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\n\t\tif (index < 0) return;\n\t\treturn this._items[index];\n\t\t//let oldItem = this._items[index];\n\t\t//let oid = this.getPageId(oldItem);\n\t\t//if (pid === oid) return oldItem;\n\t}\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport classNames from 'classnames';\nimport { IVPage } from './page';\nimport { IObservableValue } from 'mobx/lib/internal';\nimport '../../css/va-tab.css';\nimport { ScrollView } from './scrollView';\n\nexport type TabCaption = (selected:boolean) => JSX.Element;\n\nexport interface TabProp {\n    name: string;\n    caption: TabCaption;\n\tcontent?: () => JSX.Element;\n\tpage?: IVPage;\n    notify?: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tisSelected?: boolean;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n}\n\nexport interface TabsProps {\n    tabs: TabProp[];\n    tabPosition?: 'top' | 'bottom';\n    size?: 'sm' | 'lg' | 'md';\n    tabBg?: string;\n    contentBg?: string;\n    sep?: string;\n    selected?: string;\n    borderColor?: string;\n    borderWidth?: string;\n}\n\nclass Tab {\n\t@observable private loaded: boolean = false;\n    name: string;\n    @observable selected: boolean;\n    caption: TabCaption;\n\tcontentBuilder: ()=>JSX.Element;\n\tpage: IVPage;\n    notify: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n\n    private _content: JSX.Element;\n    \n    get content(): JSX.Element {\n\t\tif (this.load && this.loaded === false) return null;\n\t\tif (this.selected === false) return this._content;\n\t\tif (!this._content) {\n\t\t\tif (this.contentBuilder !== undefined) {\n\t\t\t\tthis._content = this.contentBuilder();\n\t\t\t}\n\t\t\telse if (this.page !== undefined) {\n\t\t\t\tthis._content = this.page.content();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\n\t\t\t}\n\t\t}\n\t\treturn this._content;\n    }\n\n    async shown() {\n        if (this.onShown !== undefined) {\n            await this.onShown();\n        }\n        if (this.load !== undefined) {\n\t\t\tif (this.loaded === false) {\n\t\t\t\tawait this.load();\n\t\t\t\tthis.loaded = true;\n\t\t\t}\n        }\n    }\n}\n\nexport const TabCaptionComponent = (label:string, icon:string, color:string) => <div \n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\n    <small>{label}</small>\n</div>;\n\nexport const TabCaption = TabCaptionComponent;\n\nexport class TabsView {\n\tprivate props: TabsProps;\n    private size: string;\n    private tabBg: string;\n    //private contentBg: string;\n    private sep: string;\n    @observable private selectedTab: Tab;\n    @observable private tabArr: Tab[];\n\n    constructor(props: TabsProps) {\n\t\tthis.props = props;\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\n\t\tthis.size = size || 'md';\n        this.tabArr = tabs.map(v => {\n            let tab = new Tab();\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\ttab.name = name;\n\t\t\tif (isSelected === true || name === selected) {\n\t\t\t\tthis.selectedTab = tab;\n\t\t\t}\n\t\t\ttab.selected = false;\n\t\t\ttab.caption = caption;\n\t\t\tif (content !== undefined) {\n\t\t\t\ttab.contentBuilder = content;\n\t\t\t}\n\t\t\telse if (page !== undefined) {\n\t\t\t\ttab.page = page;\n\t\t\t\t//contentBuilder = () => {return page.content()};\n\t\t\t}\n            tab.notify = notify;\n            tab.load = load;\n\t\t\ttab.onShown = onShown;\n\t\t\ttab.onScroll = onScroll;\n\t\t\ttab.onScrollTop = onScrollTop;\n\t\t\ttab.onScrollBottom = onScrollBottom;\n\t\t\ttab.className = className;\n            return tab;\n        });\n        this.tabBg = tabBack;\n        //this.contentBg = contentBack;\n        this.sep = sep;\n        if (this.selectedTab === undefined) {\n\t\t\tthis.selectedTab = this.tabArr[0];\n\t\t}\n        this.selectedTab.selected = true;\n    }\n\n    tabClick = async (tab:Tab) => {\n\t\tif (!tab) {\n\t\t\ttab = this.selectedTab;\n\t\t\tif (tab === undefined) {\n\t\t\t\tif (this.tabArr === undefined) return;\n\t\t\t\tif (this.tabArr.length === 0) return;\n\t\t\t\ttab = this.tabArr[0];\n\t\t\t}\n\t\t}\n\n        this.selectedTab.selected = false;\n        tab.selected = true;\n\t\tthis.selectedTab = tab;\n\t\t\n\t\tawait tab.shown();\n    }\n\n\t/*\n    showTab(tabName: string) {\n        let tab = this.tabs.find(v => v.name === tabName);\n        if (tab === undefined) return;\n        if (this.selectedTab !== undefined) this.selectedTab.selected = false;\n        tab.selected = true;\n        this.selectedTab = tab;\n\t}\n\t*/\n\n\tprivate tabs = observer(() => {\n        let {tabPosition, borderColor} = this.props;\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\n        if (borderColor) {\n            bsCur = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderLeftWidth: 1,\n                borderRightWidth: 1,\n                borderBottomWidth: 1,\n            }\n            bsTab = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderBottomWidth: 1,\n                borderLeftWidth: 0,\n                borderRightWidth: 0,\n            }\n            if (tabPosition === 'top') {\n                bsCur.borderBottomWidth = 0;\n                bsCur.borderTopLeftRadius = 10;\n                bsCur.borderTopRightRadius = 10;\n                bsTab.borderTopWidth = 0;\n            }\n            else {\n                bsCur.borderTopWidth = 0;\n                bsCur.borderBottomLeftRadius = 10;\n                bsCur.borderBottomRightRadius = 10;\n                bsTab.borderBottomWidth = 0;\n            }\n        }\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\n\t\tlet tabs = <div className={cn}>\n            {this.tabArr.map((v,index) => {\n                let {selected, caption, notify} = v;\n                let notifyCircle:any;\n                if (notify !== undefined) {\n                    let num = notify.get();\n                    if (num !== undefined) {\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\n                    }\n                }\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\n\t\t\t\t\t<div>\n\t\t\t\t\t{notifyCircle}\n\t\t\t\t\t{caption(selected)}\n\t\t\t\t\t</div>\n                </div>\n            })}\n\t\t</div>;\n\t\treturn tabs;\n\t});\n\n\tcontent = observer(() => {\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\n\t\treturn <>\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet {tabPosition} = this.props;\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\t\tlet tabs = React.createElement(this.tabs);\n\t\t\t\tlet pageHeader:any, pageFooter:any;\n\t\t\t\tif (page !== undefined) {\n\t\t\t\t\tpageHeader = page.header();\n\t\t\t\t\tpageFooter = page.footer();\n\t\t\t\t}\n\t\t\t\tlet header:any, footer:any;\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\n\t\t\t\tif (tabPosition === 'top') {\n\t\t\t\t\theader = <>\n\t\t\t\t\t\t<section className=\"tv-page-header\">\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\n\t\t\t\t\t</>;\n\t\t\t\t\tif (pageFooter !== undefined) {\n\t\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pageHeader !== undefined) {\n\t\t\t\t\t\theader = <>\n\t\t\t\t\t\t\t<section className='tv-page-header'>\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t<section className='tv-page-footer'>\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</>;\n\t\t\t\t}\n\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = displayNone;\n\t\t\t\treturn <ScrollView key={index} className={className}\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\n\t\t\t\t\t{header}\n\t\t\t\t\t{content}\n\t\t\t\t\t{footer}\n\t\t\t\t</ScrollView>;\n\t\t\t})}\n\t\t</>;\n\t});\n\n    render() {\n\t\tlet {tabPosition} = this.props;\n\t\tlet tabs = <this.tabs />;\n\t\tlet header:any, footer:any;\n\t\tlet visibility:React.CSSProperties = {display:'none'};\n\t\tif (tabPosition === 'top') {\n\t\t\theader = <header>{tabs}</header>;\n\t\t}\n\t\telse {\n\t\t\tfooter = <footer>{tabs}</footer>;\n\t\t}\n\t\treturn <>\n\t\t\t{header}\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = visibility;\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\n\t\t\t\t\t{v.content}\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t\t{footer}\n\t\t</>;\n    }\n};\n\n@observer export class Tabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn this.tabsView.render();\n    }\n};\n\n@observer export class RootTabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn React.createElement(this.tabsView.content);\n    }\n};\n","import * as React from 'react';\nimport { nav } from './nav';\nimport { Loading } from './loading';\nimport { Image as ImageControl } from './image';\nimport { Page } from './page/page';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { LMR } from './simple';\n\nexport interface ResUploaderProps {\n    className?: string;\n    label?: string;\n    multiple?: boolean;\n    maxSize?: number;\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\n@observer\nexport class ResUploader extends React.Component<ResUploaderProps> {\n    private fileInput: HTMLInputElement;\n    @observable private fileName: string;\n\n    buildFormData():FormData {\n        let {maxSize} = this.props;\n        if (maxSize === undefined || maxSize <= 0) \n            maxSize = 100000000000;\n        else\n            maxSize = maxSize * 1024;\n        var files:FileList = this.fileInput.files;\n        var data = new FormData();\n        let len = files.length;\n        for (let i=0; i<len; i++) {\n            let file = files[i];\n            if (file.size > maxSize) return null;\n            data.append('files[]', file, file.name);\n        }\n    }\n\n    getFile0(): File {\n        return this.fileInput.files[0];\n    }\n\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\n        let resUrl = nav.resUrl + 'upload';\n        if (!formData) formData = this.buildFormData();\n        try {\n            nav.startWait();\n            let headers = new Headers();\n            headers.append('Access-Control-Allow-Origin', '*');\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \n            //let abortController = new AbortController();\n            let res = await fetch(resUrl, {\n                method: \"POST\",\n                body: formData,\n                headers: headers,\n                //signal: abortController.signal,\n            });\n            let json = await res.json();\n            return ':' + json.res.id;\n        }\n        catch (err) {\n            console.error('%s %s', resUrl, err);\n            return {error:err};\n        }\n        finally {\n            nav.endWait();\n        }\n    }\n\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let {onFilesChange} = this.props;\n        if (onFilesChange) onFilesChange(evt);\n        let files = evt.target.files;\n        let len = files.length;\n        let names:string[] = [];\n        for (let i=0; i<len; i++) {\n            names.push(files.item(i).name);\n        }\n        this.fileName = names.join(', ');\n    }\n\n    render() {\n        let {className, multiple, label} = this.props;\n        return <div>\n                <label className=\"btn btn-outline-success\">\n                    {label || '选择文件'} \n                    <input \n                        className={className}\n                        ref={t=>this.fileInput=t} \n                        onChange={this.onFilesChange}\n                        type='file' name='file' \n                        multiple={multiple} style={{display:'none'}} />\n                </label>\n                &nbsp;\n                {this.fileName}\n            </div>\n    }\n}\n\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\n    var unit;\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    while ( (unit = units.shift()) && size > 1024 ) {\n        size = size / 1024;\n    }\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\n}\n\ninterface ImageUploaderProps {\n    id?: string;\n    label?: string;\n    size?: 'sm' | 'md' | 'lg';\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\nconst largeSize = 800;\nconst mediumSize = 400;\nconst smallSize = 180;\n\n@observer\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\n    private imgBaseSize: number;\n    private suffix: string;\n    private resUploader: ResUploader;\n    @observable private file: File;    \n    @observable private desImgWidth: number;\n    @observable private desImgHeight: number;\n    @observable private desImgSize: number;\n    @observable private srcImgWidth: number;\n    @observable private srcImgHeight: number;\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private srcImage: string;\n    @observable private desImage: string;\n    @observable private fileError: string;\n    @observable private uploaded: boolean = false;\n\n    constructor(props: ImageUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(ImageUploader.imageTypes.indexOf(this.suffix) < 0){\n                this.fileError = `图片类型必须是 ${ImageUploader.imageTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.srcImage = reader.result as string;\n\t\t\t\tswitch (this.suffix ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tawait this.setSize(this.props.size);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'svg':\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\n\t\t\t\t\t\tthis.desImage = this.srcImage;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n            };\n        }\n    }\n\n    private async setSize(size?: 'sm' | 'md' | 'lg') {\n        switch (size) {\n            default:\n            case 'sm':\n                this.imgBaseSize = smallSize; break;\n            case 'md':\n                this.imgBaseSize = mediumSize; break;\n            case 'lg':\n                this.imgBaseSize = largeSize; break;\n\t\t}\n\t\tthis.desImage = await this.compress();\n    }\n\n    private compress = ():Promise<string> => {\n        return new Promise<string>((resolve, reject) => {\n            var img = new Image();\n            img.src = this.srcImage;\n            img.onload = () => {\n                //var that = this;\n                // 默认按比例压缩\n                let {width, height} = img;\n                this.srcImgWidth = width;\n                this.srcImgHeight = height;\n                let scale = width / height;\n                let w:number, h:number;\n                if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\n                    w = width;\n                    h = height;\n                }\n                else if (scale < 0) {\n                    w = this.imgBaseSize;\n                    h = w / scale;\n                }\n                else {\n                    h = this.imgBaseSize;\n                    w = h * scale;\n                }\n                this.desImgWidth = Math.round(w);\n                this.desImgHeight = Math.round(h);\n                var quality = 0.7;  // 默认图片质量为0.7\n                //生成canvas\n                var canvas = document.createElement('canvas');\n                var ctx = canvas.getContext('2d');\n                // 创建属性节点\n                var anw = document.createAttribute(\"width\");\n                anw.nodeValue = String(w);\n                var anh = document.createAttribute(\"height\");\n                anh.nodeValue = String(h);\n                canvas.setAttributeNode(anw);\n                canvas.setAttributeNode(anh);\n                ctx.drawImage(img, 0, 0, w, h);\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\n                let blob = this.convertBase64UrlToBlob(base64);\n                this.desImgSize = blob.size;\n                if (this.desImgSize > 5000000) {\n                    this.fileError = \"图片大于4M，无法上传\";\n                    this.enableUploadButton = false;\n                }\n                resolve(base64);\n            }\n        });\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.desImage);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    private showOrgImage = () => {\n        nav.push(<Page header=\"原图\">\n            <div className=\"p-3 text-center\">\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\n            </div>\n        </Page>);\n    }\n\n    private levelDiv() {\n        if (this.props.size) return;\n        let arr = [{caption:'小图', size:'sm'}];\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\n            arr.push({caption:'中图', size:'md'});\n        }\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\n            arr.push({caption:'大图', size:'lg'});\n        }\n        if (arr.length < 2) return;\n        return <div>{arr.map((v, index) => {\n            let {caption, size} = v;\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \n                onChange={()=>this.setSize(size as any)}\n                defaultChecked={index===0} /> {caption}</label>;\n        })}</div>\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改图片'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择图片文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {ImageUploader.imageTypes.join(', ')} 格式图片。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                    <LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n                            :\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\n                                <div className=\"mr-5\">\n                                    {this.levelDiv()}\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\n                                    &nbsp; &nbsp;\n                                    文件大小：{formatSize(this.desImgSize)}\n                                    </div>\n                                </div>\n                                <button className=\"btn btn-primary\" \n                                    disabled={!this.enableUploadButton}\n                                    onClick={this.upload}>上传</button>\n                            </div>\n                    }\n                    right={this.desImage && \n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\n                            原图大小: {formatSize(this.file.size)}<br/>\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\n                        </button>\n                    }\n                    ></LMR>\n                </div>\n                <div className=\"text-center\" \n                    style={{\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\n                        padding: '8px'\n                    }}>\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\ninterface AudioUploaderProps {\n    id?: string;\n    label?: string;\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\n@observer\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\n\tprivate static audioTypes = ['mp3', 'wav'];\n\n    private suffix: string;\n\tprivate resUploader: ResUploader;\n\t@observable private content: string;\n\t@observable private file: File;    \n\t@observable private fileSize: number;\n\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private fileError: string;\n\t@observable private uploaded: boolean = false;\n\t@observable private uploading: boolean = false;\n\n    constructor(props: AudioUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.content = reader.result as string;\n\t\t\t\tthis.fileSize = this.content.length;\n            };\n        }\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n\t\tif (!this.resUploader) return;\n\t\tthis.uploading = true;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.content);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改文件'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择音频文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                </div>\n            </div>\n\t\t\t<LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\tthis.uploading === true?\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t/>\n        </Page>;\n    }\n}\n","export * from './uqMan';\nexport * from './entity';\nexport * from './action';\nexport * from './query';\nexport * from './sheet';\nexport * from './tuid';\nexport * from './book';\nexport * from './map';\nexport * from './history';\nexport * from './pending';\nexport * from './uqsMan';\nexport * from './tag/tag';\n","import _ from 'lodash';\nimport { UqApi, UqData, UnitxApi, appInFrame } from '../net';\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\nimport { Action } from './action';\nimport { Sheet } from './sheet';\nimport { Query } from './query';\nimport { Book } from './book';\nimport { History } from './history';\nimport { Map } from './map';\nimport { Pending } from './pending';\nimport { CreateBoxId, BoxId } from './tuid';\nimport { LocalMap, LocalCache } from '../tool';\nimport { UQsMan } from './uqsMan';\nimport { ReactBoxId } from './tuid/reactBoxId';\nimport { Tag } from './tag/tag';\n\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\n    | 'datetime' | 'date' | 'time' | 'timestamp';\n\nexport function fieldDefaultValue(type:FieldType) {\n    switch (type) {\n        case 'tinyint':\n        case 'smallint':\n        case 'int':\n        case 'bigint':\n        case 'dec':\n            return 0;\n        case 'char':\n        case 'text':\n            return '';\n        case 'datetime':\n        case 'date':\n            return '2000-1-1';\n        case 'time':\n            return '0:00';\n    }\n}\n\nexport interface Field {\n    name: string;\n    type: FieldType;\n    tuid?: string;\n    arr?: string;\n    null?: boolean;\n    size?: number;\n    owner?: string;\n    _tuid: TuidBox;\n}\nexport interface ArrFields {\n    name: string;\n    fields: Field[];\n    id?: string;\n    order?: string;\n}\nexport interface FieldMap {\n    [name:string]: Field;\n}\nexport interface SchemaFrom {\n    owner:string;\n    uq:string;\n}\nexport interface TuidModify {\n    max: number;\n    seconds: number;\n}\n\nexport class UqMan {\n    private readonly actions: {[name:string]: Action} = {};\n    private readonly sheets: {[name:string]: Sheet} = {};\n    private readonly queries: {[name:string]: Query} = {};\n    private readonly books: {[name:string]: Book} = {};\n    private readonly maps: {[name:string]: Map} = {};\n    private readonly histories: {[name:string]: History} = {};\n\tprivate readonly pendings: {[name:string]: Pending} = {};\n\tprivate readonly tags: {[name:string]: Tag} = {};\n    private readonly tuidsCache: TuidsCache;\n    private readonly localAccess: LocalCache;\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\n    readonly localMap: LocalMap;\n    readonly localModifyMax: LocalCache;\n    readonly tuids: {[name:string]: Tuid} = {};\n    readonly createBoxId: CreateBoxId;\n    readonly newVersion: boolean;\n    readonly uqOwner: string;\n    readonly uqName: string;\n    readonly name: string;\n    readonly uqApi: UqApi;\n    readonly id: number;\n\n    uqVersion: number;\n\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\n        this.createBoxId = createBoxId;\n        if (createBoxId === undefined) {\n            this.createBoxId = this.createBoxIdFromTVs;\n            this.tvs = tvs || {};\n        }\n        let {id, uqOwner, uqName, access, newVersion: clearTuids} = uqData;\n        this.newVersion = clearTuids;\n        this.uqOwner = uqOwner;\n        this.uqName = uqName;\n        this.id = id;\n        this.name = uqOwner + '/' + uqName;\n        this.uqVersion = 0;\n        this.localMap = uqs.localMap.map(this.name);\n        this.localModifyMax = this.localMap.child('$modifyMax');\n        this.localAccess = this.localMap.child('$access');\n        //let hash = document.location.hash;\n        let baseUrl = 'tv/';\n\n        let acc: string[];\n        if (access === null || access === undefined || access === '*') {\n            acc = [];\n        }\n        else {\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\n        }\n        if (this.name === '$$$/$unitx') {\n            // 这里假定，点击home link之后，已经设置unit了\n            // 调用 UnitxApi会自动搜索绑定 unitx service\n            this.uqApi = new UnitxApi(appInFrame.unit);\n        }\n        else {\n            let {appOwner, appName} = uqs;\n            this.uqApi = new UqApi(baseUrl, appOwner, appName, uqOwner, uqName, acc, true);\n        }\n        this.tuidsCache = new TuidsCache(this);\n    }\n\n    get entities() {\n        return _.merge({}, \n            this.actions, this.sheets, this.queries, this.books,\n\t\t\tthis.maps, this.histories, this.pendings, this.tuids,\n\t\t\tthis.tags,\n        );\n    }\n\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\n        let {name} = tuid;\n        /*\n        let tuidUR = this.tuidURs[name];\n        if (tuidUR === undefined) {\n            let {ui, res} = this.getUI(tuid);\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\n        }\n        */\n        return new ReactBoxId(id, tuid, this.tvs[name]);\n    }\n\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\n    tuidDiv(name:string, div:string):TuidDiv {\n        let tuid = this.tuids[name.toLowerCase()]\n        return tuid && tuid.div(div.toLowerCase());\n    }\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\n    book(name:string):Book {return this.books[name.toLowerCase()]}\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\n    history(name:string):History {return this.histories[name.toLowerCase()]}\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\n\n    sheetFromTypeId(typeId:number):Sheet {\n        for (let i in this.sheets) {\n            let sheet = this.sheets[i];\n            if (sheet.typeId === typeId) return sheet;\n        }\n    }\n\n    readonly tuidArr: Tuid[] = [];\n    readonly actionArr: Action[] = [];\n    readonly sheetArr: Sheet[] = [];\n    readonly queryArr: Query[] = [];\n    readonly bookArr: Book[] = [];\n    readonly mapArr: Map[] = [];\n    readonly historyArr: History[] = [];\n    readonly pendingArr: Pending[] = [];\n    readonly tagArr: Tag[] = [];\n\n    async init() {\n        await this.uqApi.init();\n    }\n\n    async loadEntities(): Promise<string> {\n        try {\n            let accesses = this.localAccess.get();\n            if (!accesses) {\n                accesses = await this.uqApi.loadAccess();\n            }\n            if (!accesses) return;\n            this.buildEntities(accesses);\n        }\n        catch (err) {\n            return err;\n        }\n    }\n\n\tbuildEntities(entities:any) {\n        if (entities === undefined) {\n            debugger;\n        }\n        this.localAccess.set(entities);\n        let {access, tuids, version} = entities;\n        this.uqVersion = version;\n        this.buildTuids(tuids);\n        this.buildAccess(access);\n\t}\n\t\n    private buildTuids(tuids:any) {\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let {typeId, from} = schema;\n            let tuid = this.newTuid(i, typeId, from);\n            tuid.sys = true;\n        }\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let tuid = this.getTuid(i);\n            tuid.setSchema(schema);\n        }\n        for (let i in this.tuids) {\n            let tuid = this.tuids[i];\n            tuid.buildFieldsTuid();\n        }\n\t}\n\n    async loadEntitySchema(entityName: string): Promise<any> {\n        return await this.uqApi.schema(entityName);\n    }\n\n    getTuid(name:string): Tuid {\n        return this.tuids[name];\n    }\n\n    private buildAccess(access:any) {\n        for (let a in access) {\n            let v = access[a];\n            switch (typeof v) {\n                case 'string': this.fromType(a, v); break;\n                case 'object': this.fromObj(a, v); break;\n            }\n        }\n    }\n\n    cacheTuids(defer:number) {\n        this.tuidsCache.cacheTuids(defer);\n    }\n\n    newAction(name:string, id:number):Action {\n        let action = this.actions[name];\n        if (action !== undefined) return action;\n        action = this.actions[name] = new Action(this, name, id)\n        this.actionArr.push(action);\n        return action;\n    }\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\n        let tuid = this.tuids[name];\n        if (tuid !== undefined) return tuid;\n        if (from !== undefined)\n            tuid = new TuidImport(this, name, id, from);\n        else\n            tuid = new TuidInner(this, name, id);\n        this.tuids[name] = tuid;\n        this.tuidArr.push(tuid);\n        return tuid;\n    }\n    newQuery(name:string, id:number):Query {\n        let query = this.queries[name];\n        if (query !== undefined) return query;\n        query = this.queries[name] = new Query(this, name, id)\n        this.queryArr.push(query);\n        return query;\n    }\n    private newBook(name:string, id:number):Book {\n        let book = this.books[name];\n        if (book !== undefined) return book;\n        book = this.books[name] = new Book(this, name, id);\n        this.bookArr.push(book);\n        return book;\n    }\n    private newMap(name:string, id:number):Map {\n        let map = this.maps[name];\n        if (map !== undefined) return map;\n        map = this.maps[name] = new Map(this, name, id)\n        this.mapArr.push(map);\n        return map;\n    }\n    private newTag(name:string, id:number):Tag {\n        let tag = this.tags[name];\n        if (tag !== undefined) return tag;\n        tag = this.tags[name] = new Tag(this, name, id)\n        this.tagArr.push(tag);\n        return tag;\n    }\n    private newHistory(name:string, id:number):History {\n        let history = this.histories[name];\n        if (history !== undefined) return;\n        history = this.histories[name] = new History(this, name, id)\n        this.historyArr.push(history);\n        return history;\n    }\n    private newPending(name:string, id:number):Pending {\n        let pending = this.pendings[name];\n        if (pending !== undefined) return;\n        pending = this.pendings[name] = new Pending(this, name, id)\n        this.pendingArr.push(pending);\n        return pending;\n    }\n    newSheet(name:string, id:number):Sheet {\n        let sheet = this.sheets[name];\n        if (sheet !== undefined) return sheet;\n        sheet = this.sheets[name] = new Sheet(this, name, id);\n        this.sheetArr.push(sheet);\n        return sheet;\n    }\n    private fromType(name:string, type:string) {\n        let parts = type.split('|');\n        type = parts[0];\n        let id = Number(parts[1]);\n        switch (type) {\n            //case 'uq': this.id = id; break;\n            case 'tuid':\n                // Tuid should not be created here!;\n                //let tuid = this.newTuid(name, id);\n                //tuid.sys = false;\n                break;\n            case 'action': this.newAction(name, id); break;\n            case 'query': this.newQuery(name, id); break;\n            case 'book': this.newBook(name, id); break;\n            case 'map': this.newMap(name, id); break;\n            case 'history': this.newHistory(name, id); break;\n            case 'sheet':this.newSheet(name, id); break;\n\t\t\tcase 'pending': this.newPending(name, id); break;\n\t\t\tcase 'tag': this.newTag(name, id); break;\n        }\n    }\n    private fromObj(name:string, obj:any) {\n        switch (obj['$']) {\n            case 'sheet': this.buildSheet(name, obj); break;\n        }\n    }\n    private buildSheet(name:string, obj:any) {\n        let sheet = this.sheets[name];\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\n        sheet.build(obj);\n    }\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\n        if (fields === undefined) return;\n        for (let f of fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.getTuid(tuid);\n            if (t === undefined) continue;\n            f._tuid = t.buildTuidBox();\n        }\n        for (let f of fields) {\n            let {owner} = f;\n            if (owner === undefined) continue;\n            let ownerField = fields.find(v => v.name === owner);\n            if (ownerField === undefined) {\n                if (mainFields !== undefined) {\n                    ownerField = mainFields.find(v => v.name === owner);\n                }\n                if (ownerField === undefined) {\n                    debugger;\n                    throw new Error(`owner field ${owner} is undefined`);\n                }\n            }\n            let {arr, tuid} = f;\n            let t = this.getTuid(ownerField._tuid.tuid.name);\n            if (t === undefined) continue;\n            let div = t.div(arr || tuid);\n            f._tuid = div && div.buildTuidDivBox(ownerField);\n            if (f._tuid === undefined) {\n                debugger;\n                throw new Error(`owner field ${owner} is not tuid`);\n            }\n        }\n    }\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\n        if (arrFields === undefined) return;\n        for (let af of arrFields) {\n            let {fields} = af;\n            if (fields === undefined) continue;\n            this.buildFieldTuid(fields, mainFields);\n        }\n    }\n\n    pullModify(modifyMax:number) {\n        this.tuidsCache.pullModify(modifyMax);\n    }\n}\n","import { Entity } from './entity';\nimport { PageItems } from '../tool/pageItems';\nimport { EntityCaller } from './caller';\n\nexport interface SheetState {\n    name: string;\n    actions: SheetAction[];\n}\n\nexport interface SheetAction {\n    name: string;\n}\n\nexport interface StateCount {\n    state: string;\n    count: number;\n}\n\nexport class Sheet extends Entity {\n    get typeName(): string { return 'sheet';}\n    states: SheetState[];\n\n    /*\n    setStates(states: SheetState[]) {\n        for (let state of states) {\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\n        }\n    }*/\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.states = schema.states;\n    }\n    build(obj:any) {\n        this.states = [];\n        for (let op of obj.ops) {\n            this.states.push({name: op, actions:undefined});\n        }\n        /*\n        for (let p in obj) {\n            switch(p) {\n                case '#':\n                case '$': continue;\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\n            }\n        }*/\n    }\n    private createSheetState(name:string, obj:object):SheetState {\n        let ret:SheetState = {name:name, actions:[]};\n        let actions = ret.actions;\n        for (let p in obj) {\n            let action:SheetAction = {name: p};\n            actions.push(action);\n        }\n        return ret;\n    }\n    /*\n    private setStateAccess(s:SheetState, s1:SheetState) {\n        if (s === undefined) return;\n        for (let action of s1.actions) {\n            let acn = action.name;\n            let ac = s.actions.find(a=>a.name === acn);\n            if (ac === undefined) continue;\n            s.actions.push(action);\n        }\n    }*/\n    async save(discription:string, data:any):Promise<any> {\n        /*\n        await this.loadSchema();\n        let {id} = this.uq;\n        let text = this.pack(data);\n\n        let ret = await this.uqApi.sheetSave(this.name, );\n        return ret;\n        */\n        let {id} = this.uq;\n        //let text = this.pack(data);\n        let params = {app: id, discription: discription, data:data};\n        return await new SaveCaller(this, params).request();\n        /*\n        let {id, state} = ret;\n        if (id > 0) this.changeStateCount(state, 1);\n        return ret;\n        */\n    }\n    async action(id:number, flow:number, state:string, action:string) {\n        /*\n        await this.loadSchema();\n        return await this.uqApi.sheetAction(this.name, {id:id, flow:flow, state:state, action:action});\n        */\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\n    }\n    private unpack(data:any):any {\n        //if (this.schema === undefined) await this.loadSchema();\n        let ret = data[0];\n        let brief = ret[0];\n        let sheetData = this.unpackSheet(brief.data);\n        let flows = data[1];\n        return {\n            brief: brief,\n            data: sheetData,\n            flows: flows,\n        }\n    }\n    async getSheet(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.getSheet(this.name, id);\n        */\n        let ret = await new GetSheetCaller(this, id).request();\n        if (ret[0].length === 0) return await this.getArchive(id);\n        return this.unpack(ret);\n    }\n    async getArchive(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchive(this.name, id)\n        return this.unpack(ret);\n        */\n        let ret = await new SheetArchiveCaller(this, id).request();\n        return this.unpack(ret);\n    }\n\n    async getArchives(pageStart:number, pageSize:number) {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {pageStart:pageStart, pageSize:pageSize};\n        return await new SheetArchivesCaller(this, params).request();\n    }\n\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new StateSheetsCaller(this, params).request();\n    }\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\n\n    async stateSheetCount():Promise<StateCount[]> {\n        /*\n        await this.loadSchema();\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\n        return this.states.map(s => {\n            let n = s.name, count = 0;\n            let r = ret.find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n        */\n        return await new StateSheetCountCaller(this, undefined).request();\n    }\n\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\n        return await new UserSheetsCaller(this, params).request();\n    }\n\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new MySheetsCaller(this, params).request();\n    }\n}\n\n\nabstract class SheetCaller<T> extends EntityCaller<T> {\n    protected get entity(): Sheet {return this._entity as Sheet;}\n    protected readonly suffix:string;\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\n}\n\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\n    get path():string {return `sheet/${this.entity.name}`;}\n    buildParams() {\n        let {app, discription, data} = this.params;\n        return {\n            app: app,\n            discription: discription,\n            data: this.entity.pack(data)\n        };\n    }\n}\n\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\n    method = 'PUT';\n    get path():string {return `sheet/${this.entity.name}`;}\n    //buildParams() {return this.entity.buildParams(this.params);}\n}\n\nclass GetSheetCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //private id:number;\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\n}\n\nclass SheetArchiveCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\n}\n\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'archives';\n}\n\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'states';\n}\n\nclass StateSheetCountCaller extends SheetCaller<undefined> {\n    method = 'GET';\n    protected readonly suffix = 'statecount';\n    xresult(res:any):any {\n        let {states} = this.entity;\n        return states.map(s => {\n            let n = s.name, count = 0;\n            let r = (res as any[]).find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n    }\n}\n\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'user-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'my-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nexport class PageStateItems<T> extends PageItems<T> {\n    private sheet: Sheet;\n    constructor(sheet: Sheet) {\n        super(true);\n        this.sheet = sheet;\n        this.pageSize = 10;\n\t}\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n\t\treturn {$page: ret};\n\t}\n\t/*\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n        return ret;\n\t}\n\t*/\n\tprotected getPageId(item:T) {\n\t\treturn item === undefined? 0 : (item as any).id;\n\t}\n\t/*\n    protected setPageStart(item:any) {\n        this.pageStart = item === undefined? 0 : item.id;\n\t}\n\t*/\n}\n","import {Query} from './query';\nimport { QueryQueryCaller } from './caller';\n\nexport class Book extends Query {\n    get typeName(): string { return 'book';}\n    protected queryApiName = 'book';\n\n    protected queryCaller(params: any): QueryQueryCaller {\n        return new BookQueryCaller(this, params);\n    }\n}\n\nexport class BookQueryCaller extends QueryQueryCaller {\n    //protected get entity(): Query {return this._entity as Query};\n    get path():string {return `book/${this.entity.name}`;}\n    /*\n    xresult(res:any) {\n        let data = this.entity.unpackReturns(res);\n        return data;\n    }\n    buildParams() {return this.entity.buildParams(this.params);}\n    */\n}\n","import {Query} from './query';\n\nexport class History extends Query {\n    get typeName(): string { return 'history';}\n    protected queryApiName = 'history';\n}\n","import { Entity } from './entity';\nimport { Action, ActionSubmitCaller } from './action';\nimport { Query } from './query';\nimport { Field } from './uqMan';\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\n\ninterface MapActions {\n    add: Action;\n    del: Action;\n}\ninterface MapQueries {\n    all: Query;\n    page: Query;\n    query: Query;\n}\n\nexport class Map extends Entity {\n    get typeName(): string { return 'map';}\n    keys: Field[];\n    actions: MapActions = {} as any;\n    queries: MapQueries = {} as any;\n    schemaFrom: {owner:string; uq:string};\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.schemaFrom = this.schema.from;\n        let {actions, queries, keys} = schema;\n        this.uq.buildFieldTuid(this.keys = keys);\n        //let t = this.schemaStringify();\n        for (let i in actions) {\n            let actionSchema = actions[i];\n            let {name} = actionSchema;\n            let action = this.uq.newAction(name, undefined);\n            action.setSchema(actionSchema);\n            action.buildFieldsTuid();\n            (this.actions as any)[i] = action;\n        }\n        for (let i in queries) {\n            let querySchema = queries[i];\n            let {name} = querySchema;\n            let query = this.uq.newQuery(name, undefined);\n            query.setSchema(querySchema);\n            query.buildFieldsTuid();\n            (this.queries as any)[i] = query;\n        }\n    }\n\n    async add(param:any) {\n        /*\n        await this.loadSchema();\n        return await this.actions.add.submit(param);\n        */\n        let ret = await new AddCaller(this, param).request();\n        return ret;\n    }\n\n    async del(param:any) {\n        /*\n        await this.loadSchema();\n        return await this.actions.del.submit(param);\n        */\n        let ret = await new DelCaller(this, param).request();\n        return ret;\n    }\n\n    async all() {\n        /*\n        await this.loadSchema();\n        return await this.queries.all.query({});\n        */\n        let ret = await new AllCaller(this, undefined).request();\n        return ret;\n    }\n\n    async page(param:any, pageStart:any, pageSize: number) {\n        /*\n        await this.loadSchema();\n        return await this.queries.page.page(param, pageStart, pageSize);\n        */\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\n        return ret;\n    }\n\n    async query(param:any) {\n        /*\n        await this.loadSchema();\n        return await this.queries.query.query(param);\n        */\n       let qc = new QueryCaller(this, param);\n       let ret = await qc.request();\n       return ret;\n   }\n    async table(params:any): Promise<any[]> {\n        let ret = await this.query(params);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any):Promise<any> {\n        let ret = await this.table(params);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any):Promise<any> {\n        let ret = await this.obj(params);\n        for (let i in ret) return ret[i];\n    }\n}\n\nabstract class MapCaller extends EntityCaller<any> {\n    protected get entity(): Map {return this._entity as Map;}\n    get path():string {return undefined;}\n\n    protected abstract getCaller(param: any):EntityCaller<any>;\n\n    protected async innerCall(): Promise<any> {\n        let caller = this.getCaller(this.params);\n        let res = await this.entity.uqApi.xcall(caller);\n        let ret = caller.xresult(res.res);\n        return {res: ret};\n    }\n\n    buildParams() {\n        let p = super.buildParams();\n        return p;\n    }\n}\n\nclass AddCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass DelCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass AllCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\n    }\n}\n\nclass PageCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\n    }\n}\n\nclass QueryCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\n    }\n}\n\nclass MapAddCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/add`}\n    get headers(): {[header:string]: string} {return undefined;}\n    /*\n        let {ver, uq} = this.map;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }*/\n}\n\nclass MapDelCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/del`}\n    get headers(): {[header:string]: string} {return undefined}\n    /*\n        let {ver, uq} = this.map;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }*/\n}\n\nclass MapAllCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/all`}\n    get headers(): {[header:string]: string} {return undefined}\n    /*\n        let {ver, uq} = this.map;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }*/\n}\n\n\nclass MapPageCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/page`}\n    get headers(): {[header:string]: string} {return undefined}\n    /*\n        let {ver, uq} = this.map;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }*/\n}\n\nclass MapQueryCaller extends QueryQueryCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/query`}\n    get headers(): {[header:string]: string} {return undefined}\n    /*\n        let {ver, uq} = this.map;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }*/\n}","import {Query} from './query';\n\nexport class Pending extends Query {\n    get typeName(): string { return 'pending';}\n    protected queryApiName = 'pending';\n}\n","import * as React from 'react';\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\nimport { Tag, TagValue } from './tag';\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class TagView implements IValuesView {\n\tprivate tag: Tag;\n\tconstructor(tag: Tag) {\n\t\tthis.tag = tag;\n\t}\n\trender(values: number|string):JSX.Element {\n\t\tlet names:string[];\n\t\tif (typeof values === 'number') {\n\t\t\tnames = [this.tag.nameFromId(values)];\n\t\t}\n\t\telse {\n\t\t\tnames = this.tag.namesFromIds(values);\n\t\t}\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\n\t\t})}</div>;\n\t}\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\n        let content = this.tag.values.map((item,index) => {\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\n        });\n\t\treturn this.renderView(options, content);\n\t}\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\n\t\tlet content = this.tag.values.map((item,index) => {\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\n\t\t});\n\t\treturn this.renderView(options, content);\n\t}\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\n\t\tlet {className, wrapClassName} = options;\n\t\twrapClassName = wrapClassName?\n\t\t\t'row ' + wrapClassName\n\t\t\t:\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\n\t\treturn <div className={className} style={radioStyle}>\n\t\t\t<div className={wrapClassName}>\n                {content}\n\t\t\t</div>\n        </div>;\n\t}\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, inputName, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\n\t\t\t\tvalue={id} defaultChecked={value===id}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"checkbox\"\n\t\t\t\tvalue={id} defaultChecked={checked}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n}\n","import { Entity } from \"../entity\";\nimport { TagView } from \"./tagView\";\n\nexport interface TagValue {\n\tid: number;\n\tname: string;\n\text: string;\n}\n\nexport class Tag extends Entity {\n    get typeName(): string { return 'tag';}\n\tvalues: TagValue[];\n\tprivate coll: {[id:number]: TagValue} = {};\n\n\tprivate _view: TagView;\n\tget view(): TagView { \n\t\tif (this._view !== undefined) return this._view; \n\t\treturn this._view = new TagView(this);\n\t}\n\n\tnameFromId(id:number) {\n\t\tlet c = this.coll[id]; \n\t\treturn c===undefined? undefined : c.name;\n\t}\n\n\tnamesFromIds(ids:string):string[] {\n\t\tlet ret:string[] = [];\n\t\tfor (let id of ids.split('|')) {\n\t\t\tlet c = this.coll[Number(id)];\n\t\t\tlet name = c===undefined? undefined : c.name;\n\t\t\tif (name !== undefined) ret.push(name);\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync loadValues():Promise<TagValue[]> {\n\t\tif (this.values !== undefined) return this.values;\n\t\tthis.values = [];\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\n\t\tif (ret === undefined) return;\n\t\tlet lines = (ret as string).split('\\n');\n\t\tfor (let line of lines) {\n\t\t\tif (line.length === 0) continue;\n\t\t\tlet parts = line.split('\\t');\n\t\t\tlet id = Number(parts[0]);\n\t\t\tlet val = {\n\t\t\t\tid: id,\n\t\t\t\tname: parts[1],\n\t\t\t\text: parts[2],\n\t\t\t};\n\t\t\tthis.values.push(val);\n\t\t\tthis.coll[id] = val;\n\t\t}\n\t\treturn this.values;\n\t}\n}\n","export * from './page';\nexport * from './tabs';\nexport * from './scrollView';\n","export * from './schema';\nexport * from './uiSchema';\nexport * from './toUiSelectItems';\nexport * from './IValuesView';","\nexport const mobileRegex = /^[0-9]*$/;\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\n\nexport const EmailFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\n}\n\nexport const MobileFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface DropdownAction {\n    icon?: string;\n    caption?: string;\n    action?: () => void;\n}\n\nexport interface DropdownActionsProps {\n    icon?: string;\n    actions: DropdownAction[];\n    isRight?: boolean;\n    className?: string;\n}\n\nexport interface DropdownActionsState {\n    dropdownOpen: boolean;\n}\n\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\n    private menu: HTMLDivElement;\n    private button: HTMLElement;\n    constructor(props:DropdownActionsProps) {\n        super(props);\n        this.state = {\n            dropdownOpen: false\n        };\n    }\n\n    componentDidMount() {\n        document.addEventListener('click', this.handleDocumentClick);\n        document.addEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.handleDocumentClick);\n        document.removeEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    private handleDocumentClick = (evt:any) => {\n        if (this.state.dropdownOpen === false) return;\n        if (this.button && this.button.contains(evt.target)) return;\n        if (!this.menu) return;\n        //if (!this.menu.contains(evt.target)) \n        this.toggle();\n    }\n\n    private toggle = () => {\n        this.setState({\n            dropdownOpen: !this.state.dropdownOpen\n        });\n    }\n\n    render() {\n        let {icon, actions, isRight, className} = this.props;\n        if (isRight === undefined) isRight = true;\n        let hasIcon = actions.some(v => v.icon!==undefined);\n        let {dropdownOpen} = this.state;\n        //isOpen={this.state.dropdownOpen} toggle={this.toggle}\n        return <div className={classNames('dropdown', className)}>\n            <button ref={v=>this.button=v} className=\"cursor-pointer dropdown-toggle btn btn-sm\"\n                data-toggle=\"dropdown\"\n                aria-expanded={dropdownOpen}\n                onClick={this.toggle}>\n                <i className={classNames('fa', 'fa-'+(icon||'ellipsis-v'))} />\n            </button>\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\n                {\n                    actions.map((v,index) => {\n                        let {icon, caption, action} = v;\n                        if (icon === undefined && caption === undefined) \n                            return <div className=\"dropdown-divider\" />;\n                        let i:any;\n                        if (hasIcon === true) {\n                            if (icon !== undefined) icon = 'fa-' + icon;\n                            i = <><i className={classNames('fa', icon, 'fa-fw')} aria-hidden={true}></i>&nbsp; </>;\n                        }\n                        if (action === undefined) \n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\n                            evt.preventDefault();\n                            action();\n                        }\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\n                            action();\n                        }\n                            // eslint-disable-next-line\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\n                            >{i} {caption}</a>\n                    })\n                }\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport { setRes } from '../../components';\n\nexport interface EasyDateProps {\n    date: Date | number;\n}\n\n//type YMD = (year:number, month:number, date:number) => string;\n//type MD = (month:number, date:number) => string;\n\nconst timeRes:{[prop:string]:any} = {\n\tmd: (month:number, date:number) => `${month}-${date}`,\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\tyesterday: 'Yday',\n\ttoday: 'Today',\n\ttomorrow: 'Tmw',\n\t$zh: {\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\n\t\tyesterday: '昨天',\n\t\ttoday: '今天',\n\t\ttomorrow: '明天',\n\t},\n\t$en: {\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\t\tyesterday: 'Yday',\n\t\ttoday: 'Today',\n\t\ttomorrow: 'Tmw',\n\t}\n}\n\nsetRes(timeRes, timeRes);\n\nfunction tt(str:string):any {\n\treturn timeRes[str];\n}\n\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\n    if (!vDate) return null;\n    let date: Date;\n    switch (typeof vDate) {\n        default: date = vDate as Date; break;\n        case 'string': date = new Date(vDate); break;\n        case 'number': date = new Date((vDate as number)*1000); break;\n    }\n\n    let now = new Date();\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\n    let d = date;\n    tick = now.getTime() - d.getTime();\n    let hour=d.getHours(), minute=d.getMinutes();\n    nDate=now.getDate();\n    _date=d.getDate();\n    month=d.getMonth()+1;\n    year=d.getFullYear();\n\tnowYear = now.getFullYear();\n\n\tlet appendTime:boolean = false;\n\tlet dPart:string = (function() {\n\t\tif (tick < -24*3600*1000) {\n\t\t\tif (year === nowYear) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('md')(month, _date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('ymd')(year, month, _date);\n\t\t\t}\n\t\t}\n\t\tif (tick < 24*3600*1000) {\n\t\t\tif (_date!==nDate) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\n\t\t\t}\n\t\t\tif (withTime===true) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn tt('today');\n\t\t}\n\t\tif (year === nowYear) {\n\t\t\treturn tt('md')(month, _date);\n\t\t}\n\t\treturn tt('ymd')(year, month, _date);\n\t})();\n\n\tlet hm = hour + ((minute<10?':0':':') + minute);\n\n\t/*\n    if (tick < -24*3600*1000) {\n        if (year === nowYear)\n            return tt('md')(month, _date) + ' ' + hm;\n        else\n            return tt('ymd')(year, month, _date) + ' ' + hm;\n    }\n    if (always === true || tick < 24*3600*1000) {\n        return _date!==nDate? \n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \n            : withTime===true? hm : tt('today');\n    }\n    if (year === nowYear) {\n        return tt('md')(month, _date);\n    }\n\treturn tt('ymd')(year, month, _date);\n\t*/\n\tif (appendTime === true || always === true) {\n\t\treturn dPart + ' ' + hm;\n\t}\n\treturn dPart;\n}\n\n\nexport class EasyDate extends React.Component<EasyDateProps> {\n    render() {\n        return renderDate(this.props.date, false);\n    }\n}\n\ninterface EasyTimeProps extends EasyDateProps {\n\talways?: boolean;\n}\nexport class EasyTime extends React.Component<EasyTimeProps> {\n    render() {\n\t\tlet {date, always} = this.props;\n        return renderDate(date, true, always);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Image } from '.';\n\nexport interface MediaProps {\n    icon: string;\n    main: string|JSX.Element;\n    discription?: string | JSX.Element;\n    px?: number;\n    py?: number;\n}\n\nexport class Media extends React.Component<MediaProps> {\n    render() {\n        let {icon, main, discription, px, py} = this.props;\n        let disp:any;\n        if (typeof discription === 'string')\n            disp = <div>{discription}</div>;\n        else\n            disp = discription;\n        let cn = classNames(\n            'media', \n            px===undefined? 'px-0':'px-'+px, \n            py===undefined? 'py-2':'py-'+py);\n        return <div className={cn}>\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\n            <div className=\"media-body\">\n                <h5 className=\"mt-0\">{main}</h5>\n                {disp}\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\n\nexport interface SearchBoxProps {\n    className?: string;\n    label?: string;\n    initKey?: string;\n    placeholder?: string;\n    buttonText?: string;\n    maxLength?: number;\n    size?: 'sm' | 'md' | 'lg';\n    inputClassName?: string;\n    onSearch: (key:string)=>Promise<void>;\n    onFocus?: ()=>void;\n    allowEmptySearch?: boolean;\n}\n\n/*\nexport interface SearchBoxState {\n    disabled: boolean;\n}*/\n\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\n    private input: HTMLInputElement;\n    private key: string = null;\n    @observable private disabled: boolean;\n\n    private onChange = (evt: React.ChangeEvent<any>) => {\n        this.key = evt.target.value;\n        if (this.key !== undefined) {\n            this.key = this.key.trim();\n            if (this.key === '') this.key = undefined;\n        }\n        if (this.props.allowEmptySearch !== true) {\n            this.disabled = !this.key;\n        }\n    }\n    private onSubmit = async (evt: React.FormEvent<any>) => {\n        evt.preventDefault();\n        if (this.key === null) this.key = this.props.initKey || '';\n        if (this.props.allowEmptySearch !== true) {\n            if (!this.key) return;\n            if (this.input) this.input.disabled = true;\n        }\n        await this.props.onSearch(this.key);\n        if (this.input) this.input.disabled = false;\n    }\n    clear() {\n        if (this.input) this.input.value = '';\n    }\n    render() {\n        let {className, inputClassName, onFocus,\n            label, placeholder, buttonText, maxLength, size} = this.props;\n        let inputSize:string;\n        switch (size) {\n            default:\n            case 'sm': inputSize = 'input-group-sm'; break;\n            case 'md': inputSize = 'input-group-md'; break;\n            case 'lg': inputSize = 'input-group-lg'; break;\n        }\n        return <form className={className} onSubmit={this.onSubmit} >\n            <div className={classNames(\"input-group\", inputSize)}>\n                {label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\n                <input ref={v=>this.input=v} onChange={this.onChange}\n                    type=\"text\"\n                    name=\"key\"\n                    onFocus={onFocus}\n                    className={classNames('form-control', inputClassName || 'border-primary')}\n                    placeholder={placeholder}\n                    defaultValue={this.props.initKey}\n                    maxLength={maxLength} />\n                <div className=\"input-group-append\">\n                    <button className=\"btn btn-primary\"\n                        type=\"submit\"\n                        disabled={this.disabled}>\n                        <i className='fa fa-search' />\n                        <i className=\"fa\"/>\n                        {buttonText}\n                    </button>\n                </div>\n            </div>\n        </form>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { userApi } from '../net';\nimport { User } from '../tool';\n\nexport type UserLoader = (userId:number)=>Promise<any>;\n\nexport class UserCache<T> {\n\tprivate loader: UserLoader;\n\tprivate onLoaded: (user:User) => void;\n\tprivate map = observable(new Map<number, T|number>());\n\n\tconstructor(loader: UserLoader) {\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\n\t\tthis.loader = loader;\n\t}\n\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tif (!id) return;\n\t\tthis.onLoaded = onLoaded;\n\t\tid = Number(id);\n\t\tlet ret = this.map.get(id);\n\t\tif (ret === undefined) {\n\t\t\tthis.map.set(id, id);\n\t\t}\n\t}\n\n\tgetValue(id:number|any):any {\n\t\tif (!id) return;\n\t\tswitch (typeof(id)) {\n\t\t\tcase 'object': \n\t\t\t\tid = id.id; \n\t\t\t\tif (!id) return;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet ret = this.map.get(id);\n\t\tif (!ret) return;\n\t\tswitch (typeof(ret)) {\n\t\tdefault:\n\t\t\treturn ret;\n\t\tcase 'number':\n\t\t\tif (ret < 0) return id;\n\t\t\tthis.map.set(id, -id);\n\t\t\tthis.loader(id).then(v => {\n\t\t\t\tif (!v) v = null;\n\t\t\t\tthis.map.set(id, v);\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\n\t\t\t}).catch(reason => {\n\t\t\t\tconsole.error(reason);\n\t\t\t});\n\t\t\treturn id;\n\t\t}\n\t}\n}\n\nconst userCache = new UserCache(undefined);\n\nexport interface UserIconProps {\n    id: number;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n    noneImage?: any;\n}\n\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\n    let {className, style, id, altImage, noneImage} = props;\n    let user = userCache.getValue(id);\n    switch (typeof user) {\n\tcase 'undefined':\n\tcase 'number':\n        return <div className={classNames(className, 'image-none')} style={style}>\n            {noneImage || <i className=\"fa fa-file-o\" />}\n        </div>;\n    }\n    let {icon} = user;\n    if (!icon) {\n        return <div className={classNames(className, 'image-none')} style={style}>\n            <i className=\"fa fa-file-o\" />\n        </div>;\n    }\n    if (icon.startsWith(':') === true) {\n        icon = nav.resUrl + icon.substr(1);\n    }\n    return <img src={icon} className={className} alt=\"img\"\n        style={style}\n        onError={evt=>{\n            if (altImage) evt.currentTarget.src=altImage;\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n        }} />;\n});\n\nexport interface UserViewProps {\n\tid?: number;\n\tuser?: number|User;\n\trender: (user:User) => JSX.Element;\n\tonLoaded?: (user:User) => void\n}\n\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\n\tlet {id:idProp, user, render, onLoaded} = props;\n\tif (user === null) return <>null</>;\n\tswitch (typeof user) {\n\t\tcase 'undefined': \n\t\t\tuser = userCache.getValue(idProp);\n\t\t\tbreak;\n\t\tcase 'object': \n\t\t\tlet {/*obj, */id} = user as any;\n\t\t\t//if (typeof obj !== 'object') {\n\t\t\t\tuseUser(id, onLoaded);\n\t\t\t\tuser = userCache.getValue(id);\n\t\t\t//}\n\t\t\tbreak;\n\t\tcase 'number':\n\t\t\tuseUser(user as number, onLoaded);\n\t\t\tuser = userCache.getValue(user as number);\n\t\t\tbreak;\n\t\tcase 'string':\n\t\t\tuseUser(Number(user), onLoaded);\n\t\t\tuser = userCache.getValue(Number(user));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tuser = undefined;\n\t\t\tbreak;\n\t}\n    switch (typeof user) {\n\t\tcase 'undefined':\n\t\tcase 'number':\n        \treturn <>{user}</>;\n    }\n    return render(user);\n});\n\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\n\tif (!id) return;\n\tif (typeof(id) === 'object') {\n\t\tid = (id as any).id;\n\t}\n\tuserCache.use(id, onLoaded);\n}\n","import { UqMan, TuidModify } from '../uqMan';\nimport { Tuid } from \"./tuid\";\nimport { env } from '../../tool';\n\ninterface Modify {\n    id: number;\n    entity: string;\n    key: string;\n}\n\nexport class TuidsCache {\n    private readonly uq: UqMan;\n    private modifyMax: TuidModify;\n    private cacheTimer: any;\n    constructor(uq: UqMan) {\n        this.uq = uq;\n    }\n\n    cacheTuids(defer:number) {\n        this.clearCacheTimer();\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\n    }\n    private clearCacheTimer() {\n        if (this.cacheTimer === undefined) return;\n        env.clearTimeout(this.cacheTimer);\n        this.cacheTimer = undefined;\n    }\n    private loadIds = () => {\n        this.clearCacheTimer();\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            let tuid = tuids[i];\n            tuid.cacheIds();\n        }\n    }\n    \n    pullModify(modifyMax:number) {\n        if (modifyMax === undefined) return;\n        let now = Math.floor(Date.now() / 1000);\n        if (this.modifyMax === undefined) {\n            this.modifyMax = this.uq.localModifyMax.get();\n            if (this.modifyMax === undefined) {\n                this.modifyMax = {\n                    max: modifyMax,\n                    seconds: now,\n                };\n                this.uq.localModifyMax.set(this.modifyMax);\n            }\n        }\n        let {max, seconds} = this.modifyMax;\n        let lockGap = 3600;\n        if (now - seconds < lockGap) return;\n        if (modifyMax <= max) return;\n        let tuidCached:string[] = [];\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            //if (tuids[i].cached === true) \n            tuidCached.push(i);\n        }\n        if (tuidCached.length === 0) return;\n        this.modifyMax.seconds = now;\n        this.innerPullModify(tuidCached.join('\\t'));\n    }\n\n    private async innerPullModify(tuidLists:string):Promise<void> {\n        let {uqApi, tuids} = this.uq;\n        let {max} = this.modifyMax;\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\n        let modifyMax:number = 0;\n        for (let modify of ret.queue) {\n\t\t\tlet {id, entity, key} = modify;\n\t\t\tif (!key) continue;\n            let tuid = tuids[entity];\n            if (tuid === undefined) continue;\n            let item = group[entity];\n            if (item === undefined) {\n                item = group[entity] = {tuid: tuid, ids:[]};\n            }\n            item.ids.push(key);\n            if (id > modifyMax) modifyMax = id;\n        }\n        for (let i in group) {\n            let {tuid, ids} = group[i];\n            await tuid.modifyIds(ids);\n        }\n        let now = Math.floor(Date.now() / 1000);\n        this.modifyMax = {\n            max: modifyMax,\n            seconds: now,\n        }\n        this.uq.localModifyMax.set(this.modifyMax);\n    }\n}\n","import { LocalMap, LocalCache, env } from '../tool';\nimport { UqData } from '../net';\nimport { UqMan } from './uqMan';\nimport { TuidImport, TuidInner } from './tuid';\nimport { nav } from '../components';\n\nexport interface TVs {\n    [uqName:string]: {\n        [tuidName: string]: (values: any) => JSX.Element;\n    }\n}\n\nexport class UQsMan {\n    private collection: {[uqName: string]: UqMan};\n    private readonly tvs: TVs;\n\n    readonly name: string;\n    readonly appOwner: string;\n    readonly appName: string;\n    readonly localMap: LocalMap;\n    readonly localData: LocalCache;\n    id: number;\n\n    constructor(tonvaAppName:string, tvs:TVs) {\n        this.tvs = tvs || {};\n        this.buildTVs();\n        this.collection = {};\n        let parts = tonvaAppName.split('/');\n        if (parts.length !== 2) {\n            throw new Error('tonvaApp name must be / separated, owner/app');\n        }\n        this.appOwner = parts[0];\n        this.appName = parts[1];\n        this.localMap = env.localDb.map(tonvaAppName);\n        this.localData = this.localMap.child('uqData');\n    }\n\n    // to be removed in the future\n    addUq(uq: UqMan) {\n        this.collection[uq.name] = uq;\n    }\n\n    private buildTVs() {\n        for (let i in this.tvs) {\n            let uqTVs = this.tvs[i];\n            if (uqTVs === undefined) continue;\n            let l = i.toLowerCase();\n            if (l === i) continue;\n            this.tvs[l] = uqTVs;\n            for (let j in uqTVs) {\n                let en = uqTVs[j];\n                if (en === undefined) continue;\n                let lj = j.toLowerCase();\n                if (lj === j) continue;\n                uqTVs[lj] = en;\n            }\n        }\n    }\n\n    async init(uqsData:UqData[]):Promise<void> {\n        let promiseInits: PromiseLike<void>[] = [];\n        for (let uqData of uqsData) {\n            let {uqOwner, uqName} = uqData;\n            let uqFullName = uqOwner + '/' + uqName;\n            //let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\n            //let cUq = this.newCUq(uqData, uqUI);\n            //this.cUqCollection[uqFullName] = cUq;\n            //this.uqs.addUq(cUq.uq);\n            let uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\n            this.collection[uqFullName] = uq;\n            let lower = uqFullName.toLowerCase();\n            if (lower !== uqFullName) {\n                this.collection[lower] = uq;\n            }\n            promiseInits.push(uq.init());\n        }\n        await Promise.all(promiseInits);\n    }\n\n    async load(): Promise<string[]> {\n        let retErrors:string[] = [];\n        let promises: PromiseLike<string>[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            promises.push(uq.loadEntities());\n\t\t}\t\t\n        let results = await Promise.all(promises);\n        for (let result of results)\n        {\n            let retError = result; // await cUq.loadSchema();\n            if (retError !== undefined) {\n                retErrors.push(retError);\n                continue;\n            }\n\t\t}\n        return retErrors;\n    }\n\n    buildUQs(): any {\n        let that = this;\n        let uqs:any = {};\n        for (let i in this.collection) {\n            let uqMan = this.collection[i];\n            //let n = uqMan.name;\n            let uqName = uqMan.uqName;\n            let l = uqName.toLowerCase();\n            let entities = uqMan.entities;\n            let keys = Object.keys(entities);\n            for (let key of keys) {\n                let entity = entities[key];\n                let {name} = entity;\n                //if (name !== sName) \n                //entities[sName] = entity;\n                entities[name.toLowerCase()] = entity;\n            }\n            //uqs[i] = entities;\n            //uqs[uqName] = entities;\n            //if (l !== uqName) \n            uqs[l] = new Proxy(entities, {\n                get: function(target, key, receiver) {\n                    let lk = (key as string).toLowerCase();\n                    let ret = target[lk];\n                    if (ret !== undefined) return ret;\n\t\t\t\t\tdebugger;\n\t\t\t\t\tlet err = `entity ${uqName}.${String(key)} not defined`;\n                    console.error(err);\n                    that.showReload('UQ错误：' + err);\n                    return undefined;\n                }\n            });\n        }\n        //let uqs = this.collection;\n        return new Proxy(uqs, {\n            get: function (target, key, receiver) {\n                let lk = (key as string).toLowerCase();\n                let ret = target[lk];\n                if (ret !== undefined) return ret;\n                /*\n                for (let i in uqs) {\n                    if (i.toLowerCase() === lk) {\n                        return uqs[i];\n                    }\n                }*/\n                debugger;\n                console.error('error in uqs');\n                that.showReload(`代码错误：新增 uq ${String(key)}`);\n                return undefined;\n            },\n        });\n    }\n\n    private showReload(msg: string) {\n        this.localMap.removeAll();\n        nav.showReloadPage(msg);\n    }\n\n    setTuidImportsLocal():string[] {\n        let ret:string[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            for (let tuid of uq.tuidArr) {\n                if (tuid.isImport === true) {\n                    let error = this.setInner(tuid as TuidImport);\n                    if (error) ret.push(error);\n                }\n            }\n        }\n        return ret;\n    }\n\n    private setInner(tuidImport: TuidImport):string {\n        let {from} = tuidImport;\n        let fromName = from.owner + '/' + from.uq;\n        let uq = this.collection[fromName];\n        if (uq === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\n        }\n        let iName = tuidImport.name\n        let tuid = uq.tuid(iName);\n        if (tuid === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\n        }\n        if (tuid.isImport === true) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\n        }\n        tuidImport.setFrom(tuid as TuidInner);\n    }\n}\n","import _ from 'lodash';\nimport { Context } from '../context';\nimport { FormRes } from '../../../res/formRes';\n\nexport abstract class Rule {\n    abstract check(defy:string[], value:any):void;\n}\n\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\nexport type FieldRule = (value:any) => string[] | string;\n\nexport class RuleCustom extends Rule {\n    private func: FieldRule;\n    constructor(func: FieldRule) {\n        super();\n        this.func = func;\n    }\n    check(defy:string[], value:any) {\n        let ret = this.func(value);\n        if (ret === undefined) return;\n        switch (typeof ret) {\n            case 'undefined': return;\n            case 'string': defy.push(ret as string); return;\n            default: defy.push(...ret); return;\n        }        \n    }\n}\n\nexport abstract class RulePredefined extends Rule {\n    protected res: FormRes;\n    constructor(res: FormRes) {\n        super();\n        this.res = res;\n    }\n}\n\nexport class RuleRequired extends RulePredefined {\n    check(defy:string[], value:any) {\n        switch (typeof value) {\n            default:\n            case 'boolean': return;\n            case 'object':\n                if (value !== null) return;\n                break;\n            case 'string':\n                if ((value as string).trim().length > 0) return;\n                break;\n            case 'number':\n                if (isNaN(value as number) === false) return;\n                break;\n            case 'undefined':\n                break;\n        }\n        defy.push(this.res.required);\n    }\n}\n\nexport class RuleNum extends RulePredefined {\n    private minMsg: _.TemplateExecutor;\n    private maxMsg: _.TemplateExecutor;\n    protected min: number;\n    protected max: number\n    constructor(res: FormRes, min?: number, max?: number) {\n        super(res);\n        this.minMsg = _.template(res.min);\n        this.maxMsg = _.template(res.max);\n        this.min = min;\n        this.max = max;\n    }\n    check(defy:string[], value:any) {\n        if (value === undefined || value === null) return;\n        let n = Number(value);\n        if (isNaN(n) === true) {\n            defy.push(this.res.number);\n        }\n        else {\n            this.checkMore(defy, n);\n        }\n    }\n\n    protected checkMore(defy:string[], value: number) {\n        if (this.min !== undefined && Number(value) < this.min) {\n            defy.push(this.minMsg({min:this.min}));\n        }\n        if (this.max !== undefined && Number(value) > this.max) {\n            defy.push(this.maxMsg({max:this.max}));\n        }\n    }\n}\n\nexport class RuleInt extends RuleNum {\n    protected checkMore(defy:string[], n: number) {\n        super.checkMore(defy, n);\n        if (Number.isInteger(n) === false) {\n            defy.push(this.res.integer);\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { ItemSchema } from '../../schema';\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport abstract class Widget {\n    name: string;\n    protected context: Context;\n    protected fieldProps:FieldProps;\n    protected children: React.ReactNode;\n    protected _itemSchema: ItemSchema;\n    protected _ui: UiItem;\n    protected defaultValue: any;\n    protected value: any;\n    protected rules: Rule[];\n    @observable errors: string[] = [];\n    @observable protected contextErrors: string[] = [];\n    @computed protected get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\n    protected readOnly:boolean;\n    protected disabled:boolean;\n    @observable visible:boolean;\n\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\n        this.context = context;\n        let {name} = itemSchema;\n        this.name = name;\n        this._itemSchema = itemSchema;\n        this.fieldProps = fieldProps;\n        this.children = children;\n        this._ui = context.getUiItem(name);\n        if (this.ui === undefined) {\n            this.readOnly = false;\n            this.disabled = false;\n            this.visible = true;\n        }\n        else {\n            let {readOnly, disabled, visible} = this.ui;\n            this.readOnly = (readOnly === true);\n            this.disabled = (disabled === true);\n            this.visible = !(visible === false);            \n        }\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\n        // this.init();\n    }\n\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\n    protected get ui(): UiItem {return this._ui};\n\n    init() {\n        this.rules = [];\n        if (this.itemSchema.required === true) {\n            this.rules.push(new RuleRequired(this.context.form.res));\n        }\n        this.buildRules();\n        if (this.ui === undefined) return;\n        let {rules} = this.ui;\n        if (rules === undefined) return;\n        if (Array.isArray(rules) === false) {\n            this.rules.push(new RuleCustom(rules as FieldRule));\n            return;\n        }\n        for (let rule of rules as FieldRule[]) {\n            this.rules.push(new RuleCustom(rule));\n        }\n    }\n\n    protected buildRules() {\n    }\n\n    checkRules() {\n        let defy:string[] = [];\n        for (let r of this.rules) r.check(defy, this.value);\n        if (defy.length === 0) {\n            this.context.removeErrorWidget(this);\n        }\n        else {\n            this.context.addErrorWidget(this);\n            this.errors.push(...defy);\n        }\n    }\n\n    @computed get isOk() {\n        return this.errors.length ===0;\n    }\n\n    setError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.errors.push(err);\n        else this.errors.push(...err);\n    }\n\n    setContextError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.contextErrors.push(err);\n        else this.contextErrors.push(...err);\n    }\n\n    clearError() {\n        this.errors.splice(0);\n    }\n\n    clearContextError() {\n        this.contextErrors.splice(0);\n    }\n\n    protected parse(value:any):any {return value}\n\n    protected setElementValue(value:any) {}\n    protected setDataValue(value:any) {\n        if (this.isChanging === true) return;\n        this.context.initData[this.name] = this.value = this.parse(value);\n    }\n\n    setValue(value:any) {\n        if (this.isChanging === true) return;\n        //this.setDataValue(value);\n        //this.setElementValue(value);\n        this.changeValue(value, false);\n    }\n\n    getValue() {\n        return this.context.getValue(this.name);\n    }\n\n    getReadOnly():boolean {return this.readOnly}\n    getDisabled():boolean {return this.disabled}\n    getVisible():boolean {return this.visible}\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}\n    setVisible(value:boolean) {this.visible = value}\n\n    private isChanging: boolean;\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n\n    protected changeValue(newValue: any, fromElement: boolean) {\n        let prev = this.value;\n        let onChanging: ChangingHandler;\n        let onChanged: ChangedHandler;\n        if (this.ui !== undefined) {\n            onChanging = this.ui.onChanging;\n            onChanged = this.ui.onChanged;\n        }\n        let allowChange = true;\n        if (onChanging !== undefined) {\n            this.isChanging = true;\n            allowChange = onChanging(this.context, this.value, prev);\n            this.isChanging = false;\n        }\n        if (allowChange === true) {\n            this.setDataValue(newValue);\n            if (fromElement !== true) this.setElementValue(newValue);\n            if (onChanged !== undefined) {\n                this.isChanging = true;\n                onChanged(this.context, this.value, prev);\n                this.isChanging = false;\n            }\n        }\n    }\n\n    protected get className():string {\n        let fieldClass:string;\n        if (this.context.inNode === false) fieldClass = 'form-control';\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\n    }\n\n    protected abstract render():JSX.Element;\n\n    protected renderBody():JSX.Element {\n        let elDiscription;\n        if (this.hasError === false && this.ui) {\n            let {discription, discriptionClassName} = this.ui;\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\n            elDiscription = <span className={discriptionClassName}>\n                {discription}\n            </span>;\n        }\n        return <>\n            {this.render()}\n            {elDiscription}\n        </>;\n    }\n\n    container = observer(():JSX.Element => {\n        if (this.visible === false) return null;\n        let {form, inNode} = this.context;\n        if (inNode === true) return this.render();\n        let label:any = this.label;\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\n        }\n        return form.FieldContainer(label, this.renderBody());\n    })\n\n    protected get label():string {\n        let label:any;\n        if (this.ui === undefined) {\n            label = this.name;\n        }\n        else {\n            let uiLabel = this.ui.label;\n            if (uiLabel === null) label = null;\n            else label = uiLabel || this.name;\n        }\n        return label;\n    }\n\n    protected renderTemplet():JSX.Element | undefined {\n        if (this.children !== undefined) {\n            return <>{this.children}</>;\n        }\n        if (this.ui === undefined) return undefined;\n        let {Templet} = this.ui;\n        if (typeof Templet === 'function') return Templet(this.value);\n        return Templet;\n    }\n\n    protected renderErrors() {\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\n        if (errorList.length === 0) return null;\n        let {inNode} = this.context;\n        let tag = inNode === true? 'span' : 'div';\n        return errorList.map(err => React.createElement(tag, \n            {\n                key: err, \n                className: 'text-danger d-inline-block my-2 ml-3'\n            },\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\n        ));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextItem, StringSchema } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class TextWidget extends Widget {\n    protected inputType = 'text';\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\n    protected input: HTMLInputElement;\n    @observable protected hasFocus: boolean;\n\n    protected setElementValue(value:any) {\n        if (this.input === null) return;\n        this.input.value = value;\n    }\n    protected get placeholder() {return (this.ui && this.ui.placeholder) || this.name}\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        this.internalOnKeyDown(evt);\n        if (evt.keyCode !== 13) return;\n        let {onEnter} = this.context.form.props;\n        if (onEnter === undefined) return;\n\n        this.changeValue(evt.currentTarget.value, true);\n\n        //this.checkRules();\n        //this.context.checkContextRules();\n        this.input.blur();\n\n        let ret = await onEnter(this.name, this.context);\n        if (ret !== undefined) {\n            this.context.setError(this.name, ret);\n        }\n    }\n\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n    }\n\n    protected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n\t\tthis.context.checkContextRules();\n\t\tthis.hasFocus = false;\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n\t\tthis.hasFocus = true;\n    }\n    protected onChange(evt: React.ChangeEvent<any>) {\n    }\n\n    setReadOnly(value:boolean) {\n        if (this.input === null) return;\n        this.input.readOnly = this.readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        if (this.input === null) return;\n        this.input.disabled = this.disabled = value;\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {\n            //'form-control': true,\n        };\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, cn)}\n            type={this.inputType}\n            defaultValue={this.value}\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\n            placeholder={this.placeholder}\n            readOnly={this.readOnly}\n            disabled={this.disabled}\n            onKeyDown = {this.onKeyDown}\n            onFocus = {this.onFocus}\n            onBlur={this.onBlur}\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextAreaItem } from '../../schema';\nimport { StringSchema } from '../../schema';\n\nexport class TextAreaWidget extends Widget {\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\n    protected input: HTMLTextAreaElement;\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\n\n    protected setElementValue(value:any) {this.input.value = value}\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.setValue(evt.currentTarget.value);\n    }\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n        this.context.checkContextRules();\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {};\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <>\n\t\t\t<textarea ref={(input) => this.input=input}\n\t\t\t\tonBlur={this.onBlur} \n\t\t\t\tonFocus={this.onFocus}\n                className={classNames(this.className, cn)}\n                rows={this.ui && this.ui.rows}\n                maxLength={this.itemSchema.maxLength}\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class PasswordWidget extends TextWidget {\n    protected inputType = 'password';\n}\n\nexport class UrlWidget extends TextWidget {\n    protected inputType = 'url';\n}\n\nexport class EmailWidget extends TextWidget {\n    protected inputType = 'email';\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\nimport { RuleNum, RuleInt } from '../rules';\nimport { NumBaseSchema } from '../../schema';\n\nexport class NumberWidget extends TextWidget {\n    protected inputType = 'number';\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\n\n    protected buildRules() {\n        super.buildRules();\n        let res = this.context.form.res;\n        let {min, max} = this.itemSchema;\n        this.rules.push(\n            this.itemSchema.type === 'integer'?\n                new RuleNum(res, min, max) :\n                new RuleInt(res, min, max)\n        );\n        /*\n        if (this.itemSchema.type === 'integer') {\n            this.rules.push(new RuleInt);\n        }\n        let {min, max} = this.itemSchema;\n        if (min !== undefined) this.rules.push(new RuleMin(min));\n        if (max !== undefined) this.rules.push(new RuleMax(max));\n        */\n    }\n\n    protected parse(value:any):any {\n        if (value === undefined || value === null) return;\n        return Number(value);\n    }\n}\n","import * as React from 'react';\nimport { NumberWidget } from './numberWidget';\n\nexport class UpdownWidget extends NumberWidget {\n    protected inputType = 'number';\n\n    protected isValidKey(key:number):boolean {\n        return key===46 || key===8 || key===37 || key===39\n            || (key>=48 && key<=57)\n            || (key>=96 && key<=105)\n            || key===109 || key===189;\n    }\n    \n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n        let key = evt.keyCode;\n        window.event.returnValue = this.isValidKey(key);\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class DateWidget extends TextWidget {\n    protected inputType = 'date';\n}\n\nexport class DateTimeWidget extends TextWidget {\n    protected inputType = 'datetime';\n}\n\nexport class TimeWidget extends TextWidget {\n    protected inputType = 'time';\n}\n\nexport class MonthWidget extends TextWidget {\n    protected inputType = 'month';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiCheckItem } from '../../schema';\n\nexport class CheckBoxWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\n    protected trueValue: any;\n    protected falseValue: any;\n\n    init() {\n        super.init();\n        if (this.ui !== undefined) {\n            let {trueValue, falseValue} = this.ui;\n            if (trueValue === undefined) this.trueValue = true;\n            else this.trueValue = trueValue;\n            if (falseValue === undefined) this.falseValue = false;\n            else this.falseValue = falseValue;\n        }\n        else {\n            this.trueValue = true;\n            this.falseValue = false;\n        }\n    }\n    protected setElementValue(value:any) {\n        this.input.checked = value === this.trueValue;\n    }\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\n        this.setDataValue(v);\n    }\n\n    protected onClick = () => {\n        this.context.clearErrors();\n    }\n\n    render() {\n        let cn = classNames(this.className, 'form-check-inline p-0');\n        let input = <input\n            ref={(input)=>this.input = input}\n            className={'align-self-center'}\n            type=\"checkbox\"\n            defaultChecked={this.defaultValue} \n            onChange={this.onInputChange}\n            onClick={this.onClick} />;\n        if (this.context.inNode === true) {\n            return <label className={cn}>\n                {input} {(this.ui&&this.ui.label) || this.name}\n            </label>\n        }\n        else {\n            return <div className={cn}>\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\n            </div>;\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\nimport { Widget } from './widget';\nimport { UiSelect } from '../../schema';\n\nexport class SelectWidget extends Widget {\n    protected select: HTMLSelectElement;\n    protected get ui(): UiSelect {return this._ui as UiSelect};\n    @observable protected readOnly: boolean;\n\n    protected setElementValue(value:any) {this.select.value = value}\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\n        this.setDataValue(evt.target.value);\n    }\n\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\n\n    render() {\n        if (this.readOnly === true) {\n            let option = this.ui.list.find(v => v.value === this.value);\n            let title = (option === undefined)? '(???)' : option.title;\n            return <span className=\"form-control w-min-6c\">{title}</span>;\n        }\n        return <select\n            ref={(select)=>this.select = select}\n            className={classNames(this.className, 'form-control')}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}>\n            {this.ui.list.map((v,index) => {\n                let {title, value} = v;\n                let cn:string;\n                //if (value === undefined || value === null) cn = 'text-light small';\n                //else cn = 'text-danger';\n                return <option className={cn} key={index} value={value}>{title || value}</option>\n            })}\n        </select>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n//import { TextWidget } from './textWidget';\nimport { Widget } from './widget';\nimport { UiRadio } from '../../schema';\nimport { RowContext } from '../context';\n\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class RadioWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiRadio {return this._ui as UiRadio};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n    }\n\n    /*\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n    */\n\n    render() {\n        let {defaultValue, list} = this.ui;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n        return <span className={cn} style={radioStyle}>\n                {list.map((v,index) => {\n                    let {value, title} = v;\n                    let name = this.name;\n                    if (rowKey !== undefined) name += '-' + rowKey;\n                    return <label key={index} className=\"form-radio-inline\">\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\n                            onChange={this.onInputChange} />\n                        {title || value}\n                    </label>;\n                    //</span>\n                })}\n            </span>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiRange } from '../../schema';\nimport { Widget } from './widget';\n\nexport class RangeWidget extends Widget {\n    protected inputType = 'range';\n    protected input: HTMLInputElement;\n    protected get ui(): UiRange {return this._ui as UiRange};\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    render() {\n        let {min, max, step} = this.ui;\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\n            type={this.inputType}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}\n            max={max}\n            min={min}\n            step={step}\n            />\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiIdItem, TempletType } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class IdWidget extends Widget {\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\n    @observable protected value:number;\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}    \n\n    protected onClick = async () => {\n        let pickId = this.ui && this.ui.pickId;\n        if (pickId === undefined) {\n            alert('no pickId defined!');\n            return;\n        }\n        let id = await pickId(this.context, this.name, this.value);        \n        this.setDataValue(id);\n        this.clearError();\n        this.clearContextError();\n        this.checkRules();\n    }\n\n    render() {\n        let placeholder:string|JSX.Element, Templet: TempletType;\n        if (this.ui !== undefined) {\n            placeholder = this.ui.placeholder;\n            Templet = this.ui.Templet;\n        }\n        let cn:any = {\n            'form-control': true,\n            'required-item': this.itemSchema.required === true,\n            'cursor-pointer': true,\n            'is-invalid': this.hasError,\n        };\n        let content;\n        if (this.value === undefined || this.value === null) {\n            content = placeholder || <small className=\"text-muted\">[无]</small>;\n            cn['text-muted'] = true;\n        }\n        else if (Templet === undefined) {\n            let c: any;\n            if (this.value === null) {\n                c = 'null';\n            }\n            else {\n                switch (typeof this.value) {\n                    case 'undefined': c = <small className=\"text-muted\">[无]</small>; break;\n                    case 'object': c = (this.value as any).id; break;\n                    default: c = this.value; break;\n                }\n            }\n            content = <>{c}</>;\n        }\n        else if (typeof Templet === 'function') {\n            content = Templet(this.value);\n        }\n        else {\n            content = Templet;\n        }\n        return <>\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport { DataType } from '../../schema';\nimport { UiType } from '../../schema';\n\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\n};\n","import * as React from 'react';\nimport { UiButton, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { Widget } from './widget';\nimport { observer } from 'mobx-react';\n\nexport class ButtonWidget extends Widget {\n    protected get ui(): UiButton {return this._ui as UiButton};\n\n    protected onClick = async () => {\n        this.clearError();\n        this.clearContextError();\n        let {name, type} = this.itemSchema;\n        if (type === 'submit') {\n            await this.context.submit(name);\n        }\n        /*\n        let {onButtonClick} = this.context.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${name} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(name, this.context);\n        if (ret === undefined) return;\n        this.context.setError(name, ret);\n        */\n    }\n\n    private observerRender = observer(() => {\n        let {name, type} = this.itemSchema;\n        let Templet:TempletType, cn:string, caption:string;\n        if (this.ui !== undefined) {\n            let {widget:widgetType} = this.ui;\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\n            Templet = this.ui.Templet;\n            cn = this.ui.className;\n            caption = this.ui.label;\n        }\n        let {form, hasError} = this.context;\n        let context = this.context;\n        let disabled = type==='submit' && hasError;\n        let content:any;\n        if (this.children !== undefined) content = this.children;\n        else if (typeof Templet === 'function') content = Templet();\n        else if (Templet !== undefined) content = Templet;\n        else content = caption; \n        let button = <button \n            className={cn} \n            type=\"button\"\n            disabled={disabled}\n            onClick={this.onClick}>\n            {content || name}\n        </button>;\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\n        return <div className={form.ButtonClass}>\n            <div>{this.renderErrors()}</div>\n            {button}\n        </div>;\n    });\n    \n    protected get label():string {return null}\n\n    render() {\n        return <this.observerRender />\n    }\n}\n","import * as React from 'react';\nimport { Form } from './form';\nimport { UiSchema, UiArr, UiItem } from '../schema';\nimport { ArrSchema, ItemSchema } from '../schema';\nimport { Widget } from './widgets/widget';\n//import { ArrRow } from './arrRow';\nimport { observable, computed } from 'mobx';\nimport { ContextRule } from './rules';\nimport { observer } from 'mobx-react';\n\nexport abstract class Context {\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\n    readonly form: Form;\n    readonly uiSchema: UiSchema;\n    readonly initData: any;\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\n    readonly widgets: {[name:string]: Widget} = {};\n    readonly rules: ContextRule[];\n    readonly isRow: boolean;\n    @observable errors: string[] = [];\n    @observable errorWidgets:Widget[] = [];\n\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\n        this.form = form;\n        this.uiSchema = uiSchema;\n        this.initData = data;\n        this.inNode = inNode;\n        this.isRow = isRow;\n        if (uiSchema !== undefined) {\n            let {rules} = uiSchema;\n            if (rules !== undefined) {\n                this.rules = [];\n                if (Array.isArray(rules) === false)\n                    this.rules.push(rules as ContextRule);\n                else\n                    this.rules.push(...rules as ContextRule[]);\n            }\n        }\n    }\n\n    getArrRowContexts(arrName: string) {\n        if (this.subContexts === undefined) this.subContexts = {};\n        let arrRowContexts = this.subContexts[arrName];\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\n        return arrRowContexts;\n    }\n\n    abstract get data():any;\n    abstract getItemSchema(itemName:string):ItemSchema;\n    abstract getUiItem(itemName:string):UiItem;\n    get arrName():string {return undefined}\n    getValue(itemName:string):any {return this.initData[itemName]}\n    setValue(itemName:string, value:any) {\n        this.initData[itemName] = value;\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setValue(value);\n    }\n    getDisabled(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) return widget.getDisabled();\n        return undefined;\n    }\n    setDisabled(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setDisabled(value);\n    }\n    getReadOnly(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getReadOnly();\n        return undefined;\n    }\n    setReadOnly(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setReadOnly(value);\n    }\n    getVisible(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getVisible();\n        return undefined;\n    }\n    setVisible(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setVisible(value);\n    }\n\n    async submit(buttonName: string) {\n        this.checkRules()\n        if (this.hasError === true) {\n            let err = '';\n            for (let ew of this.errorWidgets) {\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\n            }\n            console.error(err);\n            return;\n        }\n        let {onButtonClick} = this.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this);\n        if (ret === undefined) return;\n        this.setError(buttonName, ret);\n\n    }\n\n    checkFieldRules() {\n        for (let i in this.widgets) {\n            this.widgets[i].checkRules();\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                arrRowContexts[j].checkFieldRules();\n            }\n        }\n    }\n\n    checkContextRules() {\n        this.clearErrors();\n        if (this.rules === undefined) return;\n        for (let rule of this.rules) {\n            let ret = rule(this);\n            if (ret === undefined) continue;\n            if (Array.isArray(ret) === true) {\n                this.errors.push(...ret as string[]);\n            }\n            else if (typeof ret === 'string') {\n                this.errors.push(ret as string);\n            }\n            else {\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\n            }\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                let rowContext = arrRowContexts[j];\n                rowContext.clearErrors();\n                rowContext.checkContextRules();\n            }\n        }\n    }\n\n    setError(itemName:string, error:string) {\n        let widget = this.widgets[itemName];\n        if (widget === undefined) return;\n        widget.setContextError(error);\n        this.addErrorWidget(widget);\n    }\n\n    clearContextErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearContextError();\n        }\n    }\n\n    clearWidgetsErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearError();\n        }\n    }\n\n    checkRules() {\n        this.clearErrors();\n        this.clearWidgetsErrors();\n        this.checkFieldRules();\n        if (this.hasError === true) return;\n        this.checkContextRules();\n    }\n\n    addErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos < 0) this.errorWidgets.push(widget);\n    }\n    removeErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\n    }\n\n    protected checkHasError():boolean {\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\n        if (ret === true) return true;\n        if (this.subContexts === undefined) return false;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                if (arrRowContexts[j].hasError === true) return true;\n            }\n        }\n        return false;\n    }\n\n    @computed get hasError():boolean {\n        return this.checkHasError();\n    };\n\n    clearErrors() {\n        this.errors.splice(0);\n        this.errorWidgets.splice(0);\n        this.clearContextErrors();\n    }\n\n    renderErrors = observer((): JSX.Element => {\n        let {errors} = this;\n        if (errors.length === 0) return null;\n        return <>\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\n            </span>)}\n        </>\n    });\n}\n\nlet rowKeySeed:number = 1;\nexport class RowContext extends Context {\n    readonly parentContext: Context;\n    readonly arrSchema: ArrSchema;\n    readonly rowKey: number;\n\treadonly data: any;\n    //readonly uiSchema: UiArr;\n\t\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\n        let uiArr:UiArr;\n        let {uiSchema} = parentContext;\n        if (uiSchema !== undefined) {\n            let {items} = uiSchema;\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\n        }\n        super(parentContext.form, uiArr, data, inNode, true);\n        this.parentContext = parentContext;\n        this.arrSchema = arrSchema;\n        this.rowKey = rowKeySeed++;\n        this.data = data;\n    }\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        if (this.uiSchema === undefined) return undefined;\n        let {items} = this.uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName]\n    }\n    get arrName():string {return this.arrSchema.name}\n    clearErrors() {\n        super.clearErrors();\n        this.parentContext.clearErrors();\n    }\n\n    get parentData():any {return this.parentContext.data;}\n}\n\nexport class FormContext extends Context {\n    constructor(form:Form, inNode:boolean) {\n        super(form, form.uiSchema, form.data, inNode, false);\n    }\n    get data():any {return this.form.data}\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        let {uiSchema} = this.form;\n        if (uiSchema === undefined) return undefined;\n        let {items} = uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName];\n    }\n}\n\nexport const ContextContainer = React.createContext<Context>({} as any);\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\n//import { ArrRow } from '../arrRow';\nimport { Context, RowContext, ContextContainer } from '../context';\nimport { ArrSchema } from '../../schema';\nimport { UiArr, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { factory } from './factory';\n\nexport const ArrComponent = observer((\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \n{\n    let {name, arr} = arrSchema;\n    let data = parentContext.initData[name] as any[];\n    let {form} = parentContext;\n    let arrRowContexts = parentContext.getArrRowContexts(name);\n    let ui = parentContext.getUiItem(name) as UiArr;\n    let arrLabel = name;\n    let Templet:TempletType;\n    let selectable:boolean, deletable:boolean, restorable:boolean;\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\n    if (uiSchema !== undefined) {\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\n        if (selectable !== true) selectable = formSelectable;\n        if (deletable !== true) deletable = formDeletable;\n        if (restorable !== true) restorable = formRestorable;\n    }\n    if (ui !== undefined) {\n        let {widget:widgetType, label, \n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\n        } = ui;\n        if (arrSelectable !== undefined) selectable = arrSelectable;\n        if (arrDeletable !== undefined) deletable = arrDeletable;\n        if (arrRestorable !== undefined) restorable = arrRestorable;\n        if (ac !== undefined) ArrContainer = ac;\n        if (rc !== undefined) RowContainer = rc;\n        if (rs !== undefined) RowSeperator = rs;\n        Templet = ui.Templet;\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\n        arrLabel = label || arrLabel;\n    }\n    let first = true;\n    return ArrContainer(arrLabel, <>\n        {data.map((row:any, index) => {\n            let rowContext: RowContext;\n            let rowContent: JSX.Element;\n            let sep = undefined;\n            if (first === false) sep = RowSeperator;\n            else first = false;\n            if (children !== undefined) {\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\n                rowContent = <>{children}</>;\n            }\n            else {\n                let typeofTemplet = typeof Templet;\n                if (typeofTemplet === 'function') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\n                }\n                else if (typeofTemplet === 'object') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = Templet as JSX.Element;\n                }\n                else {\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\n                    rowContent = <>{\n                        arr.map((v, index) => {\n                            return <React.Fragment key={v.name}>\n                                {factory(rowContext, v, undefined)}\n                            </React.Fragment>\n                        })}\n                    </>;\n                }\n            }\n            let {rowKey} = rowContext;\n            arrRowContexts[rowKey] = rowContext;\n\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\n            if (selectable === true) {\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\n                    let {checked} = (evt.target as HTMLInputElement);\n                    row.$isSelected = checked;\n                    let {$source} = row;\n                    if ($source !== undefined) $source.$isSelected = checked;\n                    rowContext.clearErrors();\n                }\n                selectCheck = <div className=\"form-row-checkbox\">\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\n                </div>;\n            }\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\n            if (deletable === true) {\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\n                let onDelClick = () => {\n                    if (restorable === true) {\n                        row.$isDeleted = !isDeleted;\n                        let {$source} = row;\n                        if ($source !== undefined) $source.$isDeleted = !isDeleted;\n                    }\n                    else {\n                        let p = data.indexOf(row);\n                        if (p>=0) data.splice(p, 1);\n                    }\n                    rowContext.clearErrors();\n                }\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\n                    <i className={classNames('fa', icon, 'fa-fw')} />\n                </div>;\n            }\n            let editContainer = selectable===true || deletable===true?\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\n                    {selectCheck}\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\n                    {deleteIcon}\n                </div></fieldset>\n                :\n                (content:any) => content;\n\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\n                {sep}\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\n            </ContextContainer.Provider>;\n        })}\n    </>);\n});\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiImageItem } from '../../schema';\nimport { Image } from '../../image';\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\n\nexport class ImageWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\n    @observable private imageSrc: string;\n\n    init() {\n        super.init();\n        this.imageSrc = this.value;\n    }\n\n    protected onClick = async () => {\n        let edit = new ImageItemEdit(this.itemSchema, this.ui, this.ui.label, this.value);\n        let ret = await edit.start();\n        if (ret !== null) {\n            this.setValue(ret);\n            this.imageSrc = ret;\n        }\n        await edit.end();\n    }\n\n    render() {\n        return <this.observerRender />;\n    }\n\n    private observerRender = observer(() => {\n        let cn = [\n            'bg-white p-1 d-flex justify-content-center',\n        ];\n        let onClick: any;\n        if (!this.readOnly && !this.disabled) {\n            cn.push('cursor-pointer');\n            onClick = this.onClick;\n        }\n        return <div className={classNames(cn)} onClick={onClick}>\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\n        </div>;\n    });\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\nimport { RowContext } from '../context';\n\nabstract class TagWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiTag {return this._ui as UiTag};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n\t}\n\t\n\tabstract render():JSX.Element;\n}\n\nexport class TagSingleWidget extends TagWidget {\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n\t\tlet name = this.name;\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputName: name,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\n    }\n}\n\nexport class TagMultiWidget extends TagWidget {\n\tprivate defaultArr:number[];\n\tinit() {\n\t\tsuper.init();\n\t\tlet def = this.defaultValue;\n\t\tswitch (typeof def) {\n\t\t\tdefault:\n\t\t\t\tthis.defaultArr = [];\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\n\t\t\t\tbreak;\n\t\t}\n\t}\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.changeValue(values.join('|'), true);\n\t}\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let cn = classNames(this.className, 'py-0');\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputs: this.inputs,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\n    }\n}\n","import * as React from 'react';\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\nimport { TypeWidget, UiCustom } from '../../schema';\nimport { TextWidget } from './textWidget';\nimport { TextAreaWidget } from './textareaWidget';\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\nimport { UpdownWidget } from './updownWidget';\nimport { NumberWidget } from './numberWidget';\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\nimport { CheckBoxWidget } from './checkBoxWidget';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { SelectWidget } from './selectWidget';\nimport { RadioWidget } from './radioWidget';\nimport { RangeWidget } from './rangeWidget';\nimport { IdWidget } from './idWidget';\nimport { ButtonWidget } from './buttonWidget';\nimport { ArrComponent } from './arrComponent';\nimport { ImageWidget } from './imageWidget';\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\n\nconst widgetsFactory: {[type: string]: {widget?: TypeWidget, dataTypes?: DataType[]}} = {\n    id: {\n        dataTypes: ['id'],\n        widget: IdWidget,\n    },\n    text: {\n        dataTypes: ['integer', 'number', 'string'],\n        widget: TextWidget\n    },\n    textarea: {\n        dataTypes: ['string'],\n        widget: TextAreaWidget\n    },\n    password: {\n        dataTypes: ['string'],\n        widget: PasswordWidget\n    },\n    date: {\n        dataTypes: ['date'],\n        widget: DateWidget\n    },\n    datetime: {\n        dataTypes: ['date'],\n        widget: DateTimeWidget\n    },\n    time: {\n        dataTypes: ['date'],\n        widget: TimeWidget\n    },\n    month: {\n        dataTypes: ['date'],\n        widget: MonthWidget\n    },\n    select: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: SelectWidget\n    },\n    url: {\n        dataTypes: ['string'],\n        widget: UrlWidget\n    },\n    email: {\n        dataTypes: ['string'],\n        widget: EmailWidget\n    },\n    number: {\n        dataTypes: ['integer', 'number'],\n        widget: NumberWidget\n    },\n    updown: {\n        dataTypes: ['integer', 'number'],\n        widget: UpdownWidget\n    },\n    color: {\n\n    },\n    checkbox: {\n        dataTypes: ['boolean', 'integer', 'number'],\n        widget: CheckBoxWidget\n    },\n    image: {\n        dataTypes: ['string'],\n        widget: ImageWidget,\n    },\n    checkboxes: {\n\n    },\n    radio: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: RadioWidget\n\t},\n\ttagSingle: {\n\t\tdataTypes: ['integer'],\n\t\twidget: TagSingleWidget\n\t},\n\ttagMulti: {\n\t\tdataTypes: ['string'],\n\t\twidget: TagMultiWidget\n\t},\n    range: {\n        dataTypes: ['integer'],\n        widget: RangeWidget,\n    },\n    button: {\n        dataTypes: ['button', 'submit'],\n        widget: ButtonWidget,\n    }\n}\n\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\n    if (context === undefined) {\n        debugger;\n        return null;\n    }\n    if (itemSchema === undefined) return undefined;\n    let {name, type} = itemSchema;\n    switch (type) {\n    case 'arr':\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\n    default:\n        break;\n    }\n\n    let typeWidget: TypeWidget;\n    let ui = context.getUiItem(name);\n    function getTypeWidget(t:DataType): TypeWidget {\n        switch(t) {\n        default: return TextWidget; \n        case 'id': return IdWidget;\n        case 'integer': return UpdownWidget;\n        case 'number': return NumberWidget; \n        case 'string': return TextWidget; \n        case 'date': return DateWidget; \n        case 'boolean': return CheckBoxWidget; \n        case 'button':\n        case 'submit': return ButtonWidget;\n        }\n    }\n    if (ui === undefined) { \n        typeWidget = getTypeWidget(type);\n    }\n    else {\n        let {widget:widgetType} = ui;\n        switch (widgetType) {\n        default:\n            if (widgetType !== undefined) {\n                let widgetFactory = widgetsFactory[widgetType];\n                typeWidget = widgetFactory.widget;\n            }\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\n            break;\n        case 'custom':\n            typeWidget = (ui as UiCustom).WidgetClass;\n            break;\n        case 'group':\n            return <span>impletment group</span>;\n        }\n        //label = uiLabel || name;\n    }\n    \n    let {widgets} = context;\n    let widget = new typeWidget(context, itemSchema, fieldProps, children);\n    widget.init();\n    widgets[name] = widget;\n\n    return <widget.container />;\n    /*\n    if (isRow === false) {\n        let WidgetElement = observer(() => widget.container());\n        return <WidgetElement />;\n    }\n    else {\n        let widgetElement = widget.container();\n        return widgetElement;\n    }\n    */\n}\n\n","import * as React from 'react';\nimport {observable, IReactionDisposer, autorun} from 'mobx';\nimport classNames from 'classnames';\nimport { Schema, ItemSchema, ArrSchema } from '../schema';\nimport { UiSchema, TempletType } from '../schema';\nimport { factory } from './widgets';\nimport 'font-awesome/css/font-awesome.min.css';\nimport { ContextContainer, FormContext, Context } from './context';\nimport { FormRes, formRes } from '../../res';\nimport { resLang } from '../../res/res';\n\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\n\nexport interface FormProps {\n    className?: string;\n    schema: Schema;\n    uiSchema?: UiSchema;\n    formData?: any;\n    onButtonClick?: FormButtonClick;\n    onEnter?: InputEnter;\n    fieldLabelSize?: number;            // col-sm-2 for label\n    requiredFlag?: boolean;             // default=true\n    beforeShow?: (formContext:FormContext) => void;\n    res?: FormRes;\n\n    Container?: (content:JSX.Element) => JSX.Element;\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\n    FieldClass?: string;\n    ButtonClass?: string;\n}\n\nexport class Form extends React.Component<FormProps> {\n    readonly schema: Schema;\n    readonly itemSchemas: {[name:string]: ItemSchema};\n    readonly uiSchema: UiSchema;\n    readonly res?: FormRes;\n    protected formContext: FormContext;\n    private disposer: IReactionDisposer;\n    readonly data:any;\n\n    readonly Container: (content:JSX.Element) => JSX.Element;\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\n    readonly FieldClass: string;\n    readonly ButtonClass: string;\n    \n    constructor(props:FormProps) {\n        super(props);\n        let {schema, uiSchema, \n            Container, FieldContainer, FieldClass, \n            ButtonClass, res,\n        } = props;\n        this.Container = Container || this.DefaultContainer;\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\n        this.res = res || this.DefaultRes;\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\n\n        this.schema = schema;\n        this.itemSchemas = {};\n        for (let itemSchema of this.schema) {\n            this.itemSchemas[itemSchema.name] = itemSchema;\n        }\n        this.uiSchema = uiSchema;\n\n        this.disposer = autorun(this.watch);\n        this.data = {};\n    }\n\n    private renderContent():any {\n        this.initData(this.props.formData);\n        let {children} = this.props;\n        if (children !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return <>{children}</>;\n        }\n\n        let Templet: TempletType;\n        if (this.uiSchema !== undefined) {\n            Templet = this.uiSchema.Templet;\n        }\n        if (Templet !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\n        }\n\n        this.formContext = new FormContext(this, false);\n        return <>{this.schema.map((v, index) => {\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\n        })}</>;\n    }\n\n    private initData(formData: any) {\n        if (formData === undefined) formData = {};\n        if (this.uiSchema !== undefined) {\n            let {items} = this.uiSchema;\n            if (items !== undefined) {\n                for (let i in items) {\n                    let ui = items[i];\n                    let dv = ui.defaultValue;\n                    if (dv !== undefined) {\n                        if (formData[i] === undefined) {\n                            formData[i] = dv;\n                        }\n                    }\n                }\n            }\n        }\n        for (let itemSchema of this.schema) {\n            this.initDataItem(itemSchema, this.data, formData);\n        }\n    }\n\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\n        let {name, type} = itemSchema;\n        if (type === 'button') return;\n        if (type !== 'arr') {\n            data[name] = formData[name];\n            return;\n        }\n\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\n        let {arr:arrItems} = arrItem;\n        if (arrItems === undefined) return;\n        let arrDict:any = arrItem.itemSchemas = {};\n        for (let item of arrItems) {\n            arrDict[item.name] = item;\n        }\n        let val:any[] = formData[name];\n        if (val === undefined) val = [];\n        else if (Array.isArray(val) === false) val = [val];\n        let arr:any[] = [];\n        for (let row of val) {\n            let {$isSelected, $isDeleted} = row;\n            let r = {\n                $source: row,\n                $isSelected: $isSelected,\n                $isDeleted: $isDeleted,\n            };\n            for (let item of arrItems) {\n                this.initDataItem(item, r, row);\n            }\n            arr.push(r);\n        }\n        // 如果没有observable，行删除标志点击不管用\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\n        data[name] = observable(arr);\n        //data[name] = arr;\n        return;\n    }\n\n    private watch = () => {\n        let {formData} = this.props;\n        if (formData === undefined) return;\n        //this.initData(formData);\n        this.calcSelectOrDelete();\n    }\n    private calcSelectOrDelete() {\n        for (let itemSchema of this.schema) {\n            this.arrItemOperated(itemSchema);\n        }\n    }\n\n    private arrItemOperated(itemSchema: ItemSchema) {\n        let {name, type} = itemSchema;\n        if (type !== 'arr') return;\n        if (this.data === undefined) return;\n        let formArrVal = this.data[name];\n        if (formArrVal === undefined) return;\n        let {arr: arrItems} = itemSchema as ArrSchema;\n        for (let row of formArrVal) {\n            let {$source} = row;\n            if ($source === undefined) continue;\n            let {$isSelected, $isDeleted} = $source;\n            row.$isSelected = $isSelected;\n            row.$isDeleted = $isDeleted;\n            //console.log($isSelected, $isDeleted);\n            for (let item of arrItems) {\n                this.arrItemOperated(item);\n            }\n        }\n    }\n\n    componentDidMount() {\n        let {beforeShow} = this.props;\n        if (beforeShow !== undefined) beforeShow(this.formContext);\n    }\n\n    componentWillUnmount() {\n        if (this.disposer !== undefined) this.disposer();\n    }\n\n    render() {\n        let content = this.renderContent();\n        return <ContextContainer.Provider value={this.formContext}>\n            <this.formContext.renderErrors />\n            {this.Container(content)}\n        </ContextContainer.Provider>;\n    }\n\n    async buttonClick(buttonName:string) {\n        this.formContext.checkRules()\n        if (this.formContext.hasError === true) return;\n\n        let {onButtonClick} = this.formContext.form.props;\n        if (onButtonClick === undefined) {\n            alert(`you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this.formContext);\n        if (ret === undefined) return;\n        this.formContext.setError(buttonName, ret);\n    }\n\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\n            {content}\n        </form>;\n    }\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\n        let {fieldLabelSize} = this.props;\n\n        if (fieldLabelSize > 0) {\n            let labelView:any;\n            if (label === null) {\n                fieldLabelSize = 0;\n            }\n            else {\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label')}>{label}</label>\n            }\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\n            return <div className=\"form-group row\">\n                {labelView}\n                <div className={fieldCol}>{content}</div>\n            </div>;\n        }\n        return <div className=\"form-group\">\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\n            {content}\n        </div>;\n    }\n    protected DefaultFieldClass:string = undefined;\n    protected DefaultButtonClass = 'text-center py-2';\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\n\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\n        return <div>\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\n            {content}\n        </div>;\n    }\n    RowContainer = (content:JSX.Element): JSX.Element => {\n        let cn = classNames({\n            'py-3': true\n        });\n        return <div className={cn}>{content}</div>\n    }\n    RowSeperator = <div className=\"border border-gray border-top\" />;\n}\n","import * as React from 'react';\nimport { factory } from './widgets';\nimport { ContextContainer, Context } from './context';\n\nexport interface FieldProps {\n    name: string;\n}\n\nexport class FormField extends React.Component<FieldProps> {\n    static contextType = ContextContainer;\n    render() {\n        let {name, children } = this.props;\n        let context:Context = this.context;\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\n        let itemSchema = context.getItemSchema(name);\n        let content = factory(context, itemSchema, children, this.props);\n        if (content === undefined) {\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\n        }\n        return content;\n    }\n}\n","export {Form} from './form';\nexport {FormField} from './field';\nexport {Context, RowContext} from './context';\nexport * from './widgets';\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class StringItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <input type=\"text\" \n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n                    defaultValue={this.value} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiRadio } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class RadioItemEdit extends ItemEdit {\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value: any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {name} = this.itemSchema;\n        let {list} = this.uiItem;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n            }}>保存</button>;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input name={name} type=\"radio\" value={value} \n                        onClick={()=>this.onChange(value)} \n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\n                </label></div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\n\t\t\t</div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiSelect } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class SelectItemEdit extends ItemEdit {\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiIdItem } from '../schema';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class IdItemEdit extends ItemEdit {\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>(async (resolve, reject) => {\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            //nav.push(element,reject);\n\n            let {pickId} = this.uiItem;\n            if (pickId === undefined) {\n                alert('IdItemEdit.pickId = undefined');\n                return;\n            }\n            let boxId = await pickId(undefined, undefined, this.value);\n            //if (typeof id === 'object') {\n            //    id = (id as any).id;\n            //}\n            this.onChange(boxId.id);\n            resolve(boxId);\n            //this.newValue = id;\n        });\n    }\n\n    protected async internalEnd():Promise<void> {}\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        /*\n        let {resolve, reject} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n        */\n        return <Page header={'更改' + this.label}>\n            ddd\n        </Page>\n    })\n}\n","import * as React from 'react';\nimport { UiTag } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nabstract class TagItemEdit extends ItemEdit {\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\n\tprotected inputType: 'checkbox' | 'radio';\n    get uiItem(): UiTag {return this._uiItem as UiTag};\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n\t}\n\t\n\trenderContent() {\n\t\tlet valuesView = this.uiItem.valuesView;\n\t\tif (valuesView === undefined) return super.renderContent();\n\t\treturn valuesView.render(this.value);\n\t}\n\n\tprotected abstract renderInputs():JSX.Element;\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n\t\t\t}}>保存</button>;\n\t\t/*\n        let content = list?\n            list.map((v, index:number) => {\n                let {name:itemName, id} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\n                </label></div>;\n            })\n            :\n\t\t\t<>no list defined</>;\n\t\t*/\n        return <Page header={'更改' + this.label} right={right}>\n\t\t\t<div className=\"p-3\">\n\t\t\t\t{this.renderInputs()}\n\t\t\t</div>\n        </Page>;\n    })\n}\n\nexport class TagSingleItemEdit extends TagItemEdit {\n\tprotected inputType:'radio'|'checkbox' = 'radio';\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {currentTarget} = evt;\n\t\tif (currentTarget.checked === false) return;\n        this.newValue = Number(currentTarget.value);\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\t\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange,\n\t\t};\n\t\treturn valuesView.renderRadios(this.value, options);\n\t}\n}\n\nexport class TagMultiItemEdit extends TagItemEdit {\n\t//private arr:number[];\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\n\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.newValue = values.join('|');\n        //this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange\n\t\t};\n\t\treturn valuesView.renderChecks(this.value, options);\n\t}\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class TextAreaItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\n\t\t\t// if (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <textarea\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n\t\t\t\t\tdefaultValue={this.value}\n\t\t\t\t\trows={6} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\n//import _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\nimport { ItemEdit } from './itemEdit';\nimport { StringItemEdit } from './stringItemEdit';\nimport { ImageItemEdit } from './imageItemEdit';\nimport { RadioItemEdit } from './radioItemEdit';\nimport { SelectItemEdit } from './selectItemEdit';\nimport { IdItemEdit } from './idItemEdit';\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\nimport { TextAreaItemEdit } from './textAreaItemEdit';\n\nexport interface EditProps {\n    className?: string;\n    schema: Schema;\n    data: any;\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\n    stopEdit?: boolean;\n    uiSchema?: UiSchema;\n    sepClassName?: string;\n    topBorderClassName?: string;\n    bottomBorderClassName?: string;\n    rowContainerClassName?: string;\n}\n\n@observer\nexport class Edit extends React.Component<EditProps> {\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\n    private topBorder:JSX.Element;\n    private bottomBorder:JSX.Element;\n    private rowContainerClassName?: string;\n    private sep:JSX.Element;\n\tprivate uiSchema: {[name:string]: UiItem};\n\n    constructor(props: EditProps) {\n        super(props);\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema, stopEdit} = props;\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\n        if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\n    }\n\n    render() {\n        let {schema} = this.props;\n\t\tlet sep:any;\n        return <div>\n\t\t\t{this.topBorder}\n            {schema.map((itemSchema, index) => {\n\t\t\t\tlet {name} = itemSchema;\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\n\t\t\t\tlet label:string, labelHide:any;\n\t\t\t\tif (uiItem !== undefined) {\n\t\t\t\t\tlabel = uiItem.label || name;\n\t\t\t\t\tlabelHide = uiItem.labelHide;\n\t\t\t\t};\n\t\t\t\tlet value = this.props.data[name];\n\t\t\t\tlet itemEdit = createItemEdit(itemSchema, uiItem, label, value);\n\n\t\t\t\tlet {required} = itemSchema;\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\n\t\t\t\tif (labelHide === true) {\n\t\t\t\t\tdivLabel = undefined;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\n\t\t\t\t\tcn += 'justify-content-end';\n\t\t\t\t}\n\t\t\t\tlet ret = <React.Fragment key={index}>\n\t\t\t\t\t{sep}\n\t\t\t\t\t<div className={'d-flex align-items-center' + this.rowContainerClassName} \n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\n\t\t\t\t\t\t{divLabel}\n\t\t\t\t\t\t<div className={cn}>{\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\n\t\t\t\t\t\t}</div>\n\t\t\t\t\t\t{this.props.stopEdit!==true && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\n\t\t\t\t\t</div>\n\t\t\t\t</React.Fragment>;\n\t\t\t\tsep = this.sep;\n\t\t\t\treturn ret;\n\t\t\t})}\n\t\t\t{this.bottomBorder}\n\t\t</div>;\n    }\n\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\n\t\tif (itemEdit === undefined) {\n\t\t\talert('item has no edit');\n\t\t\treturn;\n\t\t}\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\n        if (stopEdit === true) return;\n        let changeValue:any;\n        if (onItemClick !== undefined) {\n            await onItemClick(itemSchema, uiItem, value);\n            return;\n        }\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\n        if (itemEdit === undefined) {\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\n            return;\n        }\n        try {\n            changeValue = await itemEdit.start();\n            if (changeValue !== value) {\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\n                if (onItemChanged === undefined) {\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\n                    //this.props.data[itemSchema.name] = changeValue;\n                }\n                else {\n                    await onItemChanged(itemSchema, changeValue, value);\n                }\n            }\n            await itemEdit.end();\n        }\n        catch (err) {\n            // 如果直接back，会触发reject，就到这里了\n\t\t\tconsole.log('no value changed');\n\t\t\tconsole.error(err);\n        }\n    }\n}\n\ntype NewItemEdit = new (itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) => ItemEdit;\n\nfunction createItemEdit(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any):ItemEdit {\n\tlet ie: ItemEdit;\n    let itemEdit: NewItemEdit;\n    if (uiItem !== undefined) {\n        switch (uiItem.widget) {\n            default: break;\n            case 'id': itemEdit = IdItemEdit; break;\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\n            case 'image': itemEdit = ImageItemEdit; break;\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\n\t\t\tcase 'range': itemEdit = StringItemEdit; break;\n            case 'radio': \n\t\t\t\tie = new RadioItemEdit(itemSchema, uiItem as UiRadio, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagSingle':\n\t\t\t\tie = new TagSingleItemEdit(itemSchema, uiItem as UiTagSingle, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagMulti':\n\t\t\t\tie = new TagMultiItemEdit(itemSchema, uiItem as UiTagMulti, label, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\tif (ie === undefined) {\n\t\tif (itemEdit === undefined) {\n\t\t\tswitch (itemSchema.type) {\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\n\t\t\t}\n\t\t}\n\t\tif (itemEdit === undefined) return;\n\t\tie = new itemEdit(itemSchema, uiItem, label, value);\n\t}\n\tie.init();\n\treturn ie;\n}\n","export * from './edit';\n","import {CenterApiBase} from '../net';\n\nexport class CenterApi extends CenterApiBase {\n    async userAppUnits(app:number):Promise<any[]> {\n        return await this.get('tie/user-app-units', {app:app});\n    };\n    async userFromId(userId:number):Promise<any> {\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\n    }\n}\n\nexport const centerApi = new CenterApi('tv/', undefined);\n","import * as React from 'react';\nimport { Page, FA, nav, LMR, List } from \"../components\";\nimport { VPage } from '../vm';\nimport { appInFrame } from '../net';\nimport { CAppBase } from \"./CAppBase\";\n\n/*\nexport class VAppMain extends VPage<CMainBase> {\n    async open(param?:any) {\n        this.openPage(this.appPage);\n    }\n\n    render(param?:any) {\n        return this.appContent();\n    }\n\n    protected appPage = () => {\n        let {caption} = this.controller;\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\n            {this.appContent()}\n        </Page>;\n    }\n\n    protected appContent = () => {\n        let {cUqArr} = this.controller;\n        let content:any;\n        if (cUqArr.length === 0) {\n            content = <div className=\"text-danger\">\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\n            </div>;\n        }\n        else {\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\n        }\n        return <>{content}</>;\n    };\n}\n*/\nexport class VUnsupportedUnit extends VPage<CAppBase> {\n    async open(predefinedUnit: number) {\n        this.openPage(this.page, {predefinedUnit:predefinedUnit});\n    }\n\n    private page = ({predefinedUnit}:{predefinedUnit: number}) => {\n        let {user} = nav;\n        let userName:string = user? user.name : '[未登录]';\n        let {appOwner, appName} = this.controller.uqsMan;\n        return <Page header=\"APP无法运行\" logout={true}>\n            <div className=\"m-3 text-danger container\">\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\n                    <div className=\"col-sm text-body\">{userName}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">App</div>\n                    <div className=\"col-sm text-body\">{`${appOwner}/${appName}`}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">\n                        可能原因<FA name=\"exclamation-triangle\" />\n                    </div>\n                    <div className=\"col-sm text-body\">\n                        <ul className=\"p-0\">\n                            <li>没有小号运行 {appName}</li>\n                            <li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\n                            {\n                                predefinedUnit && \n                                <li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\n                            }\n                        </ul>\n                    </div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\n                    <div className=\"col-sm text-body\">\n                        预设小号定义在 public/unit.json 文件中。\n                        定义了这个文件的程序，只能由url直接启动。\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\n                        如果要删去缓存的预定义Unit，logout然后再login。\n                    </div>\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\nexport class VUnitSelect extends VPage<CAppBase> {\n    async open() {\n        this.openPage(this.page);\n    }\n\n    private renderRow = (item: any, index: number):JSX.Element => {\n        let {id, nick, name} = item;\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\n            <div>{nick || name}</div>\n        </LMR>;\n    }\n    private onRowClick = async (item: any) => {\n        appInFrame.unit = item.id; // 25;\n        await this.controller.start();\n    }\n\n    private page = () => {\n        return <Page header=\"选择小号\" logout={true}>\n            <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\n        </Page>\n    }\n}\n\nexport class VErrorsPage extends VPage<CAppBase> {\n    async open(errors:string[]) {\n        this.openPage(this.page, {errors:errors});\n    }\n\n    private page = (errors:{errors:string[]}) => {\n        return <Page header=\"ERROR\">\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\n\t\t\t\t</div>\n\n                <div>Load Uqs 发生错误：</div>\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\n            </div>\n        </Page>;\n    }\n}\n\nexport class VStartError extends VPage<CAppBase> {\n    async open(error:any) {\n        this.openPage(this.page, {error:error});\n    }\n\n    private page = ({error}:{error:any}) => {\n        return <Page header=\"App start error!\">\n            <pre>\n                {typeof error === 'string'? error : error.message}\n            </pre>\n        </Page>;\n    }\n}","import { nav, t, setGlobalRes } from \"../components\";\nimport { Controller } from '../vm';\nimport { UQsMan, TVs } from \"../uq\";\nimport { appInFrame, loadAppUqs, UqAppData } from \"../net\";\nimport { centerApi } from \"./centerApi\";\nimport { VUnitSelect, VErrorsPage, VStartError, VUnsupportedUnit } from \"./vMain\";\n\nexport interface IConstructor<T> {\n    new (...args: any[]): T;\n}\n\nexport interface AppConfig {\n    appName: string;        // 格式: owner/appName\n    version: string;        // 版本变化，缓存的uqs才会重载\n    tvs: TVs;\n    uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\n    loginTop?: JSX.Element;\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\n\tprivacy?: string;\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\n}\n\nexport interface Elements {\n\t[id:string]: (element: HTMLElement)=>void,\n}\n\nexport abstract class CAppBase extends Controller {\n    protected _uqs: any;\n\n    protected readonly name: string;\n\tprotected readonly version: string;\n\tprotected readonly noUnit: boolean;\n\n    readonly uqsMan: UQsMan;\n    appUnits:any[];\n\n    // appName: owner/name\n    constructor(config: AppConfig) {\n        super(undefined);\n        let {appName, version, tvs, noUnit} = config;\n        this.name = appName;\n        if (appName === undefined) {\n            throw new Error('appName like \"owner/app\" must be defined in MainConfig');\n        }\n\t\tthis.version = version;\n\t\tthis.noUnit = noUnit;\n        this.uqsMan = new UQsMan(this.name, tvs);\n    }\n\n    get uqs(): any {return this._uqs;}\n\n\tinternalT(str:string):any {\n\t\treturn t(str);\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tsetGlobalRes(res);\n\t}\n\t\n\tprotected hookElements(elements: Elements) {\n\t\tif (elements === undefined) return;\n\t\t//nav.setSettings(appConfig);\n\t\t//let cApp:CApp = (await start(CApp, appConfig)) as CApp;\n\t\tfor (let i in elements) {\n\t\t\tlet el = document.getElementById(i);\n\t\t\tif (el) {\n\t\t\t\telements[i](el);\n\t\t\t}\n\t\t}\n\t};\n\t\n    protected async beforeStart():Promise<boolean> {\n        try {\n            let retErrors = await this.load();\n            //let app = await loadAppUqs(this.appOwner, this.appName);\n            // if (isDevelopment === true) {\n            // 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\n            let {predefinedUnit} = appInFrame;\n            let {user} = nav;\n            if (user !== undefined && user.id > 0) {\n\t\t\t\tthis.appUnits = await centerApi.userAppUnits(this.uqsMan.id);\n\t\t\t\tif (this.noUnit === true) return true;\n                switch (this.appUnits.length) {\n                    case 0:\n                        this.showUnsupport(predefinedUnit);\n\t\t\t\t\t\treturn false;\n                    case 1:\n                        let appUnit = this.appUnits[0].id;\n                        if (appUnit === undefined || appUnit < 0 || \n                            (predefinedUnit !== undefined && appUnit !== predefinedUnit))\n                        {\n                            this.showUnsupport(predefinedUnit);\n                            return false;\n                        }\n                        appInFrame.unit = appUnit;\n                        break;\n                    default:\n                        if (predefinedUnit>0 && this.appUnits.find(v => v.id===predefinedUnit) !== undefined) {\n                            appInFrame.unit = predefinedUnit;\n                            break;\n                        }\n                        this.openVPage(VUnitSelect);\n                        return false;\n                }\n            }\n            if (retErrors !== undefined) {\n                this.openVPage(VErrorsPage, retErrors);\n                return false;\n            }\n            return true;\n        }\n        catch (err) {\n            this.openVPage(VStartError, err);\n            return false;\n        }\n    }\n\n    async userFromId(userId:number):Promise<any> {\n        return await centerApi.userFromId(userId);\n    }\n\n    private async load(): Promise<string[]> {\n        let {appOwner, appName} = this.uqsMan;\n        let {localData} = this.uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== this.version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = this.version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        this.uqsMan.id = id;\n        await this.uqsMan.init(uqs);\n        let retErrors = await this.uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...this.uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                this._uqs = this.uqsMan.buildUQs();\n                return;\n            }\n        }\n        return retErrors;\n    }\n\n    private showUnsupport(predefinedUnit: number) {\n        nav.clear();\n        this.openVPage(VUnsupportedUnit, predefinedUnit);\n    }\n}\n","import { AppConfig, CAppBase } from './CAppBase';\n\nexport async function start(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig) {\n    let html = document.getElementsByTagName('html');\n    let version = html[0].getAttribute('data-version');\n    if (version) appConfig.version = version;\n    let cApp = new CApp(appConfig);\n    await cApp.start();\n}\n","import { Controller } from \"../vm\";\nimport { IConstructor } from \"./CAppBase\";\n\nexport abstract class CBase extends Controller {\n    protected readonly _uqs: any;\n    protected readonly _cApp: any;\n\n    constructor(cApp: any) {\n        super(undefined);\n        this._cApp = cApp;\n        this._uqs = cApp && cApp.uqs;\n\t}\n\n    protected get uqs(): any {return this._uqs}\n\tget cApp(): any {return this._cApp}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._cApp.internalT(str);\n\t}\n\n    protected newC<T extends CBase>(type: IConstructor<T>, param?:any):T {\n\t\tlet c = new type(this.cApp);\n\t\tc.init(param);\n\t\treturn c;\n    }\n\n    protected newSub<O extends CBase, T extends CSub<O>>(type: IConstructor<T>):T {\n        return new type(this);\n    }\n}\n\nexport abstract class CSub<T extends CBase> extends CBase {\n    protected _owner: T;\n\n    constructor(owner: T) {\n        super(owner.cApp);\n        this._owner = owner;\n\t}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._owner.internalT(str);\n\t}\n\n    protected get owner(): CBase {return this._owner}\n}\n","export * from './CAppBase';\nexport * from './start';\nexport * from './CBase';\n","import * as React from 'react';\nimport { IObservableArray, computed } from 'mobx';\nimport { PageItems } from '../../tool/pageItems';\nimport {List} from './index';\n\nexport abstract class ListBase {\n    protected list: List;\n    constructor(list: List) {\n        this.list = list;\n    }\n    get isPaged():boolean {\n        let items = this.list.props.items;\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\n    }\n    get items():any[]|IObservableArray<any> {\n        let items = this.list.props.items;\n        if (items === null) return null;\n        if (items === undefined) return undefined;\n        if (Array.isArray(items) === true)\n            return items as IObservableArray<any>;\n        else\n            return (items as PageItems<any>).items;\n    }\n    @computed get loading():boolean {\n        let items = this.list.props.items;\n        if (items === null) return false;\n        if (items === undefined) return true;\n        let pageItems = items as PageItems<any>;\n        if (pageItems.items === undefined) return false;\n        return pageItems.loading;\n    }\n    get selectedItems():any[] { return undefined; }\n    //updateProps(nextProps:any) {}\n    dispose() {};\n    abstract render: (item:any, index:number) => JSX.Element;\n    protected renderContent(item:any, index:number) {\n        let {render} = this.list.props.item;\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\n        return render(item, index);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\n\nexport class Clickable extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key, onClick} = this.list.props.item;\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { ListBase } from './base';\nimport { uid } from '../../tool/uid';\n\nexport class Static extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key} = this.list.props.item;\n        if (typeof item === 'string') {\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\n            return <li key={uid()} className={cn}>{item}</li>;\n        }\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport {observable, IObservableArray, isObservableArray, observe} from 'mobx';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\nimport {uid} from '../../tool/uid';\nimport { PageItems } from '../../tool/pageItems';\nimport { List } from './index';\nimport { observer } from 'mobx-react';\n\nexport interface SelectableItem {\n    selected: boolean;\n    item: any;\n    labelId: string;\n}\n\nexport class Selectable extends ListBase {\n    @observable private _items: SelectableItem[];\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\n\n    constructor(list: List) {\n        super(list);\n        this.buildItems();\n        this.listenArraySplice();\n    }    \n\n    private listenArraySplice() {\n        let {items} = this.list.props;\n        if (items === undefined) return;\n        if (items === null) return;\n        let itemsArray:any;\n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        if (isObservableArray(items) === true) {\n            observe(itemsArray as IObservableArray<any>, (change) => {                \n                if (change.type === 'splice') {\n                    let {index, removedCount, added} = change;\n                    let _added = added && added.map(v => {\n                        return {\n                            selected: false, \n                            item: v, \n                            labelId:uid()\n                        }\n                    });\n                    this._items.splice(index, removedCount, ..._added);\n                    this.buildItems();\n                }\n            }, true);\n        }\n    }\n\n    private buildItems = () => {\n        let {items, selectedItems, compare} = this.list.props;\n        let itemsArray:any[] | IObservableArray<any>;\n        if (items === undefined) {\n            this._items = undefined;\n            return;\n        }\n        if (items === null) {\n            this._items = null;\n            return;\n        }\n        \n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        //let items = this.items;\n        //this._selectedItems = selectedItems;\n\n        let comp: ((item:any, selectItem:any)=>boolean);\n        if (compare === undefined) {\n            comp = (item:any, selectItem:any) => item === selectItem;\n        }\n        else {\n            comp = compare;\n        }\n        let retItems = itemsArray.map(v => {\n            //let isObserved = isObservable(v);\n            //let obj = isObserved === true? toJS(v) : v;\n            //let obj = v;\n            let selected = selectedItems === undefined?\n                false\n                : selectedItems.find(si => comp(v, si)) !== undefined;\n            return {\n                selected: selected, \n                item: v, \n                labelId:uid()\n            };\n        });\n        this._items = retItems;\n    }\n\n    get items() {\n        //if (this._items === undefined) \n        //this.buildItems();\n        return this._items;\n    }\n    private checkAll(on: boolean) {\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\n        for (let item of this._items) item.selected = on;\n    }\n    selectAll() {\n        //if (this._items) this._items.forEach(v => v.selected = true);\n        this.checkAll(true);\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\n    }\n    unselectAll() {\n        // if (this._items) this._items.forEach(v => v.selected = false);\n        this.checkAll(false);\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\n    }\n    /*\n    updateProps(nextProps:any) {\n        if (nextProps.selectedItems === this._selectedItems) return;\n        this.buildItems();\n    }\n    */\n    private get anySelected():boolean {return this._items.some(v => v.selected)}\n    private onSelect(item:SelectableItem, selected:boolean) {\n        item.selected = selected;\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\n    }\n    \n    get selectedItems():any[] {\n        return this._items.filter(v => v.selected === true).map(v => v.item);\n    }\n    /*\n    set selectedItems(value: any[]) {\n        if (value === undefined) return;\n        if (this._items === undefined) return;\n        let sLen = this._items.length;\n        let list = value.slice();\n        for (let n=0; n<sLen; n++) {\n            let sItem = this._items[n];\n            let len = list.length;\n            if (len === 0) break;\n            let item = sItem.item;\n            for (let i=0; i<len; i++) {\n                let v = list[i];\n                if (item === v) {\n                    sItem.selected = true;\n                    value.splice(i, 1);\n                    break;\n                }\n            }\n        };\n    }\n    */\n    //w-100 mb-0 pl-3\n    //m-0 w-100\n    render = (item:SelectableItem, index:number):JSX.Element => {\n        let {key} = this.list.props.item;\n        return <this.row item={item} index={index} key={key===undefined?index:key(item)} />;\n    }\n\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\n        let {item, index} = props;\n        let {className} = this.list.props.item;\n        let {labelId, selected, item:obItem} = item;\n        return <li className={classNames(className)}>\n            <div className=\"d-flex align-items-center px-3\">\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\n                    defaultChecked={selected}\n                    onChange={(e)=>{\n                        this.onSelect(item, e.target.checked)} \n                    }/>\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\n                    {this.renderContent(obItem, index)}\n                </label>\n            </div>\n        </li>\n    })\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport {PageItems} from '../../tool/pageItems';\nimport {ListBase} from './base';\nimport {Clickable} from './clickable';\nimport {Static} from './static';\nimport {Selectable} from './selectable';\nimport '../../css/va-list.css';\nimport { IObservableArray } from 'mobx';\nimport { resLang } from '../../res/res';\nimport { ListRes, listRes } from '../../res';\n\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\n\nexport interface ListProps {\n    className?: string|string[];\n    items: any[] | IObservableArray<any> | PageItems<any>;\n    item: {\n        className?: string|string[];\n        render?: (item:any, index:number) => JSX.Element;\n        onSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\n        onClick?: (item:any)=>void;\n        key?: (item:any)=>string|number;\n    };\n    compare?:(item:any, selectItem:any)=>boolean;\n    selectedItems?:any[];\n    header?: StaticRow;\n    footer?: StaticRow;\n    before?: StaticRow;\n    loading?: StaticRow;\n\tnone?: StaticRow;\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\n}\n\n@observer\nexport class List extends React.Component<ListProps> {\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\n\n    private listBase: ListBase;\n\tprivate selectable: Selectable;\n    constructor(props:ListProps) {\n\t\tsuper(props);\n        this.buildBase();\n    }\n    _$scroll = (direct: 'top'|'bottom') => {\n        console.log('############### items scroll to ' + direct);\n    }\n    private buildBase() {\n        let {item} = this.props;\n        let {onClick, onSelect} = item;\n        if (onSelect !== undefined)\n            this.selectable = this.listBase = new Selectable(this);\n        else if (onClick !== undefined)\n            this.listBase = new Clickable(this);\n        else\n            this.listBase = new Static(this);\n    }\n    /*\n    componentWillUpdate(nextProps:ListProps, nextState, nextContext) {\n        //this.listBase.updateProps(nextProps);\n    }\n    */\n    componentWillUnmount() {\n        this.listBase.dispose();\n    }\n    selectAll() {\n        if (this.selectable) this.selectable.selectAll();\n    }\n    unselectAll() {\n        if (this.selectable) this.selectable.unselectAll();\n    }\n    get selectedItems():any[] {\n        return this.listBase.selectedItems;\n    }\n    render() {\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\n        if (before === undefined) before = '-';\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\n        if (none === undefined) none = List.res.none;\n        //this.listBase.selectedItems = selectedItems;\n        let {items, loading:isLoading} = this.listBase;\n        function staticRow(row:StaticRow, type:string) {\n            if (!row) return;\n            switch (typeof row) {\n                default:\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\n                case 'object': return <li>{row}</li>\n            } \n        }\n        let content:any, waitingMore:any;\n        if (items === null)\n            content = staticRow(before, 'before');\n        else if (items === undefined)\n            content = staticRow(loading, 'loading');\n        else if (items.length === 0)\n            content = staticRow(none, 'none');\n        else {\n            content = items.map((item, index) => {\n                return this.listBase.render(item, index);\n            });\n        }\n        if (isLoading === true && items) {\n            waitingMore = staticRow(loading, 'loading');\n\t\t}\n\t\tlet tabIndex:number;\n\t\tif (onFocus !== undefined) tabIndex = -1;\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\n            {staticRow(header, 'header')}\n            {content}\n            {waitingMore}\n            {staticRow(footer, 'footer')}\n        </ul>;\n    }\n}\n","import * as React from 'react';\nimport className from 'classnames';\nimport {PropGridProps} from './PropGrid';\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\n\nexport abstract class PropRow {\n    setValues(values: any) {}\n    abstract render(key:string): any;\n}\n\nexport class PropBorder extends PropRow {\n    render(key:string): JSX.Element {\n        return <div key={'_b_' + key} className=\"\">\n            <div className=\"w-100\">\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\n            </div>\n        </div>;\n    }\n}\n\nexport class PropGap extends PropRow {\n    private param: string;\n    constructor(param?: string) {\n        super();\n        this.param = param;\n    }\n    render(key:string): JSX.Element {\n        let w: string;\n        switch (this.param) {\n            default: w = 'py-2'; break;\n            case '=': w = 'py-1'; break;\n            case '-': w = 'pb-1'; break;\n        }\n        let cn = className(w);\n        return <div key={'_g_' + key} className={cn} />;\n    }\n}\n\nconst valueAlignStart = 'justify-content-start';\nconst valueAlignCenter = 'justify-content-center';\nconst valueAlignEnd = 'justify-content-end';\nexport abstract class LabeledPropRow extends PropRow {\n    protected gridProps: PropGridProps;\n    protected _prop: LabeledProp;\n    protected get prop():LabeledProp {return this._prop}\n    protected content: any;\n    protected col: string;\n    //protected values: any;\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\n        super();\n        this.gridProps = gridProps;\n        this._prop = prop;\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\n        //this.values = values;\n    }\n    render(key:string):any {\n        let {onClick, bk} = this.prop;\n        let cn = className({\n            \"cursor-pointer\": onClick !== undefined,\n            \"bg-white\": bk === undefined, \n            \"row\": true\n        });\n        return <div key={key} className={cn} onClick={onClick}>\n            {this.renderLabel()}\n            {this.renderProp()}\n        </div>;\n    }\n    protected renderLabel():any {\n        let {label} = this.prop;\n        if (label === undefined) return null;\n        return <label className={this.col + '-3 col-form-label'}>\n            {label}\n        </label>;\n    }\n    protected renderProp():any {\n        let {label} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string = this.col + (label===undefined? '-12':'-9');\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n    protected renderPropBody():any {\n        return <div className=\"form-control-plaintext\">\n            {this.renderPropContent()}\n        </div>;\n    }\n    protected renderPropContent():any {\n        return this.content;\n    }\n}\n\nexport class StringPropRow extends LabeledPropRow {\n    protected get prop(): StringProp {return this._prop as StringProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class NumberPropRow extends LabeledPropRow {\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class ListPropRow extends LabeledPropRow {\n    protected get prop(): ListProp {return this._prop as ListProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else {\n            let list = this.prop.list;\n            if (typeof list === 'string') this.content = values[list];\n            else this.content = undefined;\n        }\n    }\n    protected renderPropBody() {\n        let {list, row} = this.prop;\n        let items:any[] = typeof list === 'string'? this.content : list;\n        if (items === undefined) return <div/>;\n        // new row(item)\n        return <div className=\"w-100\">\n            {\n                items.map((item, index) => <React.Fragment key={index}>\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\n                    {React.createElement(row, item)}\n                </React.Fragment>)\n            }\n        </div>;\n    }\n}\n\nexport class ComponentPropRow extends LabeledPropRow {\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\n    protected renderPropBody() {\n        let {component} = this.prop;\n        return component;\n    }\n    protected renderProp():any {\n        let {label, full} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string;\n        if (full !== true)\n            col = this.col + (label===undefined? '-12':'-9');\n        else\n            col = 'w-100';\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n}\n","import { PropGridProps } from './PropGrid';\nimport {\n    PropRow, PropBorder, PropGap, \n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\n} from './row';\n\nexport interface Format {\n\n}\n\nexport interface PropBase {\n    onClick?: () => void;\n}\n\nexport interface LabeledProp extends PropBase {\n    label?: string;\n    bk?: string;\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\n}\n\nexport interface StringProp extends LabeledProp {\n    type: 'string';\n    name: string;\n}\n\nexport interface NumberProp extends LabeledProp {\n    type: 'number';\n    name: string;\n}\n\nexport interface FormatProp extends LabeledProp {\n    type: 'format';\n    format: Format;\n}\n\nexport interface ListProp extends LabeledProp {\n    type: 'list';\n    list: string | any[];  // string 表示名字，否则就是值\n    row: new (props: any) => React.Component;\n}\n\nexport interface ComponentProp extends LabeledProp {\n    type: 'component';\n    full?: boolean;\n    component: any; //JSX.Element;\n}\n\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\n\nexport class PropView {\n    private gridProps: PropGridProps\n    private props: Prop[];\n    //private values:any;\n    private rows: PropRow[];\n\n    constructor(gridProps: PropGridProps, props: Prop[]) {\n        this.gridProps = gridProps;\n        this.props = props;\n        //this.values = values;\n        this.buildRows();\n    }\n\n    private buildRows() {\n        this.rows = [];\n        let isGap: boolean = true;\n        for (let prop of this.props) {\n            if (typeof prop === 'string') {\n                this.rows.push(new PropGap(prop));\n                isGap = true;\n            }\n            else {\n                if (!isGap) this.rows.push(new PropBorder());\n                let row;\n                switch (prop.type) {\n                    default: continue;\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\n                }\n                this.rows.push(row);\n                isGap = false;\n            }\n        }\n    }\n\n    setValues(values: any) {\n        for (let r of this.rows) r.setValues(values);\n    }\n\n    render() {\n        return this.rows.map((row, index) => row.render(String(index)));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport {Prop, PropView} from './propView';\n\nexport interface PropGridProps {\n    className?: string;\n    rows: Prop[];\n    values: any;\n    alignValue?: 'left'|'center'|'right';\n    labelFixLeft?: boolean;\n}\n\n@observer\nexport class PropGrid extends React.Component<PropGridProps> {\n    render() {\n        let {className, rows, values} = this.props;\n        let propView = new PropView(this.props, rows);\n        propView.setValues(values);\n        let cn = classNames('container-fluid', className);\n        return <div className={cn}>\n            {propView.render()}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\nimport { userApi } from '../net';\n\nexport class EditMeInfo extends React.Component {\n    private schema:ItemSchema[] = [\n        {name:'nick', type:'string'} as StringSchema,\n        {name:'icon', type:'image'} as ImageSchema\n    ];\n    private uiSchema:UiSchema = {\n        items: {\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\n            icon: {widget:'image', label:'头像'} as UiImageItem,\n        }\n    }\n    @observable private data:any;\n\n    constructor(props:any) {\n        super(props);\n        let {nick, icon} = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        }\n    }\n\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\n        let {name} = itemSchema;        \n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        let user:any = nav.user;\n        user[name] = newValue;\n        nav.saveLocalUser();\n    }\n\n    render() {\n        return <Page header=\"个人信息\">\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\n                data={this.data}\n                onItemChanged={this.onItemChanged} />\n        </Page>;\n    }\n}\n","// eslint-disable-next-line\nimport { Tuid, Map, Query, Action, Sheet, Tag } from \"tonva\";\n\nexport enum EnumNoteType {Text=0, Assign=10, Task=20};\nexport enum EnumTaskState {\n\tstart=0, \n\ttodo=20, doing=21, done=22, \n\tpass=40, fail=41,\n\trated=60, \n\tcancel=-40\n};\nexport enum EnumTaskAct {todo=20, done=22, check=40, rate=60};\nexport interface StateText {\n\tme:string; \n\tother?:string; \n\tact:string;\n\tpending:boolean\n}\n\nconst stateTexts:{[key in EnumTaskState]:StateText} = {\n\t[EnumTaskState.start]: {me:'收到', other:'收到', act:undefined, pending:true},\n\t[EnumTaskState.todo]: {me:'待办', act:'领办', pending:true},\t\t// todo=20\n\t[EnumTaskState.doing]: {me:'在办', act:'领办', pending:true},\t\t// doing=21\n\t[EnumTaskState.done]: {me:'已完成', act:'完成', pending:false}, \t// done=22, \n\t[EnumTaskState.pass]: {me:'已验收', act:'验收', pending:false}, \t// pass=40, \n\t[EnumTaskState.fail]: {me:'已拒签', act:'拒签', pending:false},\t\t// fail=41,\n\t[EnumTaskState.rated]: {me:'已评价', act:'评价', pending:false}, \t// rated=60, \n\t[EnumTaskState.cancel]: {me:'已取消', act:'归档', pending:false},\t\t// cancel=-40\n}\n\nexport function stateText(state:EnumTaskState):StateText {\n\treturn stateTexts[state];\n}\n\nexport function actText(act:EnumTaskAct): string {\n\tswitch (act) {\n\t\tdefault: return '';\n\t\tcase EnumTaskAct.todo: return '办理';\n\t\tcase EnumTaskAct.done: return '完成';\n\t\tcase EnumTaskAct.check: return '查验';\n\t\tcase EnumTaskAct.rate: return '评价';\n\t}\n}\n\nexport const TaskAct = {\n\tdone: '办理',\n\tcheck: '查验',\n\trate: '评价',\n}\n\nexport interface Performance {\n\tGroup: Tuid;\n\tAddGroupMember: Action;\n\tRemoveGroupMember: Action;\n\tGetMyGroups: Query;\n\tSaveGroup: Action;\n\tSaveGroupProp: Action;\n\tGetGroupNotes: Query;\n\tGetGroupMembers: Query;\n\n\tTodo: Tuid;\n\tTask: Tuid;\n\tAssign: Tuid;\n\tAssignItem: Tuid;\n\t\n\tCreateAssign: Action;\n\tNewAssign: Action;\n\tCreateAndSendAssign: Action;\n\tDoneAssign: Action;\n\tSendAssign: Action;\n\tDoneTask: Action;\n\tPassTask: Action;\n\tFailTask: Action;\n\tRateTask: Action;\n\n\tTakeAssign: Action;\n\tTaskDone: Action;\n\tTaskPass: Action;\n\tTaskFail: Action;\n\tTaskRate: Action;\n\tPushNote: Action;\n\tSaveTodo: Action;\n\tTaskTodo: Action;\n\tTaskAct: Action;\n\tRemoveTask: Action;\n\tPublishAssign: Action;\n\tSaveAssignProject: Action;\n\tTestText: Action;\n\n\t$Poked: Query;\n\tGetAssigns: Query;\n\tMyTickTodo: Query;\n\tGetMyAssigns: Query;\n\tGetAssign: Query;\n\tGetTodo: Query;\n\tGetMyArchiveTodos: Query;\n\tGetUserTodos: Query;\n\tGetTask: Query;\n\tGetTaskFlow: Query;\n\tGetMyTasks: Query;\n\t//GetMyTaskArchive: Query;\n\tGetMyMembers: Query;\n\n\tProject: Tuid;\n\tSaveProject: Action;\n\tGetMyProjects: Query;\n\n\tTestExpression: Action;\n\ttest1: Tag;\n\ttest2: Tag;\n}\n\nexport interface UQs {\n    performance: Performance\n}\n","import { AppConfig } from \"tonva\";\nimport { appName } from \"./appName\";\n\nexport const appConfig: AppConfig = {\n    appName: appName,\n\tversion: '1.0.0',\n\tnoUnit: true,\n    tvs: {},\n    oem: '百灵威'\n};\n","export const appName = 'Bruce/todo';","import { CSub, CBase, CAppBase, IConstructor } from 'tonva';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n}\n\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\n    get cApp(): CApp { return this.cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n    protected get owner(): T { return this._owner as T }\n}\n\nexport abstract class CUqApp extends CAppBase {\n    get uqs(): UQs { return this._uqs };\n\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\n\t\tlet c = new type(this);\n\t\tc.init();\n\t\treturn c;\n    }\n}\n","\nexport enum Token {\n    NONE = -1,\n    _FINISHED = 0,\n    ADD = 1, \n    SUB = 2,\n    MUL = 3,\n    DIV = 4,\n    MOD = 5,\n    XOR = 6,\n    BITWISEAND = 7,\n    BITWISEOR = 8,\n    OR = 9,\n    AND = 10,\n    NOT = 11,\n    GT = 12,\n    GE = 13,\n    LT = 14,\n    LE = 15,\n    NE = 16,\n    EQU = 17, \n    DOT =18,\n    COMMA =19,\n    COLON = 20,\n    SEMICOLON = 21,\n    AT = 22,\n    DOLLAR = 23,\n    LPARENTHESE = 24,\n    RPARENTHESE = 25,\n    LBRACE = 26,\n    RBRACE = 27, \n    NUM = 28,\n    VAR = 29,\n    HEX = 30,\n    REM = 31,\n    STRING = 32,\n    ADDEQU = 33,\n    SUBEQU = 34,\n    LBRACKET = 35,\n    RBRACKET = 36,\n    SHARP = 37,\n    CODE = 38,\n    DOLLARVAR = 39,\n}\n\n// QM_GT = 18, QM_GE, QM_LT, QM_LE, QM_EQU, QM_LIKE, QM_BETWEEN,\n// LBBRACE, RBBRACE,","import * as React from 'react';\nimport { VPage, TabCaptionComponent, Page } from 'tonva';\nimport { CApp } from './CApp';\n\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\n\nexport class VMain extends VPage<CApp> {\n    async open(param?: any) {\n        this.openPage(this.render);\n    }\n\n    render = (param?: any): JSX.Element => {\n        let { cGroup, cReport, cMe } = this.controller;\n        let faceTabs = [\n\t\t\t{ name: 'note', label: '首页', icon: 'home', content: cGroup.tab},\n\t\t\t{ name: 'job', label: '查看', icon: 'list', content: cReport.tab, onShown: cReport.load, className: 'job-tab' },\n            //{ name: 'home', label: '绩效', icon: 'tasks', content: cHome.tab, },\n            { name: 'me', label: '我的', icon: 'user', content: cMe.tab }\n        ].map(v => {\n            let { name, label, icon, content, onShown, className } = v;\n            return {\n                name: name,\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\n                content: content,\n\t\t\t\tonShown: onShown,\n\t\t\t\tclassName: className\n            }\n\t\t});\n\t\treturn <Page tabsProps={{tabs:faceTabs}} />;\n\t\t/*\n        return <Page header={false} headerClassName={\"bg-info\"} >\n            <Tabs tabs={faceTabs} />\n        </Page>;\n\t\t//\n\t\t*/\n    }\n}\n","import React from 'react';\nimport { VPage } from 'tonva';\nimport { CMe } from './CMe';\n\nexport class VMe extends VPage<CMe> {\n\tinit(param?:any) {\n\t\t// useUser(10);\n\t}\n\tlogout(): boolean | (()=>Promise<void>) {return true;}\n\trender(param?:any):JSX.Element {\n\t\tthis.init(param);\n\t\treturn this.renderPage();\n\t}\n\n\theader() {return  '我的'}\n\tcontent() {\n\t\treturn <div className=\"p-3\">\n\t\t\t<div className=\"mb-3\">\n\t\t\t\t{this.renderMe()}\n\t\t\t</div>\n\t\t\t<div className=\"small text-muted\">\n\t\t\t\t正在建设中...\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import { CUqBase } from '../tapp';\nimport { VMe } from './VMe';\n\nexport class CMe extends CUqBase {\n    protected async internalStart() {\n\n    }\n    tab = () => this.renderView(VMe);\n}","import * as React from 'react';\nimport { VPage, Page, Form, ItemSchema, Schema, UiSchema, UiTagMulti, UiTagSingle, Context, Edit, List } from 'tonva';\nimport { CTest } from './CTest';\nimport { observable } from 'mobx';\n\nconst itemBlock = \"p-3 border border-info mr-1 mb-1 w-10c cursor-pointer bg-white rounded\";\nconst itemStyle = {maxWidth: '45%'};\n\nexport class VMain extends VPage<CTest> {\n\tprivate schema:Schema = [\n\t\t{name: 'a', type: 'string'},\n\t\t{name: 'b', type: 'string'},\n\t\t{name: 'c', type: 'string'},\n\t\t{name: 'submit', type: 'submit'}\n\t];\n\tprivate uiSchema: UiSchema;\n\n\t@observable private data:any = {\n\t\tb:3, \n\t\tc:'2|4'\n\t}\n\n    async open(param?: any) {\n\t}\n\n\tprivate submit = async (name:string, context:Context ):Promise<void> => {\n\t\talert(name + ': ' + JSON.stringify(context.data));\n\t}\n\n\tprivate onEditItemChanged = async (itemSchema: ItemSchema, newValue:any, preValue:any): Promise<void> => {\n\t\tthis.data[itemSchema.name] = newValue;\n\t}\n\n    render() {\n\t\tthis.uiSchema = {\n\t\t\titems: {\n\t\t\t\tb: { \n\t\t\t\t\tlabel: '单选Radio',\n\t\t\t\t\twidget: 'tagSingle', \n\t\t\t\t\tvaluesView: this.controller.tagTest1.view,\n\t\t\t\t\t\n\t\t\t\t} as UiTagSingle,\n\t\t\t\tc: {\n\t\t\t\t\tlabel: '多选CheckBox',\n\t\t\t\t\twidget: 'tagMulti', \n\t\t\t\t\tvaluesView: this.controller.tagTest2.view,\n\t\t\t\t\twrapClassName: 'row-cols-sm-2'\n\t\t\t\t} as UiTagMulti,\n\t\t\t\tsubmit: {\n\t\t\t\t\tlabel: '提交',\n\t\t\t\t\twidget: 'button',\n\t\t\t\t\tclassName: 'btn btn-primary'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n        let arr = [\n            'adfas1fd', 'asdfddddsadf', 'adsfasf', 'sdafsdf dsf a',\n            'adfasfd', 'asdfsadf', 'adsfasf', 'sdafsdf dsf a',\n            'adfasfd', 'asdfsadf', 'adsfasf', 'sdafsdf dsf a',\n        ]\n        return <Page header=\"绩效\" headerClassName=\"bg-info\">\n\t\t\t<div className=\"m-3\">\n\t\t\t\t<button className=\"mr-3 btn btn-outline-primary\" onClick={this.controller.test}>Test</button>\n\t\t\t\t<button className=\"mr-3 btn btn-outline-primary\" onClick={this.controller.testParser}>测试表达式</button>\n\t\t\t\t<button className=\"mr-3 btn btn-outline-primary\" onClick={this.controller.actionTestExpression}>actionTestExpression</button>\n\t\t\t</div>\n\t\t\t<List items={[]} item={{render:this.renderListItem}} none={<div className=\"p-3 text-success\">ok ok ok</div>} />\n            <div className=\"d-flex flex-wrap m-3 justify-content-start\">\n                {arr.map((v, index) => <div key={index} className={itemBlock} style={itemStyle} onClick={()=>alert(v)}>{v}</div>)}\n            </div>\n\t\t\t<Form className=\"p-3\" \n\t\t\t\tschema={this.schema} \n\t\t\t\tuiSchema={this.uiSchema}\n\t\t\t\tformData={this.data}\n\t\t\t\tfieldLabelSize={2}\n\t\t\t\tonButtonClick={this.submit} />\n\t\t\t<Edit className=\"p-3\" \n\t\t\t\tschema={this.schema}\n\t\t\t\tuiSchema={this.uiSchema}\n\t\t\t\tdata={this.data}\n\t\t\t\tonItemChanged={this.onEditItemChanged}\n\t\t\t />\n        </Page>;\n\t}\n\t\n\tprivate renderListItem = (item:any, index:number) => {\n\t\treturn <div>1</div>;\n\t}\n}\n","import * as React from 'react';\nimport { Page, VPage, Form, ItemSchema, UiSchema, UiTextItem, UiButton, NumSchema, UiTextAreaItem } from 'tonva';\nimport { CTest } from './CTest';\n\nexport class VTestForm extends VPage<CTest> {\n    async open(param?: any) {\n        this.openPage(this.page);\n    }\n\n    private page = () => {\n        let items:ItemSchema[] = [\n            {name: 'name1', type: 'string', required: true},\n            {name: 'name2', type: 'string'},\n            {name: 'num', type: 'number', min: 10, max: 50} as NumSchema,\n            {name:'submit', type:'button'}\n        ];\n        let uis: UiSchema = {\n            items: {\n                name1: {widget: 'text', label: '姓名', placeholder: '请输入姓名'} as UiTextItem,\n                name2: {widget: 'textarea', label: '姓名2', placeholder: '请输入姓名2'} as UiTextAreaItem,\n                submit: {widget: \"button\", label: '提交', className: 'btn btn-success'} as UiButton\n            }\n        }\n \n        return <Page header=\"试验\">\n            <Form className=\"m-3\"\n                schema={items}\n                uiSchema={uis} fieldLabelSize={3} />\n        </Page>\n        //return <ImageUploader size=\"lg\" />\n    }\n}\n","\nlet chars = '+-*\\\\/%(){}[].,;:^=<>&|\\'\"_?09$@#';\nlet lowercase = 'abcdefghijklmnopqrstuvwxyz';\nlet uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nexport class Char {\n    static NULL         = 0;\n    static TAB          = 9;\n    static _R           = 10;\n    static ENTER        = 13;\n    static SPACE        = 32;\n    \n    static PLUS         = chars.charCodeAt(0);\n    static MINUS        = chars.charCodeAt(1);\n    static STAR         = chars.charCodeAt(2);\n    static BACKSLASH    = chars.charCodeAt(3);\n    static SLASH        = chars.charCodeAt(4);\n    static PERCENT      = chars.charCodeAt(5);\n    static LParenthese  = chars.charCodeAt(6);\n    static RParenthese  = chars.charCodeAt(7);\n    static LBrace       = chars.charCodeAt(8);\n    static RBrace       = chars.charCodeAt(9);\n    static LBracket     = chars.charCodeAt(10);\n    static RBracket     = chars.charCodeAt(11);\n    static DOT          = chars.charCodeAt(12);\n    static COMMA        = chars.charCodeAt(13);\n    static SEMICOLON    = chars.charCodeAt(14);\n    static COLON        = chars.charCodeAt(15);\n    static TOPANGLE     = chars.charCodeAt(16);\n    static EQU          = chars.charCodeAt(17);\n    static LS           = chars.charCodeAt(18);\n    static GT           = chars.charCodeAt(19);\n    static AND          = chars.charCodeAt(20);\n    static OR           = chars.charCodeAt(21);\n    static Apostrophe   = chars.charCodeAt(22);     // '\n    static QUOT         = chars.charCodeAt(23);     // \"\n    static UNDERLINE    = chars.charCodeAt(24);     // _\n    static QUESTION     = chars.charCodeAt(25);\n    static ZERO         = chars.charCodeAt(26);\n    static NINE         = chars.charCodeAt(27);\n    static DOLLAR       = chars.charCodeAt(28);\n    static AT           = chars.charCodeAt(29);\n    static SHARP        = chars.charCodeAt(30);\n    \n    static a            = lowercase.charCodeAt(0); \n    static b            = lowercase.charCodeAt(1); \n    static c            = lowercase.charCodeAt(2); \n    static d            = lowercase.charCodeAt(3); \n    static e            = lowercase.charCodeAt(4); \n    static f            = lowercase.charCodeAt(5); \n    static g            = lowercase.charCodeAt(6); \n    static h            = lowercase.charCodeAt(7); \n    static i            = lowercase.charCodeAt(8); \n    static j            = lowercase.charCodeAt(9); \n    static k            = lowercase.charCodeAt(10); \n    static l            = lowercase.charCodeAt(11); \n    static m            = lowercase.charCodeAt(12); \n    static n            = lowercase.charCodeAt(13); \n    static o            = lowercase.charCodeAt(14); \n    static p            = lowercase.charCodeAt(15); \n    static q            = lowercase.charCodeAt(16); \n    static r            = lowercase.charCodeAt(17); \n    static s            = lowercase.charCodeAt(18); \n    static t            = lowercase.charCodeAt(19); \n    static u            = lowercase.charCodeAt(20); \n    static v            = lowercase.charCodeAt(21); \n    static w            = lowercase.charCodeAt(22); \n    static x            = lowercase.charCodeAt(23); \n    static y            = lowercase.charCodeAt(24); \n    static z            = lowercase.charCodeAt(25); \n    \n    static A            = uppercase.charCodeAt(0); \n    static B            = uppercase.charCodeAt(1); \n    static C            = uppercase.charCodeAt(2); \n    static D            = uppercase.charCodeAt(3); \n    static E            = uppercase.charCodeAt(4); \n    static F            = uppercase.charCodeAt(5); \n    static G            = uppercase.charCodeAt(6); \n    static H            = uppercase.charCodeAt(7); \n    static I            = uppercase.charCodeAt(8); \n    static J            = uppercase.charCodeAt(9); \n    static K            = uppercase.charCodeAt(10); \n    static L            = uppercase.charCodeAt(11); \n    static M            = uppercase.charCodeAt(12); \n    static N            = uppercase.charCodeAt(13); \n    static O            = uppercase.charCodeAt(14); \n    static P            = uppercase.charCodeAt(15); \n    static Q            = uppercase.charCodeAt(16); \n    static R            = uppercase.charCodeAt(17); \n    static S            = uppercase.charCodeAt(18); \n    static T            = uppercase.charCodeAt(19); \n    static U            = uppercase.charCodeAt(20); \n    static V            = uppercase.charCodeAt(21); \n    static W            = uppercase.charCodeAt(22); \n    static X            = uppercase.charCodeAt(23); \n    static Y            = uppercase.charCodeAt(24); \n    static Z            = uppercase.charCodeAt(25); \n\n    static USPACE       = 0x3000;\n}","import {Token} from './token';\nimport {Char} from './char';\n\nexport type log = (log?: string) => boolean;\n\nexport class TokenStream {\n    private bracket: boolean;\n    private buffer: string;\n    private p: number;\n    private len: number;\n    private cur: number;                // 当前char code\n    \n    log: log;\n    dec: number;                // 数字值\n    isInteger: boolean;         // 表示解析出来的数字是整数\n    _var: string;\n    varBrace: boolean;                  // 带[]的字段名\n    lowerVar: string;\n    text: string; \n    token: Token;\n\n    LastP: number;                  // 上一个符号的开始位置\n    line: number;                // 当前行号\n    at: number;                 // 当前字符\n    prevLine: number;\n    prevAt: number;\n    startLine: number;\n    startAt: number;\n    PrevToken: Token;\n\n    file: string;\n\n    constructor(log:log, input: string, options?:{bracket:boolean})\n    {\n        if (options !== undefined) this.bracket = options.bracket;\n        this.log = log;\n        this.LastP = 1;\n        this.buffer = input;\n        this.len = input.length;\n        this.p = 0;\n        this.at = 0;\n        this.line = 0;\n        this.advance();\n    }\n\n    getSourceAt(pos:number):string {\n        return this.buffer.substring(pos, this.LastP-1);\n    }\n\n    getSourceNearby(sourceAt:number): string {\n        return ' ...' + this.buffer.substr(sourceAt, 50) + '... ';\n    }\n\n    private errorAt() {\n        let line = this.startLine+1;\n        let charAt = this.startAt + 1;\n        return this.file + ' 错误在'+line+'行'+charAt+'列: \\n' + this.getSourceNearby(this.p) + '\\n';\n    }\n\n    error(...msg:string[]) {\n        let err = this.errorAt()+msg.join('');\n        this.log(err);\n        throw err;\n    }\n\n    expectToken(...tokens:Token[]) {\n        let err = this.errorAt()+'应该是'+tokens.map(v => Token[v]).join('或');\n        this.log(err);\n        throw err;\n    }\n\n    expect(...msg:string[]) {\n        let err = this.errorAt() + '应该是'+msg.join('或');\n        this.log(err);\n        throw err;\n    }\n\n    assertToken(token: Token) {\n        if (this.token !== token) this.expectToken(token);\n    }\n\n    assertVar() {\n        if (this.token !== Token.VAR) this.expect('应该是变量名');\n    }\n\n    assertKey(key: string) {\n        if (this.lowerVar !== key || this.varBrace === true) this.expect(key);\n    }\n\n    private advance() {\n        this.cur = (this.p >= this.len) ? 0 : this.buffer.charCodeAt(this.p++);\n        if (this.cur === Char.ENTER)\n        {\n            this.line++;\n            this.at = 1;\n        }\n        else\n            this.at++;\n    }\n\n    isKeyword(key:string):boolean {\n        //if (this.token !== Token._VAR) return false;\n        //if (this.varBrace === true) return false;\n        return this.lowerVar === key && this.varBrace === false;\n    }\n\n    isKeywords(keys:string[]):boolean {\n        //if (this.token !== Token._VAR) return false;\n        //if (this.varBrace === true) return false;\n        if (this.varBrace === true) return false;\n        return keys.indexOf(this.lowerVar)>=0;\n    }\n\n    /*\n    // Mainly for xml parser using\n    ReadTo(to:number)\n    {\n        // There are 5 predefined entity references in XML:\n        // &lt; < less than \n        // &gt; > greater than \n        // &amp; & ampersand  \n        // &apos; ' apostrophe \n        // &quot; \" quotation mark \n\n        this.token = Token.LT;\n        if (this.cur == to)\n        {\n            this.text = null;\n            return;\n        }\n        let pos = this.p;\n        StringBuilder sb = new StringBuilder(32);\n        while (this.cur != to)\n        {\n            if (this.cur == '&')\n            {\n                int andPos = this.p;\n                this.Advance();\n                for (;;)\n                {\n                    if (this.cur == Char.NULL) this.ThrowException(\"& not end\");\n                    if (this.cur == ';')\n                    {\n                        if (this.AndCompare(andPos, \"lt\")) sb.Append('<');\n                        else if (this.AndCompare(andPos, \"gt\")) sb.Append('>');\n                        else if (this.AndCompare(andPos, \"amp\")) sb.Append('&');\n                        else if (this.AndCompare(andPos, \"apos\")) sb.Append('\\'');\n                        else if (this.AndCompare(andPos, \"quot\")) sb.Append('\"');\n                        else this.ThrowException(\"error &\");\n                        this.Advance();\n                        break;\n                    }\n                    this.Advance();\n                }\n            }\n            else if (this.cur == Char.NULL)\n            {\n                this.token = Token._FINISHED;\n                this.text = sb.ToString();\n                return;\n            }\n            else\n            {\n                sb.Append(this.cur);\n            }\n            this.Advance();\n        }\n        this.Advance();\n        this.text = sb.ToString();\n    }\n    AndCompare(andPos:number, andToken:string): boolean\n    {\n        let len = andToken.length;\n        return (string.Compare(this.buffer, andPos, andToken, 0, len, true) == 0 && this.p - andPos == len);\n    }\n    */\n    showToken() {\n        return Token[this.token];\n    }\n\n    PeekToken(): Token\n    {\n        let prevToken:Token = this.PrevToken;\n        let cur = this.cur;\n        let _var = this._var;\n        let lowerVar = this.lowerVar;\n        let lastP = this.LastP;\n        let lastLineNum = this.startLine;\n        let lastChatAt = this.startAt;\n        let token = this.token;\n        let p = this.p;\n        let lineNum = this.line;\n        let charAt = this.at;\n        this.readToken();\n        let ret = this.token;\n        this.PrevToken = prevToken;\n        this.LastP = lastP;\n        this.startLine = lastLineNum;\n        this.startAt = lastChatAt;\n        this.token = token;\n        this._var = _var;\n        this.lowerVar = lowerVar;\n        this.p = p;\n        this.line = lineNum;\n        this.at = charAt;\n        this.cur = cur;\n        return ret;\n    }\n\n    readToken()\n    {\n        this.PrevToken = this.token;\n        this.LastP = this.p;\n        this.prevLine = this.startLine;\n        this.prevAt = this.startAt;\n        this.startLine = this.line;\n        this.startAt = this.at;\n        //this.prevSpace = false;\n        this._var = undefined;\n        this.lowerVar = undefined;\n        for (; ; )\n        {\n            switch (this.cur)\n            {\n                case Char.NULL:\n                    this.token = Token._FINISHED;\n                    break;\n                case Char.TAB:\n                case Char.SPACE:\n                case Char.USPACE:       // 中文空格\n                case Char._R:\n                case Char.ENTER:\n                    this.advance();\n                    this.startLine = this.line;\n                    this.startAt = this.at;\n                    this.LastP = this.p;\n                    //this.prevSpace = true;\n                    continue;\n                case Char.PLUS: \n                    this.token = Token.ADD; this.advance(); \n                    if (this.cur === Char.EQU) {\n                        this.token = Token.ADDEQU;\n                        this.advance();\n                    }\n                    break;\n                case Char.MINUS:\n                    this.advance();\n                    switch (this.cur)\n                    {\n                        case Char.EQU:\n                            this.token = Token.SUBEQU;\n                            this.advance();\n                            break;\n                        case Char.MINUS: this.readLineRemark(); continue;\n                        default: this.token = Token.SUB; break;\n                    }\n                    break;\n                case Char.STAR: this.token = Token.MUL; this.advance(); break;\n                case Char.DOLLAR:\n                    //this.advance();\n                    this.readVar();\n                    if (this._var === '$')\n                        this.token = Token.DOLLAR;\n                    else\n                        this.token = Token.DOLLARVAR;\n                    break;\n                case Char.AT: this.token = Token.AT; this.advance(); break;\n                case Char.SLASH:\n                    this.advance();\n                    switch (this.cur)\n                    {\n                        case Char.SLASH: this.readLineRemark(); continue;\n                        case Char.STAR: this.readRemark(); continue;\n                        case Char.MINUS: this.readInlineCode(); break;\n                        default: this.token = Token.DIV; break;\n                    }\n                    break;\n                case Char.PERCENT: this.token = Token.MOD; this.advance(); break;\n                case Char.LParenthese: this.token = Token.LPARENTHESE; this.advance(); break;\n                case Char.RParenthese: this.token = Token.RPARENTHESE; this.advance(); break;\n                case Char.LBrace:\n                    this.advance();\n                    this.token = Token.LBRACE; break;\n                    //if (this.cur != Char.LBrace) { this.token = Token.LBRACE; break; }\n                    //this.advance(); this.ReadInline(); break;\n                case Char.RBrace: this.token = Token.RBRACE; this.advance(); break;\n                case Char.SHARP: this.token = Token.SHARP; this.advance(); break;\n                case Char.DOT: this.token = Token.DOT; this.advance(); break;\n                case Char.COMMA: this.token = Token.COMMA; this.advance(); break;\n                case Char.SEMICOLON: this.token = Token.SEMICOLON; this.advance(); break;\n                case Char.COLON: this.token = Token.COLON; this.advance(); break;\n                case Char.TOPANGLE: this.token = Token.XOR; this.advance(); break;\n                case Char.EQU:\n                    this.advance();\n                    switch (this.cur)\n                    {\n                        case Char.GT: this.token = Token.GE; this.advance(); break;\n                        case Char.LS: this.token = Token.LE; this.advance(); break;\n                        default: this.token = Token.EQU; break;\n                    }\n                    break;\n                case Char.GT:\n                    this.advance();\n                    switch (this.cur)\n                    {\n                        case Char.EQU: this.token = Token.GE; this.advance(); break;\n                        case Char.LS: this.token = Token.NE; this.advance(); break;\n                        default: this.token = Token.GT; break;\n                    }\n                    break;\n                case Char.LS:\n                    this.advance();\n                    switch (this.cur)\n                    {\n                        case Char.EQU: this.token = Token.LE; this.advance(); break;\n                        case Char.GT: this.token = Token.NE; this.advance(); break;\n                        default: this.token = Token.LT; break;\n                    }\n                    break;\n                case Char.AND:\n                    this.advance();\n                    this.token = Token.BITWISEAND;\n                    break;\n                case Char.OR:\n                    this.advance();\n                    this.token = Token.BITWISEOR;\n                    break;\n                case Char.LBracket:\n                    if (this.bracket === true) {\n                        this.token = Token.LBRACKET; this.advance(); break;\n                    }\n                    this.readSquareVar();\n                    break;\n                case Char.RBracket:\n                    if (this.bracket === true) {\n                        this.token = Token.RBRACKET; this.advance(); break;\n                    }\n                    this.error(\"unexpected ]\");\n                    break;\n                case Char.Apostrophe:   // '\n                    this.readString(Char.Apostrophe); // 字符串\n                    break;\n                case Char.QUOT:         // \"\n                    this.readString(Char.QUOT); // 字符串\n                    break;\n                case Char.UNDERLINE:    // _\n                    this.readVar();\n                    //this.FindToken(toFindKeyToken);\n                    break;\n                default:\n                    if (this.cur >= Char.ZERO && this.cur <= Char.NINE) \n                        this.readNumber(this.cur - Char.ZERO);\n                    else if ((this.cur>=Char.a && this.cur<=Char.z) ||\n                        (this.cur>=Char.A && this.cur<=Char.Z) ||\n                        this.cur>=0x100)\n                        this.readVar();\n                    else                        \n                        this.error(\"PARSE_UnexpectChar\");\n                    break;\n            }\n            return;\n        }\n    }\n\n    private readLineRemark()\n    {\n        while (true)\n        {\n            this.advance();\n            switch (this.cur)\n            {\n                case Char._R:\n                case Char.ENTER:\n                case Char.NULL: return;\n            }\n        }\n    }\n\n    private readInlineCode() {\n        this.token = Token.CODE;\n        let start = this.p;\n        while (true) {\n            this.advance();\n            if (this.cur === Char.NULL) break;\n            if (this.cur === Char.MINUS) {\n                this.advance();\n                if (this.cur === Char.SLASH) {\n                    this.advance();\n                    break;\n                }\n            }\n        }\n        this.text = this.buffer.substring(start, this.p - 3);\n    }\n\n    private readRemark()\n    {\n        this.advance();\n        while (true)\n        {\n            if (this.cur === Char.NULL) break;\n            if (this.cur === Char.STAR)\n            {\n                this.advance();\n                if (this.cur === Char.SLASH)\n                {\n                    this.advance();\n                    break;\n                }\n            }\n            else {\n                this.advance();\n            }\n        }\n    }\n\n    private readSquareVar()\n    {\n        let start = this.p;\n        for (; ; )\n        {\n            this.advance();\n            switch (this.cur)\n            {\n                case Char.NULL:\n                case Char._R:\n                case Char.ENTER:\n                    this.error(\"PARSE_UnexpectEndVar\");\n                    return;\n                case Char.RBracket:\n                    this.token = Token.VAR;\n                    this.varBrace = true;\n                    this._var = this.buffer.substring(start, this.p - 1);\n                    this.lowerVar = this._var.toLowerCase();\n                    this.advance();\n                    return;\n            }\n        }\n    }\n\n    private readNumber(firstDigit:number)\n    {\n        this.dec = firstDigit;\n        this.isInteger = true;\n        this.advance();\n        if (firstDigit === 0 && ( this.cur === Char.x || this.cur === Char.X))\n        {\n            this.token = Token.HEX;\n            this.advance();\n            this.text = '';\n            for (; ; )\n            {\n                if ((this.cur >= Char.ZERO && this.cur <= Char.NINE) ||\n                    (this.cur >= Char.a && this.cur <= Char.f) ||\n                    (this.cur >= Char.A && this.cur <= Char.F))\n                    this.text += String.fromCharCode(this.cur);\n                else break;\n                this.advance();\n            }\n            return;\n        }\n        this.token = Token.NUM;\n        for (; ; )\n        {\n            if (this.cur >= Char.ZERO && this.cur <= Char.NINE)\n            {\n                this.dec = this.dec * 10 + (this.cur - Char.ZERO);\n            }\n            else if (this.cur === Char.DOT)\n            {\n                this.isInteger = false;\n                let rate = 0.1;\n                for (; ; )\n                {\n                    this.advance();\n                    if (this.cur >= Char.ZERO && this.cur <= Char.NINE)\n                    {\n                        this.dec = this.dec + (this.cur - Char.ZERO) * rate;\n                        rate /= 10;\n                    }\n                    else return;\n                }\n            }\n            else break;\n            this.advance();\n        }\n    }\n\n    private readString(quote:number)\n    {\n        this.token = Token.STRING;\n        let start = this.p;\n        //StringBuilder sb = new StringBuilder(100);\n        this.advance();\n        while (true)\n        {\n            if (this.cur === Char.NULL) return;\n            if (this.cur === quote)\n            {\n                this.text = this.buffer.substring(start, this.p-1);\n                this.advance();\n                return;\n            }\n            if (this.cur === Char.BACKSLASH)\n            {\n                this.advance();\n                if (this.cur === quote) { this.advance(); break; }\n                /*\n                switch (this.cur)\n                {\n                    case Char.BACKSLASH: sb.Append(Char.BACKSLASH); this.Advance(); break;\n                    case Char.T: sb.Append(Char.TAB); this.Advance(); break;\n                    case Char.R: sb.Append(Char._R); this.Advance(); break;\n                    case Char.N: sb.Append(Char.ENTER); this.Advance(); break;\n                    default: this.ThrowException(\"PARSE_UnknownEscape\"); break;\n                }*/\n                continue;\n            }\n            this.advance();\n        }\n    }\n\n    private readVar()\n    {\n        let start = this.p - 1;\n        let loop = true;\n        while (loop)\n        {\n            this.advance();\n            if (this.cur === Char.NULL)\n            {\n                this._var = this.buffer.substring(start, this.p-1);\n                this.lowerVar = this._var.toLowerCase();\n                this.varBrace = false;\n                return;\n            }\n            switch (this.cur)\n            {\n                case Char.UNDERLINE:\n                    break;\n                default:\n                    if ((this.cur>=Char.ZERO && this.cur<=Char.NINE) ||\n                        (this.cur>=Char.a && this.cur<=Char.z) ||\n                        (this.cur>=Char.A && this.cur<=Char.Z) ||\n                        this.cur>=0x100)\n                        continue;\n                    loop = false;\n                    break;\n            }\n        }\n        this.token = Token.VAR;\n        this._var = this.buffer.substring(start, this.p-1);\n        this.lowerVar = this._var.toLowerCase();\n        this.varBrace = false;\n    }\n}\n","export interface Stack {\n    or():void;\n    and():void;\n    not():void;\n    le():void;\n    lt():void;\n    eq():void;\n    ne():void;\n    gt():void;\n    ge():void;\n    neg():void;\n    add():void;\n    sub():void;\n    mul():void;\n    div():void;\n    mod():void;\n    bitAnd():void;\n    bitOr():void;\n    str(val:string):void;\n    num(val:number):void;\n    star():void;\n    hex(val:string):void;\n    datePart(part:string):void;\n    isNull():void;\n    isNotNull():void;\n    exists():void;\n    in(params:number):void;\n    like():void;\n    searchCase(whenCount:number, hasElse:boolean):void;\n    simpleCase(whenCount:number, hasElse:boolean):void;\n    func(func:string, n:number):void;\n\n    var(name:string):void;\n    field(name:string, tbl?:string):void;\n    dollarVar(name:string):void;\n}\n\nexport class RunStack implements Stack {\n    private stack:string[] = [];\n    private queue:string[] = [];\n\n    getResult():string {return this.stack[0]}\n\n    or():void {}\n    and():void {}\n    not():void {}\n    le():void {}\n    lt():void {}\n    eq():void {}\n    ne():void {}\n    gt():void {}\n    ge():void {}\n    neg():void {}\n    add():void {}\n    sub():void {}\n    mul():void {}\n    div():void {}\n    mod():void {}\n    bitAnd():void {}\n    bitOr():void {}\n    str(val:string):void {}\n    num(val:number):void {this.stack.push('#'+val);}\n    star():void {}\n    hex(val:string):void {}\n    datePart(part:string):void {}\n    isNull():void {}\n    isNotNull():void {}\n    exists():void {}\n    in(params:number):void {}\n    like():void {}\n    searchCase(whenCount:number, hasElse:boolean):void {}\n    simpleCase(whenCount:number, hasElse:boolean):void {}\n    func(func:string, n:number):void {}\n\n    var(name:string):void {}\n    field(name:string, tbl?:string):void {}\n    dollarVar(name:string):void {}\n}\n\nexport abstract class Atom {\n    abstract to(stack: Stack):void;\n    abstract str():string;\n}\n\nexport class OpOr extends Atom {\n    to(stack: Stack) {stack.or();}\n    str():string {return '||'}\n}\nexport class OpAnd extends Atom {\n    to(stack: Stack) {stack.and();}\n    str():string {return '&&'}\n}\nexport class OpNot extends Atom {\n    to(stack: Stack) {stack.not();}\n    str():string {return '!'}\n}\nexport class OpLE extends Atom {\n    to(stack: Stack) {stack.le();}\n    str():string {return '<='}\n}\nexport class OpLT extends Atom {\n    to(stack: Stack) {stack.lt();}\n    str():string {return '<'}\n}\nexport class OpEQ extends Atom {\n    to(stack: Stack) {stack.eq();}\n    str():string {return '='}\n}\nexport class OpNE extends Atom {\n    to(stack: Stack) {stack.ne();}\n    str():string {return '<>'}\n}\nexport class OpGT extends Atom {\n    to(stack: Stack) {stack.gt();}\n    str():string {return '>'}\n}\nexport class OpGE extends Atom {\n    to(stack: Stack) {stack.ge();}\n    str():string {return '>='}\n}\nexport class OpAdd extends Atom {\n    to(stack: Stack) {stack.add();}\n    str():string {return '+'}\n}\nexport class OpSub extends Atom {\n    to(stack: Stack) {stack.sub();}\n    str():string {return '-'}\n}\nexport class OpMul extends Atom {\n    to(stack: Stack) {stack.mul();}\n    str():string {return '*'}\n}\nexport class OpDiv extends Atom {\n    to(stack: Stack) {stack.div();}\n    str():string {return '/'}\n}\nexport class OpMod extends Atom {\n    to(stack: Stack) {stack.mod();}\n    str():string {return '%'}\n}\nexport class OpBitwiseAnd extends Atom {\n    to(stack: Stack) {stack.bitAnd();}\n    str():string {return '&'}\n}\nexport class OpBitwiseOr extends Atom {\n    to(stack: Stack) {stack.bitOr();}\n    str():string {return '|'}\n}\nexport class OpNeg extends Atom {\n    to(stack: Stack) {stack.neg();}\n    str():string {return '-'}\n}\nexport class OpBrace extends Atom {\n    to(stack: Stack) {}\n    str():string {return '()'}\n}\nexport class TextOperand extends Atom {\n    text:string;\n    constructor(text:string) {\n        super();\n        this.text = text;\n    }\n    to(stack: Stack) {stack.str(this.text);}\n    str():string {return '\\'' + this.text + '\\''}\n}\nexport class NumberOperand extends Atom {\n    num:number;\n    constructor(num:number) {\n        super();\n        this.num = num;\n    }\n    to(stack: Stack) {stack.num(this.num);}\n    str():string {return String(this.num)}\n}\nexport class HexOperand extends Atom {\n    text:string;\n    constructor(text:string) {\n        super();\n        this.text = text;\n    }\n    to(stack: Stack) {stack.hex(this.text);}\n    str():string {return '#h'}\n}\nexport class NullOperand extends Atom {\n    to(stack: Stack) { stack.hex('null'); }\n    str():string {return 'null'}\n}\nexport class VarOperand extends Atom {\n    get type():string {return 'var';}\n    dotFirst: boolean = false;\n    _var: string[] = [];\n    to(stack: Stack) {}\n    str():string {return this._var.join('.')}\n}\nexport class OpSearchCase extends Atom {\n    whenCount: number;\n    hasElse: boolean;\n    constructor(whenCount: number, hasElse: boolean) {\n        super();\n        this.whenCount = whenCount;\n        this.hasElse = hasElse;\n    }\n    to(stack: Stack) { stack.searchCase(this.whenCount, this.hasElse); }\n    str():string {return 'case'}\n}\nexport class OpSimpleCase extends Atom {\n    whenCount: number;\n    hasElse: boolean;\n    constructor(whenCount: number, hasElse: boolean) {\n        super();\n        this.whenCount = whenCount;\n        this.hasElse = hasElse;\n    }\n    to(stack: Stack) { stack.simpleCase(this.whenCount, this.hasElse); }\n    str():string {return 'case'}\n}\nexport class OpFunction extends Atom {\n    func: string;\n    paramCount: number;\n    constructor(func: string, paramCount: number) {\n        super();\n        this.func = func;\n        this.paramCount = paramCount;\n    }\n    to(stack: Stack) {stack.func(this.func, this.paramCount)}\n    str():string {return this.func}\n}\nexport class StarOperand extends Atom {\n    to(stack: Stack) {stack.star();}\n    str():string {return '*'}\n}\nexport class DatePartOperand extends Atom {\n    datePart: string;\n    constructor(datePart: string) {\n        super();\n        this.datePart = datePart;\n    }\n    to(stack: Stack) {stack.datePart(this.datePart)}\n    str():string {return this.datePart}\n}\nexport class ExistsSubOperand extends Atom {\n    to(stack: Stack) {stack.exists();}\n    str():string {return 'exists'}\n}\nexport class OpIsNull extends Atom {\n    to(stack: Stack) {stack.isNull()}\n    str():string {return 'is null'}\n}\nexport class OpIsNotNull extends Atom {\n    to(stack: Stack) {stack.isNotNull()}\n    str():string {return 'is not null'}\n}\nexport class OpIn extends Atom {\n    private params:number;\n    constructor(params:number) {\n        super();\n        this.params = params;\n    }\n    to(stack: Stack) {stack.in(this.params)}\n    str():string {return 'in'}\n}\nexport class OpLike extends Atom {\n    to(stack: Stack) {stack.like()}\n    str():string {return 'like'}\n}\nexport class OpBetween extends Atom {\n    to(stack: Stack) {}\n    str():string {return 'between'}\n}\nexport class OpNotBetween extends Atom {\n    to(stack: Stack) {}\n    str():string {return 'not between'}\n}\nconst dollarVars = ['unit', 'user', \n    'pagestart', 'pagesize',\n    'date', 'id', 'state', 'row', 'sheet_date', 'sheet_no', 'sheet_discription'];\nexport class OpDollarVar extends Atom {\n    static isValid(name:string):boolean { return dollarVars.find(v=>v===name) !== undefined }\n    _var: string;\n    constructor(_var:string) {super(); this._var = _var;}\n    to(stack: Stack) {stack.dollarVar(this._var)}\n    str():string {return '$' + this._var}\n}\n","import { Token } from \"./token\";\nimport { TokenStream } from './tokenStream';\nimport { Atom, \n    OpAdd, OpSub, OpBitwiseOr, OpAnd, OpBitwiseAnd, \n    OpBrace, OpDiv, OpDollarVar, OpEQ, OpFunction, OpGE, OpGT, \n    OpLE, OpLT, OpMod, OpMul, OpNE, OpNeg, OpNot, OpOr,\n    TextOperand, NumberOperand, HexOperand, VarOperand\n} from './atom';\n\nexport abstract class Expression\n{\n    protected ts: TokenStream;\n    protected at: number;\n    protected line: number;\n    protected sourceStart: number;\n    private atoms: Atom[] = [];\n\n    constructor(ts: TokenStream) {\n        this.ts = ts;\n    }\n    run():string {\n        let result:string = '';\n        for (let atom of this.atoms) {\n            result += atom.str() + ' ';\n        }\n        return result;\n    }\n\n    protected savePos() {\n        this.at = this.ts.prevAt;\n        this.line = this.ts.prevLine;\n        this.sourceStart = this.ts.LastP - 1;\n    }\n\n    protected getSource() {\n        return this.ts.getSourceAt(this.sourceStart);\n    }\n\n    private errorAt() {\n        let line = this.ts.startLine+1;\n        let at = this.ts.startAt + 1;\n        return this.ts.file + ' 错误在'+line+'行'+at+'列: \\n' + this.ts.getSourceNearby(this.sourceStart) + '\\n';\n    }\n\n    log(...msg:string[]) {\n        let err:string;\n        if (this.line === undefined)\n            err = msg.join('');\n        else {\n            let line = this.line + 1;\n            let at = this.at + 1;\n            err = this.ts.file + ' 错误在'+line+'行'+at+'列: \\n'\n                + this.ts.getSourceNearby(this.sourceStart) + '\\n'\n                + msg.join('\\n');\n        }\n        this.ts.log(err);\n    }\n\n    msg(...msg:string[]) {\n        let err:string;\n        if (this.line === undefined)\n            err = msg.join('');\n        else {\n            let line = this.line + 1;\n            let at = this.at + 1;\n            err = this.ts.file + ' 提醒在'+line+'行'+at+'列: '+msg.join('');\n        }\n        this.ts.log(err);\n    }\n\n    error(...msg:string[]) {\n        let err = this.errorAt()+msg.join('');\n        this.ts.log(err);\n        throw err;\n    }\n\n    expectToken(...tokens:Token[]) {\n        let err = this.errorAt()+'应该是'+tokens.map(v => Token[v]).join('或');\n        this.ts.log(err);\n        throw err;\n    }\n\n    expect(...msg:string[]) {\n        let err = this.errorAt() + '应该是'+msg.join('或');\n        this.ts.log(err);\n        throw err;\n    }\n\n    private add(atom: Atom) {\n        this.atoms.push(atom);\n    }\n\n    protected abstract entry():void;\n\n    parse() {\n        this._parse();\n    }\n\n    protected _parse() {\n        this.entry();\n    }\n\n    protected expCompare()\n    {\n        this.B();\n        for (; ; )\n        {\n            if (this.ts.token === Token.OR || this.ts.isKeyword('or') === true) {\n                this.ts.readToken();\n                this.B();\n                this.add(new OpOr());\n            }\n            else break;\n        }\n    }\n\n    private B()\n    {\n        this.C();\n        for (; ; )\n        {\n            if (this.ts.token === Token.AND || this.ts.isKeyword('and') === true) {\n                this.ts.readToken();\n                this.C();\n                this.add(new OpAnd());\n            }\n            else break;\n        }\n    }\n\n    private C()\n    {\n        if (this.ts.token === Token.NOT ||\n            this.ts.isKeyword('not'))\n        {\n            this.ts.readToken();\n            this.C();\n            this.add(new OpNot());\n            return;\n        }\n        this.expValue();\n        switch (this.ts.token)\n        {\n            default:\n                break;\n            case Token.LE:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpLE());\n                break;\n            case Token.LT:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpLT());\n                break;\n            case Token.EQU:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpEQ());\n                break;\n            case Token.NE:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpNE());\n                break;\n            case Token.GT:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpGT());\n                break;\n            case Token.GE:\n                this.ts.readToken();\n                this.expValue();\n                this.add(new OpGE());\n                break;\n        }\n    }\n\n    protected expValue()\n    {\n        this.t();\n        for (; ; )\n        {\n            switch (this.ts.token)\n            {\n                default:\n                    return;\n                case Token.ADD:\n                    this.ts.readToken();\n                    this.t();\n                    this.add(new OpAdd());\n                    break;\n                case Token.SUB:\n                    this.ts.readToken();\n                    this.t();\n                    this.add(new OpSub());\n                    break;\n            }\n        }\n    }\n\n    private t()\n    {\n        this.bitWise();\n        for (; ; )\n        {\n            switch (this.ts.token)\n            {\n                default:\n                    return;\n                case Token.MUL:\n                    this.ts.readToken();\n                    this.bitWise();\n                    this.add(new OpMul());\n                    break;\n                case Token.DIV:\n                    this.ts.readToken();\n                    this.bitWise();\n                    this.add(new OpDiv());\n                    break;\n                case Token.MOD:\n                    this.ts.readToken();\n                    this.bitWise();\n                    this.add(new OpMod());\n                    break;\n            }\n        }\n    }\n\n    private bitWise()\n    {\n        this.f();\n        for (; ; )\n        {\n            switch (this.ts.token)\n            {\n                default: return;\n                case Token.BITWISEAND:\n                    this.ts.readToken();\n                    this.f();\n                    this.add(new OpBitwiseAnd());\n                    break;\n                case Token.BITWISEOR:\n                    this.ts.readToken();\n                    this.f();\n                    this.add(new OpBitwiseOr());\n                    break;\n            }\n        }\n    }\n\n    private f()\n    {\n        let lowerVar:string;\n        switch (this.ts.token) {\n            case Token.SUB:\n                this.ts.readToken();\n                this.f();\n                this.add(new OpNeg());\n                return;\n            case Token.LPARENTHESE:\n                this.ts.readToken();\n                this.entry();\n                if (this.ts.token === Token.RPARENTHESE as any)\n                {\n                    let op = new OpBrace();\n                    this.add(op);\n                    this.ts.readToken();\n                    return;\n                }\n                this.expectToken(Token.RPARENTHESE);\n                return;\n            case Token.STRING:\n                this.add(new TextOperand(this.ts.text));\n                this.ts.readToken();\n                return;\n            case Token.NUM:\n                this.add(new NumberOperand(this.ts.dec));\n                this.ts.readToken();\n                return;\n            case Token.HEX:\n                this.add(new HexOperand(this.ts.text));\n                this.ts.readToken();\n                return;\n            case Token.DOLLARVAR:\n                //this.ts.readToken();\n                //if (this.ts.token !== Token.VAR as any) this.expect('变量名');\n                lowerVar = this.ts.lowerVar.substr(1);\n                if (OpDollarVar.isValid(lowerVar) === false) {\n                    this.error(lowerVar + '不是系统变量');\n                }\n                this.add(new OpDollarVar(lowerVar));\n                this.ts.readToken();\n                return;\n            case Token.VAR:\n                lowerVar = this.ts.lowerVar;\n                this.ts.readToken();\n                switch (this.ts.token as any) {\n                    default:\n                        let op = new VarOperand();\n                        op._var.push(lowerVar);\n                        this.add(op);\n                        return;\n                    case Token.LPARENTHESE:\n                        this.func(lowerVar);\n                        return;\n                }\n            default:\n                this.error('语法错误', this.ts._var);\n                return;\n        }\n    }\n\n    static funcs:{[name:string]:number|number[]} = {\n        concat: -1,\n        concat_ws: -1,\n        now: 0,\n        substr: [2,3],\n        unix_timestamp: [0,1],\n    };\n    private func(func:string) {\n        this.ts.readToken();\n        if (this.predefinedFunc(func) === true) return;\n        \n        let v = Expression.funcs[func];\n        if (v === undefined) {\n            this.error('未知的函数 ' + func);\n        }\n        let paramCount = this.readFuncParameters();\n        this.add(new OpFunction(func, paramCount));\n        if (Array.isArray(v)) {\n            let min = v[0], max = v[1];\n            if (paramCount < min) {\n                this.error('函数 ' + func + ' 至少 ' + min + '个参数');\n            }\n            else if (paramCount > max) {\n                this.error('函数 ' + func + ' 最多 ' + max + '个参数');\n            }\n        }\n        else if (v >= 0 && v !== paramCount) {\n            this.error('函数 ' + func + ' 只能是 ' + v + '个参数');\n        }\n    }\n    private predefinedFunc(func:string):boolean\n    {\n        //let paramCount = 0;\n        switch (func)\n        {\n            default:\n                return false;\n            case 'year':\n            case 'month':\n            case 'day':\n            case 'len':\n            case 'ltrim':\n            case 'rtrim':\n            case 'from_unixtime':\n                this.ReadFixCountFunc(func, 1);\n                break;\n            case 'rand':\n                this.ReadFixCountFunc(func, 0);\n                break;\n            case 'left':\n            case 'right':\n            case 'ifnull':\n            case 'round':\n                this.ReadFixCountFunc(func, 2);\n                break;\n            case 'replace':\n            case 'substring':\n                this.ReadFixCountFunc(func, 3);\n                break;\n            case 'charindex':\n                this.ReadVariableParameters(func, 2, 3);\n                break;\n        }\n        return true;\n    }\n\n    ReadFixCountFunc(func:string, count:number)\n    {\n        let paramCount = this.readFuncParameters();\n        if (count !== paramCount) this.error('函数'+func+'需要'+count+'个参数');\n        this.add(new OpFunction(func, count));\n    }\n\n    ReadVariableParameters(func:string, min:number, max:number)\n    {\n        let paramCount = this.readFuncParameters();\n        if (paramCount < min) this.error('函数'+func+'至少需要'+min+'个参数');\n        if (paramCount > max) this.error('函数'+func+'最多需要'+max+'个参数');\n        this.add(new OpFunction(func, paramCount));\n    }\n\n    private readFuncParameters():number\n    {\n        if (this.ts.token === Token.RPARENTHESE)\n        {\n            this.ts.readToken();\n            return 0;\n        }\n        let n = 0;\n        for (; ; )\n        {\n            this.expValue();\n            n++;\n            if (this.ts.token === Token.COMMA)\n            {\n                this.ts.readToken();\n                continue;\n            }\n            if (this.ts.token as any === Token.RPARENTHESE)\n            {\n                this.ts.readToken();\n                break;\n            }\n            this.expectToken(Token.COMMA, Token.RPARENTHESE);\n        }\n        return n;\n    }\n\n    static OperationExpression()\n    {\n        // Array.Sort<string>(DATEPARTS, StringComparer.CurrentCultureIgnoreCase);\n    }\n}\n\nexport class ValueExpression extends Expression {\n    entry() {\n        this.expValue();\n    }\n}\n\nexport class CompareExpression extends Expression {\n    entry() {\n        this.expCompare();\n    }\n}\n","import { TokenStream } from \"./tokenStream\";\nimport { ValueExpression } from \"./expression\";\n\nexport function test():string {\n    try {\n        let log = (text?:string) => {\n            return false;\n        };\n        let ts = new TokenStream(log, 'a + 2 * [b] * 3');\n        ts.readToken();\n        let exp = new ValueExpression(ts);\n        exp.parse();\n        return exp.run();\n    }\n    catch (err) {\n        return 'error: ' + err;\n    }\n}\n","import { CUqBase } from \"../tapp\";\nimport { VMain } from \"./VMain\";\nimport { VTestForm } from \"./VTestForm\";\nimport { test } from \"parser/test\";\n\nexport class CTest extends CUqBase {\n    protected async internalStart() {\n\t\t// eslint-disable-next-line\n\t\tlet values1 = this.uqs.performance.test1.values;\n\t\t// eslint-disable-next-line\n\t\tlet values2 = this.uqs.performance.test2.values;\n\t}\n\t\n\tget tagTest1() {\n\t\treturn this.uqs.performance.test1;\n\t}\n\n\tget tagTest2() {\n\t\treturn this.uqs.performance.test2;\n\t}\n\n    tab = () => this.renderView(VMain);\n\n    test = () => {\n        this.openVPage(VTestForm);\n    }\n\n    testParser = () => {\n        alert(test());\n    }\n\n    actionTestExpression = async () => {\n        let rev = test();\n\n        let data = {\n            name: 'subject3',\n            a: rev,\n        };\n        await this.uqs.performance.TestExpression.submitConvert(data);\n    }\n}\n","import * as React from 'react';\nimport { FA } from 'tonva';\n\nexport enum stateDefs {\n\tstart = 0,\n\ttodo = 10,\n\tdoing = 20,\n\tdone = 30,\n\tverified = 40,\n\tcanceled = 50,\n};\n\nconst stateNames:{[state:number]:string} = {\n\t\"0\": \"发布\",\n\t\"10\": \"待办\",\n\t\"20\": \"在办\",\n\t\"30\": \"已办\",\n\t\"40\": \"完成\",\n\t\"50\": \"取消\",\n};\n\nconst stateIcons:{[state:number]:JSX.Element} = {\n\t\"0\": <FA name=\"bullhorn\" />,\n\t\"10\": <FA name=\"ellipsis-h\" />,\n\t\"20\": <FA name=\"circle-o-notch\" className=\"text-primary\" />,\n\t\"30\": <FA name=\"flag\" className=\"text-success\" />,\n\t\"40\": <FA name=\"check-circle-o\" className=\"text-waning\" />,\n\t\"50\": <FA name=\"times\" className=\"text-danger\" />,\n};\n\nexport function stateName(state: number):string {\n\tif (!state) state = 0;\n\treturn stateNames[state];\n}\n\nexport function stateIcon(state: number):JSX.Element {\n\tif (!state) state = 0;\n\treturn stateIcons[state];\n}\n","import * as React from 'react';\nimport { VPage, FA, LMR, Page, Form, ItemSchema, Context, List, tv, UiSchema, UiTextItem } from 'tonva';\nimport { CHome } from './CHome';\nimport { observer } from 'mobx-react';\n\nexport class VMain extends VPage<CHome> {\n    async open(param?: any) {\n\t}\n\n\tprivate renderGroup = (item: any, index: number):JSX.Element => {\n\t\tlet {group, count, memberCount} = item;\n\t\treturn <div className=\"px-3 py-2\">{tv(group, v => {\n\t\t\tlet {name} = v;\n\t\t\tlet vCount:any, bg:string;\n\t\t\tlet style = {top: '0.0rem', right: '0.3rem'};\n\t\t\tlet cn = 'position-absolute text-success';\n\t\t\tif (memberCount <= 1) {\n\t\t\t}\n\t\t\telse if (memberCount < 10) {\n\t\t\t\tvCount = <small className={cn} style={style}>{memberCount}</small>;\n\t\t\t\tbg = 'bg-warning';\n\t\t\t}\n\t\t\telse if (memberCount < 100) {\n\t\t\t\tvCount = <small className={cn} style={style}>{memberCount}</small>;\n\t\t\t\tbg = 'bg-success';\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//vCount = <span className=\"position-relative\" style={{fontSize:'1.2rem'}}>99<small className=\"position-absolute\" style={{bottom:'-0.1rem', right:'-0.55rem'}}>+</small></span>;\n\t\t\t\tvCount = <small className={cn} style={style}>99+</small>;\n\t\t\t\tbg = 'bg-primary';\n\t\t\t}\n\t\t\tlet left = <div className={'red-dot num mr-3 d-flex w-2-5c h-2-5c rounded align-items-center justify-content-center position-relative text-white bg-warning text-right'}>\n\t\t\t\t<FA name=\"user-circle\" size=\"lg\" />\n\t\t\t\t{vCount}\n\t\t\t</div>;\n\t\t\tlet right = count>0 && <small className=\"\">{count}</small>;\n\t\t\treturn <LMR className=\"w-100 align-items-center\" left={left} right={right}>\n\t\t\t\t{name}\n\t\t\t</LMR>;\n\t\t})}</div>;\n\t}\n\n\tprivate onClickGroup = (item: any) => {\n\t\tthis.controller.showGroupAssigns(item);\n\t}\n\n\tprivate onClickSend = () => {\n\t\tthis.form.buttonClick('send');\n\t}\n\n\tprivate onFormSubmit = async (buttonName:string, context: Context) => {\n\t\tlet {name, discription} = context.data;\n\t\tawait this.controller.saveGroup(0, name, discription);\n\t\tthis.closePage();\n\t}\n\n\tprivate form: Form;\n\tprivate onClickAdd = () => {\n\t\tlet schema:ItemSchema[] = [\n\t\t\t{name: 'name', type: 'string'},\n\t\t];\n\t\tlet uiSchema:UiSchema = {\n\t\t\titems: {\n\t\t\t\tname: {\n\t\t\t\t\tlabel: '名称',\n\t\t\t\t\tplaceholder: '输入工作群组名称'\n\t\t\t\t} as UiTextItem\n\t\t\t}\n\t\t}\n\t\tlet right = <button onClick={this.onClickSend}\n\t\t\tclassName=\"btn btn-sm btn-success align-self-center mr-2\">\n\t\t\t<FA name=\"paper-plane-o\" />\n\t\t</button>;\n\t\tthis.openPageElement(<Page header=\"新建群\" right={right}>\n\t\t\t<div className=\"m-3\">\n\t\t\t\t<Form ref={f => this.form = f} schema={schema} uiSchema={uiSchema}\n\t\t\t\t\tonButtonClick={this.onFormSubmit} />\n\t\t\t</div>\n\t\t</Page>);\n\t}\n\n\tprivate keyGroup = (item:any) => {\n\t\tlet {group} = item;\n\t\tif (typeof group === 'object') return group.id;\n\t\treturn group;\n\t}\n\n\trender() {\n\t\tlet page = observer(() => {\n\t\t\tlet {myGroupsPager, todosChanged, defaultGroupAssignCount} = this.controller;\n\t\t\tlet {items} = myGroupsPager;\n\t\t\tlet right = <button onClick={this.onClickAdd}\n\t\t\t\tclassName=\"btn btn-sm btn-primary align-self-center mr-2\">\n\t\t\t\t<FA name=\"plus\" />\n\t\t\t</button>;\n\t\t\tlet myLeft = <div className={'red-dot mx-3 d-flex w-2-5c h-2-5c text-center rounded text-white align-items-center justify-content-center bg-info'}>\n\t\t\t\t<FA name=\"circle-o\" fixWidth={true} size=\"lg\" />\n\t\t\t\t{todosChanged===true && <u></u>}\n\t\t\t</div>;\n\t\t\tlet myRight = defaultGroupAssignCount>0 && <small className=\"mr-3\">{defaultGroupAssignCount}</small>;\n\n\t\t\treturn <Page header=\"首页\" headerClassName=\"bg-info\" right={right}>\n\t\t\t\t<LMR className=\"py-2 bg-white align-items-center cursor-pointer mb-2\"\n\t\t\t\t\tleft={myLeft} right={myRight}\n\t\t\t\t\tonClick={this.controller.showMyAssigns}>\n\t\t\t\t\t我的待办\n\t\t\t\t</LMR>\n\t\t\t\t<List items={items} \n\t\t\t\t\titem={{render:this.renderGroup, onClick: this.onClickGroup, key: this.keyGroup}}\n\t\t\t\t\tnone={()=><>[无]</>} />\n\t\t\t</Page>;\n\t\t});\n\t\treturn React.createElement(page);\n\t}\n\t\n}\n//{/*this.renderVm(VTodos)*/}\n/*\n<div className=\"py-2 d-flex bg-white align-items-center cursor-pointer mb-2\" \nonClick={this.controller.showMyTodos}>\n<div className={'red-dot mx-3 d-flex w-2-5c h-2-5c text-center rounded text-white align-items-center justify-content-center bg-info'}>\n\t<FA name=\"list-ol\" fixWidth={true} size=\"lg\" />\n\t{todosChanged===true && <u></u>}\n</div>\n<div>待办工作</div>\n</div>\n*/","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { VPage, tv, List, FA, Tuid, EasyTime, Scroller, UserView, User, Image } from 'tonva';\nimport { CHome } from './CHome';\nimport { NoteItem } from './NoteItem';\nimport { Group } from 'models';\n\nexport class VGroup extends VPage<CHome> {\n\t@observable private inputed: boolean = false;\n\t@observable private commandsShown: boolean = false;\n\n\tinit() {\n\t\tthis.scrollToBottom();\n\t}\n\tprivate scrollToBottom() {\n\t\tsetTimeout(() => {\n\t\t\tthis.divBottom?.scrollIntoView();\n\t\t}, 100);\n\t}\n\n\tprivate renderTime(noteItem:NoteItem, index:number):JSX.Element {\n\t\tlet {$create} = noteItem;\n\t\tif (index > 0) {\n\t\t\tlet lastNoteItem:NoteItem;\n\t\t\tlastNoteItem = this.controller.groupNotesPager.items[index-1];\n\t\t\tif ($create.getTime() - lastNoteItem.$create.getTime() < 2 * 60 * 1000) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\treturn <div className=\"pt-3 text-muted small text-center\"><EasyTime date={$create} /></div>\n\t}\n\n\tprivate onUserLoaded = (user:User) => {\n\t\tthis.scrollToBottom();\n\t}\n\n\tprivate renderNote = (noteItem:NoteItem, index:number):JSX.Element => {\n\t\tlet {owner} = noteItem;\n\t\tlet isMe = (Tuid.equ(owner, this.controller.user.id));\n\t\tlet vNote: any;\n\t\tif (isMe === true) {\n\t\t\tvNote = <div className=\"d-flex flex-column align-items-end my-2\">\n\t\t\t\t{noteItem.renderAsNote()}\n\t\t\t</div>\n\t\t}\n\t\telse {\n\t\t\tvNote = <UserView user={owner} onLoaded={this.onUserLoaded} render={(values:User)=> {\n\t\t\t\tlet {icon, nick, name} = values;\n\t\t\t\treturn <div className=\"d-flex align-items-start my-2\">\n\t\t\t\t\t<Image src={icon} className=\"w-2c h-2c mr-3\" />\n\t\t\t\t\t<div className=\"flex-fill d-flex flex-column align-items-start\">\n\t\t\t\t\t\t<div className=\"small text-muted mb-1\">{nick || name}</div>\n\t\t\t\t\t\t{noteItem.renderAsNote()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}} />;\n\t\t}\n\t\treturn <div className=\"d-block\">\n\t\t\t{this.renderTime(noteItem, index)}\n\t\t\t{vNote}\n\t\t</div>;\n\t}\n\n\tprivate inputRef = (input:any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t}\n\n\tprivate addTextNote = async () => {\n\t\tif (!this.input) return;\n\t\tlet content:string = this.input.value;\n\t\tthis.input.value = '';\n\t\tthis.inputed = false;\n\t\tawait this.controller.addTextNote(content);\n\t\tthis.commandsShown = false;\n\t\tthis.scrollToBottom();\n\t}\n\n\t\n\tprivate divBottom: HTMLElement;\n\tprivate refDivBottom = (divButtom:HTMLElement) => {\n\t\tthis.divBottom = divButtom;\n\t};\n\n\tprivate input: HTMLInputElement;\n\tprivate onKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.addTextNote();\n\t\t}\n\t}\n\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputed = evt.target.value.trim().length > 0;\n\t}\n\n\tprivate showCommands = () => {\n\t\tthis.commandsShown = !this.commandsShown;\n\t\tif (this.commandsShown) {\n\t\t\tthis.scrollToBottom();\n\t\t}\n\t}\n\n\tprivate taskTodo = async () => {\n\t\tthis.input.value = '';\n\t\tthis.inputed = false;\n\t\t//let ret = await this.controller.showNewTask();\n\t\t//if (ret === true) this.scrollToBottom();\n\t}\n\n\tprivate onListFocus = (evt: React.FocusEvent<HTMLUListElement>) => {\n\t\tthis.commandsShown = false;\n\t}\n\n\tprivate onDetail = () => {\n\t\tthis.controller.showGroupDetail();\n\t}\n\n\theader() {\n\t\tlet Header = observer(() => {\n\t\t\tlet {currentGroup} = this.controller;\n\t\t\treturn tv(currentGroup as any, (v:Group) => {\n\t\t\t\tlet {name, count} = v;\n\t\t\t\treturn <>{name} &nbsp; {count && <small>({count}成员)</small>}</>\n\t\t\t});\n\t\t});\n\t\treturn <Header />;\n\t}\n\tfooter() {\n\t\tlet Footer = observer(() => {\n\t\t\tlet cnFooter = classNames('w-100 d-flex flex-column justify-content-center', {\n\t\t\t});\n\t\t\tlet cnInputRow = classNames(\"d-flex px-2 align-items-center py-1 border-top\", \n\t\t\t\t{\n\t\t\t\t\t'align-items-start':  this.commandsShown,\n\t\t\t\t});\n\t\t\treturn <div className={cnFooter}>\n\t\t\t\t<div className={cnInputRow}>\n\t\t\t\t\t<input className=\"flex-fill form-control mr-2 mb-0\" \n\t\t\t\t\t\ttype=\"text\" ref={this.inputRef} \n\t\t\t\t\t\tonKeyDown={this.onKeyDown} onChange={this.onInputChange} />\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inputed === true?\n\t\t\t\t\t\t<button onClick={this.addTextNote}\n\t\t\t\t\t\t\tclassName=\"btn btn-sm btn-success text-nowrap\">\n\t\t\t\t\t\t\t发送\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t:\n\t\t\t\t\t\t<button onClick={this.showCommands}\n\t\t\t\t\t\t\tclassName=\"btn btn-sm btn-outline-dark\">\n\t\t\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t{\n\t\t\t\t\tthis.commandsShown === true && <div className=\"d-flex flex-wrap px-3 py-4\">\n\t\t\t\t\t\t<div className=\"cursor-pointer\" onClick={this.taskTodo}>\n\t\t\t\t\t\t\t<div className=\"p-2 bg-white\" style={{borderRadius:'0.6em'}}>\n\t\t\t\t\t\t\t\t<FA name=\"tasks\" size=\"lg\" fixWidth={true} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"text-center mt-1 small text-muted\"><small>作业</small></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t});\n\t\treturn <Footer />;\n\t}\n\tright() {\n\t\treturn <div className=\"d-flex px-3 align-items-center cursor-pointer\"\n\t\t\tonClick={this.onDetail}>\n\t\t\t<FA name=\"ellipsis-h\" />\n\t\t</div>;\n\t}\n\tcontent() {\n\t\tlet {groupNotesPager} = this.controller;\t\t\n\t\tlet bottomMark = observer(() => {\n\t\t\treturn <div id={groupNotesPager.bottomDiv} \n\t\t\t\tref={this.refDivBottom} \n\t\t\t\tclassName=\"h-1c\" />\n\t\t});\n\t\treturn <>\n\t\t\t<List className=\"px-3 flex-fill bg-transparent\" \n\t\t\t\titems={groupNotesPager.items} \n\t\t\t\titem={{render: this.renderNote}}\n\t\t\t\tonFocus={this.onListFocus} />\n\t\t\t{React.createElement(bottomMark)}\n\t\t</>;\n\t}\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {\n\t\tlet ret = await this.controller.groupNotesPager.more();\n\t\treturn ret;\n\t}\n}\n","import * as React from 'react';\nimport { CHome } from \"./CHome\";\nimport { VPage, Page, Edit, Schema, UiSchema, StringSchema, UiTextItem, UiTextAreaItem, ItemSchema, FA, QueryPager, UserView, UserIcon, Loading, Form, ButtonSchema, UiButton, Context, userApi, useUser, Tuid, List } from \"tonva\";\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport class VGroupDetail extends VPage<CHome> {\n\tprivate groupMembersPager: QueryPager<any>;\n\n    async open(groupMembersPager: QueryPager<any>) {\n\t\tthis.groupMembersPager = groupMembersPager;\n\t\tthis.openPage(this.page);\n\t}\n\n\tprivate onItemChanged = async (item:ItemSchema, value:any, prev:any) => {\n\t\tlet {currentGroup} = this.controller;\n\t\tlet props:any = {\n\t\t\tid: currentGroup.id,\n\t\t};\n\t\tswitch (item.name) {\n\t\t\tcase 'name':\n\t\t\t\tcurrentGroup.name = props.name = value;\n\t\t\t\tbreak;\n\t\t\tcase 'discription':\n\t\t\t\tcurrentGroup.discription = props.discription = value;\n\t\t\t\tbreak;\n\t\t}\n\t\tawait this.controller.saveGroupProp(props);\n\t}\n\n\tprivate onMember = (memberId:number) => {\n\t\tthis.controller.cApp.showMemberDetail(memberId);\n\t}\n\n\tprivate renderMember = (member:any) => {\n\t\tlet id:number = (typeof member === 'object')? member.id : member;\n\t\treturn <div key={id} className=\"m-2 cursor-pointer\"\n\t\t\tonClick={()=>this.onMember(id)}>\n\t\t\t<UserView id={id} render={user => {\n\t\t\t\tlet {name, nick} = user;\n\t\t\t\treturn \t<>\n\t\t\t\t<div className=\"w-3c h-3c rounded border \">\n\t\t\t\t\t<UserIcon id={id} className=\"w-100 h-100 rounded\" />\n\t\t\t\t</div>\n\t\t\t\t\t<div className=\"w-3c d-inline-block text-truncate small text-muted text-center\">\n\t\t\t\t\t\t<small>{nick || name}</small>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}} />\n\t\t</div>;\n\t}\n\n\tprivate onSubmitAddMember = async (name:string, context: Context) => {\n\t\tlet user = await userApi.fromKey(context.data.user);\n\t\tif (!user) {\n\t\t\tcontext.setError('user', '账号不存在或者不接受邀请');\n\t\t\treturn;\n\t\t}\n\t\tawait this.controller.groupAddMember(user);\n\t\t//  this.controller.setGroup();\n\t\tuseUser(user.id);\n\t\tthis.groupMembersPager.items.push({member: user.id});\n\t\tthis.closePage();\n\t}\n\n\tprivate onAddMember = () => {\n\t\tlet schema:Schema = [\n\t\t\t{name: 'user', type: 'string', maxLength: 100, required: true} as StringSchema,\n\t\t\t{name: 'submit', type: 'submit'} as ButtonSchema,\n\t\t];\n\t\tlet uiSchema: UiSchema = {\n\t\t\titems: {\n\t\t\t\tuser: {widget:'text', label:'成员', placeholder: '请输入成员账号'} as UiTextItem,\n\t\t\t\tsubmit: {widget:'button', label:'提交', className: 'btn btn-primary'} as UiButton,\n\t\t\t}\n\t\t}\n\t\tthis.openPageElement(<Page header=\"添加成员\">\n\t\t\t<Form onButtonClick={this.onSubmitAddMember}\n\t\t\t\tonEnter={this.onSubmitAddMember}\n\t\t\t\tclassName=\"m-5 px-5 py-3 bg-white\" \n\t\t\t\tschema={schema} uiSchema={uiSchema} />\n\t\t</Page>);\n\t}\n\n\t@observable disabled:boolean = true;\n\tprivate listRemoveMember:List;\n\tprivate renderRemoveButton = observer(()=> {\n\t\treturn <button onClick={this.onRemoveMemberList}\n\t\t\tclassName=\"btn btn-sm btn-success mr-2 align-self-center\"\n\t\t\tdisabled={this.disabled}>删除</button>;\n\t});\n\tprivate renderRemoveMemberItem = (item:any, index:number):JSX.Element => {\n\t\tlet {member} = item;\n\t\tlet id:number = (typeof member === 'object')? member.id : member;\n\t\t//return <div key={index} className=\"p-3\">{tv(item.member)}</div>;\n\t\treturn <UserView id={id} render={user => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn \t<div className=\"d-flex align-items-center py-2\">\n\t\t\t\t<div className=\"w-3c h-3c rounded border mx-3\">\n\t\t\t\t\t<UserIcon id={id} className=\"w-100 h-100 rounded\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"\">{nick || name}</div>\n\t\t\t</div>;\n\t\t}} />\n\t}\n\tprivate onRemoveMemberList = async () => {\n\t\tlet members = this.listRemoveMember.selectedItems;\n\t\tawait this.controller.groupRemoveMembers(members);\n\t\tlet {items} = this.groupMembersPager;\n\t\tfor (let m of members) {\n\t\t\tlet index = items.findIndex(v => v.member === m.member);\n\t\t\tif (index>=0) items.splice(index, 1);\n\t\t}\n\t\t//this.controller.setGroup();\n\t\tthis.closePage();\n\t}\n\tprivate onSelectRemoveMember = (item:any, isSelected:boolean, anySelected:boolean) => {\n\t\tthis.disabled = anySelected===false;\n\t}\n\tprivate onRemoveMember = () => {\n\t\tthis.openPageElement(<Page header=\"成员\" right={<this.renderRemoveButton />}>\n\t\t\t<List ref={list=>this.listRemoveMember=list} items={this.groupMembersPager.items} item={{\n\t\t\t\trender: this.renderRemoveMemberItem, \n\t\t\t\tonSelect: this.onSelectRemoveMember}} />\n\t\t</Page>);\n\t}\n\n\tprivate renderMemberAction = (icon:string, action:()=>void) => {\n\t\tlet {currentGroup, user} = this.controller;\n\t\tif (Tuid.equ(currentGroup.owner, user.id) === false) return;\n\t\treturn <div onClick={action}\n\t\t\tclassName=\"d-flex m-2 w-3c h-3c rounded border text-muted justify-content-center align-items-center cursor-pointer\">\n\t\t\t<FA name={icon} />\n\t\t</div>;\n\t}\n\n\tprivate renderMembers = () => {\n\t\tlet {items} = this.groupMembersPager;\n\t\tif (items === undefined) {\n\t\t\treturn <Loading />;\n\t\t}\n\t\tlet divMembers = [];\n\t\tfor (let item of items) {\n\t\t\tdivMembers.push(this.renderMember(item.member));\n\t\t}\n\t\treturn <div className=\"mb-3 bg-white d-flex flex-wrap p-2\">\n\t\t\t{divMembers}\n\t\t\t{this.renderMemberAction('plus', this.onAddMember)}\n\t\t\t{this.renderMemberAction('minus', this.onRemoveMember)}\n\t\t</div>;\n\t}\n\n\tprivate schema: Schema = [\n\t\t{name: 'name', type: 'string', maxLength: 100 } as StringSchema,\n\t\t{name: 'discription', type: 'string', maxLength: 1000} as StringSchema\n\t];\n\tprivate uiSchema: UiSchema = {\n\t\titems: {\n\t\t\tname: {\n\t\t\t\tlabel: '组名称',\n\t\t\t\twidget: 'text',\n\t\t\t} as UiTextItem,\n\t\t\tdiscription: {\n\t\t\t\tlabel: '组公告',\n\t\t\t\twidget: 'textarea',\n\t\t\t} as UiTextAreaItem\n\t\t}\n\t};\n\t//@observable private detail: any;\n\tprivate page = observer(():JSX.Element => {\n\t\tlet {currentGroup} = this.controller;\n\t\treturn <Page header=\"详情\">\n\t\t\t{this.renderMembers()}\n\t\t\t<Edit schema={this.schema} uiSchema={this.uiSchema} data={currentGroup}\n\t\t\t\tonItemChanged={this.onItemChanged} />\n\t\t</Page>;\n\t});\n}\n","import { CHome } from \"home/CHome\";\n\nexport abstract class NoteItem {\n\tid: number;\n\towner: number;\n\t$create: Date;\n\tprotected readonly cGroup: CHome\n\tconstructor(cGroup: CHome) {\n\t\tthis.cGroup = cGroup;\n\t}\n\tabstract renderAsNote():JSX.Element;\n\tabstract renderInView():JSX.Element;\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport { NoteItem } from \"./NoteItem\";\nimport { Tuid } from 'tonva';\n\nexport class NoteText extends NoteItem {\n\tcontent: string;\n\trenderAsNote():JSX.Element {\n\t\tlet isMe = (Tuid.equ(this.owner, this.cGroup.user.id));\n\t\tlet cnDiv = classNames('p-3 rounded', {\"bg-white\": !isMe});\n\t\tlet bgStyle:{[prop:string]:string} = {maxWidth:'75%'};\n\t\tif (isMe === true) bgStyle['backgroundColor'] = '#8f8';\n\t\treturn <div className={cnDiv} style={bgStyle}>{this.content}</div>;\n\t}\n\n\trenderInView():JSX.Element {\n\t\treturn this.renderAsNote();\n\t}\n}\n","import React from 'react';\nimport { NoteItem } from \"./NoteItem\";\nimport { stateIcon } from 'tools';\nimport { EasyTime } from 'tonva';\n\nexport class NoteAssign extends NoteItem {\n\tassignId: number;\n\tcaption: string;\n\tdiscription: string;\n\ttime: Date;\n\tx: number = 0;\n\n\trenderAsNote():JSX.Element {\n\t\tif (this.x === 1) {\n\t\t\t// removed\n\t\t\treturn <div className=\"w-100 d-flex justify-content-center\">\n\t\t\t\t<div className=\"bg-light py-1 px-3 small text-muted\">撤销了 <del>{this.discription}</del></div>\n\t\t\t</div>\n\t\t}\n\t\treturn this.renderInternal();\n\t}\n\trenderInView():JSX.Element {\n\t\treturn this.renderInternal();\n\t}\n\n\tprivate onClick = () => {\n\t\t//this.cGroup.showAssign(this);\n\t}\n\n\tprivate renderInternal():JSX.Element {\n\t\tlet cn = 'bg-info rounded border border-info w-75 cursor-pointer';\n\t\treturn <div className={cn}\n\t\t\tonClick={this.onClick}>\n\t\t\t<div className=\"d-flex align-items-center \">\n\t\t\t\t<div className=\"d-flex align-items-center justify-content-center text-danger w-3c h-3c \n\t\t\t\t\tbg-white border-info rounded-left\">\n\t\t\t\t\t{stateIcon(undefined)}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill px-3 py-2 text-white\">\n\t\t\t\t\t<div><b>{this.caption}</b></div>\n\t\t\t\t\t<div><span className=\"\">{this.discription}</span></div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"small px-3 py-1 text-light\">\n\t\t\t\t\t<EasyTime date={this.$create} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { NoteItem } from \"./NoteItem\";\nimport { EnumTaskAct, EnumTaskState } from 'tapp';\nimport { FA } from 'tonva';\n\nexport class NoteTaskTodo extends NoteItem {\n\ttaskId: number;\n\tcaption: string;\n\tdiscription: string;\n\ttime: Date;\n\towner: number;\n\tx: number;\n\tstep: EnumTaskAct;\n\tstate: EnumTaskState;\n\n\trenderAsNote():JSX.Element {\n\t\tif (this.x === 1) {\n\t\t\t// removed\n\t\t\treturn <div className=\"w-100 d-flex justify-content-center\">\n\t\t\t\t<div className=\"bg-light py-1 px-3 small text-muted\">撤销了 <del>{this.discription}</del></div>\n\t\t\t</div>\n\t\t}\n\t\treturn this.renderInternal();\n\t}\n\trenderInView():JSX.Element {\n\t\treturn this.renderInternal();\n\t}\n\n\tprivate onClick = () => {\n\t\t//this.cGroup.cApp.showTask(this.taskId);\n\t}\n\n\tprivate renderInternal():JSX.Element {\n\t\tlet text:string;\n\t\tswitch (this.step) {\n\t\t\tdefault: text = '未知 ' + this.step; break;\n\t\t\tcase EnumTaskAct.todo: text = '领办'; break;\n\t\t\tcase EnumTaskAct.done: text = '已办'; break;\n\t\t\tcase EnumTaskAct.check: text = '查验'; break;\n\t\t\tcase EnumTaskAct.rate: text = '评价'; break;\n\t\t}\n\t\treturn <div className=\"border rounded px-3 py-1 text-muted bg-light cursor-pointer\"\n\t\t\tonClick={this.onClick}>\n\t\t\t\t<FA className=\"text-danger mr-1\" name=\"chevron-circle-right\" />\n\t\t\t\t<span className=\"text-success mr-3\">{text}</span>\n\t\t\t\t<span className=\"text-dark mr-1\">{this.caption}</span>\n\t\t\t\t<small className=\"\">{this.discription}</small>\n\t\t\t</div>;\n\t}\n}\n","import { Note } from \"../../models\";\nimport { EnumNoteType, EnumTaskAct, EnumTaskState } from \"../../tapp\";\nimport { NoteText } from \"./NoteText\";\nimport { NoteAssign } from \"./NoteAssign\";\nimport { NoteTaskTodo } from \"./NoteTaskTodo\";\nimport { NoteItem } from \"./NoteItem\";\nimport { CHome } from \"../CHome\";\n\nexport * from \"./NoteItem\";\nexport * from './NoteAssign';\nexport * from './NoteTaskTodo';\n\nexport function dataToNoteItem(cGroup: CHome, note:Note, queryResults:{[name:string]:any[]}):NoteItem {\n\tswitch (note.type) {\n\t\tdefault: \n\t\t\tdebugger;\n\t\t\tthrow new Error('unknow note type');\n\t\tcase EnumNoteType.Text:\n\t\t\treturn buildNoteText(cGroup, note, queryResults);\n\t\tcase EnumNoteType.Assign:\n\t\t\treturn buildNoteAssign(cGroup, note, queryResults);\n\t\tcase EnumNoteType.Task:\n\t\t\treturn buildNoteTaskTodo(cGroup, note, queryResults);\n\t}\n}\n\nexport function createNoteText(cGroup: CHome, owner:any, content:string):NoteText {\n\tlet ret:NoteText = new NoteText(cGroup);\n\tret.owner = owner;\n\tret.content = content;\n\tret.$create = new Date();\n\treturn ret;\n}\n\nexport function createNoteAssign(cGroup: CHome, owner:any, assignId:number):NoteAssign {\n\tlet noteAssign:NoteAssign = new NoteAssign(cGroup);\n\tnoteAssign.owner = owner;\n\tnoteAssign.$create = new Date();\n\tnoteAssign.assignId = assignId;\n\treturn noteAssign;\n}\n\nexport function createNoteTaskTodo(cGroup: CHome):NoteTaskTodo {\n\tlet taskTodo:NoteTaskTodo = new NoteTaskTodo(cGroup);\n\treturn taskTodo;\n}\n\n\nfunction buildNoteText(cGroup: CHome, note: Note, results:{[name:string]:any[]}):NoteItem {\n\tlet ret:NoteText = new NoteText(cGroup);\n\tlet {id, owner, content} = note;\n\tret.id = id;\n\tret.owner = owner;\n\tret.$create = note.$create;\n\tret.content = content;\n\treturn ret;\n}\n\nfunction buildNoteAssign(cGroup: CHome, note:Note, results:{[name:string]:any[]}):NoteItem {\n\tlet noteAssign: NoteAssign = new NoteAssign(cGroup);\n\tlet {id, owner, $create, obj} = note;\n\tnoteAssign.id = id;\n\tnoteAssign.owner = owner;\n\tnoteAssign.$create = $create;\n\tlet {assigns} = results;\n\tlet assign = assigns.find(v => v.assignId === obj);\n\tif (assign !== undefined) {\n\t\tlet {assignId, caption, discription} = assign;\n\t\tnoteAssign.assignId = assignId;\n\t\tnoteAssign.caption = caption;\n\t\tnoteAssign.discription = discription;\n\t\tnoteAssign.x = note.x;\n\t}\n\treturn noteAssign;\n}\n\nfunction buildNoteTaskTodo(cGroup: CHome, note:Note, results:{[name:string]:any[]}):NoteItem {\n\tlet ret:NoteTaskTodo = new NoteTaskTodo(cGroup);\n\tlet {id, owner, $create, content, obj} = note;\n\tret.id = id;\n\tret.owner = owner;\n\tret.$create = $create;\n\tif (content) {\n\t\tlet parts = content.split('|');\n\t\tret.step = Number(parts[0]) as EnumTaskAct;\n\t\tret.state = Number(parts[1]) as EnumTaskState;\n\t}\n\n\tlet {tasks} = results;\n\tlet annItem = tasks.find(v => v.taskId === obj);\n\tif (annItem !== undefined) {\n\t\tlet {taskId, caption, discription} = annItem;\n\t\tret.taskId = taskId;\n\t\tret.caption = caption;\n\t\tret.discription = discription;\n\t\t//ret.time = time;\n\t\tret.x = note.x;\n\t}\n\treturn ret;\n}\n","import React from \"react\";\nimport { CAssigns } from \"./CAssigns\";\nimport { VPage } from \"tonva\";\n\nexport abstract class VBase<T extends CAssigns> extends VPage<T> {\n\tprivate divTop:HTMLElement;\n\tprotected scrollToTop() {\n\t\tsetTimeout(() => {\n\t\t\tthis.divTop?.scrollIntoView();\n\t\t}, 100);\n\t}\n\tprivate refTop = (el:HTMLElement) => {\n\t\tif (!el) return;\n\t\tthis.divTop=el.parentElement.previousElementSibling as HTMLElement;\n\t}\n\tprotected renderDivTop() {\n\t\treturn <div ref={this.refTop} style={{height:'0.01rem'}}></div>\n\t}\n\n\tprivate divBottom:HTMLElement;\n\tprotected scrollToBottom() {\n\t\tsetTimeout(() => {\n\t\t\tthis.divBottom?.scrollIntoView();\n\t\t}, 100);\n\t}\n\n\tprotected renderDivBottom() {\n\t\treturn <div ref={v=>this.divBottom=v} style={{height:'0.01rem'}}></div>\n\t}\n}\n","import React from \"react\";\nimport { Controller, View, FA } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport interface FooterInputProps {\n\tonAdd: (inputContent: string) => Promise<void>;\n\tcaption: string;\n}\n\nexport class VFooterInput<T extends Controller> extends View<T> {\n\t@observable protected isFocused: boolean = false;\n\t@observable protected inputContent: string;\n\tprivate props: FooterInputProps;\n\n\trender(props: FooterInputProps):JSX.Element {\n\t\tthis.props = props;\n\t\treturn React.createElement(observer(() => this.isFocused === true?\n\t\t\t<div className=\"d-flex p-3 align-items-center border-top\">\n\t\t\t\t<input className=\"flex-fill form-control mr-1 mb-0\" \n\t\t\t\t\ttype=\"text\" ref={this.inputRef}\n\t\t\t\t\tonBlur={this.onBlur}\n\t\t\t\t\tonKeyDown={this.onKeyDown} onChange={this.onInputChange} />\n\t\t\t\t<button onClick={this.onAddAction} disabled={!this.inputContent}\n\t\t\t\t\tclassName=\"btn btn-success\">\n\t\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t:\n\t\t\t<div className=\"p-3 border-top cursor-pointer\"\n\t\t\t\tonClick={() => this.isFocused = true}>\n\t\t\t\t<FA className=\"mr-3 text-success\" name=\"plus\" />{this.props.caption}\n\t\t\t</div>\n\t\t));\n\t}\n\n\tprotected input: HTMLInputElement;\n\tprotected lostFocusTimeoutHandler: NodeJS.Timeout;\n\tprotected onKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.onAddAction();\n\t\t}\n\t}\n\tprotected onBlur = (evt:React.FocusEvent<HTMLInputElement>) => {\n\t\tthis.lostFocusTimeoutHandler = setTimeout(() => {\n\t\t\tthis.lostFocusTimeoutHandler = undefined;\n\t\t\tthis.isFocused = false;\n\t\t}, 200);\n\t}\n\tprotected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputContent = this.input.value.trim();\n\t}\n\tprotected inputRef = (input:any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t\tthis.input.focus();\n\t\tif (this.inputContent) this.input.value = this.inputContent;\n\t}\n\n\tprotected onAddAction = async () => {\n\t\tclearTimeout(this.lostFocusTimeoutHandler);\n\t\tif (!this.input) return;\n\t\tif (!this.inputContent) return;\n\t\tthis.input.disabled = true;\n\t\tclearTimeout(this.lostFocusTimeoutHandler);\n\t\t//await this.controller.saveAssignItem(this.inputContent);\n\t\t//this.scrollToTop();\n\t\tif (this.props?.onAdd) this.props.onAdd(this.inputContent);\n\t\tthis.input.value = '';\n\t\tthis.inputContent = undefined;\n\t\tthis.input.disabled = false;\n\t\tthis.input.focus();\n\t}\n}\n","import React from 'react';\nimport { CAssigns, AssignListItem } from \"./CAssigns\";\nimport { List, FA, tv } from \"tonva\";\nimport { VBase } from \"./VBase\";\nimport { observer } from \"mobx-react\";\nimport { Assign } from 'models';\nimport { observable } from 'mobx';\nimport { VFooterInput, FooterInputProps } from './VFooterInput';\n\nexport abstract class VList<T extends CAssigns> extends VBase<T> {\n\t@observable private endItemsVisible: boolean = false;\n\theader() {\n\t\treturn this.controller.caption;\n\t}\n\n\tcontent() {\n\t\tlet page = observer(() => {\n\t\t\tlet {assignListItems: assignItems} = this.controller;\n\t\t\t//let none = <div className=\"px-3 py-2 text-muted small border-top\">[无]</div>;\n\t\t\treturn <>\n\t\t\t\t{this.renderDivTop()}\n\t\t\t\t{this.renderList('待办', this.renderAssignItem, assignItems)}\n\t\t\t\t{this.renderEndItems()}\n\t\t\t\t{this.renderDivBottom()}\n\t\t\t</>;\n\t\t});\n\t\treturn React.createElement(page);\n\t}\n\n\tprivate renderList(caption:string, \n\t\trenderItem: (item:any, index:number)=>JSX.Element, \n\t\tassignItems: AssignListItem[]) \n\t{\n\t\tlet none = <div className=\"px-3 py-3 text-muted small border-top border-bottom d-flex align-items-center\">\n\t\t\t<FA className=\"text-warning mr-3\" name=\"circle-thin\" />\n\t\t\t无{caption}任务\n\t\t</div>;\n\t\treturn <List className=\"bg-transparent mb-3\" items={assignItems}\n\t\t\titem={{\n\t\t\t\trender: renderItem, \n\t\t\t\tonClick:this.onClickAssign, \n\t\t\t\tkey: this.keyAssign, \n\t\t\t\tclassName:\"bg-transparent\"}}\n\t\t\tnone={none}\n\t\t/>;\n\t}\n\n\tprivate onToggleEndItems = async () => {\n\t\tif (this.endItemsVisible === true) {\n\t\t\tthis.endItemsVisible = false;\n\t\t\tthis.controller.endListItems = undefined;\n\t\t}\n\t\telse {\n\t\t\tthis.endItemsVisible = true;\n\t\t\tawait this.controller.loadEndItems();\n\t\t}\n\t}\n\tprivate renderEndItems() {\n\t\tlet btnToggle = (icon:string) => <button className=\"btn btn-info mx-3 my-2\"\n\t\t\tonClick={this.onToggleEndItems}>\n\t\t\t<FA className=\"mr-2\" name={icon} /> 已完成\n\t\t</button>;\n\n\t\tif (this.endItemsVisible === false) {\n\t\t\treturn btnToggle('chevron-right');\n\t\t}\n\t\treturn <>\n\t\t\t{btnToggle('chevron-down')}\n\t\t\t{this.renderList('完成', this.renderEndItem, this.controller.endListItems)}\n\t\t</>;\n\t}\n\n//\t@observable private isFocused: boolean = false;\n//\t@observable private inputContent: string;\n\tfooter() {\n\t\tlet props:FooterInputProps = {\n\t\t\tonAdd: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.newAssign(inputContent);\n\t\t\t\tthis.scrollToTop();\n\t\t\t},\n\t\t\tcaption: '新增任务'\n\t\t};\n\t\treturn this.renderVm(VFooterInput, props);\n\t\t/*\n\t\tlet Footer = observer(() => this.isFocused === true?\n\t\t\t<div className=\"d-flex p-3 align-items-center border-top\">\n\t\t\t\t<input className=\"flex-fill form-control mr-1 mb-0\" \n\t\t\t\t\ttype=\"text\" ref={this.inputRef}\n\t\t\t\t\tonBlur={this.onBlur}\n\t\t\t\t\tonKeyDown={this.onKeyDown} onChange={this.onInputChange} />\n\t\t\t\t<button onClick={this.onAddAssign} disabled={!this.inputContent}\n\t\t\t\t\tclassName=\"btn btn-success\">\n\t\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t:\n\t\t\t<div className=\"p-3 border-top\"\n\t\t\t\tonClick={() => this.isFocused = true}>\n\t\t\t\t<FA className=\"mr-3 text-success\" name=\"plus\" />添加任务\n\t\t\t</div>\n\t\t);\n\t\treturn React.createElement(Footer);\n\t\t*/\n\t}\n\t/*\n\tprivate input: HTMLInputElement;\n\tprivate lostFocusTimeoutHandler: NodeJS.Timeout;\n\tprivate onKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.onAddAssign();\n\t\t}\n\t}\n\tprivate onBlur = (evt:React.FocusEvent<HTMLInputElement>) => {\n\t\tthis.lostFocusTimeoutHandler = setTimeout(() => {\n\t\t\tthis.lostFocusTimeoutHandler = undefined;\n\t\t\tthis.isFocused = false;\n\t\t}, 200);\n\t}\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputContent = this.input.value.trim();\n\t}\n\tprivate inputRef = (input:any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t\tthis.input.focus();\n\t\tif (this.inputContent) this.input.value = this.inputContent;\n\t}\n\n\tprivate onAddAssign = async () => {\n\t\tclearTimeout(this.lostFocusTimeoutHandler);\n\t\tif (!this.input) return;\n\t\tif (!this.inputContent) return;\n\t\tthis.input.disabled = true;\n\t\tclearTimeout(this.lostFocusTimeoutHandler);\n\t\t//this.inputed = false;\n\t\tawait this.controller.newAssign(this.inputContent);\n\t\tthis.input.value = '';\n\t\tthis.inputContent = undefined;\n\t\tthis.input.disabled = false;\n\t\tthis.input.focus();\n\t\tthis.scrollToTop();\n\t}\n\t*/\n\n\tprivate keyAssign = (assignItem: AssignListItem) => {\n\t\treturn assignItem.assign.id;\n\t}\n\n\tprivate onClickAssign = (item: AssignListItem) => {\n\t\tthis.controller.showAssign(item.assign);\n\t}\n\n\tprivate renderAssignItem = (item:AssignListItem, index: number) => {\n\t\treturn this.renderAssignItemBase(item, false);\n\t}\n\n\tprivate renderEndItem = (item:AssignListItem, index: number) => {\n\t\treturn this.renderAssignItemBase(item, true);\n\t}\n\n\tprivate renderAssignItemBase(item:AssignListItem, end:boolean) {\n\t\tlet {assign} = item;\n\t\tlet icon:string, color:string, textColor:string;\n\t\tif (end === true) {\n\t\t\ticon = 'check-circle-o';\n\t\t\tcolor = 'text-warning';\n\t\t\ttextColor = 'text-muted';\n\t\t}\n\t\telse {\n\t\t\ticon = 'circle-o';\n\t\t\tcolor = 'text-info';\n\t\t}\n\t\treturn tv(assign, (values: Assign) => {\n\t\t\tlet {caption} = values;\n\t\t\treturn <div className=\"px-3 bg-white align-items-center\">\n\t\t\t\t<div className=\"py-3\">\n\t\t\t\t\t<FA className={'mr-3 ' + color} name={icon} size=\"lg\" fixWidth={true} /> \n\t\t\t\t</div>\n\t\t\t\t<div className={'py-2 ' + textColor}>\n\t\t\t\t\t<div>{caption}</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t}\n}\n","import { VList } from \"../../VList\";\nimport { CAssignsSelf } from \"./CAssignsSelf\";\n\nexport class VListForSelf extends VList<CAssignsSelf> {\n\n}\n","import React from \"react\";\nimport classNames from 'classnames'\nimport { Controller, View, FA, Page } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport interface InfoInputProps {\n\tonUpdate: (inputContent: string) => Promise<void>;\n  content: string;\n  color:string;\n}\n\nexport class VInfoInput<T extends Controller> extends View<T> {\n  @observable private disabled: boolean;\n  private inputText:string;\n  private props: InfoInputProps;\n\n  onEditInfo = () => {\n    this.disabled = true;\n    this.openPageElement(React.createElement(observer(() => {\n      let onClickSave = async () => {\n        if (this.disabled === true) return;\n        let inputText = this.inputText.trim();\n        await this.props.onUpdate(inputText);\n        this.closePage();\n      }\n      let onKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        if (evt.keyCode === 13) onClickSave();\n      }\n      let onInputChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n        this.inputText = evt.target.value;\n        this.disabled = this.props.content === this.inputText;\n      }\n      let right = <button className=\"btn btn-sm btn-success mr-2\"\n        disabled={this.disabled}\n        onClick={onClickSave}>保存</button>;\n      return <Page header=\"说明\" back=\"close\" right={right}>\n        <div className=\"p-3\">\n          <input className=\"form-control\" type=\"text\"\n            onChange={onInputChange} onKeyDown={onKeyDown}\n            defaultValue={this.props.content} />\n        </div>\n      </Page>;\n    })));\n  }\n\n  render(props: InfoInputProps):JSX.Element {\n    this.props = props;\n    this.inputText = this.props.content;\n\n    return <div className=\"p-2 cursor-pointer\" onClick={this.onEditInfo}>\n      <FA name={classNames(\"pencil-square-o\", this.props.color)} />\n    </div>\n  }\n\n}\n","import React from \"react\";\nimport { Controller, View, FA, Page } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport interface EditTextItemProps {\n\tonUpdate: (inputContent: string) => Promise<void>;\n  content: string;\n  header:string;\n}\n\nexport class VEditTextItemInput<T extends Controller> extends View<T> {\n  @observable private disabled: boolean;\n  private inputText:string;\n  private props: EditTextItemProps;\n\n  constructor(controller:T, props:EditTextItemProps) {\n    super(controller);\n    this.props = props;\n    this.inputText = this.props.content;\n  }\n\n  onUpdate = () => {\n    this.disabled = true;\n    this.openPageElement(React.createElement(observer(() => {\n      let onClickSave = async () => {\n        if (this.disabled === true) return;\n        let inputText = this.inputText.trim();\n        await this.props.onUpdate(inputText);\n        this.closePage();\n      }\n      let onKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        if (evt.keyCode === 13) onClickSave();\n      }\n      let onInputChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n        this.inputText = evt.target.value;\n        this.disabled = this.props.content === this.inputText;\n      }\n      let right = <button className=\"btn btn-sm btn-success mr-2\"\n        disabled={this.disabled}\n        onClick={onClickSave}>保存</button>;\n      return <Page header={this.props.header} back=\"close\" right={right}>\n        <div className=\"p-3\">\n          <input className=\"form-control\" type=\"text\"\n            onChange={onInputChange} onKeyDown={onKeyDown}\n            defaultValue={this.props.content} />\n        </div>\n      </Page>;\n    })));\n  }\n\n  render(props: EditTextItemProps):JSX.Element {\n    this.props = props;\n    this.inputText = this.props.content;\n\n    return <></>\n  }\n}\n","import React from 'react';\nimport { VBase } from \"./VBase\";\nimport { CAssigns } from './CAssigns';\nimport { Muted, EasyTime, FA, Page, useUser } from 'tonva';\nimport { observer } from 'mobx-react';\nimport { Assign, AssignTask, AssignItem, Todo } from 'models';\nimport { VFooterInput, FooterInputProps } from './VFooterInput';\nimport { stateText } from 'tapp';\nimport { InfoInputProps, VInfoInput } from './VInfoInput';\nimport { VEditTextItemInput, EditTextItemProps } from './VEditTextItem';\n\nexport const vStopFlag = <FA name=\"square-o\" className=\"text-danger small\" />;\n\nexport abstract class VAssign<T extends CAssigns> extends VBase<T> {\n\tprotected assign: Assign;\n\n\tinit(params?: any) {\n\t\tthis.assign = this.controller.assign;\n\t\tuseUser(this.assign.owner);\n\t}\n\n\theader() {return '任务详情';}\n\n\tprotected renderCaption() {\n\t\tlet {caption, end} = this.assign;\n\t\tlet icon = end === 1? 'check-circle-o' : 'circle-o';\n\t\treturn <div className=\"bg-white p-3 d-flex align-items-center\">\n\t\t\t<FA className=\"mr-3 text-success\" name={icon} size=\"lg\" />\n\t\t\t<b>{caption}</b>\n\t\t</div>;\n\t}\n\n\tprotected renderFrom() {\n\t\tlet {owner, $create, $update} = this.assign;\n\t\tlet spanUpdate:any;\n\t\tif ($update.getTime() - $create.getTime() > 6*3600*1000) {\n\t\t\tspanUpdate = <><Muted>更新:</Muted> <EasyTime date={$update} /></>;\n\t\t}\n\t\treturn <div className=\"d-flex px-3 py-2 border-top bg-white align-items-center text-muted\">\n\t\t\t<small>{this.renderUser(owner)}</small>\n\t\t\t<span className=\"mr-3 small\">创建于<EasyTime date={$create} /> {spanUpdate}</span>\n\t\t</div>;\n\t}\n\n\tprotected renderDiscription() {\n\t\tlet {discription} = this.assign;\n\t\tif (!discription) return;\n\t\tlet parts = discription.split('\\n');\n\t\treturn <div className=\"bg-white px-3 py-2 border-top\">\n\t\t\t{parts.map((v, index) => <div key={index} className=\"py-2\">{v}</div>)}\n\t\t</div>;\n\t}\n\n\tprotected renderAssignItem(item:AssignItem) {\n\t\tlet ismy = this.isMe(this.assign.owner);\n\t\tlet {id, discription, x} = item;\n\t\tlet oinfo:JSX.Element = undefined;\n\t\tlet icon = 'circle';\n\t\tlet cnIcon = 'text-primary';\n\t\tif (ismy) {\n\t\t\tlet eIcon = x === 1? 'undo' : 'minus-circle';\n\t\t\tlet eColor = x === 1? 'text-success' : 'text-danger'\n\t\t\tlet onCutUndo = () => {\n\t\t\t\tthis.controller.setAssignItemFlag(item, x === 1? 0: 1);\n\t\t\t}\n\t\t\tlet onUpdate = async (v:string) => {\n\t\t\t\tawait this.controller.setAssignItemContent(item, v);\n\t\t\t}\n\t\t\tlet eprops:EditTextItemProps = {onUpdate:onUpdate, content:discription, header:'编辑事项'}\n\t\t\tlet vEdit = new VEditTextItemInput(this.controller, eprops);\n\t\t\toinfo = <>{x === 1?<del className=\"flex-fill ml-3\">{discription}</del>:\n\t\t\t\t<div className=\"flex-fill ml-3 cursor-ponter\" onClick={vEdit.onUpdate}>{discription}</div>}\n\t\t \t\t<div className=\"p-2 cursor-pointer\" onClick={onCutUndo}>\n\t\t\t \t\t<FA name={eIcon} className={eColor} />\n\t\t \t\t</div>\n\t\t\t</>\n\t\t}\n\t\telse {\n\t\t\toinfo = x === 1?<del className=\"flex-fill ml-3\">{discription}</del>:\n\t\t\t<div className=\"flex-fill ml-3\" >{discription}</div>\n\t\t}\n\n\t\treturn <div key={id} className=\"pl-5 pr-3 py-2 d-flex align-items-center bg-white border-top\">\n\t\t\t<small><FA name={icon} className={cnIcon} fixWidth={true} /></small>\n\t\t\t{oinfo}\n\t\t</div>\n\t}\n\n\tprotected renderTodoWithCheck(id:number, discription:string, onCheckChanged: (isChecked:boolean) => Promise<void>, isChecked:boolean) {\n\t\tlet onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tif (!onCheckChanged) return;\n\t\t\tonCheckChanged(evt.target.checked);\n\t\t}\n\t\treturn <label key={id}\n\t\t\tclassName=\"px-3 py-2 m-0 d-flex align-items-center bg-white border-top cursor-point\">\n\t\t\t<input type=\"checkbox\" onChange={onChange} defaultChecked={isChecked}/>\n\t\t\t<div className=\"flex-fill ml-3\">{discription}</div>\n\t\t</label>\n\t}\n\n\tprotected renderAssignItems():any {\n\t\tlet {items} = this.controller.assign;\n\t\treturn items.map((v, index) => this.renderAssignItem(v));\n\t}\n\n\tprotected renderTodos() {\n\t\tlet {tasks} = this.controller.assign;\n\t\tlet my = tasks.find(v => this.isMe(v.worker));\n\t\tif (!my) {\n\t\t\treturn this.renderAssignItems();\n\t\t}\n\t\tlet {todos} = my;\n\t\treturn <div className=\"border-top border-bottom\">\n\t\t<div className=\"border-bottom bg-light small py-1 px-3 text-muted\">事项</div>\n\t\t\t{todos.map((item, index) => {\n\t\t\t\treturn this.renderTodo(item, index);\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprotected renderTodo (todo:Todo, index:number):JSX.Element {\n\t\tlet {id, discription, done, doneMemo, x} = todo;\n\t\tlet onCheckChanged = async (isChecked:boolean):Promise<void> => {\n\t\t\tawait this.controller.saveTodoDone(todo, isChecked?1:0);\n\t\t\treturn;\n\t\t}\n\t\tlet onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tif (!onCheckChanged) return;\n\t\t\tonCheckChanged(evt.target.checked);\n\t\t}\n\t\tlet eIcon = x === 1? 'undo' : 'minus-circle';\n\t\tlet eColor = x === 1? 'text-success' : 'text-danger'\n\t\tlet onCutUndo = () => {\n\t\t\tthis.controller.setTodoFlag(todo, x === 1? 0: 1);\n\t\t}\n\t\tlet onUpdate = async (v:string) => {\n\t\t\tawait this.controller.saveTodoContent(todo, v);\n\t\t}\n\t\tlet eprops:EditTextItemProps = {\n\t\t\tonUpdate:onUpdate, content:discription, header:'编辑事项'\n\t\t}\n\n\t\tlet vEdit = new VEditTextItemInput(this.controller, eprops);\n\n\t\treturn <div className={'d-flex bg-white '}>\n\t\t\t<label key={id} className=\"flex-grow-1 px-3 py-2 m-0 d-flex cursor-point\">\n\t\t\t\t<input className=\"mt-1 mr-3\" type=\"checkbox\" onChange={onChange} defaultChecked={done === 1} disabled={x === 1}/>\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t{x===1?<del className=\"\">{discription}</del>:\n\t\t\t\t\t\t<div className=\"cursor-pointer\" onClick={e => {e.preventDefault();vEdit.onUpdate()} }>{discription}</div> }\n\t\t\t\t\t{x!==1 && doneMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info\">{doneMemo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t{x !== 1 && this.renderMemo(todo)}\n\t\t\t<div className=\"p-2 cursor-pointer\" onClick={onCutUndo}>\n      \t<FA name={eIcon} className={eColor} />\n    \t</div>\n\t\t</div>\n\t}\n\n\tprotected renderMemo(todo: Todo):JSX.Element {\n\t\tlet props:InfoInputProps = {\n\t\t\tonUpdate: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoDoneMemo(todo, inputContent);\n\t\t\t},\n\t\t\tcontent: todo.doneMemo,\n\t\t\tcolor: 'text-info'\n\t\t};\n\t\treturn this.renderVm(VInfoInput, props);\n\t}\n\n\tprotected renderTaskItem(task: AssignTask) {\n\t\tlet {state, actionTime} = task;\n\t\tlet {me} = stateText(state);\n\t\treturn <>\n\t\t\t{me} <EasyTime date={actionTime} />\n\t\t</>\n\t}\n\n\tcontent():JSX.Element {\n\t\treturn React.createElement(observer(() => this.renderContent()));\n\t}\n\n\tprotected renderContent() {\n\t\treturn <>\n\t\t\t{this.renderFrom()}\n\t\t\t{this.renderCaption()}\n\t\t\t{this.renderDiscription()}\n\t\t\t{this.renderTodos()}\n\t\t</>;\n\t}\n}\n\nexport class VAssignDraft<T extends CAssigns> extends VAssign<T> {\n\tprotected renderContent() {\n\t\treturn <>\n\t\t\t{super.renderContent()}\n\t\t\t<div className=\"pt-3\">\n\t\t\t\t{this.renderDraft()}\n\t\t\t</div>\n\t\t</>;\n\t}\n\n\tprotected get selfDoneCaption():string {return '自己完成';}\n\tprotected renderSelfDone() {\n\t\treturn <div className=\"px-3 py-2 border-top bg-white cursor-pointer\"\n\t\t\tonClick={this.controller.selfDone}>\n\t\t\t<FA className=\"mr-3 text-danger\" name=\"chevron-circle-right\" fixWidth={true} /> {this.selfDoneCaption}\n\t\t</div>;\n\t}\n\n\tprotected renderDraft() {\n\t\treturn this.renderSelfDone()\n\t}\n\n\tprotected renderDiscription() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {discription} = this.assign;\n\t\t\tlet {isMyAssign} = this.controller;\n\t\t\tif (discription) {\n\t\t\t\tlet vTitle:any;\n\t\t\t\tif (isMyAssign === true) {\n\t\t\t\t\tvTitle = <div className=\"small muted pt-2 pb-1 px-3 cursor-pointer\" onClick={this.editDiscription}>\n\t\t\t\t\t\t说明 <FA name=\"pencil-square-o ml-3\" />\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t\treturn <div>\n\t\t\t\t\t{vTitle}\n\t\t\t\t\t{super.renderDiscription()}\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\telse if (isMyAssign) {\n\t\t\t\treturn <div className=\"bg-white border-top px-3 py-2 cursor-pointer\" onClick={this.editDiscription}>\n\t\t\t\t\t<FA className=\"mr-3\" name=\"pencil-square-o\" /> <Muted>添加说明</Muted>\n\t\t\t\t</div>;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate editDiscription = () => {\n\t\tlet textarea:HTMLTextAreaElement;\n\t\tlet saveDiscription = async () => {\n\t\t\tlet disc = textarea.value;\n\t\t\tawait this.controller.saveAssignDiscription(disc);\n\t\t\tthis.assign.discription = disc;\n\t\t\tthis.closePage();\n\t\t}\n\t\tlet right = <button className=\"btn btn-sm btn-success mr-2\" onClick={saveDiscription}>保存</button>;\n\t\tlet {discription} = this.assign;\n\t\tthis.openPageElement(<Page header=\"说明\" right={right}>\n\t\t\t<div className=\"m-3 border\">\n\t\t\t\t<textarea ref={v => textarea = v} className=\"w-100 border-0 form-control\" \n\t\t\t\t\trows={8} defaultValue={discription} />\n\t\t\t</div>\n\t\t</Page>);\n\t}\n\n\tfooter() {\n\t\tif (!this.controller.isMyAssign) {\n\t\t\treturn null;\n\t\t}\n\t\tlet props:FooterInputProps = {\n\t\t\tonAdd: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveAssignItem(inputContent);\n\t\t\t\tthis.scrollToTop();\n\t\t\t\treturn;\n\t\t\t},\n\t\t\tcaption: '添加事项'\n\t\t};\n\t\treturn this.renderVm(VFooterInput, props);\n\t}\n}\n\nexport class VAssignEnd<T extends CAssigns> extends VAssign<T> {\n\n\tprotected renderTodos() {\n\t\tlet {tasks} = this.controller.assign;\n\t\tlet my = tasks.find(v => this.isMe(v.worker));\n\t\tif (!my) {\n\t\t\treturn super.renderTodos();\n\t\t}\n\t\tlet {todos} = my;\n\t\treturn todos.map((item, index) => {\n\t\t\tlet {assignItem, discription, id} = item;\n\t\t\tlet cn:string, icon:string;\n\t\t\tif (assignItem) {\n\t\t\t\tcn = 'text-primary';\n\t\t\t\ticon = 'circle';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcn = 'text-info';\n\t\t\t\ticon = 'circle-o'\n\t\t\t}\n\t\t\treturn <div key={id} className=\"px-3 py-2 d-flex align-items-center bg-white border-top\">\n\t\t\t\t<small><small><FA name={icon} className={cn} fixWidth={true} /></small></small>\n\t\t\t\t<div className=\"flex-fill ml-3\">{discription}</div>\n\t\t\t</div>\n\t\t});\n\t}\n}\n","import React from \"react\";\nimport { VAssignDraft, VAssignEnd, vStopFlag } from \"../../VAssign\";\nimport { CAssignsSelf } from \"./CAssignsSelf\";\nimport { AssignItem } from \"models\";\nimport { FooterInputProps, VFooterInput } from \"../../VFooterInput\";\n\nexport class VAssignDraftSelf extends VAssignDraft<CAssignsSelf> {\n\tprotected get selfDoneCaption():string {return '完成'}\n\n\tprotected renderAssignItem(item:AssignItem) : any {\n\t\treturn undefined;\n\t\t// let {id, discription} = item;\n\t\t// let onCheckChanged = (isChecked:boolean):Promise<void> => {\n\t\t// \t//alert(isChecked);\n\t\t// \treturn;\n\t\t// }\n\t\t// return <div className=\"pl-4 bg-white\">\n\t\t// \t{this.renderTodoWithCheck(id, discription, onCheckChanged, false)}\n\t\t// </div>;\n\t}\n\n\tfooter() {\n\t\tlet props:FooterInputProps = {\n\t\t\tonAdd: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoItem(inputContent);\n\t\t\t\tthis.scrollToTop();\n\t\t\t},\n\t\t\tcaption: '添加我的任务事项'\n\t\t};\n\t\treturn this.renderVm(VFooterInput, props);\n\t}\n}\n\nexport class VAssignEndSelf extends VAssignEnd<CAssignsSelf> {\n\tprotected get selfDoneCaption():string {return '完成'}\n\n\trenderContent() {\n\t\tlet {tasks} = this.assign;\n\t\tlet my = tasks[0];\n\t\treturn <>\n\t\t\t{super.renderContent()}\n\t\t\t<div className=\"mt-3 px-3 py-2 bg-white\">\n\t\t\t\t{this.renderTaskItem(my)}\n\t\t\t\t<span className=\"mx-3\">{vStopFlag}</span>\n\t\t\t</div>\n\t\t</>;\n\t}\n}\n","import React from \"react\";\nimport { VList } from \"../../VList\";\nimport { CAssignsNoMember } from \"./CAssignsNoMember\";\nimport { FA } from \"tonva\";\n\nexport class VListNoMember extends VList<CAssignsNoMember> {\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-secondary mr-2\"\n\t\t\tonClick={this.controller.showGroupDetail}>\n\t\t\t<FA name=\"ellipsis-h\" />\n\t\t</button>;\n\t}\n}\n","import React from \"react\";\nimport { VAssignDraft, VAssignEnd } from \"../../VAssign\";\nimport { CAssignsNoMember } from \"./CAssignsNoMember\";\nimport { AssignItem } from \"models\";\nimport { FooterInputProps, VFooterInput } from \"../../VFooterInput\";\n\nexport class VAssignDraftNoMember extends VAssignDraft<CAssignsNoMember> {\n\tprotected get selfDoneCaption():string {return '完成'}\n\n\tprotected renderAssignItem(item:AssignItem) {\n\t\tlet {id, discription} = item;\n\t\tlet onCheckChanged = (isChecked:boolean):Promise<void> => {\n\t\t\t//alert(isChecked);\n\t\t\treturn;\n\t\t}\n\t\treturn <div className=\"pl-4 bg-white\">\n\t\t\t{this.renderTodoWithCheck(id, discription, onCheckChanged, false)}\n\t\t</div>;\n\t}\n\n\tfooter() {\n\t\tlet props:FooterInputProps = {\n\t\t\tonAdd: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoItem(inputContent);\n\t\t\t\tthis.scrollToTop();\n\t\t\t},\n\t\t\tcaption: '添加我的任务事项'\n\t\t};\n\t\treturn this.renderVm(VFooterInput, props);\n\t}\n\n\tprotected renderContent() {\n\t\treturn super.renderContent();\n\t}\n}\n\nexport class VAssignEndNoMember extends VAssignEnd<CAssignsNoMember> {\n\tprotected get selfDoneCaption():string {return '完成'}\n\n}\n","import React from \"react\";\nimport { CAssigns } from \"../CAssigns\";\nimport { VAssign } from \"../VAssign\";\nimport { AssignTask, Todo } from \"models\";\nimport { List, FA } from \"tonva\";\n\nexport abstract class VTask extends VAssign<CAssigns> {\n\tprotected task: AssignTask;\n\n\tinit(task: AssignTask) {\n\t\tsuper.init();\n\t\tthis.task = task;\n\t}\n\n\tprotected get back():'close' {return 'close'}\n\n\tprotected afterAct() {\n\t\tthis.closePage(2);\n\t\tthis.controller.showAssign();\n\t}\n\n\tprotected renderContent() {\n\t\treturn <div className=\"m-3\">\n\t\t\t<div className=\"border rounded\">\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderDiscription()}\n\t\t\t\t{this.renderTodos()}\n\t\t\t</div>\n\t\t\t{this.renderMore()}\n\t\t</div>\n\t}\n\n\tprotected abstract renderMore():JSX.Element;\n\n\n\tprotected renderTodos():JSX.Element {\n\t\tif (!this.task) {\n\t\t\treturn this.renderAssignItems();\n\t\t}\n\t\tlet {todos} = this.task;\n\t\tif (todos.length === 0) return;\n\t\treturn <div className=\"border-top border-bottom\">\n\t\t\t<div className=\"border-bottom bg-light small py-1 px-3 text-muted\">事项</div>\n\t\t\t<List items={todos} \n\t\t\t\titem={{render: this.rendTodoListItem}} />\n\t\t</div>;\n\t}\n\n\tprivate rendTodoListItem = (todo:Todo, index:number) => {\n\t\tlet {x} = todo;\n\t\tif (x === 1) return null;\n\t\treturn this.renderTodo(todo, index);\n\t}\n\n\tprotected renderTodo (todo:Todo, index:number):JSX.Element {\n\t\tlet {discription, doneMemo, checkMemo} = todo;\n\t\treturn <div className={'py-2 d-flex'}>\n\t\t\t<div className=\"mx-3\">{this.renderTodoDot(todo)}</div>\n\t\t\t<div className=\"flex-fill\">\n\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t\t<div className=\"flex-fill\">{discription}</div>\n\t\t\t\t\t\t{doneMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t\t<span className=\"text-info\">{doneMemo}</span>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t{checkMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t\t\t<FA name=\"comments-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t\t<span className=\"text-info\">{checkMemo}</span>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tprotected renderTodoRadio(todo: Todo):JSX.Element {\n\t\treturn <></>;\n\t}\n\n\tprotected renderMemoBase(memo:string, color:string, icon:string, caption:string): JSX.Element {\n\t\t/*\n\t\tif (vTodo === undefined) return;\n\t\tlet {state} = this.task;\n\t\tswitch (state) {\n\t\t\tcase EnumTaskState.done:\n\t\t\t\treturn;\n\t\t}\n\t\tlet {check, checkMemo} = todo;\n\t\tif (check === undefined) return;\t\t\n\t\tlet {checkColor, checkText, checkIcon} = vTodo;\n\t\t*/\n\t\tif (!memo) return;\n\t\treturn <div className=\"mt-1\">\n\t\t\t<span className={'small text-' + color}>\n\t\t\t\t<span className=\"mr-3\">\n\t\t\t\t\t<FA className=\"mr-1\" name={icon} />\n\t\t\t\t\t<span className=\"text-muted\">{caption}</span>\n\t\t\t\t</span>\n\t\t\t\t{memo}\n\t\t\t</span>\n\t\t</div>;\n\t}\n\n\tprotected renderTodoDot(todo:Todo) {\n\t\tlet {assignItem} = todo;\n\t\tlet dotColor:string, dotIcon:string;\n\t\tif (assignItem) {\n\t\t\tdotIcon = 'circle';\n\t\t\tdotColor = 'text-black';\n\t\t}\n\t\telse {\n\t\t\tdotIcon = 'circle';\n\t\t\tdotColor = 'text-primary';\n\t\t}\n\n\t\treturn <small><small><FA name={dotIcon} className={dotColor} fixWidth={true} /></small></small>;\n\t}\n}\n","import React from \"react\";\nimport { VTask } from \"./VTask\";\nimport { Todo, AssignItem } from \"models\";\nimport { InfoInputProps, VInfoInput } from \"assigns/VInfoInput\";\nimport { FA } from \"tonva\";\n\nexport class VDone extends VTask {\n\theader() {return '完成'}\n\n\tprotected renderMore() {\n\t\tlet enabled = this.calcEnabled(this.task.todos);\n\t\treturn <div className=\"mt-3 text-center\">\n\t\t\t<button className=\"btn btn-success\" onClick={this.done} disabled={!enabled}>确认完成</button>\n\t\t</div>\n\t}\n\n\tprivate calcEnabled(todos: Todo[]):boolean {\n\t\tif (todos === undefined || todos.length === 0) return true;\n\t\tfor (let todo of todos) {\n\t\t\tlet {done} = todo;\n\t\t\tif (done === undefined || done === 0) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\n\tprivate done = async () => {\n\t\t// 暂时界面上不输入分数\n\t\tlet point = 0;\n\t\tlet comment:string;\n\t\tif (this.task) {\n\t\t\tawait this.controller.doneTask(this.task.id, point, comment);\n\t\t}\n\t\telse {\n\t\t\tawait this.controller.doneAssign(point, comment);\n\t\t}\n\t\tthis.afterAct();\n\t}\n\n\tprotected renderTodo (todo:Todo, index:number):JSX.Element {\n\t\tlet {id, discription, done, doneMemo} = todo;\n\t\tlet onCheckChanged = async (isChecked:boolean):Promise<void> => {\n\t\t\tawait this.controller.saveTodoDone(todo, isChecked?1:0);\n\t\t\treturn;\n\t\t}\n\t\tlet onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tif (!onCheckChanged) return;\n\t\t\tonCheckChanged(evt.target.checked);\n\t\t}\n\n\t\treturn <div className={'d-flex'}>\n\t\t\t<label key={id} className=\"flex-grow-1 px-3 py-2 m-0 d-flex bg-white cursor-point\">\n\t\t\t\t<input className=\"mt-1 mr-3\" type=\"checkbox\" onChange={onChange} defaultChecked={done === 1}/>\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t<div className=\"\">{discription}</div>\n\t\t\t\t\t{doneMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info\">{doneMemo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t{this.renderMemo(todo)}\n\t\t</div>\n\t}\n\n\tprotected renderMemo(todo: Todo):JSX.Element {\n\t\tlet props:InfoInputProps = {\n\t\t\tonUpdate: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoDoneMemo(todo, inputContent);\n\t\t\t},\n\t\t\tcontent: todo.doneMemo,\n\t\t\tcolor: 'text-info'\n\t\t};\n\t\treturn this.renderVm(VInfoInput, props);\n\t}\n\n\tprotected renderAssignItem(item:AssignItem) {\n\t\tlet {id, discription} = item;\n\t\tlet onCheckChanged = (isChecked:boolean):Promise<void> => {\n\t\t\t//alert(isChecked);\n\t\t\treturn;\n\t\t}\n\t\treturn this.renderTodoWithCheck(id, discription, onCheckChanged, false);\n\t}\n}\n","import React from \"react\";\nimport { VTask } from \"./VTask\";\nimport { FA } from \"tonva\";\nimport { Todo } from \"models\";\nimport { InfoInputProps, VInfoInput } from \"assigns/VInfoInput\";\n\nexport class VCheck extends VTask {\n\theader() {return '查验'}\n\n\tprivate calcEnabled(todos: Todo[]):boolean {\n\t\tif (todos === undefined || todos.length === 0) return true;\n\t\tfor (let todo of todos) {\n\t\t\tlet {check} = todo;\n\t\t\tif (check === undefined) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprotected renderMore() {\n\t\tlet enabled = this.calcEnabled(this.task.todos);\n\t\treturn <div className=\"mt-3 d-flex\">\n\t\t\t<button className=\"btn btn-success mx-auto px-4\" onClick={this.pass} disabled={!enabled}>\n\t\t\t\t<FA className=\"mr-2\" name=\"check\" /> 验收\n\t\t\t</button>\n\t\t\t<button className=\"btn btn-outline-danger\" onClick={this.fail}>\n\t\t\t\t<FA name=\"times\" /> 拒签\n\t\t\t</button>\n\t\t</div>;\n\t}\n\n\tprivate pass = async () => {\n\t\t// 暂时界面上不输入分数\n\t\tlet point = 0;\n\t\tlet comment:string;\n\t\tawait this.controller.passTask(this.task.id, point, comment);\n\t\tthis.afterAct();\n\t}\n\n\tprivate fail = async () => {\n\t\tlet comment:string;\n\t\tawait this.controller.failTask(this.task.id, comment);\n\t\tthis.afterAct();\n\t}\n\n\tprotected renderTodos():JSX.Element {\n\t\t// 改写，根据Check来显示。每项需要加确认\n\t\treturn super.renderTodos();\n\t}\n\n\tprotected renderTodo (todo:Todo, index:number):JSX.Element {\n\t\tlet {id, discription, doneMemo, checkMemo} = todo;\n\n\t\treturn <div className={'d-flex'}>\n\t\t<label key={id} className=\"flex-grow-1 px-3 py-2 m-0 d-flex bg-white cursor-point\">\n\t\t\t<div className=\"mx-3\">{this.renderTodoDot(todo)}</div>\n\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t<div className=\"\">{discription}</div>\n\t\t\t\t{doneMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t<span className=\"text-info\">{doneMemo}</span>\n\t\t\t\t</div>}\n\t\t\t\t{checkMemo && <div className=\"mt-1 small\">\n\t\t\t\t\t<FA name=\"comments-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t<span className=\"text-info\">{checkMemo}</span>\n\t\t\t\t</div>}\n\t\t\t</div>\n\t\t\t{this.renderTodoRadio(todo)}\n\t\t</label>\n\t\t{this.renderCheckMemo(todo)}\n\t</div>\n\n\t}\n\n\tprotected renderTodoRadio(todo: Todo): JSX.Element {\n\t\tlet {id, check} = todo;\n\t\tlet radios = [\n\t\t\t{val:1, text:'验收'},\n\t\t\t{val:0, text:'拒签'},\n\t\t];\n\n\t\tlet onChange = async (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tlet check:0|1 = Number(evt.target.value) as 0|1;\n\t\t\tawait this.controller.saveTodoCheck(todo, check);\n\t\t};\n\n\t\treturn <div>\n\t\t\t{radios.map((v, index) => {\n\t\t\t\tlet {val, text} = v;\n\t\t\t\treturn <label key={index} className=\"mb-0 mx-3\">\n\t\t\t\t\t<input className=\"mr-1\" type=\"radio\" value={val} \n\t\t\t\t\t\tdefaultChecked={check===val} name={'rg' + id} onChange={onChange} />\n\t\t\t\t\t{text}\n\t\t\t\t</label>\t\t\t\t\t\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprotected renderCheckMemo(todo: Todo):JSX.Element {\n\t\tlet props:InfoInputProps = {\n\t\t\tonUpdate: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoCheckMemo(todo, inputContent);\n\t\t\t},\n\t\t\tcontent: todo.checkMemo,\n\t\t\tcolor: 'text-info'\n\t\t};\n\t\treturn this.renderVm(VInfoInput, props);\n\t}\n\n}\n","import React from \"react\";\nimport { VTask } from \"./VTask\";\nimport { Todo } from \"models\";\n\nexport class VRate extends VTask {\n\theader() {return '评价'}\n\n\tprotected renderMore() {\n\t\treturn <div className=\"mt-3 text-center\">\n\t\t\t<button className=\"btn btn-success\" onClick={this.done}>评价</button>\n\t\t</div>;\n\t}\n\n\tprotected renderTodoRadio(todo: Todo): JSX.Element {\n\t\tlet {check} = todo;\n\t\tlet checkStr = check===1?'验收':'拒签';\n\n\t\treturn <div className=\"mb-0 mx-3\">{checkStr}</div>;\n\t}\n\n\tprivate done = async () => {\n\t\t// 暂时界面上不输入分数\n\t\tlet point = 0;\n\t\tlet comment:string;\n\t\tawait this.controller.rateTask(this.task.id, point, comment);\n\t\tthis.afterAct();\n\t}\n}\n","import React from 'react';\nimport { VTask } from './VTask';\nimport { EasyTime, FA } from 'tonva';\nimport { stateText, actText } from 'tapp';\n\nexport class VFlowDetail extends VTask {\n\theader() {return '任务过程'}\n\n\tprotected renderFrom():JSX.Element {return;}\n\n\tprotected renderMore() {\n\t\treturn <>\n\t\t\t<div className=\"d-flex mx-3 mt-3 mb-1 align-items-center\">\n\t\t\t\t{this.renderUser(this.task.worker)}\n\t\t\t</div>\n\t\t\t{this.renderFlows()}\n\t\t</>;\n\t}\n\n\tprivate renderFlows() {\n\t\tlet {flows, worker} = this.task;\n\t\treturn flows.map((v, index) => {\n\t\t\tlet {date, user, state, act} = v;\n\t\t\tlet {me} = stateText(state);\n\t\t\tlet action = actText(act);\n\t\t\treturn <div key={index} className=\"px-3 py-2 d-flex align-items-center\">\n\t\t\t\t<span className=\"mr-3 w-8c text-warning\">\n\t\t\t\t\t<FA name=\"angle-double-right\" className=\"mr-1\" fixWidth={true} />\n\t\t\t\t\t<span className=\"small text-muted\"><EasyTime date={date} always={true} /></span>\n\t\t\t\t</span>\n\t\t\t\t<span className=\"mr-3 text-success\">{me}</span>\n\t\t\t\t{user !== worker && <>\n\t\t\t\t\t{this.renderUser(user)}<span className=\"mr-3\"/>\n\t\t\t\t\t{action && <span className=\"mr-3 text-info\">{action}</span>}\n\t\t\t\t</>}\n\t\t\t</div>;\n\t\t});\n\t}\n}\n","import _ from 'lodash';\nimport { CUqBase, EnumTaskState, TaskAct } from \"tapp\";\nimport { Performance } from '../tapp'\nimport { Assign, AssignTask, Todo, AssignItem } from \"models\";\nimport { BoxId, Tuid } from \"tonva\";\nimport { observable, computed } from \"mobx\";\nimport { VDone, VCheck, VRate } from './task';\nimport { VFlowDetail } from './task';\n\nexport interface AssignListItem {\n\tassign: BoxId;\n}\n\nexport abstract class CAssigns extends CUqBase {\n\tprotected performance: Performance;\n\t@observable assign: Assign;\n\t@observable assignListItems: AssignListItem[];\n\t@observable endListItems: AssignListItem[];\n\t@computed get isMyAssign():boolean { return this.isMe(this.assign?.owner)};\n\n\tprotected async internalStart() {\n\t}\n\n\tabstract get caption(): any;\n\tabstract get groupId(): number;\n\tprotected abstract openVList(): void;\n\tprotected abstract openVAssign(): void\n\n\tinit(param?:any) {\n\t\tthis.performance = this.uqs.performance;\n\t}\n\n\tshowList = async () => {\n\t\tlet params = {group: this.groupId, end: 0};\n\t\tlet result = await this.performance.GetAssigns.query(params, true);\n\t\tthis.assignListItems = result.ret;\n\t\tthis.openVList();\n\t}\n\n\tasync loadEndItems() {\n\t\tlet params = {group: this.groupId, end: 1};\n\t\tlet result = await this.performance.GetAssigns.query(params, true);\n\t\tthis.endListItems = result.ret;\n\t}\n\n\tshowAssign = async (assignId?: BoxId) => {\n\t\tlet id:any = assignId;\n\t\tif (!assignId) id = this.assign.id;\n\t\tawait this.loadAssign(id);\n\t\tthis.openVAssign();\n\t}\n\n\tprivate async loadAssign(assignId:BoxId | number) {\n\t\tlet retAssign = await this.performance.GetAssign.query({assignId}, true);\n\t\tlet {assign, items, tasks, todos, tolist} = retAssign;\n\t\tlet assignObj:Assign = {items, tasks, toList:tolist} as any;\n\t\t_.mergeWith(assignObj, assign[0]);\n\t\tlet discription:string = assignObj.discription;\n\t\tif (discription) assignObj.discription = discription.replace(/\\\\n/g, '\\n');\n\t\tfor (let task of tasks as AssignTask[]) {\n\t\t\ttask.todos = (todos as Todo[]).filter(v => v.task === task.id);\n\t\t\tfor (let todo of task.todos) {\n\t\t\t\tlet {assignItem, discription} = todo;\n\t\t\t\tif (assignItem && !discription) {\n\t\t\t\t\tlet item = (items as AssignItem[]).find(v => v.id===assignItem);\n\t\t\t\t\tif (item) todo.discription = item.discription;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.assign = assignObj;\n\t\tthis.onAssignLoaded();\n\t}\n\n\tprotected onAssignLoaded() {}\n\n\tshowFlowDetail = async (task:AssignTask) => {\n\t\tlet ret = await this.uqs.performance.GetTaskFlow.query({taskId: task.id}, true);\n\t\ttask.flows = ret.ret;\n\t\tthis.openVPage(VFlowDetail, task);\n\t}\n\n\tnewAssign = async (caption:string) => {\n\t\tlet data = {group: this.groupId, caption};\n\t\tlet {CreateAssign} = this.performance;\n\t\tlet result = await CreateAssign.submit(data);\n\t\tlet res = result;\n\t\tlet {id} = res;\n\t\tlet assign = this.performance.Assign.boxId(id);\n\t\tthis.assignListItems.unshift({assign});\n\t}\n\n\tasync saveAssignDiscription(discription: string) {\n\t\tawait this.performance.Assign.saveProp(this.assign.id, 'discription', discription);\n\t\tthis.assign.discription = discription;\n\t}\n\n\tsaveAssignItem = async (todoContent: string):Promise<any> => {\n\t\tlet assignItem = {\n\t\t\tid: undefined as any,\n\t\t\tassign: this.assign.id,\n\t\t\tdiscription: todoContent,\n\t\t\tx: 0\n\t\t};\n\t\tlet ret = await this.performance.AssignItem.save(undefined, assignItem);\n\t\tassignItem.id = ret.id;\n\t\tthis.assign.items.push({id:ret.id,discription:todoContent, x:0});\n\t\treturn assignItem;\n\t}\n\n\tsetAssignItemFlag = async (item:AssignItem, x:number):Promise<any> => {\n\t\tawait this.performance.AssignItem.saveProp(item.id, 'x', x);\n\t\titem.x = x;\n\t}\n\n\tsetAssignItemContent = async (item:AssignItem, v:string):Promise<any> => {\n\t\tawait this.performance.AssignItem.saveProp(item.id, 'discription', v);\n\t\titem.discription = v;\n\t}\n\n\tselfDone = async () => {\n\t\tlet {tasks} = this.assign;\n\t\tlet task = tasks.find(v=>this.isMe(v.worker));\n\t\tif (task) {\n\t\t\tthis.openVPage(VDone, task);\n\t\t}\n\t\telse {\n\t\t\tlet toList:{to:number}[] = [];\n\t\t\ttoList.push({to:this.user.id});\n\t\t\tlet data = {\n\t\t\t\tassignId: this.assign.id,\n\t\t\t\ttoList\n\t\t\t};\n\t\t\tawait this.uqs.performance.SendAssign.submit(data);\n\t\t\tawait this.loadAssign(this.assign.id);\n\t\t\tthis.backPage();\n\t\t\tthis.openVAssign();\n\t\t}\n\t}\n\t\n\tshowDone = async () => {\n\t\tlet {tasks} = this.assign;\n\t\tlet task = tasks.find(v=>this.isMe(v.worker));\n\t\tthis.openVPage(VDone, task);\n\t}\n\n\tsetTodoFlag = async (todo: Todo, x:number):Promise<any> => {\n\t\tawait this.performance.Todo.saveProp(todo.id, 'x', x);\n\t\ttodo.x = x;\n\t}\n\n\tsaveTodoContent = async (todo: Todo, v:string):Promise<any> => {\n\t\tawait this.performance.Todo.saveProp(todo.id, 'discription', v);\n\t\ttodo.discription = v;\n\t}\n\n\tsaveTodoDone = async (todo: Todo, vDone:0|1) => {\n\t\tlet { id } = todo;\n\t\tawait this.performance.Todo.saveProp(id, 'done', vDone);\n\t\ttodo.done = vDone;\n\t}\n\n\tsaveTodoDoneMemo = async (todo: Todo, v:string) => {\n\t\tlet { id } = todo;\n\t\tawait this.performance.Todo.saveProp(id, 'donememo', v);\n\t\ttodo.doneMemo = v;\n\t}\n\n\tsaveTodoCheck = async (todo: Todo, vCheck:0|1) => {\n\t\tlet { id } = todo;\n\t\tawait this.performance.Todo.saveProp(id, 'check', vCheck);\n\t\ttodo.check = vCheck;\n\t}\n\n\tsaveTodoCheckMemo = async (todo: Todo, v:string) => {\n\t\tlet { id } = todo;\n\t\tawait this.performance.Todo.saveProp(id, 'checkmemo', v);\n\t\ttodo.checkMemo = v;\n\t}\n\n\tgetTaskAction(state:EnumTaskState):string {\n\t\tlet {checker, rater} = this.assign;\n\t\tswitch (state) {\n\t\t\tcase EnumTaskState.start:\n\t\t\tcase EnumTaskState.todo:\n\t\t\tcase EnumTaskState.doing:\n\t\t\t\treturn TaskAct.done;\n\t\t\tcase EnumTaskState.done:\n\t\t\t\tif (checker) {\n\t\t\t\t\tif (this.isMe(checker) === true) return TaskAct.check;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (rater) {\n\t\t\t\t\tif (this.isMe(rater)) return TaskAct.rate;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase EnumTaskState.pass:\n\t\t\t\tif (rater) {\n\t\t\t\t\tif (this.isMe(rater)) return TaskAct.rate;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase EnumTaskState.fail:\n\t\t\tcase EnumTaskState.rated:\n\t\t\tcase EnumTaskState.cancel:\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\tmeAct = async () => {\n\t\tlet task = this.assign.tasks.find(v => this.isMe(v.worker) === true);\n\t\tif (!task) {\n\t\t\talert('task cannot be undefined');\n\t\t\treturn;\n\t\t}\n\t\tlet {state} = task;\n\t\tlet {checker, rater} = this.assign;\n\t\tlet v;\n\t\tswitch (state) {\n\t\t\tdefault:\n\t\t\t\talert('unkown state ' + state);\n\t\t\t\treturn;\n\t\t\tcase EnumTaskState.start:\n\t\t\tcase EnumTaskState.todo:\n\t\t\tcase EnumTaskState.doing:\n\t\t\t\tv = VDone;\n\t\t\t\tbreak;\n\t\t\tcase EnumTaskState.done:\n\t\t\t\tif (checker > 0) v = VCheck;\n\t\t\t\telse if (rater > 0) v = VRate;\n\t\t\t\tbreak;\n\t\t\tcase EnumTaskState.pass:\n\t\t\t\tif (rater > 0) v = VRate;\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.openVPage(v, task);\n\t}\n\n\tprivate afterAct(retAct: {end:number}) {\n\t\tif (retAct.end === 0) return;\n\t\tlet assignId = this.assign.id;\n\t\tlet index = this.assignListItems.findIndex(v => Tuid.equ(v.assign, assignId));\n\t\tif (index < 0) return;\n\t\tthis.assignListItems.splice(index, 1);\n\t\tif (this.endListItems) {\n\t\t\tlet assign = this.assignListItems[index];\n\t\t\tthis.endListItems.unshift(assign);\n\t\t}\n\t\tthis.cApp.addGroupAssignCount(this.groupId, -1);\n\t}\n\n\tdoneAssign = async (point: number, comment: string) => {\n\t\tlet ret = await this.performance.DoneAssign.submit({assign: this.assign.id, point, comment});\n\t\tthis.afterAct(ret);\n\t}\n\n\tdoneTask = async (task:number, point:number, comment:string) => {\n\t\tlet ret = await this.performance.DoneTask.submit({task, point, comment});\n\t\tthis.afterAct(ret);\n\t}\n\n\tpassTask = async (task:number, point:number, comment: string) => {\n\t\tlet ret = await this.performance.PassTask.submit({task, point, comment});\n\t\tthis.afterAct(ret);\n\t}\n\n\tfailTask = async (task:number, comment:string) => {\n\t\tlet ret = await this.performance.FailTask.submit({task, comment});\n\t\tthis.afterAct(ret);\n\t}\n\n\trateTask = async (task:number, point:number, comment:string) => {\n\t\tlet ret = await this.performance.RateTask.submit({task, point, comment});\n\t\tthis.afterAct(ret);\n\t}\n}\n","import * as React from 'react';\nimport { CAssignsWithMember } from \"./withMember/CAssignsWithMember\";\nimport { Page, Edit, Schema, UiSchema, StringSchema, UiTextItem, UiTextAreaItem, ItemSchema, FA, QueryPager, UserView, UserIcon, Loading, Form, ButtonSchema, UiButton, Context, userApi, useUser, Tuid, List } from \"tonva\";\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VBase } from '../VBase';\n\nexport class VGroupDetail extends VBase<CAssignsWithMember> {\n\tprivate groupMembersPager: QueryPager<any>;\n\n  async open(groupMembersPager: QueryPager<any>) {\n\t\tthis.groupMembersPager = groupMembersPager;\n\t\tthis.openPage(this.page);\n\t}\n\n\tprivate onItemChanged = async (item:ItemSchema, value:any, prev:any) => {\n\t\tlet {group: currentGroup} = this.controller;\n\t\tlet props:any = {\n\t\t\tid: currentGroup.id,\n\t\t};\n\t\tswitch (item.name) {\n\t\t\tcase 'name':\n\t\t\t\tcurrentGroup.name = props.name = value;\n\t\t\t\tbreak;\n\t\t\tcase 'discription':\n\t\t\t\tcurrentGroup.discription = props.discription = value;\n\t\t\t\tbreak;\n\t\t}\n\t\tawait this.controller.saveGroupProp(props);\n\t}\n\n\tprivate onMember = (memberId:number) => {\n\t\tthis.controller.cApp.showMemberDetail(memberId);\n\t}\n\n\tprivate renderMember = (member:any) => {\n\t\tlet id:number = (typeof member === 'object')? member.id : member;\n\t\treturn <div key={id} className=\"m-2 cursor-pointer\"\n\t\t\tonClick={()=>this.onMember(id)}>\n\t\t\t<UserView id={id} render={user => {\n\t\t\t\tlet {name, nick} = user;\n\t\t\t\treturn \t<>\n\t\t\t\t<div className=\"w-3c h-3c rounded border \">\n\t\t\t\t\t<UserIcon id={id} className=\"w-100 h-100 rounded\" />\n\t\t\t\t</div>\n\t\t\t\t\t<div className=\"w-3c d-inline-block text-truncate small text-muted text-center\">\n\t\t\t\t\t\t<small>{nick || name}</small>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}} />\n\t\t</div>;\n\t}\n\n\tprivate onSubmitAddMember = async (name:string, context: Context) => {\n\t\tlet user = await userApi.fromKey(context.data.user);\n\t\tif (!user) {\n\t\t\tcontext.setError('user', '账号不存在或者不接受邀请');\n\t\t\treturn;\n\t\t}\n\t\tawait this.controller.groupAddMember(user);\n\t\t//  this.controller.setGroup();\n\t\tuseUser(user.id);\n\t\tthis.groupMembersPager.items.push({member: user.id});\n\t\tthis.closePage();\n\t}\n\n\tprivate onAddMember = () => {\n\t\tlet schema:Schema = [\n\t\t\t{name: 'user', type: 'string', maxLength: 100, required: true} as StringSchema,\n\t\t\t{name: 'submit', type: 'submit'} as ButtonSchema,\n\t\t];\n\t\tlet uiSchema: UiSchema = {\n\t\t\titems: {\n\t\t\t\tuser: {widget:'text', label:'成员', placeholder: '请输入成员账号'} as UiTextItem,\n\t\t\t\tsubmit: {widget:'button', label:'提交', className: 'btn btn-primary'} as UiButton,\n\t\t\t}\n\t\t}\n\t\tthis.openPageElement(<Page header=\"添加成员\">\n\t\t\t<Form onButtonClick={this.onSubmitAddMember}\n\t\t\t\tonEnter={this.onSubmitAddMember}\n\t\t\t\tclassName=\"m-5 px-5 py-3 bg-white\" \n\t\t\t\tschema={schema} uiSchema={uiSchema} />\n\t\t</Page>);\n\t}\n\n\t@observable disabled:boolean = true;\n\tprivate listRemoveMember:List;\n\tprivate renderRemoveButton = observer(()=> {\n\t\treturn <button onClick={this.onRemoveMemberList}\n\t\t\tclassName=\"btn btn-sm btn-success mr-2 align-self-center\"\n\t\t\tdisabled={this.disabled}>删除</button>;\n\t});\n\tprivate renderRemoveMemberItem = (item:any, index:number):JSX.Element => {\n\t\tlet {member} = item;\n\t\tlet id:number = (typeof member === 'object')? member.id : member;\n\t\t//return <div key={index} className=\"p-3\">{tv(item.member)}</div>;\n\t\treturn <UserView id={id} render={user => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn \t<div className=\"d-flex align-items-center py-2\">\n\t\t\t\t<div className=\"w-3c h-3c rounded border mx-3\">\n\t\t\t\t\t<UserIcon id={id} className=\"w-100 h-100 rounded\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"\">{nick || name}</div>\n\t\t\t</div>;\n\t\t}} />\n\t}\n\tprivate onRemoveMemberList = async () => {\n\t\tlet members = this.listRemoveMember.selectedItems;\n\t\tawait this.controller.groupRemoveMembers(members);\n\t\tlet {items} = this.groupMembersPager;\n\t\tfor (let m of members) {\n\t\t\tlet index = items.findIndex(v => v.member === m.member);\n\t\t\tif (index>=0) items.splice(index, 1);\n\t\t}\n\t\t//this.controller.setGroup();\n\t\tthis.closePage();\n\t}\n\tprivate onSelectRemoveMember = (item:any, isSelected:boolean, anySelected:boolean) => {\n\t\tthis.disabled = anySelected===false;\n\t}\n\tprivate onRemoveMember = () => {\n\t\tthis.openPageElement(<Page header=\"成员\" right={<this.renderRemoveButton />}>\n\t\t\t<List ref={list=>this.listRemoveMember=list} items={this.groupMembersPager.items} item={{\n\t\t\t\trender: this.renderRemoveMemberItem, \n\t\t\t\tonSelect: this.onSelectRemoveMember}} />\n\t\t</Page>);\n\t}\n\n\tprivate renderMemberAction = (icon:string, action:()=>void) => {\n\t\tlet {group, user} = this.controller;\n\t\tif (Tuid.equ(group.owner, user.id) === false) return;\n\t\treturn <div onClick={action}\n\t\t\tclassName=\"d-flex m-2 w-3c h-3c rounded border text-muted justify-content-center align-items-center cursor-pointer\">\n\t\t\t<FA name={icon} />\n\t\t</div>;\n\t}\n\n\tprivate renderMembers = () => {\n\t\tlet {items} = this.groupMembersPager;\n\t\tif (items === undefined) {\n\t\t\treturn <Loading />;\n\t\t}\n\t\tlet divMembers = [];\n\t\tfor (let item of items) {\n\t\t\tdivMembers.push(this.renderMember(item.member));\n\t\t}\n\t\treturn <div className=\"mb-3 bg-white d-flex flex-wrap p-2\">\n\t\t\t{divMembers}\n\t\t\t{this.renderMemberAction('plus', this.onAddMember)}\n\t\t\t{this.renderMemberAction('minus', this.onRemoveMember)}\n\t\t</div>;\n\t}\n\n\tprivate schema: Schema = [\n\t\t{name: 'name', type: 'string', maxLength: 100 } as StringSchema,\n\t\t{name: 'discription', type: 'string', maxLength: 1000} as StringSchema\n\t];\n\tprivate uiSchema: UiSchema = {\n\t\titems: {\n\t\t\tname: {\n\t\t\t\tlabel: '名称',\n\t\t\t\twidget: 'text',\n\t\t\t} as UiTextItem,\n\t\t\tdiscription: {\n\t\t\t\tlabel: '描述',\n\t\t\t\twidget: 'textarea',\n\t\t\t} as UiTextAreaItem\n\t\t}\n\t};\n\t//@observable private detail: any;\n\tprivate page = observer(():JSX.Element => {\n\t\tlet {group} = this.controller;\n\t\treturn <Page header=\"组详情\">\n\t\t\t{this.renderMembers()}\n\t\t\t<Edit schema={this.schema} uiSchema={this.uiSchema} data={group}\n\t\t\t\tonItemChanged={this.onItemChanged} />\n\t\t</Page>;\n\t});\n}\n","import React from \"react\";\nimport { CAssigns } from \"../CAssigns\";\nimport { tv, BoxId, QueryPager, useUser } from \"tonva\";\nimport { Group } from \"models\";\nimport { observable } from \"mobx\";\nimport { VGroupDetail } from \"./VGroupDetail\";\n\nexport abstract class CAssignsForGroup extends CAssigns {\n\tgroupBoxId:BoxId;\n\t@observable group: Group;\n\n\tinit(group:BoxId) {\n\t\tsuper.init(group);\n\t\tthis.groupBoxId = group;\n\t}\n\tget caption():any {return tv(this.groupBoxId, (values)=><>{values.name}</>)}\n\tget groupId(): number {return this.groupBoxId.id;}\n\n\tshowGroupDetail = async () => {\n\t\tawait this.groupBoxId.assure();\n\t\tthis.group = this.groupBoxId.obj;\n\t\tlet groupMembersPager = new QueryPager(this.performance.GetGroupMembers, 10, 30);\n\t\tgroupMembersPager.setEachPageItem((item:any) => {\n\t\t\tuseUser(item.member);\n\t\t});\n\t\tgroupMembersPager.first({group: this.group.id});\n\t\tthis.openVPage(VGroupDetail, groupMembersPager);\n\t}\n\n\tasync saveGroupProp(props:any) {\n\t\tawait this.performance.SaveGroupProp.submit(props);\n\t\tthis.performance.Group.resetCache(props.id);\n\t}\n\n\tasync groupAddMember(member:any) {\n\t\tawait this.performance.AddGroupMember.submit({group: this.groupId, member: member});\n\t\tif (this.group) this.group.count ++;\n\t}\n\n\tasync groupRemoveMembers(members:any[]) {\n\t\tawait this.performance.RemoveGroupMember.submit({\n\t\t\tgroup: this.groupId, \n\t\t\tmembers: members\n\t\t});\n\t\tif (this.group) this.group.count--;\n\t}\n}\n","import { VListNoMember } from \"./VListNoMember\";\nimport { VAssignDraftNoMember, VAssignEndNoMember } from \"./VAssignNoMember\";\nimport { CAssignsForGroup } from \"../CAssignsForGroup\";\n\nexport class CAssignsNoMember extends CAssignsForGroup {\n\tprotected openVList():void {this.openVPage(VListNoMember);}\n\tprotected openVAssign(): void {\n\t\tthis.openVPage(this.assign.end === 1? VAssignEndNoMember : VAssignDraftNoMember);\n\t}\n\n\tnewAssign = async (caption:string) => {\n\t\tlet data = {group:this.groupId, caption};\n\t\tlet {CreateAndSendAssign} = this.performance;\n\t\tlet result = await CreateAndSendAssign.submit(data);\n\t\tlet res = result;\n\t\tlet {id} = res;\n\t\tlet assign = this.performance.Assign.boxId(id);\n\t\tthis.assignListItems.unshift({assign});\n\t}\n\n\tsaveTodoItem = async (todoContent: string):Promise<any> => {\n\t\tlet id:number = undefined;\n\t\tlet assignItem: number = undefined;\n\t\tlet {tasks} = this.assign;\n\t\tlet my = tasks.find(v => this.isMe(v.worker));\n\t\tif (!my)\n\t\t\treturn;\n\n\t\tlet todo = {\n\t\t\tid: id, \n\t\t\ttask: my.id,\n\t\t\tassignItem,\n\t\t\tdiscription: todoContent,\n\t\t\tx: 0,\n\t\t\t$update: new Date()\n\t\t};\n\t\tlet ret = await this.uqs.performance.Todo.save(undefined, todo);\n\t\ttodo.id = ret.id;\n\t\tmy.todos.push(todo);\n\t\treturn todo;\n\t}\n\n}\n","import { VListForSelf } from \"./VListForSelf\";\nimport { VAssignDraftSelf, VAssignEndSelf } from \"./VAssignSelf\";\nimport { CAssignsNoMember } from \"../noMember/CAssignsNoMember\";\n\nexport class CAssignsSelf extends CAssignsNoMember {\n\tget caption():string {return '我的待办';}\n\tget groupId(): number {return 0;}\n\tprotected openVList():void {this.openVPage(VListForSelf);}\n\tprotected openVAssign(): void {\n\t\tthis.openVPage(this.assign.end === 1? VAssignEndSelf : VAssignDraftSelf);\n\t}\n\n\tshowGroupDetail = async () => {\n\t}\n}\n\n","import React from \"react\";\nimport { VList } from \"../../VList\";\nimport { FA } from \"tonva\";\nimport { CAssignsWithMember } from \"./CAssignsWithMember\";\n\nexport class VListForGroup extends VList<CAssignsWithMember> {\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-secondary mr-2\"\n\t\t\tonClick={this.controller.showGroupDetail}>\n\t\t\t<FA name=\"ellipsis-h\" />\n\t\t</button>;\n\t}\n}\n","import React from \"react\";\nimport { CSend, steps } from \"./CSend\";\nimport { VPage, FA } from \"tonva\";\nimport { observer } from \"mobx-react\";\nimport { computed } from \"mobx\";\n\nexport class VSendBase extends VPage<CSend> {\n\theader() {return '分配任务'}\n\tright() {return <button className=\"btn btn-sm btn-secondary mr-2\" onClick={this.controller.cancel}>取消</button>}\n\tget back():'none' {return 'none'}\n\n\t@computed protected get nextDisabled(): boolean { return false; }\n\n\tprotected renderCaption(step: number) {\n\t\treturn <div className=\"d-flex align-items-center justify-content-center my-3\">\n\t\t\t{steps.map((v, index) => {\n\t\t\t\tlet {caption} = v;\n\t\t\t\tlet p:any, d:any;\n\t\t\t\tif (index > 0) {\n\t\t\t\t\tp = <FA className=\"mx-2 mx-sm-3 text-muted\" name=\"arrow-right\" />;\n\t\t\t\t}\n\t\t\t\tif (index === step) {\n\t\t\t\t\td = <b className=\"h4 mb-0 text-primary\">{caption}</b>;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\td = <div className=\"text-muted\">{caption}</div>;\n\t\t\t\t}\n\t\t\t\treturn <>{p}{d}</>;\n\t\t\t})}\n\t\t</div>\n\t}\n\n\tcontent() {\n\t\tlet {step, prev, next, sendout} = this.controller;\n\t\tlet btnNext = step < steps.length-1 ?\n\t\t\tReact.createElement(observer(()=>\n\t\t\t\t<button className=\"btn btn-primary\" onClick={next} disabled={this.nextDisabled}>\n\t\t\t\t\t<FA className=\"mr-2\" name=\"arrow-right\" /> 下一步\n\t\t\t\t</button>)\n\t\t\t)\n\t\t\t:\n\t\t\t<button className=\"btn btn-primary\" onClick={sendout}>发出任务</button>;\n\t\tlet btnPrev = <button className=\"btn btn-outline-primary mr-3\" \n\t\t\tstyle={{visibility: step===0?'hidden':'visible'}}\n\t\t\tonClick={prev}>\n\t\t\t<FA className=\"mr-2\" name=\"arrow-left\" /> 上一步\n\t\t</button>\n\t\treturn <div>\n\t\t\t{this.renderCaption(this.controller.step)}\n\t\t\t<div className=\"mx-3 my-3\">\n\t\t\t\t{this.renderMiddlePart()}\n\t\t\t</div>\n\t\t\t<div className=\"mx-3 my-3 text-center\">\n\t\t\t\t{btnPrev} {btnNext}\n\t\t\t</div>\n\t\t</div>\n\t\t/*\n\t\t\t\t<div className=\"row\">\n\t\t\t\t<div className=\"col-sm-2\">{btnPrev}</div>\n\t\t\t\t<div className=\"col-sm-10 text-center\">\n\t\t\t\t\t{btnNext}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t*/\n\t}\n\n\tprotected renderMiddlePart():JSX.Element {return;}\n\n\tprotected renderUserWithCheck(id:number|string, none?:any) {\n\t\tconst cn = 'mr-5 my-2 d-flex align-items-center w-min-12c';\n\t\tlet check = () => <FA name=\"check\" className=\"text-primary mr-2\" />;\n\t\tif (!id) return <div className={cn}><FA name=\"times\" className=\"text-danger mr-2\" /> {none}</div>;\n\t\tif (this.isMe(id) === true) {\n\t\t\treturn <div className={cn + ' text-info'}>{check()}我自己</div>;\n\t\t}\n\t\treturn <div className={cn}>\n\t\t\t{check()}\n\t\t\t{this.renderUser(id)}\n\t\t</div>;\n\t}\n\n\tprotected renderToList() {\n\t\tlet arr:any[] = [];\n\t\tlet {members} = this.controller;\n\t\tlet me:any;\n\t\tfor (let i in members) {\n\t\t\tif (members[i] === true) {\n\t\t\t\tif (this.isMe(i) === true) {\n\t\t\t\t\tme = i;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tarr.push(this.renderUserWithCheck(i))\n\t\t\t}\n\t\t}\n\t\treturn <div className=\"form-group\">\n\t\t\t<label className=\"\">执行人</label>\n\t\t\t<div className=\"\">\n\t\t  \t\t<div className=\"form-control-plaintext border bg-light px-3 py-2\">\n\t\t\t\t\t<div className=\"d-flex flex-wrap\">{arr}</div>\n\t\t\t\t\t{me && this.renderUserWithCheck(me)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t  \t</div>;\n\t}\n\n\tprotected renderChecker() {\n\t\treturn <div className=\"form-group\">\n\t\t\t<label className=\"\">检查人</label>\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"form-control-plaintext border bg-light px-3 py-2\">\n\t\t\t\t\t{this.renderUserWithCheck(this.controller.checker, '无需检查')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t  \t</div>;\n\t}\n\n\tprotected renderRater() {\n\t\treturn <div className=\"form-group\">\n\t\t\t<label className=\"\">评价人</label>\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"form-control-plaintext border bg-light px-3 py-2\">\n\t\t\t\t\t{this.renderUserWithCheck(this.controller.rater, '无需评价')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t  \t</div>;\n\t}\n\n\tprotected renderRadios(caption:string, radioName:string, userId:number, setter: (userId:number)=>void, none:string) {\n\t\tconst cn = 'mr-5 my-2 d-flex align-items-center w-min-12c';\n\t\tlet items = this.controller.membersPager.items;\n\t\treturn <div className=\"form-group\">\n\t\t\t<label className=\"\">{caption}</label>\n\t\t\t<div className=\"px-3 py-2 bg-white border rounded\">\n\t\t\t\t<div className=\"d-flex flex-wrap\">\n\t\t\t\t\t<label className={cn + ' text-warning'}>\n\t\t\t\t\t\t<input name={radioName} type=\"radio\" className=\"mx-2\" defaultChecked={userId===0}\n\t\t\t\t\t\t\tonChange={()=>setter(0)} />\n\t\t\t\t\t\t{none}\n\t\t\t\t\t</label>\n\t\t\t\t\t<label className={cn + ' text-info'}>\n\t\t\t\t\t\t<input name={radioName} type=\"radio\" className=\"mx-2\" defaultChecked={this.isMe(userId)}\n\t\t\t\t\t\t\tonChange={()=>setter(this.controller.user.id)} />\n\t\t\t\t\t\t我自己\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex flex-wrap\">\n\t\t\t\t\t{items.map((v, index) => {\n\t\t\t\t\t\tlet {member} = v;\n\t\t\t\t\t\tif (member === this.controller.user.id) return null;\n\t\t\t\t\t\tlet onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\t\t\t\t\tsetter(Number(evt.target.value));\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn <label className={cn}>\n\t\t\t\t\t\t\t<input name={radioName} type=\"radio\" className=\"mx-2\" \n\t\t\t\t\t\t\t\tdefaultChecked={member===userId}\n\t\t\t\t\t\t\t\tvalue={member} onChange={onChange} />\n\t\t\t\t\t\t\t{this.renderUser(member)}\n\t\t\t\t\t\t</label>;\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t}\n}\n","import { QueryPager } from \"tonva\";\nimport { CAssigns } from \"assigns/CAssigns\";\nimport { VSelectToList } from \"./VSelectToList\";\nimport { VSelectChecker } from \"./VSelectChecker\";\nimport { VSelectRater } from \"./VSelectRater\";\nimport { VSendOut } from \"./VSendOut\";\nimport { VSendBase } from \"./VSendBase\";\nimport { CUqSub } from \"tapp/CBase\";\nimport { observable } from \"mobx\";\n\ninterface Step {\n\tcaption: string;\n\tVPage: new (controller: CSend)=>VSendBase\n}\nexport const steps:Step[] = [\n\t{caption: '指定执行人', VPage: VSelectToList},\n\t{caption: '指定检查人', VPage: VSelectChecker},\n\t{caption: '指定评价人', VPage: VSelectRater},\n\t{caption: '完成', VPage: VSendOut}\n];\n\nexport class CSend extends CUqSub<CAssigns> {\n\tstep: number = 0;\n\tmembersPager: QueryPager<{member:number}>;\n\t@observable members:{[id:number]: boolean} = {};\n\t@observable checker: number = 0;\n\t@observable rater: number = 0;\n\n\tprotected async internalStart() {\n\t\tthis.startAction();\n\t\tthis.step = 0;\n\t\tthis.membersPager = new QueryPager(this.uqs.performance.GetGroupMembers, 100);\n\t\tawait this.membersPager.first({group: this.owner.groupId});\n\t\tthis.openVPage(steps[0].VPage);\n\t}\n\n\tprev = () => {\n\t\tthis.popToTopPage();\n\t\tthis.openVPage(steps[--this.step].VPage);\n\t}\n\tnext = () => {\n\t\tthis.popToTopPage();\n\t\tthis.openVPage(steps[++this.step].VPage);\n\t}\n\n\tsendout = async () => {\n\t\tlet toList:{to:number}[] = [];\n\t\tfor (let i in this.members) {\n\t\t\tif (this.members[i] === true) toList.push({to:Number(i)});\n\t\t}\n\t\tlet data = {\n\t\t\tassignId: this.owner.assign.id,\n\t\t\tcheckerId: this.checker,\n\t\t\traterId: this.rater,\n\t\t\ttoList\n\t\t};\n\t\tawait this.uqs.performance.SendAssign.submit(data);\n\t\t//this.owner.reloadAssign();\n\t\tthis.popToTopPage();\n\t\tthis.owner.showAssign();\n\t}\n\n\tcancel = async () => {\n\t\tthis.popToTopPage();\n\t}\n}\n","import React from \"react\";\nimport { VSendBase } from \"./VSendBase\";\nimport { observer } from \"mobx-react\";\nimport { computed } from \"mobx\";\n\nexport class VSelectToList extends VSendBase {\n\n\t@computed protected get nextDisabled(): boolean {\n\t\tlet {members} = this.controller;\n\t\tlet enabled = false;\n\t\tfor (let i in members) {\n\t\t\tif (members[i] === true) {\n\t\t\t\tenabled = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn !enabled;\n\t}\n\n\tprotected renderMiddlePart() {\n\t\tconst cn = 'mr-5 my-2 d-flex align-items-center w-min-12c';\n\t\treturn React.createElement(observer(()=>{\n\t\t\tlet items = this.controller.membersPager.items;\n\t\t\tlet {members, user:me} = this.controller;\n\t\t\tlet meId = me.id;\n\t\t\treturn <div className=\"form-group\">\n\t\t\t\t<label className=\"\">执行人</label>\n\t\t\t\t<div className=\"px-3 py-2 bg-white border rounded\">\n\t\t\t\t\t<div className=\"d-flex flex-wrap\">\n\t\t\t\t\t\t{items.map((v, index) => {\n\t\t\t\t\t\t\tlet {member} = v;\n\t\t\t\t\t\t\tif (this.isMe(member) === true) return undefined;\n\t\t\t\t\t\t\tlet onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\t\t\t\t\t\tmembers[member] = evt.target.checked;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\treturn <label className={cn}>\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" className=\"mx-2\" value={member} \n\t\t\t\t\t\t\t\t\tdefaultChecked={members[member]===true}\n\t\t\t\t\t\t\t\t\tonChange={onChange} />\n\t\t\t\t\t\t\t\t{this.renderUser(member)}\n\t\t\t\t\t\t\t</label>;\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t\t<label className={cn}>\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"mx-2\" value={meId} \n\t\t\t\t\t\t\tdefaultChecked={members[meId]===true}\n\t\t\t\t\t\t\tonChange={(evt: React.ChangeEvent<HTMLInputElement>)=>members[meId]=evt.target.checked} />\n\t\t\t\t\t\t<div className=\"text-info\">我自己</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n}\n","import React from \"react\";\nimport { VSendBase } from \"./VSendBase\";\n\nexport class VSelectChecker extends VSendBase {\n\tprotected renderMiddlePart() {\n\t\treturn <div>\n\t\t\t{this.renderToList()}\n\t\t\t{this.renderRadios('检查人',\n\t\t\t\t'checker', \n\t\t\t\tthis.controller.checker, \n\t\t\t\tuserId=>this.controller.checker=userId,\n\t\t\t\t'无需检查')}\n\t\t</div>\n\t}\n}\n","import React from \"react\";\nimport { VSendBase } from \"./VSendBase\";\n\nexport class VSelectRater extends VSendBase {\n\tprotected renderMiddlePart() {\n\t\treturn <div>\n\t\t\t{this.renderToList()}\n\t\t\t{this.renderChecker()}\n\t\t\t{this.renderRadios('评价人',\n\t\t\t\t'rater', \n\t\t\t\tthis.controller.rater, \n\t\t\t\tuserId=>this.controller.rater=userId,\n\t\t\t\t'无需评价')}\n\t\t</div>\n\t}\n}\n","import React from \"react\";\nimport { VSendBase } from \"./VSendBase\";\n\nexport class VSendOut extends VSendBase {\n\tprotected renderMiddlePart() {\n\t\treturn <div>\n\t\t\t{this.renderToList()}\n\t\t\t{this.renderChecker()}\n\t\t\t{this.renderRater()}\n\t\t</div>\n\t}\n}\n","import React from \"react\";\nimport { CAssignsWithMember } from \"./CAssignsWithMember\";\nimport { View, FA } from \"tonva\";\nimport { AssignTask } from \"models\";\nimport { stateText } from \"tapp\";\nimport { vStopFlag } from \"assigns/VAssign\";\n\n\n// 注意：这里涉及到面向对象的基础知识。继承还是包含\n// renderTasks 可以写到一个 VAssingWithMember 里面去\n// 但是，到这里，VAssign的继承有两条线\n// 一条线是：Draft，Doing，End\n// 另外一条线是：Self, NoMember, WithMember\n// 目前的继承，只能由一条线，目前选择了 Draft, Doing, End\n\n// 于是，把renderTasks用单独的View，以控件的方式来实现。分别在Doing和End中使用\nexport class VAssignTasks extends View<CAssignsWithMember> {\n\trender() {\n\t\treturn this.renderTasks()\n\t}\n\n\tprotected renderTasks() {\n\t\treturn <>\n\t\t\t{this.renderMy()}\n\t\t\t{this.renderSelf()}\n\t\t\t{this.renderOthers()}\n\t\t</>;\n\t}\n\n\tprivate renderSelf() {\n\t\tlet {checks, rates} = this.controller.tasksToCategory;\n\t\tif (checks.length === 0 && rates.length === 0) return;\n\t\treturn <div className=\"pt-3\">\n\t\t\t{this.renderChecks(checks)}\n\t\t\t{this.renderRates(rates)}\n\t\t</div>;\n\t}\n\n\tprivate renderMy() {\n\t\tlet {my} = this.controller.tasksToCategory;\n\t\tif (!my) return;\n\t\tlet {state, end} = my;\n\t\tlet action = this.controller.getTaskAction(state);\n\t\tif (!action) {\n\t\t\tlet {me} = stateText(state);\n\t\t\treturn <div className=\"px-3 py-2 bg-white border-top cursor-pointer d-flex align-items-center\"\n\t\t\t\tonClick={() => this.controller.showFlowDetail(my)}>\n\t\t\t\t<span className=\"mr-2\">我的任务</span>\n\t\t\t\t<span className=\"text-warning\">{me}</span>\n\t\t\t\t{this.renderEndFlag(end)}\n\t\t\t\t<FA name=\"angle-right\" className=\"ml-auto\" />\n\t\t\t</div>;\n\t\t}\n\t\treturn <div className=\"px-3 py-3 bg-white border-top cursor-pointer\"\n\t\t\tonClick={this.controller.meAct}>\n\t\t\t<FA name=\"chevron-circle-right\" className=\"text-danger mr-3\" />\n\t\t\t<span className=\"text-primary \">{action}</span> 我的任务\n\t\t</div>;\n\t}\n\n\tprivate renderActions(actName:string, act:(task:AssignTask)=>void, tasks: AssignTask[]) {\n\t\tif (tasks.length === 0) return;\n\t\treturn tasks.map((task, index) => {\n\t\t\tlet {worker} = task;\n\t\t\treturn <div key={index} className=\"px-3 py-3 bg-white border-bottom cursor-pointer d-flex align-items-center\"\n\t\t\t\tonClick={()=>act(task)}>\n\t\t\t\t<FA name=\"chevron-circle-right\" className=\"text-danger mr-3\" />\n\t\t\t\t<span className=\"text-primary mr-2\">{actName}</span>\n\t\t\t\t{this.renderUser(worker)}\n\t\t\t</div>\n\t\t});\n\t}\n\t\n\tprivate renderChecks(tasks: AssignTask[]) {\n\t\tlet act = this.controller.showCheck;\n\t\treturn this.renderActions('检查', act, tasks);\n\t}\n\n\tprivate renderRates(tasks: AssignTask[]) {\n\t\tlet act = this.controller.showRate;\n\t\treturn this.renderActions('评价', act, tasks);\n\t}\n\n\tprivate renderEndFlag(end:number) {\n\t\tif (end === 1) return <span className=\"mx-3\">{vStopFlag}</span>;\n\t}\n\n\tprivate renderOthers() {\n\t\tlet {\n\t\t\tstarts,\n\t\t\tdones,\n\t\t\tpasses,\n\t\t\tfails,\n\t\t\trateds,\n\t\t\tcancels,\n\t\t\t// invalids\n\t\t} = this.controller.tasksToCategory;\n\n\t\tlet arr = [...starts, ...dones, ...passes, ...fails, ...rateds, ...cancels];\n\t\tif (arr.length <= 0) return;\n\t\treturn <div className=\"pt-3\">\n\t\t\t{arr.map((v:AssignTask, index) => {\n\t\t\t\tlet {id, end, state} = v;\n\t\t\t\tlet {me} = stateText(state);\n\t\t\t\treturn <div key={id} className=\"d-flex px-3 py-2 bg-white border-bottom cursor-pointer align-items-center\"\n\t\t\t\t\tonClick={() => this.controller.showFlowDetail(v)}>\n\t\t\t\t\t{this.renderUser(v.worker)}\n\t\t\t\t\t<span className=\"ml-3 small text-info\">任务{me}</span>\n\t\t\t\t\t{this.renderEndFlag(end)}\n\t\t\t\t\t<FA name=\"angle-right\" className=\"ml-auto\" />\n\t\t\t\t</div>\n\t\t\t})}\n\t\t</div>\n\t}\n}\n","import React from \"react\";\nimport { VAssignDraft, vStopFlag, VAssign } from \"../VAssign\";\nimport { CAssignsWithMember } from \"./withMember/CAssignsWithMember\";\nimport { FA } from \"tonva\";\nimport { VAssignTasks } from \"./withMember/VAssignTasks\";\nimport { FooterInputProps, VFooterInput } from \"../VFooterInput\";\nimport { EnumTaskState } from \"tapp\";\n\nexport class VAssignDraftWithMember extends VAssignDraft<CAssignsWithMember> {\n\tprotected renderDraft() {\n\t\tlet { isMyAssign } = this.controller;\n\t\tif (!isMyAssign) {\n\t\t\treturn null; //不是自己创建的任务\n\t\t}\n\t\treturn <>\n\t\t\t<div className=\"px-3 py-2 border-top bg-white cursor-pointer\"\n\t\t\t\tonClick={this.controller.showAssignTo}>\n\t\t\t\t<FA className=\"mr-3 text-info\" name=\"user-plus\" fixWidth={true} /> 分配给\n\t\t\t</div>\n\t\t\t{this.renderSelfDone()}\n\t\t</>\n\t}\n}\n\nabstract class VAssignWithMemberTasks extends VAssign<CAssignsWithMember> {\n\tprotected renderContent() {\n\t\treturn <>\n\t\t\t{super.renderContent()}\n\t\t\t{this.renderVm(VAssignTasks)}\n\t\t</>;\n\t}\n\n\tprotected renderTodos() {\n\t\tlet {my, myCanEdit} = this.controller.tasksToCategory;\n\t\tif (!my) {\n\t\t\treturn this.renderAssignItems();\n\t\t}\n\t\tif (myCanEdit) {\n\t\t\treturn super.renderTodos();\n\t\t}\n\t\tlet {todos} = my;\n\t\treturn todos.map((item, index) => {\n\t\t\tlet {assignItem, discription, doneMemo, checkMemo, id} = item;\n\t\t\tlet cn:string, icon:string;\n\t\t\tif (assignItem) {\n\t\t\t\tcn = 'text-primary';\n\t\t\t\ticon = 'circle';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcn = 'text-info';\n\t\t\t\ticon = 'circle-o'\n\t\t\t}\n\t\t\treturn <div key={id} className=\"px-3 py-2 d-flex align-items-center bg-white border-top\">\n\t\t\t\t<small><small><FA name={icon} className={cn} fixWidth={true} /></small></small>\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t<div className=\"flex-fill ml-3\">{discription}</div>\n\t\t\t\t\t{doneMemo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info\">{doneMemo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t\t{checkMemo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t\t<FA name=\"comments-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info\">{checkMemo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t});\n\t}\n}\n\nexport class VAssignDoingWithMember extends VAssignWithMemberTasks {\n\tprotected renderContent() {\n\t\treturn <>\n\t\t\t{super.renderContent()}\n\t\t\t{this.renderFlow()}\n\t\t</>;\n\t}\n\n\tprotected renderFlow() {\n\t\tlet cn = 'border border-warning rounded px-2 py-1 d-flex align-items-center';\n\t\tlet {checker, rater} = this.assign;\n\t\tlet angle = <FA name=\"angle-right\" className=\"mx-2 mx-sm-3 text-muted\" />;\n\t\tlet renderAdmin = (admin:any, action:string): JSX.Element => {\n\t\t\tif (admin) {\n\t\t\t\treturn <>\n\t\t\t\t\t{angle}\n\t\t\t\t\t<div className={cn}>\n\t\t\t\t\t\t<small className=\"mr-2\">{this.renderUser(admin)}</small>\n\t\t\t\t\t\t<small className=\"text-muted\">{action}</small>\n\t\t\t\t\t</div>\n\t\t\t\t</>;\n\t\t\t}\n\t\t}\t\t\n\t\treturn <div className=\"d-flex mt-3 px-3 py-2 border-top bg-white align-items-center\">\n\t\t\t<FA name=\"circle-o text-primary small\" />\n\t\t\t{angle}\n\t\t\t<div className={cn + ' small'}>执行</div>\n\t\t\t{renderAdmin(checker, '查验')}\n\t\t\t{renderAdmin(rater, '评分')}\n\t\t\t{angle}\n\t\t\t{vStopFlag}\n\t\t</div>;\n\t}\n\n\tfooter() {\n\t\tlet {my, myCanEdit} = this.controller.tasksToCategory;\n\t\tif (!my || myCanEdit === false) return;\n\t\tswitch (my.state) {\n\t\t\tdefault: return;\n\t\t\tcase EnumTaskState.start:\n\t\t\tcase EnumTaskState.todo:\n\t\t\tcase EnumTaskState.doing: break;\n\t\t}\n\t\tlet props:FooterInputProps = {\n\t\t\tonAdd: async (inputContent:string):Promise<void> => {\n\t\t\t\tawait this.controller.saveTodoItem(inputContent);\n\t\t\t\tthis.scrollToTop();\n\t\t\t},\n\t\t\tcaption: '添加我的任务事项'\n\t\t};\n\t\treturn this.renderVm(VFooterInput, props);\n\t}\n}\n\nexport class VAssignEndWithMember extends VAssignWithMemberTasks {\n}\n","import { AssignTask } from \"models\";\nimport { VListForGroup } from \"./VListForGroup\";\nimport { CSend } from \"./send\";\nimport { VCheck, VRate } from \"assigns/task\";\nimport { CAssignsForGroup } from \"../CAssignsForGroup\";\nimport { VAssignDraftWithMember, VAssignEndWithMember, VAssignDoingWithMember } from \"../VAssignWithMember\";\nimport { EnumTaskState } from \"tapp\";\n\nexport interface TasksToCategory {\n\tmy:AssignTask,\n\tmyCanEdit: boolean,\n\tchecks:AssignTask[], \n\trates:AssignTask[], \n\n\tstarts: AssignTask[];\n\n\tdones: AssignTask[];\n\tpasses: AssignTask[];\n\tfails: AssignTask[];\n\trateds: AssignTask[];\n\tcancels: AssignTask[];\n\tinvalids: AssignTask[];\n}\n\nexport class CAssignsWithMember extends CAssignsForGroup {\n\ttasksToCategory: TasksToCategory;\n\n\tprotected openVList():void {this.openVPage(VListForGroup);}\n\tprotected openVAssign(): void {\n\t\tlet {end, tasks} = this.assign;\n\t\tlet vp;\n\t\tif (end === 1) vp = VAssignEndWithMember;\t\t\n\t\telse if (tasks.length === 0) vp = VAssignDraftWithMember;\n\t\telse vp = VAssignDoingWithMember;\n\t\tthis.openVPage(vp);\n\t}\n\n\tshowAssignTo = async () => {\n\t\tlet cSend = this.newSub(CSend);\n\t\tcSend.start();\n\t}\n\n\tshowCheck = async (task: AssignTask) => {\n\t\tthis.openVPage(VCheck, task);\n\t}\n\n\tshowRate = async (task: AssignTask) => {\n\t\tthis.openVPage(VRate, task);\n\t}\n\n\tprotected onAssignLoaded(): void {\n\t\tlet {tasks, checker, rater} = this.assign;\n\t\tlet my: AssignTask;\n\t\tlet myCanEdit: boolean = false;\n\t\tlet checks: AssignTask[] = [];\n\t\tlet rates: AssignTask[] = [];\n\n\t\tlet starts: AssignTask[] = [];\n\n\t\tlet dones: AssignTask[] = [];\n\t\tlet passes: AssignTask[] = [];\n\t\tlet fails: AssignTask[] = [];\n\t\tlet rateds: AssignTask[] = [];\n\t\tlet cancels: AssignTask[] = [];\n\t\tlet invalids: AssignTask[] = [];\n\n\t\tlet isChecker = this.isMe(checker);\n\t\tlet isRater = this.isMe(rater);\n\n\t\tfor (let task of tasks) {\n\t\t\tlet {\n\t\t\t\t//id, //: number; // Task ID ASC,\n\t\t\t\t//assign, //: number|any; // ID Assign,\n\t\t\t\tworker, //: number; // ID,\n\t\t\t\t//$create, //: Date; // TIMESTAMP,\n\t\t\t\tstate, //: EnumTaskState;\n\t\t\t\t//date, //: Date;\n\t\t\t\t//stepDate, //: Date;\n\t\t\t\t//stepComment, //: string;\n\t\t\t} = task;\n\t\t\tif (this.isMe(worker) === true) {\n\t\t\t\tmy = task;\n\t\t\t\tswitch (state) {\n\t\t\t\t\tcase EnumTaskState.start:\n\t\t\t\t\tcase EnumTaskState.todo:\n\t\t\t\t\tcase EnumTaskState.doing: myCanEdit = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tswitch (state) {\n\t\t\t\t\tcase EnumTaskState.start: starts.push(task);  break;\n\t\t\t\t\tcase EnumTaskState.done:\n\t\t\t\t\t\t(isChecker === true? checks : dones).push(task);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase EnumTaskState.pass:\n\t\t\t\t\t\t(isRater === true? rates : passes).push(task);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase EnumTaskState.fail: fails.push(task); break;\n\t\t\t\t\tcase EnumTaskState.rated: rateds.push(task); break;\n\t\t\t\t\tcase EnumTaskState.cancel: cancels.push(task); break;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tinvalids.push(task);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.tasksToCategory = {\n\t\t\tmy,\n\t\t\tmyCanEdit,\n\t\t\tchecks,\n\t\t\trates,\n\t\t\tstarts,\n\t\t\tdones,\n\t\t\tpasses,\n\t\t\tfails,\n\t\t\trateds,\n\t\t\tcancels,\n\t\t\tinvalids,\n\t\t};\n\t}\n\n\tsaveTodoItem = async (todoContent: string):Promise<any> => {\n\t\tlet {my} = this.tasksToCategory;\n\t\tif (!my) alert('something wrong');\n\t\tlet id:number = undefined;\n\t\tlet assignItem: number = undefined;\n\t\tlet todo = {\n\t\t\tid: id, \n\t\t\ttask: my.id,\n\t\t\tassignItem,\n\t\t\tdiscription: todoContent,\n\t\t\tx: 0,\n\t\t\t$update: new Date()\n\t\t};\n\t\tlet ret = await this.uqs.performance.Todo.save(undefined, todo);\n\t\ttodo.id = ret.id;\n\t\tmy.todos.push(todo);\n\t\treturn todo;\n\t}\n}\n","import { CUqBase } from \"../tapp\";\nimport { VMain } from \"./VMain\";\nimport { QueryPager, useUser, Tuid, BoxId } from \"tonva\";\nimport { VGroup } from \"./VGroup\";\nimport { observable } from \"mobx\";\nimport { stateDefs } from \"tools\";\nimport { Task, Assign, Group, GroupItem } from \"../models\";\nimport { VGroupDetail } from \"./VGroupDetail\";\nimport { Performance } from '../tapp'\nimport { NoteItem, dataToNoteItem, createNoteAssign, createNoteText } from \"./NoteItem\";\nimport { CAssignsSelf, CAssignsWithMember, CAssignsNoMember } from \"assigns\";\n\nexport class CHome extends CUqBase {\n\tprivate performance: Performance;\n\n\tcurrentGroupItem: GroupItem;\n\t@observable currentGroup: Group;\n\t@observable currentTask: Task;\n\tprivate lastTick: number = 0;\n\t@observable todosChanged: boolean = false;\n\n\tdefaultGroupId: number;\n\t@observable defaultGroupAssignCount: number;\n\tmyGroupsPager: GroupsPager;\n\tgroupNotesPager: QueryPager<NoteItem>;\n\t//myDoingsPager: QueryPager<Doing>;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.performance = this.uqs.performance;\n\t\tthis.myGroupsPager = new GroupsPager(this.performance.GetMyGroups, 10, 500, true);\n\t\tthis.groupNotesPager = new QueryPager<NoteItem>(this.performance.GetGroupNotes, 10, 30, true);\n\t\tthis.groupNotesPager.setItemConverter(this.noteItemConverter);\n\t\tthis.groupNotesPager.setReverse();\n\t\t//this.myDoingsPager = new QueryPager<Doing>(this.performance.GetMyTasks, 10, 100);\n\t}\n\t\n\ttab = () => this.renderView(VMain);\n\t\n\tasync load() {\n\t\tlet arr = [\n\t\t\t//this.myDoingsPager.first(undefined),\n\t\t\tthis.myGroupsPager.first(undefined)\n\t\t];\n\t\tawait Promise.all(arr);\n\n\t\tlet myDefaultGroupIndex = this.myGroupsPager.items.findIndex(v => v.isDefault === 1);\n\t\tif (myDefaultGroupIndex >= 0) {\n\t\t\tlet ret = this.myGroupsPager.items.splice(myDefaultGroupIndex, 1);\n\t\t\tlet r0 = ret[0];\n\t\t\tthis.defaultGroupId = r0.id;\n\t\t\tthis.defaultGroupAssignCount = r0.count;\n\t\t}\n\t\t//await this.groupsPager.first(undefined);\n\t}\n\n\taddGroupAssignCount(group:number, delta:number) {\n\t\tif (group === this.defaultGroupId) {\n\t\t\tthis.defaultGroupAssignCount += delta;\n\t\t}\n\t\telse {\n\t\t\tlet groupItem = this.myGroupsPager.items.find(v => Tuid.equ(v.group, group)===true);\n\t\t\tif (groupItem) groupItem.count += delta;\n\t\t}\n\t}\n\n\tasync saveGroup(parent:number, name:string, discription:string) {\n\t\tlet data = {parent, name, discription};\n\t\tlet ret = await this.performance.SaveGroup.submit(data);\n\t\tlet retGroupId = ret?.group;\n\t\tlet groupBoxId = this.performance.Group.boxId(retGroupId);\n\t\tthis.myGroupsPager.items.unshift({\n\t\t\tid: retGroupId, \n\t\t\tgroup: groupBoxId, \n\t\t\tcount: 1, \n\t\t\ttime: new Date(),\n\t\t\tunread: 0,\n\t\t\towner: this.user.id,\n\t\t\tisDefault: 0,\n\t\t\tmemberCount: 1,\n\t\t});\n\t}\n\n\tasync saveGroupProp(props: {id:number, name:string, discription:string}) {\n\t\tawait this.performance.SaveGroupProp.submit(props);\n\t\tthis.performance.Group.resetCache(props.id);\n\t}\n\n\tasync setCurrentGroupItem(groupItem: GroupItem) {\n\t\tthis.currentGroupItem = groupItem;\n\t\t/*\n\t\tif (!groupId) groupId = this.currentGroup?.id;\n\t\tif (!groupId) return;\n\t\tlet groupItem = this.groupsPager.findItem(groupId);\n\t\t*/\n\t\tlet {Group:GroupTuid} = this.performance;\n\t\tlet g: number | BoxId = groupItem.group;\n\t\tif (typeof g === 'object') g = g.id;\n\t\tthis.currentGroup = await GroupTuid.assureBox<Group>(g);\n\t\tthis.currentGroup.count = groupItem.count;\n\t}\n\n\tprivate noteItemConverter = (item:any, queryResults:{[name:string]:any[]}):NoteItem => {\n\t\treturn dataToNoteItem(this, item, queryResults);\n\t}\n\tshowGroup = async (item: any) => {\n\t\tawait this.groupNotesPager.first({group: item.group});\n\t\titem.unread = 0;\n\t\tthis.openVPage(VGroup, undefined, ret => {\n\t\t\tthis.currentGroup = undefined;\n\t\t});\n\t\tthis.setCurrentGroupItem(item);\n\t\tthis.cApp.resetTick();\n\t}\n\n\tshowMyAssigns = async () => {\n\t\tthis.todosChanged = false;\n\t\tlet cAssignsMy = this.newC(CAssignsSelf);\n\t\tawait cAssignsMy.showList();\n\t}\n\n\tshowGroupAssigns = async (item: GroupItem) => {\n\t\tthis.todosChanged = false;\n\t\tif (item.memberCount > 1) {\n\t\t\tlet cAssigns = this.newC(CAssignsWithMember, item.group);\n\t\t\tawait cAssigns.showList();\n\t\t}\n\t\telse {\n\t\t\tlet cAssigns = this.newC(CAssignsNoMember, item.group);\n\t\t\tawait cAssigns.showList();\n\t\t}\n\t}\n\n\tshowMyTodos = async () => {\n\t\tthis.todosChanged = false;\n\t\tawait this.cApp.showMyTodos();\n\t}\n\n\tasync refresh() {\n\t\tlet arr:Promise<any>[] = [\n\t\t\tthis.performance.MyTickTodo.query({lastTick: this.lastTick}, false),\n\t\t\tthis.myGroupsPager.refresh()\n\t\t];\n\t\tif (this.currentGroup) {\n\t\t\tarr.push(this.groupNotesPager.attach());\n\t\t}\n\t\tlet ret = await Promise.all(arr);\n\t\tthis.lastTick = Date.now()/1000;\n\n\t\tlet tickTodo = ret[0];\n\t\tif (tickTodo) {\n\t\t\tlet retTickTodo:any[] = tickTodo.ret;\n\t\t\tthis.todosChanged =  retTickTodo.length > 0;\n\t\t}\n\t\tif (this.currentGroup) {\n\t\t\tlet groupId = this.currentGroup.id;\n\t\t\tlet item = this.myGroupsPager.items.find(v => Tuid.equ(v.group, groupId));\n\t\t\tif (item) {\n\t\t\t\titem.time = new Date();\n\t\t\t\titem.unread = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate afterAddNote() {\n\t\tthis.groupNotesPager.scrollToBottom();\n\t}\n\n\taddTextNote = async (content: string) => {\n\t\tlet data = {\n\t\t\tgroup: this.currentGroup, \n\t\t\tcontent, \n\t\t};\n\t\tlet ret = await this.performance.PushNote.submit(data);\n\t\tlet retNoteId = ret?.note;\n\t\tlet nts:NoteItem = createNoteText(this, this.user.id, content);\n\t\tnts.id = retNoteId;\n\t\tthis.groupNotesPager.items.push(nts);\n\t\tthis.afterAddNote();\n\t}\n\tsaveTaskProp = async (prop:string, value:any) => {\n\t\tawait this.performance.Assign.saveProp(this.currentTask.id, prop, value);\n\t}\n\n\tpublishAssign = async (assign: Assign):Promise<void> => {\n\t\tlet ret:{note:number} = await this.performance.PublishAssign.submit({\n\t\t\tassignId: assign.id,\n\t\t\tgroupId: this.currentGroup.id\n\t\t});\n\t\tif (!ret) alert('publish assign error');\n\t\tlet nts = createNoteAssign(this, this.user.id, ret.note);\n\t\tnts.id = ret.note;\n\n\t\t// eslint-disable-next-line\n\t\tlet {id, caption, discription} = assign;\n\t\tnts.assignId = id;\n\t\tnts.caption = caption;\n\t\tnts.discription = discription;\n\t\tthis.groupNotesPager.items.push(nts);\n\t\tthis.afterAddNote();\n\t}\n/*\n\tshowNewTask = async ():Promise<boolean> => {\n\t\tlet ret = await this.cApp.showNewAssign();\n\t\treturn ret;\n\t}\n\tshowAssign = async (noteItem:NoteAssign) => {\n\t\tthis.cApp.showAssign(noteItem.assignId); \n\t}\n*/\n\tsaveTodo = async (todoContent: string):Promise<any> => {\n\t\tlet todo = {\n\t\t\tid: undefined as any,\n\t\t\ttask: this.currentTask.id,\n\t\t\tstate: 0,\n\t\t\tdiscription: todoContent,\n\t\t};\n\t\tlet ret = await this.performance.Todo.save(undefined, todo);\n\t\ttodo.id = ret.id;\n\t\treturn todo;\n\t}\n\n\t// state 10: 待办，state 20: 正办\n\ttaskAct = async (noteItem:NoteItem, toState:stateDefs.todo|stateDefs.doing) => {\n\t\t// eslint-disable-next-line\n\t\tlet ret = await this.performance.TaskAct.submit({task: undefined, toState});\n\t}\n\n\trevokeTask = async (noteItem:NoteItem) => {\n\t\tawait this.performance.RemoveTask.submit({noteItem, undefined});\n\t};\n\n\tasync showGroupDetail() {\n\t\tlet groupMembersPager = new QueryPager(this.performance.GetGroupMembers, 10, 30);\n\t\tgroupMembersPager.setEachPageItem((item:any) => {\n\t\t\tuseUser(item.member);\n\t\t});\n\t\tgroupMembersPager.first({group: this.currentGroup});\n\t\tthis.openVPage(VGroupDetail, groupMembersPager);\n\t}\n\n\tasync groupAddMember(member:any) {\n\t\tawait this.performance.AddGroupMember.submit({group: this.currentGroup, member: member});\n\t\tif (this.currentGroupItem) this.currentGroupItem.count ++;\n\t\tif (this.currentGroup) this.currentGroup.count ++;\n\t}\n\n\tasync groupRemoveMembers(members:any[]) {\n\t\tawait this.performance.RemoveGroupMember.submit({\n\t\t\tgroup: this.currentGroup, \n\t\t\tmembers: members\n\t\t});\n\t\tif (this.currentGroupItem) this.currentGroupItem.count --;\n\t\tif (this.currentGroup) this.currentGroup.count--;\n\t}\n}\n\nclass GroupsPager extends QueryPager<GroupItem> {\n\tprotected getRefreshPageId(item:any) {\n\t\tif (item === undefined) return;\n\t\tlet pageId = item['group'];\n\t\tif (typeof pageId === 'object') {\n\t\t\treturn pageId.id;\n\t\t}\n\t\treturn pageId;\n\t}\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { List, EasyTime, Muted, tv, TabProp, Tabs, FA, LMR, VPage } from 'tonva';\nimport { Assign, AssignTask } from 'models';\nimport { EnumTaskAct, stateText } from 'tapp';\nimport { CReport } from './CReport';\n\nconst cnIcon = \"d-flex justify-content-center align-items-center rounded border border-info text-danger w-3c h-3c font-1-5c mr-3\";\nexport class VMyTasks extends VPage<CReport> {\n\theader() { return '任务'; }\n\n\tprivate renderTaskItem = (stepText:string, myTaskItem: AssignTask, index:number) => {\n\t\tlet {assign, $create, stepDate, stepComment, state} = myTaskItem;\n\t\t// eslint-disable-next-line\n\t\tlet {me, act} = stateText(state);\n\t\treturn tv(assign, (values:Assign) => {\n\t\t\tlet {caption, discription} = values;\n\t\t\tlet left = <div className={cnIcon}>{caption[0].toUpperCase()}</div>;\n\t\t\tlet right = <div><Muted><EasyTime date={stepDate} always={true} /></Muted></div>;\n\t\t\treturn <LMR className=\"py-3 px-3\" left={left} right={right}>\n\t\t\t\t<div className=\"small text-muted pb-1\">\n\t\t\t\t\t<FA className=\"text-danger mr-1\" name=\"chevron-circle-right\" />\n\t\t\t\t\t<span className=\"text-primary\">{me}</span> &nbsp;\n\t\t\t\t\t<EasyTime date={$create} always={true} />开始\n\t\t\t\t\t<Muted>{stepComment}</Muted>\n\t\t\t\t</div>\n\t\t\t\t<div><b>{caption}</b> &nbsp; {discription}</div>\n\t\t\t</LMR>;\n\t\t});\n\t}\n\n\tprivate onTaskClick = (myTaskItem: AssignTask) => {\n\t\t//this.controller.showTask(myTaskItem.id);\n\t}\n\n\tprivate cnTabSelected = (selected:boolean) => classNames({\n\t\t\"bg-white border border-warning\":selected,\n\t\t\"border\":!selected,\n\t},  'cursor-pointer px-4 py-2 rounded');\n\tprivate tabs:TabProp[] = [\n\t\t{\n\t\t\tname: 'todo',\n\t\t\tcaption: (selected) => <div className={this.cnTabSelected(selected)}>领办</div>,\n\t\t\tcontent: () => <div>\n\t\t\t\t<List items={this.controller.myTasksPager} \n\t\t\t\t\titem={{\n\t\t\t\t\t\trender: (item, index) => this.renderTaskItem('领办', item, index), \n\t\t\t\t\t\tonClick: this.onTaskClick\n\t\t\t\t\t}} />\n\t\t\t</div>,\n\t\t\tonShown: () => this.controller.loadTaskArchive(EnumTaskAct.todo),\n\t\t},\n\t\t{\n\t\t\tname: 'done',\n\t\t\tcaption: (selected) => <div className={this.cnTabSelected(selected)}>完成</div>,\n\t\t\tcontent: () => <div>\n\t\t\t\t<List items={this.controller.myTasksPager} \n\t\t\t\t\titem={{\n\t\t\t\t\t\trender: (item, index) => this.renderTaskItem('完成', item, index), \n\t\t\t\t\t\tonClick: this.onTaskClick\n\t\t\t\t\t}} />\n\t\t\t</div>,\n\t\t\tonShown: () => this.controller.loadTaskArchive(EnumTaskAct.done),\n\t\t},\n\t\t{\n\t\t\tname: 'check',\n\t\t\tcaption: (selected) => <div className={this.cnTabSelected(selected)}>查验</div>,\n\t\t\tcontent: () => <div>\n\t\t\t\t<List items={this.controller.myTasksPager} \n\t\t\t\t\titem={{\n\t\t\t\t\t\trender: (item, index) => this.renderTaskItem('查验', item, index), \n\t\t\t\t\t\tonClick: this.onTaskClick\n\t\t\t\t\t}} />\n\t\t\t</div>,\n\t\t\tonShown: () => this.controller.loadTaskArchive(EnumTaskAct.check),\n\t\t},\n\t\t{\n\t\t\tname: 'rate',\n\t\t\tcaption: (selected) => <div className={this.cnTabSelected(selected)}>评价</div>,\n\t\t\tcontent: () => <div>\n\t\t\t\t<List items={this.controller.myTasksPager} \n\t\t\t\t\titem={{\n\t\t\t\t\t\trender: (item, index) => this.renderTaskItem('评价', item, index), \n\t\t\t\t\t\tonClick: this.onTaskClick\n\t\t\t\t\t}} />\n\t\t\t</div>,\n\t\t\tonShown: () => this.controller.loadTaskArchive(EnumTaskAct.rate),\n\t\t},\n\t];\n\n\tcontent() {\n\t\treturn <Tabs tabs={this.tabs} tabPosition=\"top\" size=\"sm\" />;\n\t}\n}\n","import * as React from 'react';\nimport { VPage, FA } from \"tonva\";\nimport { CReport } from './CReport';\n\ninterface Cat {\n\ticon: string;\n\tbgIcon: string;\n\tcontent: any;\n\taction: () => void;\n}\n\nexport class VReport extends VPage<CReport> {\n    async open() {\n\t\t//this.openPage(this.page);\n\t}\n\n\theader() {return '查看'}\n\n\tprivate showCatProject = () => {\n\t\t//\t\talert('projects');\n\t\tthis.controller.cApp.showProjects();\n\t}\n\n\tprivate catMember:Cat = {\n\t\ticon: 'user-o',\n\t\tbgIcon: 'bg-info',\n\t\tcontent: '同事', \n\t\taction: this.controller.cApp.cMember.showList,\n\t};\n\n\tprivate catProject:Cat = {\n\t\ticon: 'sitemap',\n\t\tbgIcon: 'bg-primary',\n\t\tcontent: '项目', \n\t\taction: this.showCatProject,\n\t};\n\tprivate catAssigns:Cat = {\n\t\ticon: 'list-ol',\n\t\tbgIcon: 'bg-success',\n\t\tcontent: '作业', \n\t\taction: undefined, // this.controller.showMyAssigns,\n\t\t//action: this.controller.showMyAssigns,\n\t}\n\tprivate catTasks:Cat = {\n\t\ticon: 'list-ol',\n\t\tbgIcon: 'bg-info',\n\t\tcontent: '任务', \n\t\taction: this.controller.showMyTasks,\n\t}\n\tprivate items = [this.catMember, this.catTasks, this.catAssigns, this.catProject];\n\tcontent() {\n\t\treturn <div className=\"\">\n\t\t\t{this.items.map((cat, index) => {\n\t\t\t\tlet {icon, bgIcon, content, action} =cat;\n\t\t\t\treturn <div key={index} \n\t\t\t\t\tclassName=\"d-flex py-2 px-3 cursor-pointer mb-1 bg-white align-items-center\" \n\t\t\t\t\tonClick={action}>\n\t\t\t\t\t<div className={'d-flex w-2c h-2c text-center mr-3 rounded text-white align-items-center justify-content-center ' + bgIcon}>\n\t\t\t\t\t\t<FA name={icon} fixWidth={true} size=\"lg\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>{content}</div>\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\t/*\n\tprivate keyDoing = (doing: Doing) => {\n\t\treturn doing.task;\n\t}\n\n\tprivate onClickDoing = (doing: Doing) => {\n\t\tthis.controller.showTask(doing.task);\n\t}\n\t\n\tprivate renderState(doing:Doing):JSX.Element {\n\t\tlet {state, date} = doing;\n\t\tlet pointer = <FA className=\"text-danger mr-1\" name=\"chevron-circle-right\" />;\n\t\tlet {text, act} = stateText(state);\n\t\treturn <>{pointer} <small>{text}</small> &nbsp; <Muted>{act}于<EasyTime date={date} /></Muted></>;\n\t}\n\t\n\tprivate renderDoing = (doing:Doing, index: number) => {\n\t\tlet {assign, worker, $create} = doing;\n\t\tlet renderIcon = (user:User) => {\n\t\t\tlet {icon} = user;\n\t\t\treturn <Image className=\"w-2c h-2c mt-1\" src={icon} /> \n\t\t};\n\t\tlet renderNick = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <small>{nick || name}</small>\n\t\t};\n\t\treturn tv(assign, (values: Assign) => {\n\t\t\tlet {caption, discription} = values;\n\t\t\treturn <div className=\"my-1 bg-white\">\n\t\t\t\t<div className=\"px-3 py-2\">\n\t\t\t\t\t<UserView user={worker} render={renderIcon} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill\">\n\t\t\t\t\t<div className=\"d-flex pt-1 pb-2\">\n\t\t\t\t\t\t<div className=\"flex-fill pl-2\">\n\t\t\t\t\t\t\t<UserView user={worker} render={renderNick} />\n\t\t\t\t\t\t\t<div><b>{caption}</b> &nbsp; <Muted>{discription}</Muted></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"pr-2\"><Muted><EasyTime date={$create} /></Muted></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"text-primary pl-2 py-1 border-top\">{this.renderState(doing)}</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t}\n\t*/\n}\n","import * as React from 'react';\nimport { List, EasyTime, Muted, tv, FA, VPage, User, Image, UserView } from 'tonva';\nimport { Assign } from 'models';\nimport { stateText } from 'tapp';\nimport { CReport, Doing } from './CReport';\nimport { observer } from 'mobx-react';\n\n// const cnIcon = \"d-flex justify-content-center align-items-center rounded border border-info text-danger w-3c h-3c font-1-5c mr-3\";\n\nexport class VMyTodos extends VPage<CReport> {\n\theader() { return '待办工作'; }\n\n\tcontent() {\n\t\tlet page = observer(() => {\n\t\t\tlet none = <div className=\"px-3 py-2 text-muted small border-top\">[无]</div>;\n\t\t\treturn <List className=\"bg-transparent\" items={this.controller.myDoingsPager}\n\t\t\t\t\titem={{render: this.renderDoing, onClick: this.onClickDoing, key: this.keyDoing, className:\"bg-transparent\"}}\n\t\t\t\t\tnone={none}\n\t\t\t\t\t/>\n\t\t});\n\t\treturn React.createElement(page);\n\t}\n\n\tprivate keyDoing = (doing: Doing) => {\n\t\treturn doing.task;\n\t}\n\n\tprivate onClickDoing = (doing: Doing) => {\n\t\t//this.controller.showTask(doing.task);\n\t}\n\n\tprivate renderState(doing:Doing):JSX.Element {\n\t\tlet {state, date} = doing;\n\t\tlet pointer = <FA className=\"text-danger mr-1\" name=\"chevron-circle-right\" />;\n\t\tlet {me, act} = stateText(state);\n\t\treturn <>{pointer} <small>{me}</small> &nbsp; <Muted>{act}于<EasyTime date={date} /></Muted></>;\n\t}\n\n\tprivate renderDoing = (doing:Doing, index: number) => {\n\t\tlet {assign, worker, $create} = doing;\n\t\tlet renderIcon = (user:User) => {\n\t\t\tlet {icon} = user;\n\t\t\treturn <Image className=\"w-2c h-2c mt-1\" src={icon} /> \n\t\t};\n\t\tlet renderNick = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <small>{nick || name}</small>\n\t\t};\n\t\treturn tv(assign, (values: Assign) => {\n\t\t\tlet {caption, discription} = values;\n\t\t\treturn <div className=\"my-1 bg-white\">\n\t\t\t\t<div className=\"px-3 py-2\">\n\t\t\t\t\t<UserView user={worker} render={renderIcon} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill\">\n\t\t\t\t\t<div className=\"d-flex pt-1 pb-2\">\n\t\t\t\t\t\t<div className=\"flex-fill pl-2\">\n\t\t\t\t\t\t\t<UserView user={worker} render={renderNick} />\n\t\t\t\t\t\t\t<div><b>{caption}</b> &nbsp; <Muted>{discription}</Muted></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"pr-2\"><Muted><EasyTime date={$create} /></Muted></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"text-primary pl-2 py-1 border-top\">{this.renderState(doing)}</div>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t}\n\n}\n","import { CUqBase, EnumTaskState, Performance, EnumTaskAct } from \"../tapp\";\nimport { VMyTasks } from \"./VMyTasks\";\nimport { VReport } from \"./VReport\";\nimport { QueryPager } from \"tonva\";\nimport { AssignTask } from \"models\";\nimport { VMyTodos } from \"./VMyTodos\";\n\nexport interface Doing {\n\ttask: number; // ID ASC,\n\tassign: any; // ID Assign,\n\tworker: number; // ID,\n\t$create: Date; // TIMESTAMP, \n\tstate: EnumTaskState; \n\tdate: Date;\t\t// task act time\n}\n\nexport class CReport extends CUqBase {\n\tprivate performance: Performance;\n\t//private loaded:boolean;\n\tmyDoingsPager: QueryPager<Doing>;\n\tmyArchiveTodosPager: QueryPager<any>;\n\tmyTasksPager: QueryPager<AssignTask>;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.performance = this.uqs.performance;\n\t\tthis.myDoingsPager = new QueryPager(this.uqs.performance.GetMyTasks, 10, 100);\n\t\t//this.myTasksPager = new QueryPager(this.performance.GetMyTaskArchive, 10, 30, true);\n\t\t//this.loaded = false;\n\t}\n\n\ttab = () => this.renderView(VReport);\n\n\tload = async () => {\n\t\t//if (this.loaded === true) return;\n\t\t//this.loaded = true;\n\t\t//await this.myDoingsPager.first({});\n\t}\n\n\trefresh = async() => {\n\t\t//await this.myDoingsPager.refresh();\n\t}\n/*\n\tshowTask = async (taskId: number) => {\n\t\tawait this.cApp.showTask(taskId);\n\t}\n\n\tshowMyAssigns = async () => {\n\t\tawait this.cApp.showMyAssigns();\n\t}\n*/\n\tshowMyTasks = async () => {\n\t\tawait this.myTasksPager.first({});\n\t\tthis.openVPage(VMyTasks);\n\t}\n\n\tshowMyTodos = async () => {\n\t\tawait this.myDoingsPager.first({});\n\t\tthis.openVPage(VMyTodos);\n\t}\n\n\tasync loadTaskArchive(step: EnumTaskAct) {\n\t\tthis.myTasksPager.reset();\n\t\tawait this.myTasksPager.first({step});\n\t}\n\n\ttestText = async () => {\n\t\tlet t = 'a\\nb\\ncc';\n\t\tawait this.uqs.performance.TestText.submit({i: 1, tIn: t});\n\t}\n}\n","import React from 'react';\nimport { VPage } from \"tonva\";\nimport { CMember } from \"./CMember\";\n\nexport class VMemberDetail extends VPage<CMember> {\n\theader() {\n\t\treturn '详情';\n\t}\n\tcontent() {\n\t\treturn <div className=\"p-3\">\n\t\t\t同事详情 正在实现中...\n\t\t</div>\n\t}\n}\n","import React from 'react';\nimport { VPage, List, Muted, FA } from \"tonva\";\nimport { CMember, MemberItem } from \"./CMember\";\n\nexport class VMain extends VPage<CMember> {\n\theader() {return '同事'}\n\tcontent() {\n\t\tlet bgIcon = 'bg-info';\n\t\tlet icon = 'building-o';\n\t\treturn <>\n\t\t\t<div className=\"d-flex py-2 px-3 cursor-pointer mb-1 bg-white align-items-center\"\n\t\t\t\tonClick={this.controller.showDepartment}>\n\t\t\t\t<div className={'d-flex w-2c h-2c text-center mr-3 rounded text-white align-items-center justify-content-center ' + bgIcon}>\n\t\t\t\t\t<FA name={icon} fixWidth={true} size=\"lg\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-grow-1\">单位</div>\n\t\t\t\t<div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<List className=\"my-3\" \n\t\t\t\titems={this.controller.myMembersPager}\n\t\t\t\titem={{render:this.renderMemberItem, onClick:this.onMemberItem}}\n\t\t\t\tnone=\"无\"\n\t\t\t/>\n\t\t</>;\n\t}\n\n\tprivate renderMemberItem = (memberItem:MemberItem, index:number) => {\n\t\tlet {member, count} = memberItem;\n\t\treturn <div className=\"d-flex px-3 py-2\">\n\t\t\t{this.renderUser(member, 'w-2c h-2c mr-3', 'flex-grow-1')}\n\t\t\t<div>\n\t\t\t\t{count>0 && <Muted>{count}群</Muted>}\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tprivate onMemberItem = (userId:number) => {\n\t\tthis.controller.showMemberDetail(userId);\n\t}\n}\n","import React from 'react';\nimport { VPage } from \"tonva\";\nimport { CMember } from \"./CMember\";\n\nexport class VDepartmentList extends VPage<CMember> {\n\theader() {return '单位'}\n\tcontent() {\n\t\treturn <div className=\"p-3\">按单位查看同事 正在实现中...</div>;\n\t}\n}\n","import { VMemberDetail } from \"./VMemberDetail\";\nimport { VMain } from \"./VMain\";\nimport { CUqBase } from \"tapp\";\nimport { QueryPager } from \"tonva\";\nimport { Performance } from '../tapp'\nimport { VDepartmentList } from \"./VDepartmentList\";\n\nexport interface MemberItem {\n\tmember: number;\n\tcount: number;\n}\n\nexport class CMember extends CUqBase {\n\tprivate performance: Performance;\n\tmyMembersPager: QueryPager<MemberItem>;\n\t\n\tprotected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.performance = this.uqs.performance;\n\t\tthis.myMembersPager = new QueryPager(this.performance.GetMyMembers, 10, 500, true);\n\t}\n\t\n\tshowMemberDetail = async (memberId:number) => {\n\t\tthis.openVPage(VMemberDetail);\n\t}\n\n\tshowList = async () => {\n\t\tawait this.myMembersPager.first(undefined);\n\t\tthis.openVPage(VMain);\n\t}\n\n\tshowDepartment = async () => {\n\t\tthis.openVPage(VDepartmentList);\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VPage, FA, LMR, Page, Form, ItemSchema, Context, List, UiSchema, UiTextItem } from 'tonva';\nimport { CProject, ProjectItem } from \"./CProject\";\n\nexport class VProjectList extends VPage<CProject> {\n\theader() {return '项目'}\n\tright() {return <button onClick={this.onClickAdd}\n\t\tclassName=\"btn btn-sm btn-primary align-self-center mr-2\">\n\t\t<FA name=\"plus\" />\n\t\t</button>;\n\t\t}\n\n\tcontent() {\n\t\treturn <>\n\t\t\t{React.createElement(this.projectListContent)}\n\t\t</>;\n\t}\n\n\tprivate projectListContent = observer(() => {\n\t\tlet { projectsPager } = this.controller;\n\t\treturn <>\n\t\t\t<List className=\"flex-fill bg-transparent\" \n\t\t\t\titems={projectsPager.items} \n\t\t\t\titem={{render: this.renderProject}}\n\t\t\t/>\n\t\t</>\t\t\n\t})\n\n\tprivate renderProject = (projectItem:ProjectItem, index:number):JSX.Element => {\n\t\treturn <LMR className=\"py-3 px-3 mb-1 bg-white\" >\n\t\t\t<div><b>{projectItem.name}</b> &nbsp; {projectItem.content}</div>\n\t\t\t</LMR>\n\t}\n\n\tprivate onClickProjectItem(item:ProjectItem) {\n\t\tthis.controller.onSelectItem(item);\n\t}\n\n\tprivate onClickSend = () => {\n\t\tthis.form.buttonClick('send');\n\t}\n\n\tprivate onFormSubmit = async (buttonName:string, context: Context) => {\n\t\tlet {name, content} = context.data;\n\t\tlet ret = await this.controller.saveProject(name, content);\n\t\tif (ret >  0) {\n\t\t\tthis.closePage();\n\t\t}\n\t}\n\n\tprivate form: Form;\n\tprivate onClickAdd = () => {\n\t\tlet schema:ItemSchema[] = [\n\t\t\t{name: 'name', type: 'string'},\n\t\t\t{name: 'content', type: 'string'}\n\t\t];\n\t\tlet uiSchema:UiSchema = {\n\t\t\titems: {\n\t\t\t\tname: {\n\t\t\t\t\tlabel: '名称',\n\t\t\t\t\tplaceholder: '输入项目名称'\n\t\t\t\t} as UiTextItem,\n\t\t\t\tcontent: { \n\t\t\t\t\tlabel: '描述',\n\t\t\t\t\tplaceholder: '输入项目描述'\n\t\t\t\t} as UiTextItem\n\t\t\t}\n\t\t}\n\t\tlet right = <button onClick={this.onClickSend}\n\t\t\tclassName=\"btn btn-sm btn-success align-self-center mr-2\">\n\t\t\t<FA name=\"paper-plane-o\" />\n\t\t</button>;\n\t\tthis.openPageElement(<Page header=\"新建项目\" right={right}>\n\t\t\t<div className=\"m-3\">\n\t\t\t\t<Form ref={f => this.form = f} schema={schema} uiSchema={uiSchema}\n\t\t\t\t\tonButtonClick={this.onFormSubmit} />\n\t\t\t</div>\n\t\t</Page>);\n\t}\n\n}","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VPage, LMR, List } from 'tonva';\nimport { CSelectProject, ProjectItem } from \"./CProject\";\n\nexport class VSelectProject extends VPage<CSelectProject> {\n  header() {return '选择项目'}\n\n\tcontent() {\n\t\treturn <>\n\t\t\t{React.createElement(this.projectListContent)}\n\t\t</>;\n\t}\n\n\tprivate projectListContent = observer(() => {\n\t\tlet { projectsPager } = this.controller;\n\t\treturn <>\n\t\t\t<List className=\"flex-fill bg-transparent\" \n\t\t\t\titems={projectsPager.items} \n\t\t\t\titem={{render: this.renderProject}}\n\t\t\t/>\n\t\t</>\t\t\n\t})\n\n\tprivate renderProject = (projectItem:ProjectItem, index:number):JSX.Element => {\n\t\treturn <LMR className=\"py-3 px-3 mb-1 bg-white\" onClick={()=> this.onClickProjectItem(projectItem)}>\n\t\t\t<div><b>{projectItem.name}</b> &nbsp; {projectItem.content}</div>\n\t\t\t</LMR>\n\t}\n\n  protected afterBack() {\n    this.controller.onSelectItem(undefined);\n  }\n\n\tprivate onClickProjectItem(item:ProjectItem) {\n    this.controller.onSelectItem(item);\n    this.controller.closePage();\n\t}\n}","import { CUqBase } from \"tapp\";\nimport { QueryPager, BoxId } from \"tonva\";\nimport { VProjectList } from \"./VProjectList\";\nimport { Performance } from '../tapp'\nimport { VSelectProject } from \"./VSelectProject\";\n\nexport interface ProjectItem {\n\tid: number;\n\tproject: BoxId;\n\tname: string;\n\tcontent: string;\n\towner?: number;\n}\n\nexport class CProject extends CUqBase {\n\tprivate performance: Performance;\n\tprojectsPager: ProjectPager;\n\n  protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.performance = this.uqs.performance;\n\t\tthis.projectsPager = new ProjectPager(this.performance.GetMyProjects, 10, 500, true);\n\t}\n\n\tasync load() {\n\t\tawait this.projectsPager.first(undefined);\n\t}\n\n\n\tshowList = async () => {\n\t\tthis.load();\n\t\tthis.openVPage(VProjectList);\n\t}\n\n\tasync saveProject(name:string, content:string) {\n\t\tlet data = { name, content};\n\t\tlet ret = await this.performance.SaveProject.submit(data);\n\t\tlet retProjectId = ret?.projectId as number;\n\t\tif (retProjectId > 0) {\n\t\t\tlet projectBoxId = this.performance.Project.boxId(retProjectId);\n\t\t\tlet nitem = { \n\t\t\t\tid: this.projectsPager.items.length + 1, \n\t\t\t\tproject: projectBoxId,\n\t\t\t\tname: name,\n\t\t\t\tcontent: content,\n\t\t\t\towner: this.user.id\n\t\t\t}\n\t\t\tthis.projectsPager.items.unshift(nitem);\n\t\t}\n\n\t\treturn retProjectId;\n\t}\n\n\tasync onSelectItem(item:ProjectItem) {\n\t}\n}\n\nclass ProjectPager extends QueryPager<ProjectItem> {\n\tprotected getRefreshPageId(item:any) {\n\t\tif (item === undefined) return;\n\t\tlet pageId = item['project'];\n\t\tif (typeof pageId === 'object') {\n\t\t\treturn pageId.id;\n\t\t}\n\t\treturn pageId;\n\t}\n}\n\nexport class CSelectProject extends CUqBase {\n\tprivate performance: Performance;\n\tprojectsPager: ProjectPager;\n\n\tconstructor(cApp: any) {\n\t\tsuper(cApp);\n\t}\n\n  protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.performance = this.uqs.performance;\n\t\tthis.projectsPager = new ProjectPager(this.performance.GetMyProjects, 10, 500, true);\n\t}\n\n\tasync load() {\n\t\tawait this.projectsPager.first(undefined);\n\t}\n\n\tasync showDialog(): Promise<BoxId> {\n\t\tawait this.load();\n\t\treturn await this.vCall(VSelectProject);\n\t}\n\n\tasync onSelectItem(item:ProjectItem) {\n\t\tthis.returnCall(item?.project);\n\t}\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { Elements, BoxId } from 'tonva';\nimport { CUqApp } from \".\";\nimport { VMain } from './main';\nimport { CMe } from \"me/CMe\";\nimport { CTest } from \"test/CTest\";\nimport { CHome } from \"home/CHome\";\nimport { CReport } from \"report/CReport\";\n//import { CTask } from '../old/task/CTask';\n//import { CAssign } from '../old/assign/CAssign';\nimport { EnumNoteType } from './uqs';\nimport { CMember } from 'member/CMember';\nimport { CProject, CSelectProject } from 'project';\n\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\n\nexport class CApp extends CUqApp {\n\tcGroup: CHome;\n\tcReport: CReport;\n    cHome: CTest;\n\tcMe: CMe;\n\t//cAssign: CAssign;\n\t//cTask: CTask;\n\tcMember: CMember;\n\tcProject: CProject;\n\tcSelectProject: CSelectProject;\n\n    protected async internalStart() {\n\t\t// eslint-disable-next-line \n\t\tlet a = undefined??0;\n\t\tlet {test1, test2} = this.uqs.performance;\n\t\t// eslint-disable-next-line\n\t\tlet [values1, values2] = await Promise.all([\n\t\t\ttest1.loadValues(),\n\t\t\ttest2.loadValues()\n\t\t]);\n \n\t\tthis.cGroup = this.newC(CHome);\n\t\tthis.cGroup.load();\n\t\tthis.cReport = this.newC(CReport);\n\t\tthis.cReport.start();\n        this.cHome = this.newC(CTest);\n\t\tthis.cMe = this.newC(CMe);\n\t\t//this.cAssign = this.newC(CAssign);\n\t\t//this.cTask = this.newC(CTask);\n\t\tthis.cMember = this.newC(CMember);\n\t\tthis.cProject = this.newC(CProject);\n\t\tthis.cSelectProject = this.newC(CSelectProject);\n\t\tthis.showMain();\n\n\t\tsetInterval(this.callTick, 1000);\n\t}\n\n\tprivate tick = 0;\n\tprivate gapIndex = 0;\n\tprivate callTick = async () => {\n\t\ttry {\n\t\t\tif (!this.user) return;\n\t\t\t++this.tick;\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\n\t\t\tconsole.error('tick ', new Date());\n\t\t\tthis.tick = 0;\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\n\t\t\tlet ret = await this.uqs.performance.$Poked.query(undefined, false);\n\t\t\tlet v = ret.ret[0];\n\t\t\tif (v === undefined) return;\n\t\t\tif (!v.poke) return;\n\t\t\tthis.gapIndex = 1;\n\t\t\tthis.cGroup.refresh();\n\t\t}\n\t\tcatch {\n\t\t}\n\t}\n\n    showMain(initTabName?: string) {\n        this.openVPage(VMain, initTabName);\n\t}\n\n\tprotected afterStart():Promise<void> {\n\t\tlet elements:Elements = {\n\t\t\taId: aTest,\n\t\t\tbId: bTest,\n\t\t\tcId: cTest,\n\t\t};\n\n\t\tlet n = 1;\n\t\tlet hello = 'hello';\n\n\t\tfunction aTest(element: HTMLElement) {\n\t\t\telement.innerText = hello;\n\t\t};\n\n\t\tfunction bTest(element: HTMLElement) {\n\t\t\telement.innerText = hello + ', world!';\n\t\t};\n\n\t\tfunction cTest(element: HTMLElement) {\n\t\t\tReactDOM.render(<b className=\"text-success\">{hello}, great</b>, element);\n\t\t};\n\n\t\tthis.hookElements(elements);\n\n\t\twindow.onfocus = () => {\n\t\t\thello = hello + (++n);\n\t\t\tthis.hookElements(elements);\n\t\t}\n\t\treturn;\n\t}\n\n\t//====== App calls =======\n\taddGroupAssignCount(group:number, delta:number) {\n\t\tthis.cGroup.addGroupAssignCount(group, delta);\n\t}\n/*\n\tasync showTask(taskId:number):Promise<void> {\n\t\tawait this.cTask.showTask(taskId);\n\t}\n\n\tasync showNewTask(assign:Assign) {\n\t\tawait this.cTask.showNew(assign);\n\t}\n*/\n\tshowMyTasks = async ():Promise<void> => {\n\t\tawait this.cReport.showMyTasks();\n\t}\n\n\tshowMyTodos = async ():Promise<void> => {\n\t\tawait this.cReport.showMyTodos();\n\t}\n/*\n\tasync showAssign(assignId:number):Promise<void> {\n\t\tawait this.cAssign.showAssign(assignId);\n\t}\n\n\tasync showNewAssign():Promise<boolean> {\n\t\tlet ret = await this.cAssign.showNewAssign(this.cGroup.publishAssign);\n\t\treturn ret;\n\t}\n\n\tasync showMyAssigns():Promise<void> {\n\t\tawait this.cAssign.showMyAssigns();\n\t}\n*/\n\tasync showMemberDetail(memberId:number):Promise<void> {\n\t\tthis.cMember.showMemberDetail(memberId);\n\t}\n\n\tasync pushTaskNote(retAfterTaskAction:any) {\n\t\tif (!retAfterTaskAction) {\n\t\t\tconsole.error('task action return undefined')\n\t\t\treturn;\n\t\t}\n\t\tlet {task, step, state, group} = retAfterTaskAction;\n\t\tlet data = {\n\t\t\tgroup, \n\t\t\tcontent: step + '|' + state, \n\t\t\ttype:EnumNoteType.Task, \n\t\t\tobj:task\n\t\t};\n\t\tawait this.uqs.performance.PushNote.submit(data);\n\t\tthis.resetTick();\n\t\tthis.cGroup.refresh();\n\t}\n\n\tresetTick() {\n\t\tthis.tick = 0;\n\t\tthis.gapIndex = 1;\n\t}\n\n\tshowProjects = () => {\n\t\tthis.cProject.showList();\n\t}\n\n\tasync showSelectProject():Promise<BoxId> {\n\t\treturn await this.cSelectProject.showDialog();\n\t}\n}\n","import React from 'react';\nimport { nav, NavView, start } from 'tonva';\n//import logo from './logo.svg';\nimport './App.css';\nimport { CApp } from './tapp/CApp';\nimport { appConfig } from './tapp';\n\nnav.setSettings(appConfig);\n\nconst App: React.FC = () => {\n    const onLogined = async () => {\n\t\tawait start(CApp, appConfig);\n    }\n    return <NavView onLogined={onLogined} />;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css';\n\nlet elRoot = document.getElementById('root');\nif (!elRoot) {\n\telRoot = document.createElement('div');\n\telRoot.style.display = 'none';\n\tdocument.body.append(elRoot);\n}\nReactDOM.render(<App />, elRoot);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}